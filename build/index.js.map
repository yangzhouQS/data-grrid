{"version":3,"file":"index.js","mappings":"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","sources":["webpack://MyLibrary/webpack/universalModuleDefinition","webpack://MyLibrary/./src/internal/legacy/canvas/PathCommands.ts","webpack://MyLibrary/./src/internal/legacy/canvas/PathCommandsParser.ts","webpack://MyLibrary/./src/internal/legacy/canvas/Path2DShim.ts","webpack://MyLibrary/webpack/bootstrap","webpack://MyLibrary/webpack/runtime/define property getters","webpack://MyLibrary/webpack/runtime/global","webpack://MyLibrary/webpack/runtime/hasOwnProperty shorthand","webpack://MyLibrary/webpack/runtime/make namespace object","webpack://MyLibrary/./src/internal/utils.ts","webpack://MyLibrary/./src/core/DG_EVENT_TYPE.ts","webpack://MyLibrary/./src/columns/action/actionBind.ts","webpack://MyLibrary/./src/columns/action/BaseAction.ts","webpack://MyLibrary/./src/columns/action/action-utils.ts","webpack://MyLibrary/./src/columns/action/Action.ts","webpack://MyLibrary/./src/internal/symbolManager.ts","webpack://MyLibrary/./src/columns/action/ButtonAction.ts","webpack://MyLibrary/./src/columns/action/Editor.ts","webpack://MyLibrary/./src/internal/animate.ts","webpack://MyLibrary/./src/columns/action/CheckEditor.ts","webpack://MyLibrary/./src/columns/action/BaseInputEditor.ts","webpack://MyLibrary/./src/internal/EventHandler.ts","webpack://MyLibrary/./src/internal/dom.ts","webpack://MyLibrary/./src/columns/action/internal/input-value-handler.ts","webpack://MyLibrary/./src/columns/action/internal/InlineInputElement.ts","webpack://MyLibrary/./src/columns/action/InlineInputEditor.ts","webpack://MyLibrary/./src/columns/action/internal/InlineMenuElement.ts","webpack://MyLibrary/./src/core/EventTarget.ts","webpack://MyLibrary/./src/columns/style/BaseStyle.ts","webpack://MyLibrary/./src/columns/style/StdBaseStyle.ts","webpack://MyLibrary/./src/columns/style/Style.ts","webpack://MyLibrary/./src/columns/style/ButtonStyle.ts","webpack://MyLibrary/./src/columns/style/CheckStyle.ts","webpack://MyLibrary/./src/columns/style/IconStyle.ts","webpack://MyLibrary/./src/columns/style/ImageStyle.ts","webpack://MyLibrary/./src/columns/style/MenuStyle.ts","webpack://MyLibrary/./src/columns/style/MultilineTextStyle.ts","webpack://MyLibrary/./src/columns/style/NumberStyle.ts","webpack://MyLibrary/./src/columns/style/PercentCompleteBarStyle.ts","webpack://MyLibrary/./src/columns/style/RadioStyle.ts","webpack://MyLibrary/./src/columns/style.ts","webpack://MyLibrary/./src/columns/type/BaseColumn.ts","webpack://MyLibrary/./src/columns/style/BranchGraphStyle.ts","webpack://MyLibrary/./src/columns/type/BranchGraphColumn.ts","webpack://MyLibrary/./src/internal/icons.ts","webpack://MyLibrary/./src/columns/type/columnUtils.ts","webpack://MyLibrary/./src/columns/type/Column.ts","webpack://MyLibrary/./src/columns/type/ButtonColumn.ts","webpack://MyLibrary/./src/columns/utils/index.ts","webpack://MyLibrary/./src/columns/type/CheckColumn.ts","webpack://MyLibrary/./src/columns/type/IconColumn.ts","webpack://MyLibrary/./src/internal/canvases.ts","webpack://MyLibrary/./src/internal/LRUCache.ts","webpack://MyLibrary/./src/internal/imgs.ts","webpack://MyLibrary/./src/columns/type/ImageColumn.ts","webpack://MyLibrary/./src/internal/menu-items.ts","webpack://MyLibrary/./src/columns/type/MenuColumn.ts","webpack://MyLibrary/./src/columns/type/MultilineTextColumn.ts","webpack://MyLibrary/./src/columns/type/NumberColumn.ts","webpack://MyLibrary/./src/columns/type/PercentCompleteBarColumn.ts","webpack://MyLibrary/./src/columns/type/RadioColumn.ts","webpack://MyLibrary/./src/columns/type.ts","webpack://MyLibrary/./src/columns/action/InlineMenuEditor.ts","webpack://MyLibrary/./src/columns/action/RadioEditor.ts","webpack://MyLibrary/./src/columns/action/internal/SmallDialogInputElement.ts","webpack://MyLibrary/./src/columns/action/SmallDialogInputEditor.ts","webpack://MyLibrary/./src/columns/action.ts","webpack://MyLibrary/./src/columns.ts","webpack://MyLibrary/./src/internal/calc.ts","webpack://MyLibrary/./src/internal/hiDPI.ts","webpack://MyLibrary/./src/internal/style.ts","webpack://MyLibrary/./src/internal/NumberMap.ts","webpack://MyLibrary/./src/internal/Rect.ts","webpack://MyLibrary/./src/internal/Scrollable.ts","webpack://MyLibrary/./src/internal/paste-utils.ts","webpack://MyLibrary/./src/core/DrawGrid.ts","webpack://MyLibrary/./src/core.ts","webpack://MyLibrary/./src/tools/canvashelper.ts","webpack://MyLibrary/./src/tools.ts","webpack://MyLibrary/./src/themes/theme.ts","webpack://MyLibrary/./src/themes/BASIC.ts","webpack://MyLibrary/./src/themes/MATERIAL_DESIGN.ts","webpack://MyLibrary/./src/plugins/themes.ts","webpack://MyLibrary/./src/themes.ts","webpack://MyLibrary/./src/internal/sort.ts","webpack://MyLibrary/./src/data/DataSource.ts","webpack://MyLibrary/./src/data/CachedDataSource.ts","webpack://MyLibrary/./src/header/action/BaseAction.ts","webpack://MyLibrary/./src/header/action/actionBind.ts","webpack://MyLibrary/./src/header/action/CheckHeaderAction.ts","webpack://MyLibrary/./src/header/action/SortHeaderAction.ts","webpack://MyLibrary/./src/header/action.ts","webpack://MyLibrary/./src/header/style/BaseStyle.ts","webpack://MyLibrary/./src/header/style/StdBaseStyle.ts","webpack://MyLibrary/./src/header/style/Style.ts","webpack://MyLibrary/./src/header/style/CheckHeaderStyle.ts","webpack://MyLibrary/./src/header/style/MultilineTextHeaderStyle.ts","webpack://MyLibrary/./src/header/style/SortHeaderStyle.ts","webpack://MyLibrary/./src/header/style.ts","webpack://MyLibrary/./src/header/type/BaseHeader.ts","webpack://MyLibrary/./src/header/type/CheckHeader.ts","webpack://MyLibrary/./src/header/type/Header.ts","webpack://MyLibrary/./src/header/type/MultilineTextHeader.ts","webpack://MyLibrary/./src/header/type/SortHeader.ts","webpack://MyLibrary/./src/header/type.ts","webpack://MyLibrary/./src/list-grid/layout-map/internal/utils.ts","webpack://MyLibrary/./src/list-grid/layout-map/internal/simple-header-layout.ts","webpack://MyLibrary/./src/list-grid/layout-map/internal/multi-layout.ts","webpack://MyLibrary/./src/columns/message/messageUtils.ts","webpack://MyLibrary/./src/columns/message/BaseMessage.ts","webpack://MyLibrary/./src/columns/message/internal/MessageElement.ts","webpack://MyLibrary/./src/columns/message/internal/ErrorMessageElement.ts","webpack://MyLibrary/./src/columns/message/ErrorMessage.ts","webpack://MyLibrary/./src/columns/message/InfoMessage.ts","webpack://MyLibrary/./src/list-grid/LG_EVENT_TYPE.ts","webpack://MyLibrary/./src/columns/message/internal/WarningMessageElement.ts","webpack://MyLibrary/./src/columns/message/WarningMessage.ts","webpack://MyLibrary/./src/columns/message/MessageHandler.ts","webpack://MyLibrary/./src/internal/legacy/fontwatch/FontRuler.ts","webpack://MyLibrary/./src/internal/legacy/fontwatch/FontWatchRunner.ts","webpack://MyLibrary/./src/internal/fonts.ts","webpack://MyLibrary/./src/plugins/icons.ts","webpack://MyLibrary/./src/tools/Svg.ts","webpack://MyLibrary/./src/tools/svgToIcon.ts","webpack://MyLibrary/./src/icons.ts","webpack://MyLibrary/./src/icons/ic_add_48px.svg","webpack://MyLibrary/./src/icons/ic_arrow_downward_48px.svg","webpack://MyLibrary/./src/icons/ic_arrow_upward_48px.svg","webpack://MyLibrary/./src/icons/ic_edit_48px.svg","webpack://MyLibrary/./src/icons/ic_star_24px.svg","webpack://MyLibrary/./src/icons/ic_star_border_24px.svg","webpack://MyLibrary/./src/icons/ic_star_half_24px.svg","webpack://MyLibrary/./src/internal/path2DManager.ts","webpack://MyLibrary/./src/element/Inline.ts","webpack://MyLibrary/./src/element/InlineDrawer.ts","webpack://MyLibrary/./src/element/InlineIcon.ts","webpack://MyLibrary/./src/element/InlineImage.ts","webpack://MyLibrary/./src/element/InlinePath2D.ts","webpack://MyLibrary/./src/element/InlineSvg.ts","webpack://MyLibrary/./src/element/inlines.ts","webpack://MyLibrary/./src/internal/color.ts","webpack://MyLibrary/./src/GridCanvasHelper.ts","webpack://MyLibrary/./src/tooltip/internal/TooltipElement.ts","webpack://MyLibrary/./src/tooltip/Tooltip.ts","webpack://MyLibrary/./src/tooltip/BaseTooltip.ts","webpack://MyLibrary/./src/tooltip/TooltipHandler.ts","webpack://MyLibrary/./src/ListGrid.ts","webpack://MyLibrary/./src/data/FilterDataSource.ts","webpack://MyLibrary/./src/data.ts","webpack://MyLibrary/./src/headers.ts","webpack://MyLibrary/./src/register.ts","webpack://MyLibrary/./src/main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MyLibrary\"] = factory();\n\telse\n\t\troot[\"MyLibrary\"] = factory();\n})(self, function() {\nreturn ","import type { CanvasOperations } from './internal';\n\n/*eslint new-cap: \"off\"*/\n\nfunction mag(v: [ number, number ]): number {\n  return Math.sqrt(v[0] ** 2 + v[1] ** 2);\n}\n\nfunction dot(u: [ number, number ], v: [ number, number ]): number {\n  return u[0] * v[0] + u[1] * v[1];\n}\n\nfunction ratio(u: [ number, number ], v: [ number, number ]): number {\n  return dot(u, v) / (mag(u) * mag(v));\n}\n\nfunction clamp(value: number, min: number, max: number): number {\n  return Math.min(Math.max(value, min), max);\n}\n\nfunction angle(u: [ number, number ], v: [ number, number ]): number {\n  let sign = 1.0;\n  if (u[0] * v[1] - u[1] * v[0] < 0) {\n    sign = -1.0;\n  }\n  return sign * Math.acos(clamp(ratio(u, v), -1, 1));\n}\n\nfunction rotClockwise(v: [ number, number ], angle: number): [ number, number ] {\n  const cost = Math.cos(angle);\n  const sint = Math.sin(angle);\n  return [ cost * v[0] + sint * v[1], -1 * sint * v[0] + cost * v[1] ];\n}\n\nfunction rotCounterClockwise(v: [ number, number ], angle: number): [ number, number ] {\n  const cost = Math.cos(angle);\n  const sint = Math.sin(angle);\n  return [ cost * v[0] - sint * v[1], sint * v[0] + cost * v[1] ];\n}\n\nfunction midPoint(u: [ number, number ], v: [ number, number ]): [ number, number ] {\n  return [ (u[0] - v[0]) / 2.0, (u[1] - v[1]) / 2.0 ];\n}\n\nfunction meanVec(u: [ number, number ], v: [ number, number ]): [ number, number ] {\n  return [ (u[0] + v[0]) / 2.0, (u[1] + v[1]) / 2.0 ];\n}\n\nfunction pointMul(u: [ number, number ], v: [ number, number ]): [ number, number ] {\n  return [ u[0] * v[0], u[1] * v[1] ];\n}\n\nfunction scale(c: number, v: [ number, number ]): [ number, number ] {\n  return [ c * v[0], c * v[1] ];\n}\n\nfunction sum(u: [ number, number ], v: [ number, number ]): [ number, number ] {\n  return [ u[0] + v[0], u[1] + v[1] ];\n}\n\n// Convert an SVG elliptical arc to a series of canvas commands.\n//\n// x1, y1, x2, y2: start and stop coordinates of the ellipse.\n// rx, ry: radii of the ellipse.\n// phi: rotation of the ellipse.\n// fA: large arc flag.\n// fS: sweep flag.\nfunction ellipseFromEllipticalArc(ctx: CanvasOperations, x1: number, y1: number, rx: number, ry: number, phi: number, fA: number, fS: number, x2: number, y2: number): void {\n  // Convert from endpoint to center parametrization, as detailed in:\n  //   http://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\n  if (rx === 0 || ry === 0) {\n    ctx.lineTo(x2, x1);\n    return;\n  }\n  phi *= Math.PI / 180.0;\n  rx = Math.abs(rx);\n  ry = Math.abs(ry);\n  const xPrime = rotClockwise(midPoint([ x1, y1 ], [ x2, y2 ]), phi); // F.6.5.1\n  const xPrime2 = pointMul(xPrime, xPrime);\n  let rx2 = rx ** 2;\n  let ry2 = ry ** 2;\n\n  const lambda = Math.sqrt(xPrime2[0] / rx2 + xPrime2[1] / ry2);\n  if (lambda > 1) {\n    rx *= lambda;\n    ry *= lambda;\n    rx2 = rx ** 2;\n    ry2 = ry ** 2;\n  }\n  let factor = Math.sqrt(Math.abs(rx2 * ry2 - rx2 * xPrime2[1] - ry2 * xPrime2[0]) / (rx2 * xPrime2[1] + ry2 * xPrime2[0]));\n  if (fA === fS) {\n    factor *= -1.0;\n  }\n  const cPrime = scale(factor, [ (rx * xPrime[1]) / ry, (-ry * xPrime[0]) / rx ]); // F.6.5.2\n  const c = sum(rotCounterClockwise(cPrime, phi), meanVec([ x1, y1 ], [ x2, y2 ])); // F.6.5.3\n  const x1UnitVector: [ number, number ] = [ (xPrime[0] - cPrime[0]) / rx, (xPrime[1] - cPrime[1]) / ry ];\n  const x2UnitVector: [ number, number ] = [ (-1.0 * xPrime[0] - cPrime[0]) / rx, (-1.0 * xPrime[1] - cPrime[1]) / ry ];\n  const theta = angle([ 1, 0 ], x1UnitVector); // F.6.5.5\n  const deltaTheta = angle(x1UnitVector, x2UnitVector); // F.6.5.6\n  const start = theta;\n  const end = theta + deltaTheta;\n  ctx.save();\n  ctx.translate(c[0], c[1]);\n  ctx.rotate(phi);\n  ctx.scale(rx, ry);\n  ctx.arc(0, 0, 1, start, end, !fS);\n  ctx.restore();\n}\n\nexport class PathCommands {\n  public readonly M: (px: number, py: number) => this\n  public readonly m: (px: number, py: number) => this\n  public readonly L: (px: number, py: number) => this\n  public readonly l: (px: number, py: number) => this\n  public readonly H: (px: number) => this\n  public readonly h: (px: number) => this\n  public readonly V: (py: number) => this\n  public readonly v: (py: number) => this\n  public readonly Z: () => this\n  public readonly z: () => this\n  public readonly C: (cp1x: number, cp1y: number, cp2x: number, cp2y: number, px: number, py: number) => this\n  public readonly c: (cp1x: number, cp1y: number, cp2x: number, cp2y: number, px: number, py: number) => this\n  public readonly S: (cpx: number, cpy: number, px: number, py: number) => this\n  public readonly s: (cpx: number, cpy: number, px: number, py: number) => this\n  public readonly Q: (cpx: number, cpy: number, px: number, py: number) => this\n  public readonly q: (cpx: number, cpy: number, px: number, py: number) => this\n  public readonly T: (px: number, py: number) => this\n  public readonly t: (px: number, py: number) => this\n  public readonly A: (rx: number, ry: number, xAxisRotation: number, largeArcFlag: number, sweepFlag: number, px: number, py: number) => this\n  public readonly a: (rx: number, ry: number, xAxisRotation: number, largeArcFlag: number, sweepFlag: number, px: number, py: number) => this\n\n  constructor(ctx: CanvasOperations) {\n    let lMx: number;\n    let lMy: number;\n    let lx = 0;\n    let ly = 0;\n    let reflected: {\n      x: number;\n      y: number;\n    };\n    let lastCommand = '';\n\n    function makeReflected(): {\n      x: number;\n      y: number;\n    } {\n      if ('CcSsQqTt'.indexOf(lastCommand) < 0) {\n        return { x: lx, y: ly };\n      }\n      return reflected;\n    }\n\n    this.M = (px, py): this => {\n      ctx.moveTo(px, py);\n      lMx = px;\n      lMy = py;\n      lx = px;\n      ly = py;\n      lastCommand = 'M';\n      return this;\n    };\n    this.m = (px, py): this => this.M(px + lx, py + ly);\n    this.L = (px, py): this => {\n      ctx.lineTo(px, py);\n      lx = px;\n      ly = py;\n      lastCommand = 'L';\n      return this;\n    };\n    this.l = (px, py): this => this.L(px + lx, py + ly);\n    this.H = (px): this => this.L(px, ly);\n    this.h = (px): this => this.H(px + lx);\n    this.V = (py): this => this.L(lx, py);\n    this.v = (py): this => this.V(py + ly);\n    this.Z = (): this => {\n      ctx.closePath();\n      lx = lMx;\n      ly = lMy;\n      lastCommand = 'Z';\n      return this;\n    };\n    this.z = (): this => this.Z();\n    //C x1 y1, x2 y2, x y (or c dx1 dy1, dx2 dy2, dx dy)\n    this.C = (cp1x, cp1y, cp2x, cp2y, px, py): this => {\n      ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, px, py);\n      lx = px;\n      ly = py;\n      reflected = {\n        x: 2 * px - cp2x,\n        y: 2 * py - cp2y\n      };\n      lastCommand = 'C';\n      return this;\n    };\n    this.c = (cp1x, cp1y, cp2x, cp2y, px, py): this => this.C(cp1x + lx, cp1y + ly, cp2x + lx, cp2y + ly, px + lx, py + ly);\n    //S x2 y2, x y (or s dx2 dy2, dx dy)\n    this.S = (cpx, cpy, px, py): this => {\n      const { x: cp1x, y: cp1y } = makeReflected(/*lastCommand*/);\n      return this.C(cp1x, cp1y, cpx, cpy, px, py);\n    };\n    this.s = (cpx, cpy, px, py): this => this.S(cpx + lx, cpy + ly, px + lx, py + ly);\n    //Q x1 y1, x y (or q dx1 dy1, dx dy)\n    this.Q = (cpx, cpy, px, py): this => {\n      ctx.quadraticCurveTo(cpx, cpy, px, py);\n      lx = px;\n      ly = py;\n      reflected = {\n        x: 2 * px - cpx,\n        y: 2 * py - cpy\n      };\n      lastCommand = 'Q';\n      return this;\n    };\n    this.q = (cpx, cpy, px, py): this => this.Q(cpx + lx, cpy + ly, px + lx, py + ly);\n    //T x y (or t dx dy)\n    this.T = (px, py): this => {\n      const { x: cpx, y: cpy } = makeReflected();\n      return this.Q(cpx, cpy, px, py);\n    };\n    this.t = (px, py): this => this.T(px + lx, py + ly);\n    //A rx ry x-axis-rotation large-arc-flag sweep-flag x y\n    this.A = (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py): this => {\n      const x1 = lx;\n      const y1 = ly;\n\n      ellipseFromEllipticalArc(ctx, x1, y1, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py);\n\n      lx = px;\n      ly = py;\n      lastCommand = 'A';\n      return this;\n    };\n    //a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy\n    this.a = (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py): this => this.A(rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px + lx, py + ly);\n  }\n}\n","import type { AnyFunction } from '../../../ts-types';\nimport type { CanvasOperations } from './internal';\nimport { PathCommands } from './PathCommands';\n\ntype PathCommandName = keyof PathCommands;\ntype CanvasOperation = keyof CanvasOperations;\n\ntype Tokens = { next(): string | null };\n\nfunction pathTokens(d: string): Tokens {\n  let idx = 0;\n  return {\n    next(): string | null {\n      let s = '';\n      while (d.length > idx) {\n        const c = d[idx];\n        idx++;\n        if (' ,\\n\\r\\t'.indexOf(c) > -1) {\n          if (s) {\n            return s;\n          }\n        } else {\n          const type = '.+-1234567890'.indexOf(c) > -1 ? 'num' : 'str';\n          if (type === 'str') {\n            if (s) {\n              idx--;\n              return s;\n            }\n            return c;\n          }\n          if ('-+'.indexOf(c) > -1) {\n            if (s) {\n              idx--;\n              return s;\n            }\n          }\n          if (c === '.') {\n            if (s.indexOf('.') > -1) {\n              idx--;\n              return s;\n            }\n          }\n          s += c;\n        }\n      }\n      return s || null;\n    }\n  };\n}\n\nfunction command(builder: PathCommandsParser, cmd: PathCommandName, argsProvider: Tokens): PathCommandName | null {\n  if (cmd.toUpperCase() === 'M' || cmd.toUpperCase() === 'L' || cmd.toUpperCase() === 'T') {\n    builder.command(cmd, argsProvider.next(), argsProvider.next());\n    return cmd === 'M' ? 'L' : cmd === 'm' ? 'l' : cmd;\n  } else if (cmd.toUpperCase() === 'H' || cmd.toUpperCase() === 'V') {\n    builder.command(cmd, argsProvider.next());\n    return cmd;\n  } else if (cmd.toUpperCase() === 'Z') {\n    builder.command(cmd);\n    return cmd;\n  } else if (cmd.toUpperCase() === 'C') {\n    builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());\n    return cmd;\n  } else if (cmd.toUpperCase() === 'S' || cmd.toUpperCase() === 'Q') {\n    builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());\n    return cmd;\n  } else if (cmd.toUpperCase() === 'A') {\n    builder.command(cmd, argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next(), argsProvider.next());\n    return cmd;\n  } else {\n    // https://developer.mozilla.org/ja/docs/Web/SVG/Tutorial/Paths\n    console.warn(`unsupported:${cmd}`);\n  }\n  return null;\n}\n\nexport class PathCommandsParser implements CanvasOperations {\n  public readonly moveTo: typeof CanvasRenderingContext2D.prototype.moveTo;\n  public readonly lineTo: typeof CanvasRenderingContext2D.prototype.lineTo;\n  public readonly closePath: typeof CanvasRenderingContext2D.prototype.closePath;\n  public readonly bezierCurveTo: typeof CanvasRenderingContext2D.prototype.bezierCurveTo;\n  public readonly quadraticCurveTo: typeof CanvasRenderingContext2D.prototype.quadraticCurveTo;\n  public readonly save: typeof CanvasRenderingContext2D.prototype.save;\n  public readonly translate: typeof CanvasRenderingContext2D.prototype.translate;\n  public readonly rotate: typeof CanvasRenderingContext2D.prototype.rotate;\n  public readonly scale: typeof CanvasRenderingContext2D.prototype.scale;\n  public readonly arc: typeof CanvasRenderingContext2D.prototype.arc;\n  public readonly restore: typeof CanvasRenderingContext2D.prototype.restore;\n  public readonly arcTo: typeof CanvasRenderingContext2D.prototype.arcTo;\n  public readonly ellipse: typeof CanvasRenderingContext2D.prototype.ellipse;\n  public readonly rect: typeof CanvasRenderingContext2D.prototype.rect;\n  private readonly _commands: PathCommands;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _ops: { op: CanvasOperation; args: any[] }[] = [];\n  constructor() {\n    this._commands = new PathCommands(this as CanvasOperations);\n    const buildPush =\n      (op: CanvasOperation) =>\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (...args: any[]): void => {\n          this._ops.push({\n            op,\n            args\n          });\n        };\n    this.moveTo = buildPush('moveTo');\n    this.lineTo = buildPush('lineTo');\n    this.closePath = buildPush('closePath');\n    this.bezierCurveTo = buildPush('bezierCurveTo');\n    this.quadraticCurveTo = buildPush('quadraticCurveTo');\n    this.save = buildPush('save');\n    this.translate = buildPush('translate');\n    this.rotate = buildPush('rotate');\n    this.scale = buildPush('scale');\n    this.arc = buildPush('arc');\n    this.restore = buildPush('restore');\n    this.arcTo = buildPush('arcTo');\n    this.ellipse = buildPush('ellipse');\n    this.rect = buildPush('rect');\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  command(name: PathCommandName, ...args: any[]): void {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const numArgs: any[] = args || [];\n    for (let i = 0; i < args.length; i++) {\n      numArgs[i] -= 0;\n    }\n    const command: AnyFunction = this._commands[name];\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    command.apply(this, numArgs);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  parse(d: string): { op: CanvasOperation; args: any[] }[] {\n    const ops = (this._ops = []);\n    const tokens = pathTokens(d);\n    try {\n      let cmd: string | null;\n      let subsequentCommand: PathCommandName = 'Z';\n      while ((cmd = tokens.next())) {\n        if (!isNaN(Number(cmd))) {\n          let fst = true;\n          const argsProvider: Tokens = {\n            next() {\n              if (fst) {\n                fst = false;\n                return cmd;\n              }\n              return tokens.next();\n            }\n          };\n          subsequentCommand = command(this, subsequentCommand, argsProvider) || 'Z';\n        } else {\n          subsequentCommand = command(this, cmd as PathCommandName, tokens) || 'Z';\n        }\n      }\n    } catch (e) {\n      console.log(`Error: ${d}`);\n      throw e;\n    }\n    return ops;\n  }\n}\n","import type { AnyFunction } from '../../../ts-types';\nimport type { CanvasOperations } from './internal';\nimport { PathCommandsParser } from './PathCommandsParser';\n\nconst parser = new PathCommandsParser();\ntype CanvasOperation = keyof CanvasOperations;\n\nexport class Path2DShim implements CanvasPath {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  _ops: { op: CanvasOperation; args: any[] }[];\n  arc(...args: Parameters<typeof Path2D.prototype.arc>): void {\n    this._ops.push({ op: 'arc', args });\n  }\n  arcTo(...args: Parameters<typeof Path2D.prototype.arcTo>): void {\n    this._ops.push({ op: 'arcTo', args });\n  }\n  bezierCurveTo(...args: Parameters<typeof Path2D.prototype.bezierCurveTo>): void {\n    this._ops.push({ op: 'bezierCurveTo', args });\n  }\n  closePath(...args: Parameters<typeof Path2D.prototype.closePath>): void {\n    this._ops.push({ op: 'closePath', args });\n  }\n  ellipse(...args: Parameters<typeof Path2D.prototype.ellipse>): void {\n    this._ops.push({ op: 'ellipse', args });\n  }\n  lineTo(...args: Parameters<typeof Path2D.prototype.lineTo>): void {\n    this._ops.push({ op: 'lineTo', args });\n  }\n  moveTo(...args: Parameters<typeof Path2D.prototype.moveTo>): void {\n    this._ops.push({ op: 'moveTo', args });\n  }\n  quadraticCurveTo(...args: Parameters<typeof Path2D.prototype.quadraticCurveTo>): void {\n    this._ops.push({ op: 'quadraticCurveTo', args });\n  }\n  rect(...args: Parameters<typeof Path2D.prototype.rect>): void {\n    this._ops.push({ op: 'rect', args });\n  }\n  constructor(arg: string | Path2DShim) {\n    this._ops = [];\n    if (arg === undefined) {\n      return;\n    }\n    if (typeof arg === 'string') {\n      // try {\n      this._ops = parser.parse(arg);\n      // } catch (e) {\n      // \tthrow e;\n      // }\n    } else if (arg.hasOwnProperty('_ops')) {\n      this._ops = [...arg._ops];\n    } else {\n      throw new Error(`Error: ${typeof arg} is not a valid argument to Path`);\n    }\n  }\n}\n\nconst { CanvasRenderingContext2D } = window;\n\nconst originalFill: AnyFunction = CanvasRenderingContext2D.prototype.fill;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\n(CanvasRenderingContext2D.prototype as any).fill = function (...args: Parameters<typeof CanvasRenderingContext2D.prototype.fill>): void {\n  if (args[0] instanceof Path2DShim) {\n    const path = args[0];\n    this.beginPath();\n    path._ops.forEach((op) => {\n      const fn: AnyFunction = this[op.op];\n      fn.apply(this, op.args);\n    });\n    originalFill.apply(this, Array.prototype.slice.call(args, 1));\n  } else {\n    originalFill.apply(this, args);\n  }\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import type { CellAddress, CellRange, MaybeCall, MaybePromise } from '../ts-types';\n\nconst isNode = typeof window === 'undefined' || typeof window.window === 'undefined';\n\ntype ArrayElementPredicate<E> = (t: E, i: number, arr: E[]) => boolean;\n// type ObjectElementPredicate<T, K extends keyof T> = (\n//   t: T[K],\n//   key?: K,\n//   obj?: T\n// ) => boolean;\n\ntype ArrayElementFunction<E> = (t: E, i: number, arr: E[]) => void;\ntype ObjectElementFunction<T, K extends keyof T> = (t: T[K], key: K, obj: T) => void;\nlet arrayFind: <T>(arr: T[], predicate: ArrayElementPredicate<T>) => T | undefined;\nlet arrayFindIndex: <T>(arr: T[], predicate: ArrayElementPredicate<T>) => number;\nconst array = {\n  get find(): typeof arrayFind {\n    if (arrayFind) {\n      return arrayFind;\n    }\n    if (Array.prototype.find) {\n      arrayFind = <T>(arr: T[], predicate: ArrayElementPredicate<T>): T | undefined => Array.prototype.find.call(arr, predicate);\n    } else {\n      arrayFind = <T>(arr: T[], predicate: ArrayElementPredicate<T>): T | undefined => {\n        const index = array.findIndex(arr, predicate);\n        return index >= 0 ? arr[index] : undefined;\n      };\n    }\n    return arrayFind;\n  },\n  get findIndex(): typeof arrayFindIndex {\n    if (arrayFindIndex) {\n      return arrayFindIndex;\n    }\n    if (Array.prototype.findIndex) {\n      arrayFindIndex = <T>(arr: T[], predicate: ArrayElementPredicate<T>): number => Array.prototype.findIndex.call(arr, predicate);\n    } else {\n      arrayFindIndex = <T>(arr: T[], predicate: ArrayElementPredicate<T>): number => {\n        const { length } = arr;\n        for (let i = 0; i < length; i++) {\n          const value = arr[i];\n          if (predicate(value, i, arr)) {\n            return i;\n          }\n        }\n        return -1;\n      };\n    }\n    return arrayFindIndex;\n  }\n};\n\nfunction analyzeUserAgent(): {\n  IE: boolean;\n  Edge: boolean;\n  Chrome: boolean;\n  Firefox: boolean;\n  Safari: boolean;\n} {\n  if (isNode) {\n    return {\n      IE: false,\n      Edge: false,\n      Chrome: false,\n      Firefox: false,\n      Safari: false\n    };\n  } else {\n    const ua = window.navigator.userAgent.toLowerCase();\n    return {\n      IE: !!/(msie|trident)/.exec(ua),\n      Edge: ua.indexOf('edge') > -1,\n      Chrome: ua.indexOf('chrome') > -1 && ua.indexOf('edge') === -1,\n      Firefox: ua.indexOf('firefox') > -1,\n      Safari: ua.indexOf('safari') > -1 && ua.indexOf('edge') === -1\n    };\n  }\n}\n\nconst { IE, Chrome, Firefox, Edge, Safari } = analyzeUserAgent();\n\nfunction setReadonly<T, K extends keyof T>(obj: T, name: K, value: T[K]): void {\n  Object.defineProperty(obj, name, {\n    enumerable: false,\n    configurable: true,\n    value\n  });\n}\n\nexport function each<E>(obj: E[], fn: ArrayElementFunction<E>): void;\nexport function each<T, K extends keyof T>(obj: T, fn: ObjectElementFunction<T, K>): void;\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function each(obj: any, fn: any): void {\n  for (const key in obj) {\n    fn(obj[key], key, obj);\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction isObject(obj: any): obj is Record<string, any> {\n  return obj === Object(obj);\n}\n\nexport function omit<T, K extends keyof T>(source: T, omits: K[]): Omit<T, K> {\n  const result = {} as Omit<T, K>;\n  for (const key in source) {\n    if (omits.indexOf(key as never) >= 0) {\n      continue;\n    }\n    Object.defineProperty(result, key, {\n      get() {\n        return source[key];\n      },\n      set(val) {\n        source[key] = val;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  }\n  return result;\n}\n\nexport function defaults<T>(source: T, defs: Partial<T>): T {\n  const keys: string[] = [];\n  const result = {} as T;\n  for (const key in source) {\n    keys.push(key);\n    Object.defineProperty(result, key, {\n      get() {\n        const val = source[key];\n        return val === undefined ? defs[key] : val;\n      },\n      set(val) {\n        source[key] = val;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  }\n  for (const key in defs) {\n    if (keys.indexOf(key) >= 0) {\n      continue;\n    }\n    Object.defineProperty(result, key, {\n      get() {\n        const val = source[key];\n        return val === undefined ? defs[key] : val;\n      },\n      set(val) {\n        source[key] = val;\n      },\n      configurable: true,\n      enumerable: true\n    });\n  }\n  return result;\n}\n\nexport function extend<T, U>(t: T, u: U): T & U;\nexport function extend<T, U, V>(t: T, u: U, v: V): T & U & V;\nexport function extend<T>(...args: T[]): T;\nexport function extend<T>(...args: T[]): T {\n  const result = {} as T;\n  args.forEach((source) => {\n    for (const key in source) {\n      Object.defineProperty(result, key, {\n        get() {\n          return source[key];\n        },\n        set(val) {\n          source[key] = val;\n        },\n        configurable: true,\n        enumerable: true\n      });\n    }\n  });\n  return result;\n}\n\nfunction isDescendantElement(root: HTMLElement, target: HTMLElement): boolean {\n  while (target.parentElement) {\n    const p = target.parentElement;\n    if (root === p) {\n      return true;\n    }\n    target = p;\n  }\n  return false;\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction applyChainSafe(obj: any, fn: (value: any, name: string) => any, ...names: string[]): any {\n  let value = obj;\n  for (let i = 0; i < names.length && value != null; i++) {\n    value = fn(value, names[i]);\n  }\n  return value;\n}\n\nfunction getChainSafe(obj: any, ...names: string[]): any {\n  return applyChainSafe(obj, (val, name) => val[name], ...names);\n}\n\nfunction getOrApply<_T, A extends any[]>(value: undefined, ...args: A): undefined;\nfunction getOrApply<_T, A extends any[]>(value: null, ...args: A): null;\nfunction getOrApply<T, A extends any[]>(value: MaybeCall<T, A>, ...args: A): T;\nfunction getOrApply<T, A extends any[]>(value: MaybeCall<T, A>, ...args: A): T {\n  if (typeof value === 'function') {\n    return (value as any)(...args);\n  } else {\n    return value;\n  }\n}\n\n/* eslint-enable @typescript-eslint/no-explicit-any */\nfunction endsWith(str: string, searchString: string, position?: number): boolean {\n  const subjectString = str.toString();\n  if (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {\n    position = subjectString.length;\n  }\n  position -= searchString.length;\n  const lastIndex = subjectString.lastIndexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\nfunction genChars(s: string): { next(): string | null } {\n  // Surrogate Code Point\n  // [\\uD800-\\uDBFF]\n  // Variation Selectors\n  // FVS [\\u180B-\\u180D]\n  // VS1VS16 [\\uFE00-\\uFE0F]\n  // VS17VS256 \\uDB40[\\uDD00-\\uDDEF]\n  const re = /([\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|\\r\\n|[^\\uD800-\\uDFFF])([\\u180B-\\u180D]|[\\uFE00-\\uFE0F]|\\uDB40[\\uDD00-\\uDDEF])?/g;\n  return {\n    next(): string | null {\n      const res = re.exec(s);\n      return res !== null ? res[0] : null;\n    }\n  };\n}\n\nexport type GenWordsResult = {\n  next(): string | null;\n};\n\nfunction genWords(s: string): GenWordsResult {\n  const re = /[!-~]+|[^!-~\\s]+|\\s+/g;\n  return {\n    next(): string | null {\n      const res = re.exec(s);\n      return res !== null ? res[0] : null;\n    }\n  };\n}\n\nexport function isPromise<T>(data: T | Promise<T> | undefined): data is Promise<T> {\n  return Boolean(data && typeof (data as Promise<T>).then === 'function');\n}\n\nfunction then<T, R>(result: MaybePromise<T>, callback: (arg: T) => MaybePromise<R>): MaybePromise<R>;\nfunction then<T, R>(result: MaybePromise<T>, callback: (arg: T) => R): MaybePromise<R>;\nfunction then<T, R>(result: MaybePromise<T>, callback: (arg: T) => R): MaybePromise<R> {\n  return isPromise(result) ? result.then((r) => callback(r)) : callback(result);\n}\n\nfunction getMouseButtons(e: MouseEvent): number {\n  if (e.buttons != null) {\n    return e.buttons;\n  }\n  /*for legacy*/\n  if (e.which != null) {\n    if (e.which === 3) {\n      //right?\n      return 4;\n    }\n    if (e.which === 2) {\n      //middle?\n      return 4;\n    }\n    return e.which; //left or no\n  }\n\n  if (e.button === 0 || e.button === 1) {\n    return 1; //candidate left\n  }\n  if (e.button === 2) {\n    return 2; // right\n  }\n  return 0; //no or middle?\n}\n\nfunction getKeyCode(e: KeyboardEvent): number {\n  return e.keyCode || e.which;\n}\n\nfunction isTouchEvent(e: TouchEvent | MouseEvent): e is TouchEvent {\n  return !!(e as TouchEvent).changedTouches;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getIgnoreCase(obj: any, name: string): any {\n  if (obj[name]) {\n    return obj[name];\n  }\n  const l = name.toLowerCase();\n  if (obj[l]) {\n    return obj[l];\n  }\n  const u = name.toLowerCase();\n  if (obj[u]) {\n    return obj[u];\n  }\n  for (const k in obj) {\n    if (k.toLowerCase() === l) {\n      return obj[k];\n    }\n  }\n  return undefined;\n}\n\nfunction cancel(e: Event): void {\n  e.preventDefault();\n  e.stopPropagation();\n}\n\nfunction toBoxArray<T>(obj: T | T[]): [ T, T, T, T ] {\n  if (!Array.isArray(obj)) {\n    return [ obj /*top*/, obj /*right*/, obj /*bottom*/, obj /*left*/ ];\n  }\n  if (obj.length === 3) {\n    return [ obj[0] /*top*/, obj[1] /*right*/, obj[2] /*bottom*/, obj[1] /*left*/ ];\n  }\n  if (obj.length === 2) {\n    return [ obj[0] /*top*/, obj[1] /*right*/, obj[0] /*bottom*/, obj[1] /*left*/ ];\n  }\n  if (obj.length === 1) {\n    return [ obj[0] /*top*/, obj[0] /*right*/, obj[0] /*bottom*/, obj[0] /*left*/ ];\n  }\n  return obj as [ T, T, T, T ];\n}\n\nexport { isNode, isDescendantElement, getChainSafe, applyChainSafe, getOrApply, getIgnoreCase, then, array };\n\nexport function cellEquals(a: CellAddress, b: CellAddress): boolean {\n  return a.col === b.col && a.row === b.row;\n}\n\nexport function cellInRange(range: CellRange, col: number, row: number): boolean {\n  return range.start.col <= col && col <= range.end.col && range.start.row <= row && row <= range.end.row;\n}\n\nexport const browser = {\n  IE,\n  Edge,\n  Chrome,\n  Firefox,\n  Safari,\n  // Chrome 33554431\n  // FireFox 17895588\n  // IE 10737433\n  heightLimit: Chrome ? 33554431 : Firefox ? 17895588 : 10737433 // default IE limit\n};\n\nexport const obj = {\n  setReadonly,\n  isObject\n};\nexport const str = {\n  endsWith,\n  genChars,\n  genWords\n};\nexport const event = {\n  getMouseButtons,\n  getKeyCode,\n  isTouchEvent,\n  cancel\n};\nexport const style = {\n  toBoxArray\n};\nexport const emptyFn = Function.prototype;\n","export interface DrawGridEvents {\n  /**\n   * Indicates when the cell was clicked.\n   */\n  CLICK_CELL: 'click_cell';\n  /**\n   * Indicates when the cell was double-clicked.\n   */\n  DBLCLICK_CELL: 'dblclick_cell';\n  /**\n   * Indicates when the cell was double-taped.\n   */\n  DBLTAP_CELL: 'dbltap_cell';\n  /**\n   * Indicates when pointing device button is pressed in a cell.\n   */\n  MOUSEDOWN_CELL: 'mousedown_cell';\n  /**\n   * Indicates when pointing device button is released in a cell.\n   */\n  MOUSEUP_CELL: 'mouseup_cell';\n  /**\n   * Indicates the cell selection state has changed.\n   */\n  SELECTED_CELL: 'selected_cell';\n  /**\n   * Indicates key-downed.\n   */\n  KEYDOWN: 'keydown';\n  MOUSEMOVE_CELL: 'mousemove_cell';\n  MOUSEENTER_CELL: 'mouseenter_cell';\n  MOUSELEAVE_CELL: 'mouseleave_cell';\n  MOUSEOVER_CELL: 'mouseover_cell';\n  MOUSEOUT_CELL: 'mouseout_cell';\n  /**\n   * Indicates when the user attempts to open a context menu in the cell.\n   */\n  CONTEXTMENU_CELL: 'contextmenu_cell';\n  INPUT_CELL: 'input_cell';\n  PASTE_CELL: 'paste_cell';\n  DELETE_CELL: 'delete_cell';\n  EDITABLEINPUT_CELL: 'editableinput_cell';\n  MODIFY_STATUS_EDITABLEINPUT_CELL: 'modify_status_editableinput_cell';\n  /**\n   * Indicates when the column width has changed.\n   */\n  RESIZE_COLUMN: 'resize_column';\n  /**\n   * Indicates when scrolled.\n   */\n  SCROLL: 'scroll';\n  FOCUS_GRID: 'focus_grid';\n  BLUR_GRID: 'blur_grid';\n}\n/**\n * DrawGrid event types\n * @classdesc cheetahGrid.core.EVENT_TYPE\n * @memberof cheetahGrid.core\n */\nexport const DG_EVENT_TYPE: DrawGridEvents = {\n  CLICK_CELL: 'click_cell',\n  DBLCLICK_CELL: 'dblclick_cell',\n  DBLTAP_CELL: 'dbltap_cell',\n  MOUSEDOWN_CELL: 'mousedown_cell',\n  MOUSEUP_CELL: 'mouseup_cell',\n  SELECTED_CELL: 'selected_cell',\n  KEYDOWN: 'keydown',\n  MOUSEMOVE_CELL: 'mousemove_cell',\n  MOUSEENTER_CELL: 'mouseenter_cell',\n  MOUSELEAVE_CELL: 'mouseleave_cell',\n  MOUSEOVER_CELL: 'mouseover_cell',\n  MOUSEOUT_CELL: 'mouseout_cell',\n  CONTEXTMENU_CELL: 'contextmenu_cell',\n  INPUT_CELL: 'input_cell',\n  PASTE_CELL: 'paste_cell',\n  DELETE_CELL: 'delete_cell',\n  EDITABLEINPUT_CELL: 'editableinput_cell',\n  MODIFY_STATUS_EDITABLEINPUT_CELL: 'modify_status_editableinput_cell',\n  RESIZE_COLUMN: 'resize_column',\n  SCROLL: 'scroll',\n  FOCUS_GRID: 'focus_grid',\n  BLUR_GRID: 'blur_grid'\n} as DrawGridEvents;\n","import type { CellAddress, EventListenerId, LayoutObjectId, ListGridAPI } from '../../ts-types';\nimport { event, isPromise } from '../../internal/utils';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\n\nconst KEY_ENTER = 13;\nconst KEY_SPACE = 32;\nexport function bindCellClickAction<T>(\n  grid: ListGridAPI<T>,\n  cellId: LayoutObjectId,\n  {\n    action,\n    mouseOver,\n    mouseOut\n  }: {\n    action: (cell: CellAddress) => void;\n    mouseOver: (cell: CellAddress) => boolean;\n    mouseOut: (cell: CellAddress) => void;\n  }\n): EventListenerId[] {\n  function isTarget(col: number, row: number): boolean {\n    return grid.getLayoutCellId(col, row) === cellId;\n  }\n  return [\n    // click\n    grid.listen(DG_EVENT_TYPE.CLICK_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (isPromise(grid.getRowRecord(e.row))) {\n        return;\n      }\n      action({\n        col: e.col,\n        row: e.row\n      });\n    }),\n    // mouse move\n    grid.listen(DG_EVENT_TYPE.MOUSEOVER_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (isPromise(grid.getRowRecord(e.row))) {\n        return;\n      }\n      if (mouseOver) {\n        if (\n          !mouseOver({\n            col: e.col,\n            row: e.row\n          })\n        ) {\n          return;\n        }\n      }\n      grid.getElement().style.cursor = 'pointer';\n    }),\n    grid.listen(DG_EVENT_TYPE.MOUSEOUT_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (mouseOut) {\n        mouseOut({\n          col: e.col,\n          row: e.row\n        });\n      }\n      grid.getElement().style.cursor = '';\n    })\n  ];\n}\nexport function bindCellKeyAction<T>(\n  grid: ListGridAPI<T>,\n  cellId: LayoutObjectId,\n  {\n    action,\n    acceptKeys = []\n  }: {\n    action: (cell: CellAddress) => void;\n    acceptKeys?: number[];\n  }\n): EventListenerId[] {\n  function isTarget(col: number, row: number): boolean {\n    return grid.getLayoutCellId(col, row) === cellId;\n  }\n  acceptKeys = [...acceptKeys, KEY_ENTER, KEY_SPACE];\n  return [\n    // enter key down\n    grid.listen(DG_EVENT_TYPE.KEYDOWN, (e) => {\n      if (acceptKeys.indexOf(e.keyCode) === -1) {\n        return;\n      }\n      if (grid.keyboardOptions?.moveCellOnEnter && e.keyCode === KEY_ENTER) {\n        // When moving with the enter key, no action is taken with the enter key.\n        return;\n      }\n      const sel = grid.selection.select;\n      if (!isTarget(sel.col, sel.row)) {\n        return;\n      }\n      if (isPromise(grid.getRowRecord(sel.row))) {\n        return;\n      }\n      action({\n        col: sel.col,\n        row: sel.row\n      });\n      event.cancel(e.event);\n    })\n  ];\n}\n","import type { BaseActionOption, CellAddress, EventListenerId, LayoutObjectId, ListGridAPI, RecordBoolean } from '../../ts-types';\n\nexport abstract class BaseAction<T> {\n  protected _disabled: RecordBoolean;\n  constructor(option: BaseActionOption = {}) {\n    this._disabled = option.disabled || false;\n  }\n  abstract get editable(): boolean;\n  get disabled(): RecordBoolean {\n    return this._disabled;\n  }\n  set disabled(disabled: RecordBoolean) {\n    this._disabled = disabled;\n    this.onChangeDisabledInternal();\n  }\n  abstract clone(): BaseAction<T>;\n  abstract bindGridEvent(grid: ListGridAPI<T>, cellId: LayoutObjectId): EventListenerId[];\n  protected onChangeDisabledInternal(): void {\n    // abstruct\n  }\n  abstract onPasteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress, value: string): void;\n  abstract onDeleteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress): void;\n}\n","import type { ListGridAPI, RecordBoolean } from '../../ts-types';\nimport { isPromise } from '../../internal/utils';\n\nexport function isDisabledRecord<T>(option: RecordBoolean, grid: ListGridAPI<T>, row: number): boolean {\n  if (grid.disabled) {\n    return true;\n  }\n  return getBooleanOptionOfRecord(option, grid, row);\n}\nexport function isReadOnlyRecord<T>(option: RecordBoolean, grid: ListGridAPI<T>, row: number): boolean {\n  if (grid.readOnly) {\n    return true;\n  }\n  return getBooleanOptionOfRecord(option, grid, row);\n}\n\nexport function toggleValue(val: number): number;\nexport function toggleValue(val: string): string;\nexport function toggleValue(val: unknown): boolean;\nexport function toggleValue(val: number | string | unknown): number | string | boolean {\n  if (typeof val === 'number') {\n    if (val === 0) {\n      return 1;\n    } else {\n      return 0;\n    }\n  } else if (typeof val === 'string') {\n    if (val === 'false') {\n      return 'true';\n    } else if (val === 'off') {\n      return 'on';\n    } else if (/^0+$/.exec(val)) {\n      return val.replace(/^(0*)0$/, '$11');\n    } else if (val === 'true') {\n      return 'false';\n    } else if (val === 'on') {\n      return 'off';\n    } else if (/^0*1$/.exec(val)) {\n      return val.replace(/^(0*)1$/, '$10');\n    }\n  }\n  return !val;\n}\n\nfunction getBooleanOptionOfRecord<T>(option: RecordBoolean, grid: ListGridAPI<T>, row: number): boolean {\n  if (typeof option === 'function') {\n    const record = grid.getRowRecord(row);\n    if (isPromise(record)) {\n      return true;\n    }\n    return !!option(record);\n  }\n  return !!option;\n}\n","import type { ActionListener, ActionOption, CellAddress, EventListenerId, LayoutObjectId, ListGridAPI } from '../../ts-types';\nimport { bindCellClickAction, bindCellKeyAction } from './actionBind';\nimport { BaseAction } from './BaseAction';\nimport type { GridInternal } from '../../ts-types-internal';\nimport { extend } from '../../internal/utils';\nimport { isDisabledRecord } from './action-utils';\n\nexport class Action<T> extends BaseAction<T> {\n  private _action: ActionListener;\n  constructor(option: ActionOption = {}) {\n    super(option);\n    this._action = option.action || ((): void => {});\n  }\n  get editable(): boolean {\n    return false;\n  }\n  get action(): ActionListener {\n    return this._action;\n  }\n  set action(action: ActionListener) {\n    this._action = action;\n  }\n  clone(): Action<T> {\n    return new Action(this);\n  }\n  getState(_grid: GridInternal<T>): { mouseActiveCell?: CellAddress } {\n    return {};\n  }\n  bindGridEvent(grid: ListGridAPI<T>, cellId: LayoutObjectId): EventListenerId[] {\n    const state = this.getState(grid);\n    const action = (cell: CellAddress): void => {\n      if (isDisabledRecord(this.disabled, grid, cell.row)) {\n        return;\n      }\n      const record = grid.getRowRecord(cell.row);\n      this._action(record, extend(cell, { grid }));\n    };\n\n    return [\n      ...bindCellClickAction(grid, cellId, {\n        action,\n        mouseOver: (e) => {\n          if (isDisabledRecord(this.disabled, grid, e.row)) {\n            return false;\n          }\n          state.mouseActiveCell = {\n            col: e.col,\n            row: e.row\n          };\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n          return true;\n        },\n        mouseOut: (e) => {\n          delete state.mouseActiveCell;\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n        }\n      }),\n      ...bindCellKeyAction(grid, cellId, {\n        action\n      })\n    ];\n  }\n  onPasteCellRangeBox(): void {\n    // noop\n  }\n  onDeleteCellRangeBox(): void {\n    // noop\n  }\n}\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { isNode } from './utils';\n\ntype SymbolType = (description?: string | number) => symbol;\n\nconst Symbol: SymbolType = isNode\n  ? (global.Symbol as SymbolType)\n  : (window.Symbol as SymbolType)\n    ? (window.Symbol as SymbolType)\n    : ((): SymbolType => {\n      function random(): string {\n        const c = 'abcdefghijklmnopqrstuvwxyz0123456789';\n        const cl = c.length;\n        let r = '';\n        for (let i = 0; i < 10; i++) {\n          r += c[Math.floor(Math.random() * cl)];\n        }\n        return r;\n      }\n\n      return (name?: string | number): symbol => {\n        if (name) {\n          return `#${name}_${random()}` as any;\n        } else {\n          return `#_${random()}` as any;\n        }\n      };\n    })();\nconst mem: { [key: string]: symbol } = {};\n\nexport function get(name?: string): '$$$$private symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  if (name) {\n    return (mem[name] ? mem[name] : (mem[name] = Symbol(name))) as any;\n  } else {\n    return Symbol() as any;\n  }\n}\n\nexport function getProtectedSymbol(): '$$$$protected symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('protected') as any;\n}\n\nexport function getCheckColumnStateId(): '$$$$chkcol.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('chkcol.stateID') as any;\n}\n\nexport function getRadioColumnStateId(): '$$$$rdcol.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('rdcol.stateID') as any;\n}\n\nexport function getButtonColumnStateId(): '$$$$btncol.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('btncol.stateID') as any;\n}\n\nexport function getColumnFadeinStateId(): '$$$$col.fadein_stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('col.fadein_stateID') as any;\n}\n\nexport function getBranchGraphColumnStateId(): '$$$$branch_graph_col.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('branch_graph_col.stateID') as any;\n}\n\nexport function getSmallDialogInputEditorStateId(): '$$$$small_dialog_input_editor.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('small_dialog_input_editor.stateID') as any;\n}\n\nexport function getInlineInputEditorStateId(): '$$$$inline_input_editor.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('inline_input_editor.stateID') as any;\n}\n\nexport function getInlineMenuEditorStateId(): '$$$$inline_menu_editor.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('inline_menu_editor.stateID') as any;\n}\n\nexport function getCheckHeaderStateId(): '$$$$check_header.stateID symbol$$$$' /* It is treated as a string so that it can be handled easily with typescript. */ {\n  return get('check_header.stateID') as any;\n}\n","import type { ButtonColumnState, GridInternal } from '../../ts-types-internal';\nimport { Action } from './Action';\nimport { getButtonColumnStateId } from '../../internal/symbolManager';\nimport { obj } from '../../internal/utils';\nconst BUTTON_COLUMN_STATE_ID = getButtonColumnStateId();\nexport class ButtonAction<T> extends Action<T> {\n  getState(grid: GridInternal<T>): ButtonColumnState {\n    let state = grid[BUTTON_COLUMN_STATE_ID];\n    if (!state) {\n      state = {};\n      obj.setReadonly(grid, BUTTON_COLUMN_STATE_ID, state);\n    }\n    return state;\n  }\n}\n","import type { EditorOption, RecordBoolean } from '../../ts-types';\nimport { BaseAction } from './BaseAction';\nexport abstract class Editor<T> extends BaseAction<T> {\n  protected _readOnly: RecordBoolean;\n  constructor(option: EditorOption = {}) {\n    super(option);\n    this._readOnly = option.readOnly || false;\n  }\n  get editable(): boolean {\n    return true;\n  }\n  get readOnly(): RecordBoolean {\n    return this._readOnly;\n  }\n  set readOnly(readOnly: RecordBoolean) {\n    this._readOnly = readOnly;\n    this.onChangeReadOnlyInternal();\n  }\n  onChangeReadOnlyInternal(): void {\n    // abstruct\n  }\n}\n","import { isNode } from './utils';\n\nfunction cubicBezier(x2: number, y2: number, x3: number, y3: number): EasingFunction {\n  let step: number;\n  const err = 0.0001;\n\n  x2 *= 3;\n  y2 *= 3;\n  x3 *= 3;\n  y3 *= 3;\n\n  return function (t: number): number {\n    let p, a, b, c, d, x, s;\n    if (t < 0 || 1 < t) {\n      throw new Error(`${t}`);\n    }\n\n    p = step || t;\n\n    do {\n      a = 1 - p;\n      b = a * a;\n      c = p * p;\n      d = c * p;\n\n      x = x2 * b * p + x3 * a * c + d;\n      s = t - x;\n      p += s * 0.5;\n    } while (err < Math.abs(s));\n\n    step = p;\n    return y2 * b * p + y3 * a * c + d;\n  };\n}\n\nconst EASINGS = {\n  linear(p: number): number {\n    return p;\n  },\n  easeIn: cubicBezier(0.42, 0.0, 1.0, 1.0),\n  easeOut: cubicBezier(0.0, 0.0, 0.58, 1.0),\n  easeInOut: cubicBezier(0.42, 0.0, 0.58, 1.0)\n};\n\nconst raf: typeof requestAnimationFrame = (\n  isNode\n    ? (): void => {}\n    : window.requestAnimationFrame ||\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      ((fn: () => void): any => setTimeout(fn, 1))\n) as typeof requestAnimationFrame;\n\nfunction now(): number {\n  return Date.now();\n}\n\nexport type EasingFunction = (t: number) => number;\nexport type EasingKind = keyof typeof EASINGS;\nexport type StepFunction = (s: number) => void;\n/**\n * <pre>\n * Animates.\n * </pre>\n * @function\n * @param {number} duration animation time.\n * @param {function} step step\n * @param {function|string} easing easing\n * @returns {object} Deferred object.\n */\nexport function animate(\n  duration: number,\n  step: StepFunction,\n  easing?: EasingKind | EasingFunction\n): {\n    cancel: () => void;\n  } {\n  const startedAt = now();\n\n  const easingFn: EasingFunction = easing == null ? EASINGS.easeInOut : typeof easing === 'string' ? EASINGS[easing] : easing;\n\n  let canceledFlg = false;\n  const createAnim = (resolve: () => void, reject: () => void): (() => void) => {\n    const anim = (): void => {\n      const point = now() - startedAt;\n      if (canceledFlg) {\n        //cancel\n        if (reject) {\n          reject();\n        }\n      } else if (point >= duration) {\n        //end\n        step(1);\n        if (resolve) {\n          resolve();\n        }\n      } else {\n        step(easingFn(point / duration));\n\n        raf(anim);\n      }\n    };\n    return anim;\n  };\n  const cancel = (): void => {\n    canceledFlg = true;\n  };\n  if (typeof Promise !== 'undefined') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const result: any = new Promise<void>((resolve, reject) => {\n      const anim = createAnim(resolve, reject);\n      step(0);\n      anim();\n    });\n    result.cancel = cancel;\n    return result;\n  } else {\n    const anim = createAnim(\n      () => {},\n      () => {}\n    );\n    step(0);\n    anim();\n    return {\n      cancel\n    };\n  }\n}\n","import type { CellAddress, EventListenerId, LayoutObjectId } from '../../ts-types';\nimport { bindCellClickAction, bindCellKeyAction } from './actionBind';\nimport { cellEquals, event, isPromise, obj } from '../../internal/utils';\nimport { isDisabledRecord, isReadOnlyRecord, toggleValue } from './action-utils';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\nimport { Editor } from './Editor';\nimport type { GridInternal } from '../../ts-types-internal';\nimport { animate } from '../../internal/animate';\nimport { getCheckColumnStateId } from '../../internal/symbolManager';\n\nconst CHECK_COLUMN_STATE_ID = getCheckColumnStateId();\n\nexport class CheckEditor<T> extends Editor<T> {\n  clone(): CheckEditor<T> {\n    return new CheckEditor(this);\n  }\n  bindGridEvent(grid: GridInternal<T>, cellId: LayoutObjectId): EventListenerId[] {\n    let _state = grid[CHECK_COLUMN_STATE_ID];\n    if (!_state) {\n      _state = { block: {}, elapsed: {} };\n      obj.setReadonly(grid, CHECK_COLUMN_STATE_ID, _state);\n    }\n    const state = _state;\n\n    const action = (cell: CellAddress): void => {\n      const range = grid.getCellRange(cell.col, cell.row);\n      const cellKey = `${range.start.col}:${range.start.row}`;\n\n      if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row) || state.block[cellKey]) {\n        return;\n      }\n      const ret = grid.doChangeValue(cell.col, cell.row, toggleValue);\n      if (ret) {\n        const onChange = (): void => {\n          // checkbox animation\n          animate(200, (point) => {\n            if (point === 1) {\n              delete state.elapsed[cellKey];\n            } else {\n              state.elapsed[cellKey] = point;\n            }\n            grid.invalidateCellRange(range);\n          });\n        };\n        if (isPromise(ret)) {\n          state.block[cellKey] = true;\n          ret.then(() => {\n            delete state.block[cellKey];\n            onChange();\n          });\n        } else {\n          onChange();\n        }\n      }\n    };\n\n    function isTarget(col: number, row: number): boolean {\n      return grid.getLayoutCellId(col, row) === cellId;\n    }\n    return [\n      ...bindCellClickAction(grid, cellId, {\n        action,\n        mouseOver: (e) => {\n          if (isDisabledRecord(this.disabled, grid, e.row)) {\n            return false;\n          }\n          state.mouseActiveCell = {\n            col: e.col,\n            row: e.row\n          };\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n          return true;\n        },\n        mouseOut: (e) => {\n          delete state.mouseActiveCell;\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n        }\n      }),\n      ...bindCellKeyAction(grid, cellId, {\n        action: (_e) => {\n          const selrange = grid.selection.range;\n          const { col } = grid.selection.select;\n          for (let { row } = selrange.start; row <= selrange.end.row; row++) {\n            if (!isTarget(col, row)) {\n              continue;\n            }\n            action({\n              col,\n              row\n            });\n          }\n        }\n      }),\n\n      // paste value\n      grid.listen(DG_EVENT_TYPE.PASTE_CELL, (e) => {\n        if (e.multi) {\n          // ignore multi cell values\n          return;\n        }\n        const selectionRange = grid.selection.range;\n        if (!cellEquals(selectionRange.start, selectionRange.end)) {\n          // ignore multi paste values\n          return;\n        }\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        const pasteValue = e.normalizeValue.trim();\n        grid.doGetCellValue(e.col, e.row, (value) => {\n          const newValue = toggleValue(value);\n          if (`${newValue}`.trim() === pasteValue) {\n            event.cancel(e.event);\n\n            action({\n              col: e.col,\n              row: e.row\n            });\n          }\n        });\n      })\n    ];\n  }\n  onPasteCellRangeBox(grid: GridInternal<T>, cell: CellAddress, value: string): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    const pasteValue = value.trim();\n    grid.doGetCellValue(cell.col, cell.row, (value) => {\n      const newValue = toggleValue(value);\n      if (`${newValue}`.trim() === pasteValue) {\n        grid.doChangeValue(cell.col, cell.row, toggleValue);\n      }\n    });\n  }\n  onDeleteCellRangeBox(): void {\n    // noop\n  }\n}\n","import type { CellAddress, EditorOption, EventListenerId, LayoutObjectId, ListGridAPI } from '../../ts-types';\nimport { cellEquals, event } from '../../internal/utils';\nimport { isDisabledRecord, isReadOnlyRecord } from './action-utils';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\nimport { Editor } from './Editor';\nconst KEY_ENTER = 13;\nconst KEY_F2 = 113;\n\nexport abstract class BaseInputEditor<T> extends Editor<T> {\n  constructor(option: EditorOption = {}) {\n    super(option);\n  }\n  abstract clone(): BaseInputEditor<T>;\n  abstract onInputCellInternal(grid: ListGridAPI<T>, cell: CellAddress, inputValue: string): void;\n  abstract onOpenCellInternal(grid: ListGridAPI<T>, cell: CellAddress): void;\n  abstract onChangeSelectCellInternal(grid: ListGridAPI<T>, cell: CellAddress, selected: boolean): void;\n  abstract onSetInputAttrsInternal(grid: ListGridAPI<T>, cell: CellAddress, input: HTMLInputElement): void;\n  abstract onGridScrollInternal(grid: ListGridAPI<T>): void;\n  bindGridEvent(grid: ListGridAPI<T>, cellId: LayoutObjectId): EventListenerId[] {\n    const open = (cell: CellAddress): boolean => {\n      if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n        return false;\n      }\n      this.onOpenCellInternal(grid, cell);\n      return true;\n    };\n\n    const input = (cell: CellAddress, value: string): void => {\n      if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n        return;\n      }\n      this.onInputCellInternal(grid, cell, value);\n    };\n\n    function isTarget(col: number, row: number): boolean {\n      return grid.getLayoutCellId(col, row) === cellId;\n    }\n    return [\n      grid.listen(DG_EVENT_TYPE.INPUT_CELL, (e) => {\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        input(\n          {\n            col: e.col,\n            row: e.row\n          },\n          e.value\n        );\n      }),\n      grid.listen(DG_EVENT_TYPE.PASTE_CELL, (e) => {\n        if (e.multi) {\n          // ignore multi cell values\n          return;\n        }\n        const selectionRange = grid.selection.range;\n        if (!cellEquals(selectionRange.start, selectionRange.end)) {\n          // ignore multi paste values\n          return;\n        }\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        event.cancel(e.event);\n        input(\n          {\n            col: e.col,\n            row: e.row\n          },\n          e.normalizeValue\n        );\n      }),\n      grid.listen(DG_EVENT_TYPE.DBLCLICK_CELL, (cell) => {\n        if (!isTarget(cell.col, cell.row)) {\n          return;\n        }\n        open({\n          col: cell.col,\n          row: cell.row\n        });\n      }),\n      grid.listen(DG_EVENT_TYPE.DBLTAP_CELL, (e) => {\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        open({\n          col: e.col,\n          row: e.row\n        });\n\n        event.cancel(e.event);\n      }),\n      grid.listen(DG_EVENT_TYPE.KEYDOWN, (e) => {\n        if (e.keyCode !== KEY_F2 && e.keyCode !== KEY_ENTER) {\n          return;\n        }\n        const sel = grid.selection.select;\n        if (!isTarget(sel.col, sel.row)) {\n          return;\n        }\n        if (\n          open({\n            col: sel.col,\n            row: sel.row\n          })\n        ) {\n          e.stopCellMoving();\n        }\n      }),\n      grid.listen(DG_EVENT_TYPE.SELECTED_CELL, (e) => {\n        this.onChangeSelectCellInternal(grid, { col: e.col, row: e.row }, e.selected);\n      }),\n      grid.listen(DG_EVENT_TYPE.SCROLL, () => {\n        this.onGridScrollInternal(grid);\n      }),\n      grid.listen(DG_EVENT_TYPE.EDITABLEINPUT_CELL, (cell) => {\n        if (!isTarget(cell.col, cell.row)) {\n          return false;\n        }\n        if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n          return false;\n        }\n        return true;\n      }),\n      grid.listen(DG_EVENT_TYPE.MODIFY_STATUS_EDITABLEINPUT_CELL, (cell) => {\n        if (!isTarget(cell.col, cell.row)) {\n          return;\n        }\n        if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n          return;\n        }\n        const range = grid.getCellRange(cell.col, cell.row);\n        if (range.start.col !== range.end.col || range.start.row !== range.end.row) {\n          const { input } = cell;\n          const baseRect = grid.getCellRect(cell.col, cell.row);\n          const rangeRect = grid.getCellRangeRect(range);\n          input.style.top = `${(parseFloat(input.style.top) + (rangeRect.top - baseRect.top)).toFixed()}px`;\n          input.style.left = `${(parseFloat(input.style.left) + (rangeRect.left - baseRect.left)).toFixed()}px`;\n          input.style.width = `${rangeRect.width.toFixed()}px`;\n          input.style.height = `${rangeRect.height.toFixed()}px`;\n        }\n        this.onSetInputAttrsInternal(\n          grid,\n          {\n            col: cell.col,\n            row: cell.row\n          },\n          cell.input\n        );\n      })\n    ];\n  }\n  onPasteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress, value: string): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    grid.doChangeValue(cell.col, cell.row, () => value);\n  }\n  onDeleteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    grid.doChangeValue(cell.col, cell.row, () => '');\n  }\n}\n","import type { AnyFunction, EventListenerId } from '../ts-types';\nimport type { EventTarget as CustomEventTarget } from '../core/EventTarget';\nimport { each } from './utils';\n\n/** @private */\nlet nextId = 1;\n\n/** @private */\ntype EventHandlerTarget = EventTarget | CustomEventTarget;\n/** @private */\ntype Listener = AnyFunction;\n/** @private */\ntype EventListenerObject = {\n  target: EventHandlerTarget;\n  type: string;\n  listener: Listener;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  options: any[];\n};\n\nexport class EventHandler {\n  private _listeners: {\n    [key: string]: EventListenerObject;\n  } = {};\n  on<TYPE extends keyof GlobalEventHandlersEventMap>(\n    target: EventHandlerTarget,\n    type: TYPE,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    listener: (event: GlobalEventHandlersEventMap[TYPE]) => any,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ...options: any[]\n  ): EventListenerId;\n  on(\n    target: EventHandlerTarget,\n    type: string,\n    listener: Listener,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ...options: any[]\n  ): EventListenerId;\n  on(\n    target: EventHandlerTarget,\n    type: string,\n    listener: Listener,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ...options: any[]\n  ): EventListenerId {\n    if (target.addEventListener) {\n      target.addEventListener(type, listener, ...(options as []));\n    }\n    const obj = {\n      target,\n      type,\n      listener,\n      options\n    };\n    const id = nextId++;\n    this._listeners[id] = obj;\n    return id;\n  }\n  once<TYPE extends keyof GlobalEventHandlersEventMap>(\n    target: EventHandlerTarget,\n    type: TYPE,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    listener: (event: GlobalEventHandlersEventMap[TYPE]) => any,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    ...options: any[]\n  ): EventListenerId;\n  once(target: EventHandlerTarget, type: string, listener: Listener, ...options: (boolean | AddEventListenerOptions)[]): EventListenerId;\n  once(target: EventHandlerTarget, type: string, listener: Listener, ...options: (boolean | AddEventListenerOptions)[]): EventListenerId {\n    const id = this.on(\n      target,\n      type,\n      (...args) => {\n        this.off(id);\n        listener(...args);\n      },\n      ...options\n    );\n    return id;\n  }\n  tryWithOffEvents(target: EventHandlerTarget, type: string, call: () => void): void {\n    const list: EventListenerObject[] = [];\n    try {\n      each(this._listeners, (obj) => {\n        if (obj.target === target && obj.type === type) {\n          if (obj.target.removeEventListener) {\n            obj.target.removeEventListener(obj.type, obj.listener, ...(obj.options as []));\n          }\n          list.push(obj);\n        }\n      });\n      call();\n    } finally {\n      list.forEach((obj) => {\n        if (obj.target.addEventListener) {\n          obj.target.addEventListener(obj.type, obj.listener, ...(obj.options as []));\n        }\n      });\n    }\n  }\n  off(id: EventListenerId | null | undefined): void {\n    if (id == null) {\n      return;\n    }\n    const obj = this._listeners[id];\n    if (!obj) {\n      return;\n    }\n    delete this._listeners[id];\n    if (obj.target.removeEventListener) {\n      obj.target.removeEventListener(obj.type, obj.listener, ...(obj.options as []));\n    }\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  fire(target: EventTarget, type: string, ...args: any[]): void {\n    each(this._listeners, (obj) => {\n      if (obj.target === target && obj.type === type) {\n        obj.listener.call(obj.target, ...args);\n      }\n    });\n  }\n  hasListener(target: EventTarget, type: string): boolean {\n    let result = false;\n    each(this._listeners, (obj) => {\n      if (obj.target === target && obj.type === type) {\n        result = true;\n      }\n    });\n    return result;\n  }\n  clear(): void {\n    each(this._listeners, (obj) => {\n      if (obj.target.removeEventListener) {\n        obj.target.removeEventListener(obj.type, obj.listener, ...(obj.options as []));\n      }\n    });\n    this._listeners = {};\n  }\n  dispose(): void {\n    this.clear();\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (this as any)._listeners = null;\n  }\n}\n","export function createElement<K extends keyof HTMLElementTagNameMap>(\n  tagName: K,\n  { classList, text, html }: { classList?: string[] | string; text?: string; html?: string } = {}\n): HTMLElementTagNameMap[K] {\n  const element = document.createElement(tagName);\n  if (classList) {\n    if (Array.isArray(classList)) {\n      element.classList.add(...classList);\n    } else {\n      element.classList.add(classList);\n    }\n  }\n  if (text) {\n    element.textContent = text;\n  } else if (html) {\n    element.innerHTML = html;\n  }\n  return element;\n}\n\nexport function empty(dom: HTMLElement): void {\n  let c;\n  while ((c = dom.firstChild)) {\n    dom.removeChild(c);\n  }\n}\nfunction isNode(arg: HTMLElement | string): arg is HTMLElement {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return !!((arg as any).nodeType && (arg as any).nodeName);\n}\nfunction toNode(arg: HTMLElement | string): HTMLElement | HTMLElement[] {\n  if (isNode(arg)) {\n    return arg;\n  }\n  const dom = createElement('div', { html: arg });\n  return Array.prototype.slice.call(dom.childNodes) as HTMLElement[];\n}\nexport function toNodeList(arg: HTMLElement | HTMLElement[] | string): HTMLElement[] {\n  if (Array.isArray(arg)) {\n    const result: HTMLElement[] = [];\n    arg.forEach((e) => {\n      result.push(...toNodeList(e));\n    });\n    return result;\n  }\n  const node = toNode(arg);\n  return Array.isArray(node) ? node : [node];\n}\n\nexport function appendHtml(dom: HTMLElement, inner: HTMLElement | HTMLElement[] | string): void {\n  toNodeList(inner).forEach((node) => {\n    dom.appendChild(node);\n  });\n}\n\nexport function disableFocus(el: HTMLElement): void {\n  el.dataset.disableBeforeTabIndex = `${el.tabIndex}`;\n  el.tabIndex = -1;\n  Array.prototype.slice.call(el.children, 0).forEach(disableFocus);\n}\nexport function enableFocus(el: HTMLElement): void {\n  if ('disableBeforeTabIndex' in el.dataset) {\n    el.tabIndex = Number(el.dataset.disableBeforeTabIndex);\n  }\n  Array.prototype.slice.call(el.children, 0).forEach(enableFocus);\n}\n\nexport function isFocusable(el: Node): el is HTMLElement {\n  return (el as HTMLElement).tabIndex != null && (el as HTMLElement).tabIndex > -1;\n}\nexport function findPrevSiblingFocusable(el: HTMLElement): HTMLElement | null {\n  let n = el.previousSibling;\n  while (n && !isFocusable(n)) {\n    n = n.previousSibling;\n  }\n  return n;\n}\nexport function findNextSiblingFocusable(el: HTMLElement): HTMLElement | null {\n  let n = el.nextSibling;\n  while (n && !isFocusable(n)) {\n    n = n.nextSibling;\n  }\n  return n;\n}\n","import { EventHandler } from '../../../internal/EventHandler';\n\nexport function setInputValue(input: HTMLInputElement, value: string): void {\n  const sign = input.type === 'number' && value === '-';\n  if (sign) {\n    // When `type=\"number\"`, the minus sign is not accepted, so change it to `type=\"text\"` once.\n    input.type = '';\n    let handler: EventHandler | null = new EventHandler();\n    const dispose = (): void => {\n      if (handler) {\n        handler.dispose();\n        handler = null;\n      }\n    };\n    handler.once(input, 'input', (_e) => {\n      input.type = 'number';\n      dispose();\n    });\n    handler.once(input, 'blur', (_e) => {\n      dispose();\n    });\n  }\n\n  input.value = value ?? '';\n}\n","import { EventHandler } from '../../../internal/EventHandler';\nimport type { ListGridAPI } from '../../../ts-types';\nimport { createElement } from '../../../internal/dom';\nimport { event } from '../../../internal/utils';\nimport { setInputValue } from './input-value-handler';\n\nconst KEY_TAB = 9;\nconst KEY_ENTER = 13;\n\nconst CLASSNAME = 'cheetah-grid__inline-input';\nimport './InlineInputElement.css';\n\nfunction createInputElement(): HTMLInputElement {\n  // require('@/columns/action/internal/InlineInputElement.css')\n  return createElement('input', { classList: CLASSNAME });\n}\n\ntype EditorProps = { type?: string; classList?: string[] };\n\ntype ActiveData<T> = {\n  grid: ListGridAPI<T>;\n  col: number;\n  row: number;\n  editor: EditorProps;\n};\n\nfunction setInputAttrs<T>(editor: EditorProps, _grid: ListGridAPI<T>, input: HTMLInputElement): void {\n  const { classList, type } = editor;\n  if (classList) {\n    input.classList.add(...classList);\n  }\n  input.type = type || '';\n}\n\nexport class InlineInputElement<T> {\n  private _handler: EventHandler;\n  private _input: HTMLInputElement;\n  private _beforePropEditor?: EditorProps | null;\n  private _activeData?: ActiveData<T> | null;\n  private _attaching?: boolean;\n\n  static setInputAttrs<T>(editor: { type?: string; classList?: string[] }, grid: ListGridAPI<T>, input: HTMLInputElement): void {\n    setInputAttrs(editor, grid, input);\n  }\n\n  constructor() {\n    this._handler = new EventHandler();\n    this._input = createInputElement();\n    this._bindInputEvents();\n  }\n\n  dispose(): void {\n    const input = this._input;\n    this.detach();\n    this._handler.dispose();\n    // @ts-expect-error -- ignore\n    delete this._input;\n    this._beforePropEditor = null;\n    input.parentElement?.removeChild(input);\n  }\n\n  attach(grid: ListGridAPI<T>, editor: EditorProps, col: number, row: number, value: string): void {\n    const input = this._input;\n    const handler = this._handler;\n\n    if (this._beforePropEditor) {\n      const { classList } = this._beforePropEditor;\n      if (classList) {\n        input.classList.remove(...classList);\n      }\n    }\n\n    input.style.font = grid.font || '16px sans-serif';\n\n    const { element, rect } = grid.getAttachCellsArea(grid.getCellRange(col, row));\n    input.style.top = `${rect.top.toFixed()}px`;\n    input.style.left = `${rect.left.toFixed()}px`;\n    input.style.width = `${rect.width.toFixed()}px`;\n    input.style.height = `${rect.height.toFixed()}px`;\n    element.appendChild(input);\n\n    setInputAttrs(editor, grid, input);\n\n    setInputValue(input, value);\n\n    this._activeData = { grid, col, row, editor };\n    this._beforePropEditor = editor;\n\n    const focus = (): void => {\n      input.focus();\n\n      const end = input.value.length;\n      try {\n        if (typeof input.selectionStart !== 'undefined') {\n          input.selectionStart = end;\n          input.selectionEnd = end;\n          return;\n        }\n      } catch (e) {\n        //ignore\n      }\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      if ((document as any).selection) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const range = (input as any).createTextRange();\n        range.collapse();\n        range.moveEnd('character', end);\n        range.moveStart('character', end);\n        range.select();\n      }\n    };\n    handler.tryWithOffEvents(input, 'blur', () => {\n      focus();\n    });\n\n    this._attaching = true;\n    setTimeout(() => {\n      delete this._attaching;\n    });\n  }\n\n  detach(gridFocus?: boolean): void {\n    if (this._isActive()) {\n      const { grid, col, row } = this._activeData!;\n      const input = this._input;\n      this._handler.tryWithOffEvents(input, 'blur', () => {\n        input.parentElement?.removeChild(input);\n      });\n      const range = grid.getCellRange(col, row);\n      grid.invalidateCellRange(range);\n      if (gridFocus) {\n        grid.focus();\n      }\n    }\n    this._activeData = null;\n  }\n\n  doChangeValue(): void {\n    if (!this._isActive()) {\n      return;\n    }\n    const input = this._input;\n    const { value } = input;\n    const { grid, col, row } = this._activeData!;\n    grid.doChangeValue(col, row, () => value);\n  }\n\n  _isActive(): boolean {\n    const input = this._input;\n    if (!input || !input.parentElement) {\n      return false;\n    }\n    if (!this._activeData) {\n      return false;\n    }\n    return true;\n  }\n\n  _bindInputEvents(): void {\n    const handler = this._handler;\n    const input = this._input;\n    const stopPropagationOnly = (e: Event): void => e.stopPropagation(); // grid\n    handler.on(input, 'click', stopPropagationOnly);\n    handler.on(input, 'mousedown', stopPropagationOnly);\n    handler.on(input, 'touchstart', stopPropagationOnly);\n    handler.on(input, 'dblclick', stopPropagationOnly);\n\n    handler.on(input, 'compositionstart', (_e) => {\n      input.classList.add('composition');\n    });\n    handler.on(input, 'compositionend', (_e) => {\n      input.classList.remove('composition');\n    });\n    handler.on(input, 'keydown', (e) => {\n      if (input.classList.contains('composition')) {\n        return;\n      }\n      const keyCode = event.getKeyCode(e);\n      if (keyCode === KEY_ENTER) {\n        this._onKeydownEnter(e);\n      } else if (keyCode === KEY_TAB) {\n        this._onKeydownTab(e);\n      }\n    });\n    handler.on(input, 'blur', (_e) => {\n      this.doChangeValue();\n      this.detach();\n    });\n  }\n\n  _onKeydownEnter(e: KeyboardEvent): void {\n    if (!this._isActive() || this._attaching) {\n      return;\n    }\n\n    const { grid } = this._activeData!;\n\n    this.doChangeValue();\n    this.detach(true);\n    event.cancel(e);\n\n    if (grid.keyboardOptions?.moveCellOnEnter) {\n      grid.onKeyDownMove(e);\n    }\n  }\n\n  _onKeydownTab(e: KeyboardEvent): void {\n    if (!this._isActive()) {\n      return;\n    }\n    const { grid } = this._activeData!;\n    if (!grid.keyboardOptions?.moveCellOnTab) {\n      return;\n    }\n    this.doChangeValue();\n    this.detach(true);\n    grid.onKeyDownMove(e);\n  }\n}\n","import type { CellAddress, InlineInputEditorOption, ListGridAPI } from '../../ts-types';\nimport type { GridInternal, InputEditorState } from '../../ts-types-internal';\nimport { BaseInputEditor } from './BaseInputEditor';\nimport { InlineInputElement } from './internal/InlineInputElement';\nimport { getInlineInputEditorStateId } from '../../internal/symbolManager';\nimport { obj } from '../../internal/utils';\nconst _ = getInlineInputEditorStateId();\n\nfunction getState<T>(grid: GridInternal<T>): InputEditorState {\n  let state = grid[_];\n  if (!state) {\n    state = {};\n    obj.setReadonly(grid, _, state);\n  }\n  return state;\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet globalElement: InlineInputElement<any> | null = null;\nlet bindGridCount = 0;\nfunction attachInput<T>(grid: GridInternal<T>, cell: CellAddress, editor: InlineInputEditor<T>, value: string): void {\n  const state = getState(grid);\n  if (!globalElement) {\n    globalElement = new InlineInputElement();\n  }\n  if (!state.element) {\n    state.element = globalElement;\n    bindGridCount++;\n    grid.addDisposable({\n      dispose() {\n        bindGridCount--;\n        if (!bindGridCount) {\n          globalElement?.dispose();\n          globalElement = null;\n          state.element = null;\n        }\n      }\n    });\n  }\n\n  globalElement.attach(grid, editor, cell.col, cell.row, value);\n}\nfunction detachInput(gridFocus?: boolean): void {\n  if (globalElement) {\n    globalElement.detach(gridFocus);\n  }\n}\nfunction doChangeValue<T>(_grid: ListGridAPI<T>): void {\n  if (globalElement) {\n    globalElement.doChangeValue();\n  }\n}\n\nexport class InlineInputEditor<T> extends BaseInputEditor<T> {\n  private _classList?: string | string[];\n  private _type?: string;\n  constructor(option: InlineInputEditorOption = {}) {\n    super(option);\n    this._classList = option.classList;\n    this._type = option.type;\n  }\n  get classList(): string[] | undefined {\n    if (!this._classList) {\n      return undefined;\n    }\n    return Array.isArray(this._classList) ? this._classList : [this._classList];\n  }\n  set classList(classList: string[] | undefined) {\n    this._classList = classList;\n  }\n  get type(): string | undefined {\n    return this._type;\n  }\n  set type(type: string | undefined) {\n    this._type = type;\n  }\n  clone(): InlineInputEditor<T> {\n    return new InlineInputEditor(this);\n  }\n  onInputCellInternal(grid: ListGridAPI<T>, cell: CellAddress, inputValue: string): void {\n    attachInput(grid, cell, this, inputValue);\n  }\n  onOpenCellInternal(grid: ListGridAPI<T>, cell: CellAddress): void {\n    grid.doGetCellValue(cell.col, cell.row, (value) => {\n      attachInput(grid, cell, this, value);\n    });\n  }\n  onChangeSelectCellInternal(grid: ListGridAPI<T>, _cell: CellAddress, _selected: boolean): void {\n    doChangeValue(grid);\n    detachInput();\n  }\n  onGridScrollInternal(grid: ListGridAPI<T>): void {\n    doChangeValue(grid);\n    detachInput(true);\n  }\n  onChangeDisabledInternal(): void {\n    // cancel input\n    detachInput(true);\n  }\n  onChangeReadOnlyInternal(): void {\n    // cancel input\n    detachInput(true);\n  }\n  onSetInputAttrsInternal(grid: ListGridAPI<T>, _cell: CellAddress, input: HTMLInputElement): void {\n    InlineInputElement.setInputAttrs(this, grid, input);\n  }\n}\n","import type { ColumnMenuItemOption, ListGridAPI, RectProps } from '../../../ts-types';\nimport { appendHtml, createElement, disableFocus, empty, findNextSiblingFocusable, findPrevSiblingFocusable, isFocusable } from '../../../internal/dom';\nimport { EventHandler } from '../../../internal/EventHandler';\nimport type { Rect } from '../../../internal/Rect';\nimport { event } from '../../../internal/utils';\n\nconst KEY_TAB = 9;\nconst KEY_ENTER = 13;\nconst KEY_UP = 38;\nconst KEY_DOWN = 40;\nconst KEY_ESC = 27;\n\nconst CLASSNAME = 'cheetah-grid__inline-menu';\nconst ITEM_CLASSNAME = `${CLASSNAME}__menu-item`;\nconst HIDDEN_CLASSNAME = `${CLASSNAME}--hidden`;\nconst SHOWN_CLASSNAME = `${CLASSNAME}--shown`;\nconst EMPTY_ITEM_CLASSNAME = `${ITEM_CLASSNAME}--empty`;\n\nfunction findItemParents(target: HTMLElement | null): HTMLElement | null {\n  let el: HTMLElement | null = target;\n  while (el && !el.classList.contains(ITEM_CLASSNAME)) {\n    el = el.parentElement;\n    if (!el || el.classList.contains(CLASSNAME)) {\n      return null;\n    }\n  }\n  return el;\n}\n\nimport './InlineMenuElement.css';\n\nfunction createMenuElement(): HTMLUListElement {\n  // require(\"@/columns/action/internal/InlineMenuElement.css\");\n  return createElement('ul', { classList: CLASSNAME });\n}\n\nfunction attachElement(element: HTMLElement, rect: RectProps, menu: HTMLUListElement): void {\n  menu.style.top = `${rect.top.toFixed()}px`;\n  menu.style.left = `${rect.left.toFixed()}px`;\n  menu.style.width = `${rect.width.toFixed()}px`;\n  menu.style.lineHeight = `${rect.height.toFixed()}px`;\n  element.appendChild(menu);\n}\n\nfunction optionToLi({ classList, label, value, html }: ColumnMenuItemOption, index: number): HTMLLIElement {\n  const item = createElement('li', { classList: ITEM_CLASSNAME });\n  item.tabIndex = 0;\n  item.dataset.valueindex = `${index}`;\n  if (classList) {\n    item.classList.add(...(Array.isArray(classList) ? classList : [classList]));\n  }\n\n  if (label) {\n    const span = createElement('span', { text: label });\n    item.appendChild(span);\n  } else if (html) {\n    appendHtml(item, html);\n  }\n\n  if (value === '' || value == null) {\n    item.classList.add(EMPTY_ITEM_CLASSNAME);\n  }\n\n  return item;\n}\n\nfunction openMenu<T>(grid: ListGridAPI<T>, editor: EditorProps<T>, col: number, row: number, value: string, options: ColumnMenuItemOption[], menu: HTMLUListElement): void {\n  const { classList } = editor;\n  menu.classList.remove(SHOWN_CLASSNAME);\n  menu.classList.add(HIDDEN_CLASSNAME);\n  empty(menu);\n  menu.style.font = grid.font || '16px sans-serif';\n  let emptyItemEl: null | HTMLElement = null;\n  let valueItemEl: null | HTMLElement = null;\n\n  options.forEach((option, i) => {\n    const item = optionToLi(option, i);\n    menu.appendChild(item);\n    if (option.value === value) {\n      valueItemEl = item;\n      item.dataset.select = 'select';\n    }\n    if (item.classList.contains(EMPTY_ITEM_CLASSNAME)) {\n      emptyItemEl = item;\n    }\n  });\n  const focusEl = valueItemEl || emptyItemEl || (menu.children[0] as HTMLElement);\n  if (classList) {\n    menu.classList.add(...classList);\n  }\n  const children = Array.prototype.slice.call(menu.children, 0);\n  const focusIndex = children.indexOf(focusEl);\n  const { element, rect } = grid.getAttachCellsArea(grid.getCellRange(col, row));\n\n  // Cover the right line\n  rect.width++;\n\n  // append for calculation\n  attachElement(element, rect, menu);\n\n  // Make the selection item at the middle\n  let offset = 0;\n  let allHeight = 0;\n  for (let i = 0; i < children.length; i++) {\n    const { offsetHeight } = children[i];\n    if (i < focusIndex) {\n      offset += offsetHeight;\n    }\n    allHeight += offsetHeight;\n  }\n  (rect as Rect).offsetTop(-offset);\n  menu.style.transformOrigin = `center ${offset + Math.ceil(children[focusIndex].offsetHeight / 2)}px 0px`;\n  attachElement(element, rect, menu);\n\n  // Control not to overflow the screen range\n  const menuClientRect = menu.getBoundingClientRect();\n  const scaleDiff = (allHeight - menuClientRect.height) / 2;\n  const orgMenuTop = menuClientRect.top - scaleDiff;\n  let menuTop = orgMenuTop;\n  const menuBottom = menuTop + allHeight;\n  const winBottom = window.innerHeight;\n  const winMargin = 20;\n  if (menuBottom > winBottom - winMargin) {\n    const diff = menuBottom - winBottom + winMargin;\n    menuTop -= diff;\n  }\n  if (menuTop < 0 /*winTop*/ + winMargin) {\n    menuTop = winMargin;\n  }\n  if (menuTop !== orgMenuTop) {\n    (rect as Rect).offsetTop(-(orgMenuTop - menuTop));\n    // re update\n    attachElement(element, rect, menu);\n  }\n\n  if (focusEl) {\n    focusEl.focus();\n  }\n  menu.classList.remove(HIDDEN_CLASSNAME);\n  menu.classList.add(SHOWN_CLASSNAME);\n}\n\nfunction closeMenu<T>(_grid: ListGridAPI<T>, _col: number, _row: number, menu: HTMLUListElement): void {\n  menu.classList.remove(SHOWN_CLASSNAME);\n  menu.classList.add(HIDDEN_CLASSNAME);\n  disableFocus(menu);\n}\n\ntype EditorProps<T> = {\n  classList?: string[];\n  options: (record: T | undefined) => ColumnMenuItemOption[];\n};\ntype ActiveData<T> = {\n  grid: ListGridAPI<T>;\n  col: number;\n  row: number;\n  editor: EditorProps<T>;\n  options: ColumnMenuItemOption[];\n};\n\nexport class InlineMenuElement<T> {\n  private _handler: EventHandler;\n  private _menu: HTMLUListElement;\n  private _beforePropEditor?: EditorProps<T> | null;\n  private _activeData?: ActiveData<T> | null;\n\n  constructor() {\n    this._handler = new EventHandler();\n    this._menu = createMenuElement();\n    this._bindMenuEvents();\n  }\n\n  dispose(): void {\n    const menu = this._menu;\n    this.detach();\n    this._handler.dispose();\n    // @ts-expect-error -- ignore\n    delete this._menu;\n    this._beforePropEditor = null;\n    menu.parentElement?.removeChild(menu);\n  }\n\n  attach(grid: ListGridAPI<T>, editor: EditorProps<T>, col: number, row: number, value: string, record: T | undefined): void {\n    const menu = this._menu;\n\n    if (this._beforePropEditor) {\n      const { classList } = this._beforePropEditor;\n      if (classList) {\n        menu.classList.remove(...classList);\n      }\n    }\n\n    const options = editor.options(record);\n\n    openMenu(grid, editor, col, row, value, options, menu);\n    this._activeData = { grid, col, row, editor, options };\n    this._beforePropEditor = editor;\n  }\n\n  detach(gridFocus?: boolean): void {\n    if (this._isActive()) {\n      const { grid, col, row } = this._activeData!;\n      const menu = this._menu;\n      closeMenu(grid, col, row, menu);\n\n      const range = grid.getCellRange(col, row);\n      grid.invalidateCellRange(range);\n      if (gridFocus) {\n        grid.focus();\n      }\n    }\n    this._activeData = null;\n  }\n\n  _doChangeValue(valueindex: number | string): void {\n    if (!this._isActive()) {\n      return;\n    }\n    const { grid, col, row, options } = this._activeData!;\n    const option = options[Number(valueindex)];\n    if (option) {\n      const { value } = option;\n      grid.doChangeValue(col, row, () => value);\n    }\n  }\n\n  _isActive(): boolean {\n    const menu = this._menu;\n    if (!menu || !menu.parentElement) {\n      return false;\n    }\n    if (!this._activeData) {\n      return false;\n    }\n    return true;\n  }\n\n  _bindMenuEvents(): void {\n    const handler = this._handler;\n    const menu = this._menu;\n\n    const stopPropagationOnly = (e: Event): void => e.stopPropagation(); // grid\n\n    handler.on(menu, 'mousedown', stopPropagationOnly);\n    handler.on(menu, 'touchstart', stopPropagationOnly);\n    handler.on(menu, 'dblclick', stopPropagationOnly);\n\n    handler.on(menu, 'click', (e) => {\n      e.stopPropagation();\n      const item = findItemParents(e.target as HTMLElement);\n      if (!item) {\n        return;\n      }\n      const { valueindex } = item.dataset;\n      this._doChangeValue(valueindex || '');\n      this.detach(true);\n    });\n    handler.on(menu, 'keydown', (e) => {\n      const item = findItemParents(e.target as HTMLElement);\n      if (!item) {\n        return;\n      }\n      const keyCode = event.getKeyCode(e);\n      if (keyCode === KEY_ENTER) {\n        this._onKeydownEnter(menu, item, e);\n      } else if (keyCode === KEY_ESC) {\n        this.detach(true);\n        event.cancel(e);\n      } else if (keyCode === KEY_UP) {\n        const n = findPrevSiblingFocusable(item);\n        if (n) {\n          n.focus();\n          event.cancel(e);\n        }\n      } else if (keyCode === KEY_DOWN) {\n        const n = findNextSiblingFocusable(item);\n        if (n) {\n          n.focus();\n          event.cancel(e);\n        }\n      } else if (keyCode === KEY_TAB) {\n        this._onKeydownTab(menu, item, e);\n      }\n    });\n  }\n\n  _onKeydownEnter(_menu: HTMLUListElement, item: HTMLElement, e: KeyboardEvent): void {\n    const grid = this._isActive() ? this._activeData!.grid : null;\n    const { valueindex } = item.dataset;\n    this._doChangeValue(valueindex || '');\n    this.detach(true);\n    event.cancel(e);\n\n    if (grid) {\n      if (grid.keyboardOptions?.moveCellOnEnter) {\n        grid.onKeyDownMove(e);\n      }\n    }\n  }\n\n  _onKeydownTab(menu: HTMLUListElement, item: HTMLElement, e: KeyboardEvent): void {\n    if (this._isActive()) {\n      const { grid } = this._activeData!;\n      if (grid.keyboardOptions?.moveCellOnTab) {\n        const { valueindex } = item.dataset;\n        this._doChangeValue(valueindex || '');\n        this.detach(true);\n        grid.onKeyDownMove(e);\n        return;\n      }\n    }\n\n    if (!e.shiftKey) {\n      if (!findNextSiblingFocusable(item)) {\n        let n: HTMLElement | null = menu.querySelector(`.${ITEM_CLASSNAME}`) as HTMLElement;\n        if (!isFocusable(n)) {\n          n = findNextSiblingFocusable(n);\n        }\n        if (n) {\n          n.focus();\n          event.cancel(e);\n        }\n      }\n    } else {\n      if (!findPrevSiblingFocusable(item)) {\n        const items = menu.querySelectorAll(`.${ITEM_CLASSNAME}`);\n        let n: HTMLElement | null = items[items.length - 1] as HTMLElement;\n        if (!isFocusable(n)) {\n          n = findPrevSiblingFocusable(n);\n        }\n        if (n) {\n          n.focus();\n          event.cancel(e);\n        }\n      }\n    }\n  }\n}\n","import type { AnyListener, EventListenerId } from '../ts-types';\nimport { each } from '../internal/utils';\nimport { get as getSymbol } from '../internal/symbolManager';\n\n//private symbol\n/** @private */\nconst _ = getSymbol();\n\n/** @private */\nlet nextId = 1;\n/**\n * event target.\n */\nexport class EventTarget {\n  private [_]: {\n    listeners: { [type: string]: AnyListener[] };\n    listenerData: {\n      [id: number]: {\n        type: string;\n        listener: AnyListener;\n        remove: () => void;\n      };\n    };\n  } = {\n    listeners: {},\n    listenerData: {}\n  };\n  /**\n   * Adds an event listener.\n   * @param  {string} type The event type id.\n   * @param  {function} listener Callback method.\n   * @return {number} unique id for the listener.\n   */\n  listen(type: string, listener: AnyListener): EventListenerId {\n    const list = this[_].listeners[type] || (this[_].listeners[type] = []);\n    list.push(listener);\n\n    const id = nextId++;\n    this[_].listenerData[id] = {\n      type,\n      listener,\n      remove: (): void => {\n        delete this[_].listenerData[id];\n        const index = list.indexOf(listener);\n        list.splice(index, 1);\n        if (!this[_].listeners[type].length) {\n          delete this[_].listeners[type];\n        }\n      }\n    };\n    return id;\n  }\n  /**\n   * Removes an event listener which was added with listen() by the id returned by listen().\n   * @param  {number} id the id returned by listen().\n   * @return {void}\n   */\n  unlisten(id: EventListenerId): void {\n    if (!this[_]) {\n      return;\n    }\n    this[_].listenerData[id].remove();\n  }\n  addEventListener(type: string, listener: AnyListener): void {\n    this.listen(type, listener);\n  }\n  removeEventListener(type: string, listener: AnyListener): void {\n    if (!this[_]) {\n      return;\n    }\n    each(this[_].listenerData, (obj, id) => {\n      if (obj.type === type && obj.listener === listener) {\n        this.unlisten(id);\n      }\n    });\n  }\n  hasListeners(type: string): boolean {\n    if (!this[_]) {\n      return false;\n    }\n    return !!this[_].listeners[type];\n  }\n  /**\n   * Fires all registered listeners\n   * @param  {string}    type The type of the listeners to fire.\n   * @param  {...*} args fire arguments\n   * @return {*} the result of the last listener\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  fireListeners(type: string, ...args: any[]): any {\n    if (!this[_]) {\n      return [];\n    }\n    const list = this[_].listeners[type];\n    if (!list) {\n      return [];\n    }\n    return list.map((listener) => listener.call(this, ...args)).filter((r) => r != null);\n  }\n  dispose(): void {\n    // @ts-expect-error -- ignore\n    delete this[_];\n  }\n}\n","import type { BaseStyleOption, ColorDef, ColumnStyle } from '../../ts-types';\nimport { EventTarget } from '../../core/EventTarget';\n\nconst STYLE_EVENT_TYPE = {\n  CHANGE_STYLE: 'change_style' as const\n};\n\nlet defaultStyle: BaseStyle;\nexport class BaseStyle extends EventTarget implements ColumnStyle {\n  private _bgColor?: ColorDef;\n  static get EVENT_TYPE(): { CHANGE_STYLE: 'change_style' } {\n    return STYLE_EVENT_TYPE;\n  }\n  static get DEFAULT(): BaseStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new BaseStyle());\n  }\n  constructor({ bgColor }: BaseStyleOption = {}) {\n    super();\n    this._bgColor = bgColor;\n  }\n  get bgColor(): ColorDef | undefined {\n    return this._bgColor;\n  }\n  set bgColor(bgColor: ColorDef | undefined) {\n    this._bgColor = bgColor;\n    this.doChangeStyle();\n  }\n  doChangeStyle(): void {\n    this.fireListeners(STYLE_EVENT_TYPE.CHANGE_STYLE);\n  }\n  clone(): BaseStyle {\n    return new BaseStyle(this);\n  }\n}\n","import { BaseStyle } from './BaseStyle';\nimport type { StdBaseStyleOption } from '../../ts-types';\n\nlet defaultStyle: StdBaseStyle;\nexport class StdBaseStyle extends BaseStyle {\n  private _textAlign: CanvasTextAlign;\n  private _textBaseline: CanvasTextBaseline;\n  static get DEFAULT(): StdBaseStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new StdBaseStyle());\n  }\n  constructor(style: StdBaseStyleOption = {}) {\n    super(style);\n    this._textAlign = style.textAlign || 'left';\n    this._textBaseline = style.textBaseline || 'middle';\n  }\n  get textAlign(): CanvasTextAlign {\n    return this._textAlign;\n  }\n  set textAlign(textAlign: CanvasTextAlign) {\n    this._textAlign = textAlign;\n    this.doChangeStyle();\n  }\n  get textBaseline(): CanvasTextBaseline {\n    return this._textBaseline;\n  }\n  set textBaseline(textBaseline: CanvasTextBaseline) {\n    this._textBaseline = textBaseline;\n    this.doChangeStyle();\n  }\n  clone(): StdBaseStyle {\n    return new StdBaseStyle(this);\n  }\n}\n","import type { ColorDef, StyleOption, TextOverflow } from '../../ts-types';\nimport { StdBaseStyle } from './StdBaseStyle';\nlet defaultStyle: Style;\nexport class Style extends StdBaseStyle {\n  private _color?: ColorDef;\n  private _font?: string;\n  private _padding: number | string | (number | string)[] | undefined;\n  private _textOverflow: TextOverflow;\n  static get DEFAULT(): Style {\n    return defaultStyle ? defaultStyle : (defaultStyle = new Style());\n  }\n  constructor(style: StyleOption = {}) {\n    super(style);\n    this._color = style.color;\n    this._font = style.font;\n    this._padding = style.padding;\n    this._textOverflow = style.textOverflow || 'clip';\n  }\n  get color(): ColorDef | undefined {\n    return this._color;\n  }\n  set color(color: ColorDef | undefined) {\n    this._color = color;\n    this.doChangeStyle();\n  }\n  get font(): string | undefined {\n    return this._font;\n  }\n  set font(font: string | undefined) {\n    this._font = font;\n    this.doChangeStyle();\n  }\n  get padding(): number | string | (number | string)[] | undefined {\n    return this._padding;\n  }\n  set padding(padding: number | string | (number | string)[] | undefined) {\n    this._padding = padding;\n    this.doChangeStyle();\n  }\n  get textOverflow(): TextOverflow {\n    return this._textOverflow;\n  }\n  set textOverflow(textOverflow: TextOverflow) {\n    this._textOverflow = textOverflow;\n    this.doChangeStyle();\n  }\n  clone(): Style {\n    return new Style(this);\n  }\n}\n","import type { ButtonStyleOption, ColorDef } from '../../ts-types';\nimport { Style } from './Style';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: ButtonStyle;\nexport class ButtonStyle extends Style {\n  private _buttonBgColor?: ColorDef;\n  static get DEFAULT(): ButtonStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new ButtonStyle());\n  }\n  constructor(style: ButtonStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n    const { buttonBgColor } = style;\n    this._buttonBgColor = buttonBgColor;\n  }\n  get buttonBgColor(): ColorDef | undefined {\n    return this._buttonBgColor;\n  }\n  set buttonBgColor(buttonBgColor: ColorDef | undefined) {\n    this._buttonBgColor = buttonBgColor;\n    this.doChangeStyle();\n  }\n  clone(): ButtonStyle {\n    return new ButtonStyle(this);\n  }\n}\n","import type { CheckStyleOption, ColorDef } from '../../ts-types';\nimport { StdBaseStyle } from './StdBaseStyle';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: CheckStyle;\nexport class CheckStyle extends StdBaseStyle {\n  private _uncheckBgColor?: ColorDef;\n  private _checkBgColor?: ColorDef;\n  private _borderColor?: ColorDef;\n  static get DEFAULT(): CheckStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new CheckStyle());\n  }\n  constructor(style: CheckStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n    const { uncheckBgColor, checkBgColor, borderColor } = style;\n    this._uncheckBgColor = uncheckBgColor;\n    this._checkBgColor = checkBgColor;\n    this._borderColor = borderColor;\n  }\n  get uncheckBgColor(): ColorDef | undefined {\n    return this._uncheckBgColor;\n  }\n  set uncheckBgColor(uncheckBgColor: ColorDef | undefined) {\n    this._uncheckBgColor = uncheckBgColor;\n    this.doChangeStyle();\n  }\n  get checkBgColor(): ColorDef | undefined {\n    return this._checkBgColor;\n  }\n  set checkBgColor(checkBgColor: ColorDef | undefined) {\n    this._checkBgColor = checkBgColor;\n    this.doChangeStyle();\n  }\n  get borderColor(): ColorDef | undefined {\n    return this._borderColor;\n  }\n  set borderColor(borderColor: ColorDef | undefined) {\n    this._borderColor = borderColor;\n    this.doChangeStyle();\n  }\n  clone(): CheckStyle {\n    return new CheckStyle(this);\n  }\n}\n","import type { IconStyleOption } from '../../ts-types';\nimport { Style } from './Style';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: IconStyle;\nexport class IconStyle extends Style {\n  static get DEFAULT(): IconStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new IconStyle());\n  }\n  constructor(style: IconStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n  }\n  clone(): IconStyle {\n    return new IconStyle(this);\n  }\n}\n","import type { ImageStyleOption } from '../../ts-types';\nimport { StdBaseStyle } from './StdBaseStyle';\nimport { defaults } from '../../internal/utils';\nlet defaultStyle: ImageStyle;\nexport class ImageStyle extends StdBaseStyle {\n  private _imageSizing?: 'keep-aspect-ratio';\n  private _margin: number;\n  static get DEFAULT(): ImageStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new ImageStyle());\n  }\n  constructor(style: ImageStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n    this._imageSizing = style.imageSizing;\n    this._margin = style.margin || 4;\n  }\n  get imageSizing(): 'keep-aspect-ratio' | undefined {\n    return this._imageSizing;\n  }\n  set imageSizing(imageSizing: 'keep-aspect-ratio' | undefined) {\n    this._imageSizing = imageSizing;\n    this.doChangeStyle();\n  }\n  get margin(): number {\n    return this._margin;\n  }\n  set margin(margin: number) {\n    this._margin = margin;\n    this.doChangeStyle();\n  }\n  clone(): ImageStyle {\n    return new ImageStyle(this);\n  }\n}\n","import type { MenuStyleOption } from '../../ts-types';\nimport { Style } from './Style';\n\nlet defaultStyle: MenuStyle;\nexport class MenuStyle extends Style {\n  private _appearance?: 'menulist-button' | 'none';\n  static get DEFAULT(): MenuStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new MenuStyle());\n  }\n  constructor(style: MenuStyleOption = {}) {\n    super(style);\n    const { appearance } = style;\n    this._appearance = appearance;\n  }\n  get appearance(): 'menulist-button' | 'none' | undefined {\n    return this._appearance || 'menulist-button';\n  }\n  set appearance(appearance: 'menulist-button' | 'none' | undefined) {\n    this._appearance = appearance;\n    this.doChangeStyle();\n  }\n  clone(): MenuStyle {\n    return new MenuStyle(this);\n  }\n}\n","import type { LineClamp, MultilineTextStyleOption } from '../../ts-types';\nimport { Style } from './Style';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: MultilineTextStyle;\nexport class MultilineTextStyle extends Style {\n  private _lineHeight: string | number;\n  private _autoWrapText: boolean;\n  private _lineClamp?: LineClamp;\n  static get DEFAULT(): MultilineTextStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new MultilineTextStyle());\n  }\n  constructor(style: MultilineTextStyleOption = {}) {\n    super(defaults(style, { textBaseline: 'top' }));\n    this._lineHeight = style.lineHeight || '1em';\n    this._autoWrapText = style.autoWrapText || false;\n    this._lineClamp = style.lineClamp;\n  }\n  clone(): MultilineTextStyle {\n    return new MultilineTextStyle(this);\n  }\n  get lineHeight(): string | number {\n    return this._lineHeight;\n  }\n  set lineHeight(lineHeight: string | number) {\n    this._lineHeight = lineHeight;\n    this.doChangeStyle();\n  }\n  get lineClamp(): LineClamp | undefined {\n    return this._lineClamp;\n  }\n  set lineClamp(lineClamp: LineClamp | undefined) {\n    this._lineClamp = lineClamp;\n    this.doChangeStyle();\n  }\n  get autoWrapText(): boolean {\n    return this._autoWrapText;\n  }\n  set autoWrapText(autoWrapText: boolean) {\n    this._autoWrapText = autoWrapText;\n    this.doChangeStyle();\n  }\n}\n","import type { NumberStyleOption } from '../../ts-types';\nimport { Style } from './Style';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: NumberStyle;\nexport class NumberStyle extends Style {\n  static get DEFAULT(): NumberStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new NumberStyle());\n  }\n  constructor(style: NumberStyleOption = {}) {\n    super(defaults(style, { textAlign: 'right' }));\n  }\n  clone(): NumberStyle {\n    return new NumberStyle(this);\n  }\n}\n","import type { ColorDef, PercentCompleteBarStyleOption } from '../../ts-types';\nimport { Style } from './Style';\nlet defaultStyle: PercentCompleteBarStyle;\nconst DEFAULT_BAR_COLOR = (num: number): string => {\n  if (num > 80) {\n    return '#20a8d8';\n  }\n  if (num > 50) {\n    return '#4dbd74';\n  }\n  if (num > 20) {\n    return '#ffc107';\n  }\n  return '#f86c6b';\n};\nexport class PercentCompleteBarStyle extends Style {\n  private _barColor: ColorDef | ((num: number) => ColorDef);\n  private _barBgColor: ColorDef;\n  private _barHeight: number;\n  static get DEFAULT(): PercentCompleteBarStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new PercentCompleteBarStyle());\n  }\n  constructor(style: PercentCompleteBarStyleOption = {}) {\n    super(style);\n    this._barColor = style.barColor || DEFAULT_BAR_COLOR;\n    this._barBgColor = style.barBgColor || '#f0f3f5';\n    this._barHeight = style.barHeight || 3;\n  }\n  get barColor(): ColorDef | ((num: number) => ColorDef) {\n    return this._barColor;\n  }\n  set barColor(barColor: ColorDef | ((num: number) => ColorDef)) {\n    this._barColor = barColor;\n    this.doChangeStyle();\n  }\n  get barBgColor(): ColorDef {\n    return this._barBgColor;\n  }\n  set barBgColor(barBgColor: ColorDef) {\n    this._barBgColor = barBgColor;\n    this.doChangeStyle();\n  }\n  get barHeight(): number {\n    return this._barHeight;\n  }\n  set barHeight(barHeight: number) {\n    this._barHeight = barHeight;\n    this.doChangeStyle();\n  }\n  clone(): PercentCompleteBarStyle {\n    return new PercentCompleteBarStyle(this);\n  }\n}\n","import type { ColorDef, RadioStyleOption } from '../../ts-types';\nimport { StdBaseStyle } from './StdBaseStyle';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: RadioStyle;\nexport class RadioStyle extends StdBaseStyle {\n  private _checkColor?: ColorDef;\n  private _uncheckBorderColor?: ColorDef;\n  private _checkBorderColor?: ColorDef;\n  private _uncheckBgColor?: ColorDef;\n  private _checkBgColor?: ColorDef;\n  static get DEFAULT(): RadioStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new RadioStyle());\n  }\n  constructor(style: RadioStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n    const { checkColor, uncheckBorderColor, checkBorderColor, uncheckBgColor, checkBgColor } = style;\n    this._checkColor = checkColor;\n    this._uncheckBorderColor = uncheckBorderColor;\n    this._checkBorderColor = checkBorderColor;\n    this._uncheckBgColor = uncheckBgColor;\n    this._checkBgColor = checkBgColor;\n  }\n  get checkColor(): ColorDef | undefined {\n    return this._checkColor;\n  }\n  set checkColor(checkColor: ColorDef | undefined) {\n    this._checkColor = checkColor;\n    this.doChangeStyle();\n  }\n  get uncheckBorderColor(): ColorDef | undefined {\n    return this._uncheckBorderColor;\n  }\n  set uncheckBorderColor(uncheckBorderColor: ColorDef | undefined) {\n    this._uncheckBorderColor = uncheckBorderColor;\n    this.doChangeStyle();\n  }\n  get checkBorderColor(): ColorDef | undefined {\n    return this._checkBorderColor;\n  }\n  set checkBorderColor(checkBorderColor: ColorDef | undefined) {\n    this._checkBorderColor = checkBorderColor;\n    this.doChangeStyle();\n  }\n  get uncheckBgColor(): ColorDef | undefined {\n    return this._uncheckBgColor;\n  }\n  set uncheckBgColor(uncheckBgColor: ColorDef | undefined) {\n    this._uncheckBgColor = uncheckBgColor;\n    this.doChangeStyle();\n  }\n  get checkBgColor(): ColorDef | undefined {\n    return this._checkBgColor;\n  }\n  set checkBgColor(checkBgColor: ColorDef | undefined) {\n    this._checkBgColor = checkBgColor;\n    this.doChangeStyle();\n  }\n  clone(): RadioStyle {\n    return new RadioStyle(this);\n  }\n}\n","import type {\n  BaseStyleOption,\n  ButtonStyleOption,\n  CheckStyleOption,\n  ColumnStyleOption,\n  IconStyleOption,\n  ImageStyleOption,\n  MenuStyleOption,\n  MultilineTextStyleOption,\n  NumberStyleOption,\n  PercentCompleteBarStyleOption,\n  StyleOption\n} from '../ts-types';\nimport { BaseStyle } from './style/BaseStyle';\nimport { ButtonStyle } from './style/ButtonStyle';\nimport { CheckStyle } from './style/CheckStyle';\nimport { IconStyle } from './style/IconStyle';\nimport { ImageStyle } from './style/ImageStyle';\nimport { MenuStyle } from './style/MenuStyle';\nimport { MultilineTextStyle } from './style/MultilineTextStyle';\nimport { NumberStyle } from './style/NumberStyle';\nimport { PercentCompleteBarStyle } from './style/PercentCompleteBarStyle';\nimport { RadioStyle } from './style/RadioStyle';\nimport { Style } from './style/Style';\n\nconst { EVENT_TYPE } = BaseStyle;\nexport {\n  EVENT_TYPE,\n  BaseStyle,\n  Style,\n  NumberStyle,\n  CheckStyle,\n  RadioStyle,\n  ButtonStyle,\n  ImageStyle,\n  IconStyle,\n  PercentCompleteBarStyle,\n  MultilineTextStyle,\n  MenuStyle,\n  // types\n  BaseStyleOption,\n  ButtonStyleOption,\n  CheckStyleOption,\n  IconStyleOption,\n  ImageStyleOption,\n  MenuStyleOption,\n  MultilineTextStyleOption,\n  NumberStyleOption,\n  PercentCompleteBarStyleOption,\n  StyleOption\n};\nexport function of(\n  columnStyle: ColumnStyleOption | null | undefined,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  record: any,\n  StyleClassDef: typeof BaseStyle = Style\n): BaseStyle {\n  if (columnStyle) {\n    if (columnStyle instanceof BaseStyle) {\n      return columnStyle;\n    } else if (typeof columnStyle === 'function') {\n      return of(columnStyle(record), record, StyleClassDef);\n    } else if (record && (columnStyle as symbol) in record) {\n      return of(record[columnStyle as string], record, StyleClassDef);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return new StyleClassDef(columnStyle as any);\n  } else {\n    return StyleClassDef.DEFAULT;\n  }\n}\n","import * as styleContents from '../style';\nimport type { BaseColumnOption, CellAddress, CellContext, ColumnTypeAPI, EventListenerId, GridCanvasHelperAPI, LayoutObjectId, ListGridAPI, MaybePromise, Message } from '../../ts-types';\nimport type { ColumnFadeinState, DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { isPromise, obj } from '../../internal/utils';\nimport { BaseStyle } from '../style/BaseStyle';\nimport { animate } from '../../internal/animate';\nimport { getColumnFadeinStateId } from '../../internal/symbolManager';\n\nconst { setReadonly } = obj;\nconst COLUMN_FADEIN_STATE_ID = getColumnFadeinStateId();\n\nfunction isFadeinWhenCallbackInPromise<T>(column: BaseColumn<T, unknown>, grid: ListGridAPI<T>): boolean {\n  if (column.fadeinWhenCallbackInPromise != null) {\n    return column.fadeinWhenCallbackInPromise;\n  }\n  return !!grid.configure('fadeinWhenCallbackInPromise');\n}\n\nfunction getFadeinState<T>(grid: GridInternal<T>): ColumnFadeinState {\n  let state = grid[COLUMN_FADEIN_STATE_ID];\n  if (!state) {\n    state = { cells: {} };\n    setReadonly(grid, COLUMN_FADEIN_STATE_ID, state);\n  }\n  return state;\n}\nfunction _generateFadeinPointAction<T>(grid: ListGridAPI<T>, col: number, row: number, context: CellContext, drawInternal: () => void, drawCellBase: () => void): (point: number) => void {\n  return (point: number): void => {\n    const state = getFadeinState(grid);\n    const stateKey = `${row}:${col}`;\n    if (point === 1) {\n      delete state.cells[stateKey];\n    } else {\n      state.cells[stateKey] = {\n        opacity: point\n      };\n    }\n    drawCellBase();\n\n    drawInternal();\n\n    const cellState = state.cells[stateKey];\n    if (cellState) {\n      //\n      const ctx = context.getContext();\n      ctx.globalAlpha = 1 - cellState.opacity;\n      try {\n        drawCellBase();\n      } finally {\n        ctx.globalAlpha = 1;\n      }\n    }\n  };\n}\nconst fadeinMgr = {\n  animate<T>(grid: ListGridAPI<T>, col: number, row: number, context: CellContext, drawInternal: () => void, drawCellBase: () => void): void {\n    // fadein animation\n    const state = getFadeinState(grid);\n\n    const activeFadeins = [_generateFadeinPointAction(grid, col, row, context, drawInternal, drawCellBase)];\n    state.activeFadeins = activeFadeins;\n\n    animate(500, (point: number) => {\n      activeFadeins.forEach((f) => f(point));\n      if (point === 1) {\n        delete state.activeFadeins;\n      }\n    });\n  },\n  margeAnimate<T>(grid: ListGridAPI<T>, col: number, row: number, context: CellContext, drawInternal: () => void, drawCellBase: () => void): void {\n    const state = getFadeinState(grid);\n    if (state.activeFadeins) {\n      state.activeFadeins.push(_generateFadeinPointAction(grid, col, row, context, drawInternal, drawCellBase));\n    } else {\n      drawInternal();\n    }\n  }\n};\n\nexport abstract class BaseColumn<T, V> implements ColumnTypeAPI {\n  private _fadeinWhenCallbackInPromise?: boolean | null;\n  constructor(option?: BaseColumnOption) {\n    this.onDrawCell = this.onDrawCell.bind(this); //\n\n    //Promisecallback\n    this._fadeinWhenCallbackInPromise = option?.fadeinWhenCallbackInPromise;\n  }\n  get fadeinWhenCallbackInPromise(): boolean | undefined | null {\n    return this._fadeinWhenCallbackInPromise;\n  }\n  get StyleClass(): typeof BaseStyle {\n    return BaseStyle;\n  }\n  onDrawCell(cellValue: MaybePromise<unknown>, info: DrawCellInfo<T>, context: CellContext, grid: ListGridAPI<T>): void | Promise<void> {\n    const { style, getRecord, drawCellBase } = info;\n    const helper = grid.getGridCanvasHelper();\n    drawCellBase();\n\n    const record = getRecord();\n    let promise;\n    if (isPromise(record)) {\n      promise = record;\n    } else if (isPromise(cellValue)) {\n      promise = cellValue;\n    } else {\n      const msg = info.getMessage();\n      if (isPromise(msg)) {\n        promise = msg;\n      }\n    }\n    //\n    if (promise) {\n      const start = Date.now();\n      return Promise.all([record, cellValue, promise.then(() => cellValue).then(() => info.getMessage())]).then(({ 0: record, 1: val, 2: message }) => {\n        const currentContext = context.toCurrentContext();\n        const drawRect = currentContext.getDrawRect();\n        if (!drawRect) {\n          return;\n        }\n        const time = Date.now() - start;\n\n        const drawInternal = (): void => {\n          const currentContext = context.toCurrentContext();\n          const drawRect = currentContext.getDrawRect();\n          if (!drawRect) {\n            return;\n          }\n\n          const actStyle = styleContents.of(style, record, this.StyleClass);\n          this.drawInternal(this.convertInternal(val), currentContext, actStyle, helper, grid, info);\n          this.drawMessageInternal(message, currentContext, actStyle, helper, grid, info);\n        };\n\n        if (!isFadeinWhenCallbackInPromise(this, grid)) {\n          drawInternal(); //\n        } else {\n          const { col, row } = context;\n          if (time < 80) {\n            //80msPromiseCallback\n            fadeinMgr.margeAnimate(grid, col, row, context, drawInternal, drawCellBase);\n          } else {\n            //\n            fadeinMgr.animate(grid, col, row, context, drawInternal, drawCellBase);\n          }\n        }\n      });\n    } else {\n      const actStyle = styleContents.of(style, record, this.StyleClass);\n      this.drawInternal(this.convertInternal(cellValue), context, actStyle, helper, grid, info);\n      this.drawMessageInternal(info.getMessage(), context, actStyle, helper, grid, info);\n      //\n      const { col, row } = context;\n      const stateKey = `${col}:${row}`;\n      const cellState = (grid as GridInternal<T>)[COLUMN_FADEIN_STATE_ID]?.cells[stateKey];\n      if (cellState) {\n        const ctx = context.getContext();\n        ctx.globalAlpha = 1 - cellState.opacity;\n        try {\n          drawCellBase();\n        } finally {\n          ctx.globalAlpha = 1;\n        }\n      }\n      return undefined;\n    }\n  }\n  abstract clone(): BaseColumn<T, V>;\n  convertInternal(value: unknown): V {\n    return (value != null ? value : '') as V;\n  }\n  abstract drawInternal(value: V, context: CellContext, style: BaseStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void;\n  drawMessageInternal(message: Message, context: CellContext, style: BaseStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void {\n    info.messageHandler.drawCellMessage(message, context, style, helper, grid, info);\n  }\n  bindGridEvent(_grid: ListGridAPI<T>, _cellId: LayoutObjectId): EventListenerId[] {\n    return [];\n  }\n  getCopyCellValue(value: V, _grid: ListGridAPI<T>, _cell: CellAddress): string {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return value as any;\n  }\n}\n","import type { BranchGraphStyleOption, ColorDef } from '../../ts-types';\nimport { BaseStyle } from './BaseStyle';\nlet defaultStyle: BranchGraphStyle;\n\nconst DEFAULT_BRANCH_COLORS = (_name: string, index: number): string => {\n  switch (index % 3) {\n    case 0:\n      return '#979797';\n    case 1:\n      return '#008fb5';\n    case 2:\n      return '#f1c109';\n    default:\n  }\n  return '#979797';\n};\nexport class BranchGraphStyle extends BaseStyle {\n  private _branchColors: ColorDef | ((name: string, index: number) => ColorDef);\n  private _margin: number;\n  private _circleSize: number;\n  private _branchLineWidth: number;\n  private _mergeStyle: 'straight' | 'bezier';\n  static get DEFAULT(): BranchGraphStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new BranchGraphStyle());\n  }\n  constructor(style: BranchGraphStyleOption = {}) {\n    super(style);\n    this._branchColors = style.branchColors || DEFAULT_BRANCH_COLORS;\n    this._margin = style.margin || 4;\n    this._circleSize = style.circleSize || 16;\n    this._branchLineWidth = style.branchLineWidth || 4;\n    this._mergeStyle = style.mergeStyle === 'straight' ? 'straight' : 'bezier';\n  }\n  get branchColors(): ColorDef | ((name: string, index: number) => ColorDef) {\n    return this._branchColors;\n  }\n  set branchColors(branchColors: ColorDef | ((name: string, index: number) => ColorDef)) {\n    this._branchColors = branchColors;\n    this.doChangeStyle();\n  }\n  get margin(): number {\n    return this._margin;\n  }\n  set margin(margin: number) {\n    this._margin = margin;\n    this.doChangeStyle();\n  }\n  get circleSize(): number {\n    return this._circleSize;\n  }\n  set circleSize(circleSize: number) {\n    this._circleSize = circleSize;\n    this.doChangeStyle();\n  }\n  get branchLineWidth(): number {\n    return this._branchLineWidth;\n  }\n  set branchLineWidth(branchLineWidth: number) {\n    this._branchLineWidth = branchLineWidth;\n    this.doChangeStyle();\n  }\n  get mergeStyle(): 'straight' | 'bezier' {\n    return this._mergeStyle;\n  }\n  set mergeStyle(mergeStyle: 'straight' | 'bezier') {\n    this._mergeStyle = mergeStyle;\n    this.doChangeStyle();\n  }\n  clone(): BranchGraphStyle {\n    return new BranchGraphStyle(this);\n  }\n}\n","import type { BranchGraphColumnOption, BranchGraphCommand, CellContext, ColorDef, FieldDef, GridCanvasHelperAPI, ListGridAPI, MaybePromise, MaybePromiseOrUndef } from '../../ts-types';\nimport type { DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { getOrApply, isPromise, obj } from '../../internal/utils';\nimport { BaseColumn } from './BaseColumn';\nimport { BranchGraphStyle } from '../style/BranchGraphStyle';\nimport { getBranchGraphColumnStateId } from '../../internal/symbolManager';\n\nconst _ = getBranchGraphColumnStateId();\n\ntype Timelines = { timeline: BranchPoint[][]; branches: string[] };\n\nfunction getAllColumnData<T>(grid: ListGridAPI<T>, field: FieldDef<T>, callback: (allData: BranchGraphCommand[]) => void): void {\n  const { dataSource } = grid;\n  const allData: BranchGraphCommand[] = [];\n  let promise;\n  for (let index = 0; index < dataSource.length; index++) {\n    const data = dataSource.getField(index, field) as MaybePromiseOrUndef<BranchGraphCommand>;\n    if (isPromise(data)) {\n      const dataIndex = allData.length;\n      allData.push(undefined);\n      if (!promise) {\n        promise = data.then((d) => {\n          allData[dataIndex] = d;\n        });\n      } else {\n        promise = promise\n          .then(() => data)\n          .then((d) => {\n            allData[dataIndex] = d;\n          });\n      }\n    } else {\n      allData.push(data);\n    }\n  }\n\n  if (promise) {\n    promise.then(() => callback(allData));\n  } else {\n    callback(allData);\n  }\n}\n\nclass BranchLine {\n  readonly fromIndex?: number;\n  toIndex?: number;\n  readonly colorIndex: number;\n  readonly point?: BranchPoint;\n  constructor({ fromIndex, toIndex, colorIndex, point }: { fromIndex?: number; toIndex?: number; colorIndex: number; point?: BranchPoint }) {\n    this.fromIndex = fromIndex;\n    this.toIndex = toIndex;\n    this.colorIndex = colorIndex;\n    this.point = point;\n  }\n}\nclass BranchPoint {\n  readonly index: number;\n  readonly commit: boolean;\n  lines: BranchLine[];\n  readonly tag?: string;\n  constructor({ index, commit = false, lines = [], tag }: { index: number; commit?: boolean; lines?: BranchLine[]; tag?: string }) {\n    this.index = index;\n    this.commit = commit;\n    this.lines = lines;\n    this.tag = tag;\n  }\n  static mergeLines(lines: BranchLine[]): BranchLine[] {\n    const result = lines.filter((l) => l.fromIndex != null && l.toIndex != null);\n\n    const froms = lines.filter((l) => l.fromIndex != null && l.toIndex == null);\n    const tos = lines.filter((l) => l.fromIndex == null && l.toIndex != null);\n\n    froms.forEach((f) => {\n      for (let i = 0; i < tos.length; i++) {\n        const t = tos[i];\n        if (t.point) {\n          continue;\n        }\n        if (f.colorIndex === t.colorIndex) {\n          f.toIndex = t.toIndex;\n          tos.splice(i, 1);\n          break;\n        }\n      }\n\n      result.push(f);\n    });\n\n    return result.concat(tos);\n  }\n  static merge(a: BranchPoint, b: BranchPoint): BranchPoint {\n    if (!a) {\n      return b;\n    }\n    return new BranchPoint({\n      index: a.index,\n      commit: a.commit || b.commit,\n      lines: BranchPoint.mergeLines(a.lines.concat(b.lines)),\n      tag: a.tag || b.tag\n    });\n  }\n}\n\nfunction joinLine(timeline: BranchPoint[][], branchIndex: number): boolean {\n  const reverse = [...timeline].reverse();\n  for (let i = 0; i < reverse.length; i++) {\n    const f = reverse[i][branchIndex];\n    if (f) {\n      f.lines = BranchPoint.mergeLines(\n        f.lines.concat([\n          new BranchLine({\n            toIndex: branchIndex,\n            colorIndex: branchIndex\n          })\n        ])\n      );\n\n      for (let j = 0; j < i; j++) {\n        const tl = reverse[j];\n        tl[branchIndex] = new BranchPoint({\n          index: branchIndex,\n          lines: [\n            new BranchLine({\n              fromIndex: branchIndex,\n              toIndex: branchIndex,\n              colorIndex: branchIndex\n            })\n          ]\n        });\n      }\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction branch({ timeline, branches }: Timelines, from: string | null, to: string): BranchPoint | null {\n  const fromIndex = from != null ? branches.indexOf(from) : -1;\n  let toIndex = branches.indexOf(to);\n  if (toIndex < 0) {\n    toIndex = branches.length;\n    branches.push(to);\n  }\n\n  function findBranchRootIndex(): number {\n    for (let index = timeline.length - 1; index >= 0; index--) {\n      const tl = timeline[index];\n      const from = tl[fromIndex];\n      if (from && from.commit) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  if (fromIndex < 0) {\n    return new BranchPoint({\n      index: toIndex\n    });\n  } else {\n    const fromTargetIndex = findBranchRootIndex();\n    if (fromTargetIndex === -1) {\n      return null;\n    }\n    const branchTargetFromIndex = fromTargetIndex + 1;\n    const branchPoint = new BranchPoint({\n      index: toIndex,\n      lines: [\n        new BranchLine({\n          fromIndex,\n          colorIndex: toIndex\n        })\n      ]\n    });\n    let point;\n    let result = null;\n    if (branchTargetFromIndex < timeline.length) {\n      const targetLine = timeline[branchTargetFromIndex];\n      point = targetLine[toIndex] = BranchPoint.merge(targetLine[toIndex], branchPoint);\n    } else {\n      point = branchPoint;\n      result = branchPoint;\n    }\n    const from = timeline[fromTargetIndex][fromIndex];\n    from.lines = BranchPoint.mergeLines(\n      from.lines.concat([\n        new BranchLine({\n          toIndex,\n          colorIndex: toIndex,\n          point\n        })\n      ])\n    );\n    return result;\n  }\n}\n\nfunction commit({ timeline, branches }: Timelines, name: string): BranchPoint | null {\n  const index = branches.indexOf(name);\n  if (index < 0) {\n    return null;\n  }\n  const result = new BranchPoint({\n    index,\n    commit: true\n  });\n\n  if (joinLine(timeline, index)) {\n    result.lines = BranchPoint.mergeLines(\n      result.lines.concat([\n        new BranchLine({\n          fromIndex: index,\n          colorIndex: index\n        })\n      ])\n    );\n  }\n  return result;\n}\n\nfunction commitTag({ branches }: Timelines, name: string, tag: string): BranchPoint {\n  let index = branches.indexOf(name);\n  if (index < 0) {\n    index = branches.length;\n    branches.push(name);\n  }\n  return new BranchPoint({\n    index,\n    tag\n  });\n}\n\nfunction commitMerge({ timeline, branches }: Timelines, from: string, to: string): BranchPoint {\n  const fromIndex = branches.indexOf(from);\n  const toIndex = branches.indexOf(to);\n  if (toIndex < 0 || fromIndex < 0) {\n    return new BranchPoint({\n      index: toIndex,\n      commit: true\n    });\n  }\n  const result = new BranchPoint({\n    index: toIndex,\n    commit: true,\n    lines: [\n      new BranchLine({\n        fromIndex,\n        colorIndex: fromIndex\n      }),\n      new BranchLine({\n        fromIndex: toIndex,\n        colorIndex: toIndex\n      })\n    ]\n  });\n  const froms = [...timeline];\n  const fromTargetLine = froms.pop();\n  if (fromTargetLine) {\n    fromTargetLine[fromIndex] = BranchPoint.merge(\n      fromTargetLine[fromIndex],\n      new BranchPoint({\n        index: toIndex,\n        lines: [\n          new BranchLine({\n            toIndex,\n            colorIndex: fromIndex\n          })\n        ]\n      })\n    );\n  }\n\n  if (joinLine(froms, fromIndex) && fromTargetLine) {\n    fromTargetLine[fromIndex].lines = BranchPoint.mergeLines(\n      fromTargetLine[fromIndex].lines.concat([\n        new BranchLine({\n          fromIndex,\n          colorIndex: fromIndex\n        })\n      ])\n    );\n  }\n  joinLine(timeline, toIndex);\n\n  return result;\n}\n\nfunction calcCommand(info: Timelines, command: BranchGraphCommand): void {\n  const { timeline } = info;\n  const timelineData: BranchPoint[] = [];\n  // const last = timeline.length > 0 ? timeline[timeline.length - 1] : null;\n  const commands = Array.isArray(command) ? command : [command];\n  commands.forEach((cmd) => {\n    if (!cmd) {\n      return;\n    }\n    let point;\n    if (cmd.command === 'branch') {\n      const from = obj.isObject(cmd.branch) ? cmd.branch.from : null;\n      const to = obj.isObject(cmd.branch) ? cmd.branch.to : cmd.branch;\n      point = branch(info, from, to);\n    } else if (cmd.command === 'commit') {\n      const { branch } = cmd;\n      point = commit(info, branch);\n    } else if (cmd.command === 'merge') {\n      const { from, to } = cmd.branch;\n      point = commitMerge(info, from, to);\n    } else if (cmd.command === 'tag') {\n      const { branch, tag } = cmd;\n      point = commitTag(info, branch, tag);\n    }\n    if (point && point.index > -1) {\n      timelineData[point.index] = BranchPoint.merge(timelineData[point.index], point);\n    }\n  });\n  timeline.push(timelineData);\n}\n\nfunction calcBranchesInfo<T>(start: 'top' | 'bottom', grid: ListGridAPI<T>, field: FieldDef<T>): Timelines {\n  const result = {\n    branches: [],\n    timeline: []\n  };\n  getAllColumnData(grid, field, (data) => {\n    if (start !== 'top') {\n      data = [...data].reverse();\n    }\n    data.forEach((command) => {\n      calcCommand(result, command);\n    });\n  });\n  return result;\n}\n\nfunction calcBranchXPoints(ctx: CanvasRenderingContext2D, left: number, width: number, radius: number, branches: string[], timeline: BranchPoint[][]): number[] {\n  let w = Math.max(width / branches.length + 1, 5);\n  timeline.forEach((tl) => {\n    tl.forEach((p, index) => {\n      if (index <= 0) {\n        // \n        return;\n      }\n      if (p.tag) {\n        const textWidth = ctx.measureText(p.tag).width;\n        if (w * index + radius * 2 + 4 + textWidth > width) {\n          w = Math.max((width - radius * 2 - 4 - textWidth) / index, 5);\n        }\n      }\n    });\n  });\n  const result: number[] = [];\n  let x = left;\n  branches.forEach(() => {\n    result.push(Math.ceil(x + radius));\n    x += w;\n  });\n  return result;\n}\n\nfunction renderMerge<T>(\n  grid: ListGridAPI<T>,\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  upLineIndex: number | undefined,\n  downLineIndex: number | undefined,\n  colorIndex: number,\n  {\n    branchXPoints,\n    // margin,\n    branchColors,\n    branchLineWidth,\n    mergeStyle\n  }: {\n    branchXPoints: number[];\n    margin: number;\n    branchColors: ColorDef | ((name: string, index: number) => ColorDef);\n    branchLineWidth: number;\n    mergeStyle: 'straight' | 'bezier';\n  },\n  {\n    // width,\n    col,\n    row,\n    branches\n  }: {\n    width: number;\n    col: number;\n    row: number;\n    branches: string[];\n  }\n): void {\n  if (upLineIndex != null || downLineIndex != null) {\n    ctx.strokeStyle = getOrApply(branchColors, branches[colorIndex], colorIndex);\n    ctx.lineWidth = branchLineWidth;\n    ctx.lineCap = 'round';\n    ctx.beginPath();\n\n    if (upLineIndex != null) {\n      const upX = branchXPoints[upLineIndex];\n      const upRect = grid.getCellRelativeRect(col, row - 1);\n      const upY = upRect.top + upRect.height / 2;\n      ctx.moveTo(upX, upY);\n      if (mergeStyle === 'bezier') {\n        ctx.bezierCurveTo(upX, (y + upY) / 2, x, (y + upY) / 2, x, y);\n      } else {\n        ctx.lineTo(x, y);\n      }\n    } else {\n      ctx.moveTo(x, y);\n    }\n\n    if (downLineIndex != null) {\n      const downX = branchXPoints[downLineIndex];\n      const downRect = grid.getCellRelativeRect(col, row + 1);\n      const downY = downRect.top + downRect.height / 2;\n      if (mergeStyle === 'bezier') {\n        ctx.bezierCurveTo(x, (y + downY) / 2, downX, (y + downY) / 2, downX, downY);\n      } else {\n        ctx.lineTo(downX, downY);\n      }\n    }\n\n    ctx.stroke();\n  }\n}\n\n/**\n * BranchGraphColumn\n *\n * Data commands\n * - mastar branch or orphan branch\n *\n * ```js\n * {\n * \tcommand: 'branch',\n * \tbranch: 'branch name A',\n * }\n * ```\n *\n * - commit\n *\n * ```js\n * {\n * \tcommand: 'commit',\n * \tbranch: 'branch name A'\n * }\n * ```\n *\n * - branch\n *\n * ```js\n * {\n * \tcommand: 'branch',\n * \tbranch: {\n * \t\tfrom: 'branch name A',\n * \t\tto: 'branch name B'\n * \t}\n * }\n * ```\n *\n * - merge\n *\n * ```js\n * {\n * \tcommand: 'merge',\n * \tbranch: {\n * \t\tfrom: 'branch name B',\n * \t\tto: 'branch name A'\n * \t}\n * }\n * ```\n *\n * - tag\n *\n * ```js\n * {\n * \tcommand: 'tag',\n * \tbranch: 'branch name A',\n * \ttag: 'tag name'\n * }\n * ```\n *\n * @memberof cheetahGrid.columns.type\n */\nexport class BranchGraphColumn<T> extends BaseColumn<T, unknown> {\n  private _start: 'top' | 'bottom';\n  private _cache: boolean;\n  constructor(option: BranchGraphColumnOption = {}) {\n    super(option);\n    this._start = option.start || 'bottom';\n    this._cache = option.cache != null ? option.cache : false;\n  }\n  get StyleClass(): typeof BranchGraphStyle {\n    return BranchGraphStyle;\n  }\n  clearCache(grid: GridInternal<T>): void {\n    delete grid[_];\n  }\n  onDrawCell(cellValue: MaybePromise<unknown>, info: DrawCellInfo<T>, context: CellContext, grid: GridInternal<T>): void | Promise<void> {\n    if (this._cache) {\n      const state = grid[_] || (grid[_] = new Map());\n      const { col, row } = context;\n      const field = grid.getField(col, row) as FieldDef<T>;\n      if (!state.has(field)) {\n        state.set(field, calcBranchesInfo(this._start, grid, field));\n      }\n    }\n    return super.onDrawCell(cellValue, info, context, grid);\n  }\n  clone(): BranchGraphColumn<T> {\n    return new BranchGraphColumn(this);\n  }\n  drawInternal(_value: unknown, context: CellContext, style: BranchGraphStyle, helper: GridCanvasHelperAPI, grid: GridInternal<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { col, row } = context;\n    const field = grid.getField(col, row) as FieldDef<T>;\n    const { timeline, branches } = (this._cache ? grid[_]?.get(field) : null) ?? calcBranchesInfo(this._start, grid, field);\n\n    const {\n      upLineIndexKey,\n      downLineIndexKey\n    }: {\n      upLineIndexKey: 'fromIndex' | 'toIndex';\n      downLineIndexKey: 'fromIndex' | 'toIndex';\n    } = this._start !== 'top' ? { upLineIndexKey: 'toIndex', downLineIndexKey: 'fromIndex' } : { upLineIndexKey: 'fromIndex', downLineIndexKey: 'toIndex' };\n    const data = this._start !== 'top' ? timeline[timeline.length - (row - grid.frozenRowCount) - 1] : timeline[row - grid.frozenRowCount];\n\n    const { branchColors, branchLineWidth, circleSize, mergeStyle, margin, bgColor } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    const rect = context.getRect();\n    const radius = circleSize / 2;\n    const width = rect.width - margin * 2;\n\n    helper.drawWithClip(context, (ctx) => {\n      ctx.textAlign = 'left';\n      ctx.textBaseline = 'middle';\n      const branchXPoints = calcBranchXPoints(ctx, rect.left + margin, width, radius, branches, timeline);\n\n      const y = rect.top + rect.height / 2;\n\n      // draw join lines\n      data\n        .map((point, index) =>\n          point\n            ? point.lines.map((line) => ({\n              colorIndex: line.colorIndex,\n              upLineIndex: line[upLineIndexKey],\n              downLineIndex: line[downLineIndexKey],\n              pointIndex: index\n            }))\n            : []\n        )\n        .reduce((p, c) => p.concat(c), []) // flatMap\n        // order of overlap\n        .sort((a, b) => b.colorIndex - a.colorIndex)\n        .forEach((line) => {\n          const x = branchXPoints[line.pointIndex];\n          renderMerge(\n            grid,\n            ctx,\n            x,\n            y,\n            line.upLineIndex,\n            line.downLineIndex,\n            line.colorIndex,\n            {\n              margin,\n              branchXPoints,\n              branchLineWidth,\n              branchColors,\n              mergeStyle\n            },\n            {\n              width,\n              col,\n              row,\n              branches\n            }\n          );\n        });\n      // draw commit points\n      data.forEach((p, index) => {\n        if (p && p.commit) {\n          const x = branchXPoints[index];\n          ctx.fillStyle = getOrApply(branchColors, branches[index], index);\n          ctx.beginPath();\n          ctx.arc(x, y, radius, 0, Math.PI * 2, true);\n          ctx.fill();\n          ctx.closePath();\n        }\n      });\n      // draw tags\n      data.forEach((p, index) => {\n        if (p && p.tag) {\n          ctx.fillStyle = getOrApply(branchColors, branches[index], index);\n          ctx.fillText(p.tag, branchXPoints[index] + radius + 4, y);\n        }\n      });\n    });\n  }\n}\n","import type { ColumnIconOption, FontIcon, ImageIcon, NamedIcon, PathIcon, SvgIcon } from '../ts-types';\nimport type { SimpleColumnIconOption } from '../ts-types-internal';\n\ntype ColumnIconArrayOption = {\n  content?: (string | null)[];\n  font?: (string | null)[];\n  color?: (string | null)[];\n  className?: (string | null)[];\n  tagName?: (string | null)[];\n  isLiga?: (boolean | null)[];\n  width?: (number | null)[];\n  src?: (string | null)[];\n  svg?: (string | null)[];\n  name?: (string | null)[];\n  path?: (string | null)[];\n};\n\ntype IconPropKey = (keyof FontIcon<unknown> | keyof ImageIcon<unknown> | keyof PathIcon<unknown> | keyof SvgIcon<unknown> | keyof NamedIcon<unknown>) & keyof SimpleColumnIconOption;\nconst ICON_PROP_KEYS: IconPropKey[] = ['content', 'font', 'color', 'className', 'tagName', 'isLiga', 'width', 'src', 'svg', 'name', 'path'];\n\nfunction quote(name: string): string {\n  const quoted = [];\n  const split = name.split(/,\\s*/);\n  for (let i = 0; i < split.length; i++) {\n    const part = split[i].replace(/['\"]/g, '');\n    if (part.indexOf(' ') === -1 && !/^\\d/.test(part)) {\n      quoted.push(part);\n    } else {\n      quoted.push(`'${part}'`);\n    }\n  }\n  return quoted.join(',');\n}\n\nconst doms: {\n  [tagName: string]: HTMLElement;\n} = {};\nconst props: {\n  [tagName: string]: {\n    [className: string]: { [key: string]: string | number | boolean };\n  };\n} = {};\n\nexport function getIconProps(tagName: string, className: string): SimpleColumnIconOption {\n  const tagProps = props[tagName] || (props[tagName] = {});\n  if (tagProps[className]) {\n    return tagProps[className];\n  }\n  const dom = doms[tagName] || (doms[tagName] = document.createElement(tagName));\n  dom.className = className;\n  document.body.appendChild(dom);\n  try {\n    const beforeStyle = (document.defaultView || window).getComputedStyle(dom, '::before');\n    let content = beforeStyle.getPropertyValue('content');\n    if (content.length >= 3 && (content[0] === '\"' || content[0] === '\\'')) {\n      if (content[0] === content[content.length - 1]) {\n        content = content.substr(1, content.length - 2);\n      }\n    }\n    let font = beforeStyle.getPropertyValue('font');\n    if (!font) {\n      font = `${beforeStyle.getPropertyValue('font-style')} ${beforeStyle.getPropertyValue('font-variant')} ${beforeStyle.getPropertyValue('font-weight')} ${beforeStyle.getPropertyValue(\n        'font-size'\n      )}/${beforeStyle.getPropertyValue('line-height')} ${quote(beforeStyle.getPropertyValue('font-family'))}`;\n    }\n    const color = beforeStyle.getPropertyValue('color');\n    const width = dom.clientWidth;\n    const isLiga = (beforeStyle.getPropertyValue('font-feature-settings') || '').indexOf('liga') > -1;\n\n    return (tagProps[className] = {\n      content,\n      font,\n      color,\n      width,\n      isLiga\n    });\n  } finally {\n    document.body.removeChild(dom);\n  }\n}\n\nfunction toPropArray<T>(prop: T, count: number): (T | null)[] {\n  const result: (T | null)[] = [];\n  if (Array.isArray(prop)) {\n    result.push(...prop);\n    for (let i = prop.length; i < count; i++) {\n      result.push(null);\n    }\n  } else {\n    for (let i = 0; i < count; i++) {\n      result.push(prop);\n    }\n  }\n  return result;\n}\n\nfunction toSimpleArray(iconProps: ColumnIconOption<unknown> | ColumnIconOption<unknown>[]): SimpleColumnIconOption[] {\n  if (!iconProps) {\n    return iconProps;\n  } else if (Array.isArray(iconProps)) {\n    return iconProps;\n  }\n\n  const workData = {} as Required<ColumnIconArrayOption>;\n\n  let count = 0;\n  ICON_PROP_KEYS.forEach((k) => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const prop = (iconProps as any)[k];\n    if (prop) {\n      if (Array.isArray(prop)) {\n        count = Math.max(count, prop.length);\n      } else {\n        count = Math.max(count, 1);\n      }\n    }\n  });\n\n  ICON_PROP_KEYS.forEach((k) => {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const arr = toPropArray((iconProps as any)[k], count);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (workData as any)[k] = arr;\n  });\n\n  const result: SimpleColumnIconOption[] = [];\n  for (let i = 0; i < count; i++) {\n    const data = {} as SimpleColumnIconOption;\n    ICON_PROP_KEYS.forEach((k) => {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const val = (workData as any)[k][i];\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (data as any)[k] = val;\n    });\n    result.push(data);\n  }\n  return result;\n}\n\nfunction normarize(iconProps: SimpleColumnIconOption): SimpleColumnIconOption {\n  const data: SimpleColumnIconOption = {};\n  for (const k in iconProps) {\n    if (k === 'className') {\n      continue;\n    }\n    if (isIconKey(k)) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      data[k] = iconProps[k] as any;\n    }\n  }\n  if (iconProps.className) {\n    const prop = getIconProps(iconProps.tagName || 'i', iconProps.className);\n    for (const k in prop) {\n      if (isIconKey(k)) {\n        if (iconProps[k] == null) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          data[k] = prop[k] as any;\n        }\n      }\n    }\n  }\n  return data;\n}\n\nexport function toNormarizeArray(iconProps: ColumnIconOption<unknown> | ColumnIconOption<unknown>[]): SimpleColumnIconOption[] {\n  const icons = toSimpleArray(iconProps);\n  if (!icons) {\n    return icons;\n  }\n  return icons.map((icon) => normarize(icon));\n}\nexport const iconPropKeys = ICON_PROP_KEYS;\n\nfunction isIconKey(k: string): k is IconPropKey {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return ICON_PROP_KEYS.indexOf(k as any) >= 0;\n}\n","import * as icons from '../../internal/icons';\nimport type { CellContext, ColumnIconOption, GridCanvasHelperAPI, MaybePromise } from '../../ts-types';\nimport type { SimpleColumnIconOption } from '../../ts-types-internal';\nimport { isPromise } from '../../internal/utils';\n\nexport function loadIcons(\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  icon: MaybePromise<ColumnIconOption<any> | ColumnIconOption<any>[]> | null,\n  context: CellContext,\n  helper: GridCanvasHelperAPI,\n  callback: (icons: SimpleColumnIconOption[] | undefined, context: CellContext) => void\n): void {\n  let argIcon = undefined;\n  if (icon) {\n    if (isPromise(icon)) {\n      icon.then((i) => {\n        loadIcons(i, context.toCurrentContext(), helper, callback);\n      });\n    } else {\n      const iconList = icons.toNormarizeArray(icon);\n      iconList.forEach((i) => {\n        if (i.font && i.content) {\n          helper.testFontLoad(i.font, i.content, context);\n        }\n      });\n      argIcon = iconList;\n    }\n  }\n  callback(argIcon, context);\n}\n","import * as utils from './columnUtils';\nimport type { CellContext, GridCanvasHelperAPI, ListGridAPI } from '../../ts-types';\nimport { BaseColumn } from './BaseColumn';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { Style } from '../style/Style';\n\nexport class Column<T> extends BaseColumn<T, string> {\n  get StyleClass(): typeof Style {\n    return Style;\n  }\n  clone(): Column<T> {\n    return new Column(this);\n  }\n  drawInternal(value: string, context: CellContext, style: Style, helper: GridCanvasHelperAPI, _grid: ListGridAPI<T>, { drawCellBase, getIcon }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, color, font, bgColor, padding, textOverflow } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n    helper.testFontLoad(font, value, context);\n    utils.loadIcons(getIcon(), context, helper, (icons, context) => {\n      helper.text(value, context, {\n        textAlign,\n        textBaseline,\n        color,\n        font,\n        padding,\n        textOverflow,\n        icons\n      });\n    });\n  }\n}\n","import * as utils from './columnUtils';\nimport type { ButtonColumnOption, CellContext, GridCanvasHelperAPI } from '../../ts-types';\nimport type { DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { ButtonStyle } from '../style/ButtonStyle';\nimport { Column } from './Column';\nimport { cellInRange } from '../../internal/utils';\nimport { getButtonColumnStateId } from '../../internal/symbolManager';\n\nconst BUTTON_COLUMN_STATE_ID = getButtonColumnStateId();\n\nexport class ButtonColumn<T> extends Column<T> {\n  private _caption?: string;\n  constructor(option: ButtonColumnOption = {}) {\n    super(option);\n    this._caption = option.caption;\n  }\n  get StyleClass(): typeof ButtonStyle {\n    return ButtonStyle;\n  }\n  get caption(): string | undefined {\n    return this._caption;\n  }\n  withCaption(caption: string): ButtonColumn<T> {\n    const c = this.clone();\n    c._caption = caption;\n    return c;\n  }\n  clone(): ButtonColumn<T> {\n    return new ButtonColumn(this);\n  }\n  convertInternal(value: unknown): string {\n    return this._caption || super.convertInternal(value);\n  }\n  drawInternal(value: string, context: CellContext, style: ButtonStyle, helper: GridCanvasHelperAPI, grid: GridInternal<T>, { drawCellBase, getIcon }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, bgColor, color, buttonBgColor, font, padding, textOverflow } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n    helper.testFontLoad(font, value, context);\n    const { col, row } = context;\n    const range = grid.getCellRange(col, row);\n    let active = false;\n    const state = grid[BUTTON_COLUMN_STATE_ID];\n\n    if (state) {\n      if (state.mouseActiveCell && cellInRange(range, state.mouseActiveCell.col, state.mouseActiveCell.row)) {\n        active = true;\n      } else {\n        const { select } = context.getSelection();\n        if (cellInRange(range, select.col, select.row)) {\n          active = true;\n        }\n      }\n    }\n\n    utils.loadIcons(getIcon(), context, helper, (icons, context) => {\n      helper.button(value, context, {\n        textAlign,\n        textBaseline,\n        bgColor: buttonBgColor,\n        color,\n        font,\n        padding,\n        shadow: active\n          ? {\n            color: 'rgba(0, 0, 0, 0.48)',\n            blur: 6,\n            offsetY: 3\n          }\n          : {},\n        textOverflow,\n        icons\n      });\n    });\n  }\n}\n","export function toBoolean(val: unknown): boolean {\n  if (typeof val === 'string') {\n    if (val === 'false') {\n      return false;\n    } else if (val === 'off') {\n      return false;\n    } else if (/^0+$/.exec(val)) {\n      return false;\n    }\n  }\n  return Boolean(val);\n}\n","import type { CellContext, GridCanvasHelperAPI } from '../../ts-types';\nimport type { DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { BaseColumn } from './BaseColumn';\nimport { CheckStyle } from '../style/CheckStyle';\nimport { getCheckColumnStateId } from '../../internal/symbolManager';\nimport { toBoolean } from '../utils';\n\nconst CHECK_COLUMN_STATE_ID = getCheckColumnStateId();\n\nexport class CheckColumn<T> extends BaseColumn<T, boolean> {\n  get StyleClass(): typeof CheckStyle {\n    return CheckStyle;\n  }\n  clone(): CheckColumn<T> {\n    return new CheckColumn(this);\n  }\n  convertInternal(value: unknown): boolean {\n    return toBoolean(value);\n  }\n  drawInternal(value: boolean, context: CellContext, style: CheckStyle, helper: GridCanvasHelperAPI, grid: GridInternal<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, borderColor, checkBgColor, uncheckBgColor, bgColor } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    const { col, row } = context;\n    const range = grid.getCellRange(col, row);\n    const cellKey = `${range.start.col}:${range.start.row}`;\n    const elapsed = grid[CHECK_COLUMN_STATE_ID]?.elapsed[cellKey];\n\n    const opt: Parameters<GridCanvasHelperAPI['checkbox']>[2] = {\n      textAlign,\n      textBaseline,\n      borderColor,\n      checkBgColor,\n      uncheckBgColor\n    };\n    if (elapsed != null) {\n      opt.animElapsedTime = elapsed;\n    }\n    helper.checkbox(value, context, opt);\n  }\n}\n","import * as icons from '../../internal/icons';\nimport type { CellContext, ColumnIconOption, GridCanvasHelperAPI, IconColumnOption, ListGridAPI } from '../../ts-types';\nimport { Column } from './Column';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { IconStyle } from '../style/IconStyle';\n\nfunction repeatArray(val: ColumnIconOption<unknown>, count: number): ColumnIconOption<unknown>[] {\n  if (count === Infinity) {\n    count = 0;\n  }\n  const a = [];\n  for (let i = 0; i < count; i++) {\n    a.push(val);\n  }\n  return a;\n}\n\nexport class IconColumn<T> extends Column<T> {\n  private _tagName?: string;\n  private _className?: string;\n  private _content?: string;\n  private _name?: string;\n  private _iconWidth?: number;\n  constructor(option: IconColumnOption = {}) {\n    super(option);\n    this._tagName = option.tagName || 'i';\n    this._className = option.className;\n    this._content = option.content;\n    this._name = option.name;\n    this._iconWidth = option.iconWidth;\n  }\n  get StyleClass(): typeof IconStyle {\n    return IconStyle;\n  }\n  clone(): IconColumn<T> {\n    return new IconColumn(this);\n  }\n  drawInternal(value: string, context: CellContext, style: IconStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void {\n    const num = Number(value);\n    if (!isNaN(num)) {\n      const icon: IconColumnOption & { width?: number } = {};\n      icons.iconPropKeys.forEach((k) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (icon as any)[k] = (style as any)[k];\n      });\n      icon.className = this._className;\n      icon.tagName = this._tagName;\n      if (this._content) {\n        icon.content = this._content;\n      }\n      icon.name = this._name;\n      if (this._iconWidth) {\n        icon.width = this._iconWidth;\n      }\n\n      info.getIcon = (): ColumnIconOption<unknown>[] => repeatArray(icon as ColumnIconOption<unknown>, num);\n    } else {\n      info.getIcon = (): null => null;\n    }\n    super.drawInternal('', context, style, helper, grid, info);\n  }\n}\n","import type { RectProps } from '../ts-types';\n\nexport type PaddingOption = {\n  left?: number;\n  right?: number;\n  top?: number;\n  bottom?: number;\n};\n\nconst fontSizeCache: {\n  [key: string]: {\n    width: number;\n    height: number;\n  };\n} = {};\nexport function getFontSize(\n  ctx: CanvasRenderingContext2D,\n  font: string | null | undefined\n): {\n    width: number;\n    height: number;\n  } {\n  const fontName = font || ctx.font;\n  if (fontSizeCache[fontName]) {\n    return fontSizeCache[fontName];\n  }\n  const bk = ctx.font;\n  try {\n    ctx.font = fontName;\n    const em = ctx.measureText('').width;\n    return (fontSizeCache[fontName] = {\n      width: em,\n      height: em\n    });\n  } finally {\n    ctx.font = bk;\n  }\n}\n\nexport function calcBasePosition(\n  ctx: CanvasRenderingContext2D,\n  rect: RectProps,\n  {\n    offset = 0,\n    padding: { left: paddingLeft = 0, right: paddingRight = 0, top: paddingTop = 0, bottom: paddingBottom = 0 } = {}\n  }: {\n    offset?: number;\n    padding?: PaddingOption;\n  } = {}\n): { x: number; y: number } {\n  return calcStartPosition(ctx, rect, 0, 0, {\n    offset,\n    padding: {\n      left: paddingLeft,\n      right: paddingRight,\n      top: paddingTop,\n      bottom: paddingBottom\n    }\n  });\n}\nexport function calcStartPosition(\n  ctx: CanvasRenderingContext2D,\n  rect: RectProps,\n  width: number,\n  height: number,\n  {\n    offset = 0,\n    padding: { left: paddingLeft = 0, right: paddingRight = 0, top: paddingTop = 0, bottom: paddingBottom = 0 } = {}\n  }: {\n    offset?: number;\n    padding?: PaddingOption;\n  } = {}\n): { x: number; y: number } {\n  const textAlign = ctx.textAlign || 'left';\n  const textBaseline = ctx.textBaseline || 'middle';\n  ctx.textAlign = textAlign;\n  ctx.textBaseline = textBaseline;\n\n  let x = rect.left + offset + paddingLeft;\n  if (textAlign === 'right' || textAlign === 'end') {\n    x = rect.right - width - offset - paddingRight;\n  } else if (textAlign === 'center') {\n    x = rect.left + (rect.width - width + paddingLeft - paddingRight) / 2;\n  }\n  let y = rect.top + offset + paddingTop;\n  if (textBaseline === 'bottom' || textBaseline === 'alphabetic' || textBaseline === 'ideographic') {\n    y = rect.bottom - height - offset - paddingBottom;\n  } else if (textBaseline === 'middle') {\n    y = rect.top + (rect.height - height + paddingTop - paddingBottom) / 2;\n  }\n  return { x, y };\n}\n","export class LRUCache<T> {\n  private _list: string[];\n  private _map: { [key: string]: T };\n  private _cacheSize: number;\n  constructor(cacheSize: number) {\n    this._list = [];\n    this._map = {};\n    this._cacheSize = cacheSize || 50;\n  }\n  get(key: string): T {\n    const val = this._map[key];\n    if (val) {\n      const list = this._list;\n      const idx = list.indexOf(key);\n      list.splice(idx, 1);\n      list.push(key);\n    }\n    return val;\n  }\n  put(key: string, value: T): void {\n    const list = this._list;\n    const map = this._map;\n    if (map[key]) {\n      const idx = list.indexOf(key);\n      list.splice(idx, 1);\n    }\n    map[key] = value;\n    list.push(key);\n    if (list.length > this._cacheSize) {\n      const remKey = list.shift() || '';\n      delete map[remKey];\n    }\n  }\n}\n","import { LRUCache } from './LRUCache';\nimport type { MaybePromise } from '../ts-types';\nimport { then } from './utils';\n\nconst allCache: {\n  [key: string]: LRUCache<MaybePromise<HTMLImageElement>>;\n} = {};\n\nexport function loadImage(src: string): Promise<HTMLImageElement> {\n  if (typeof Promise === 'undefined') {\n    console.error('Promise is not loaded. load Promise before this process.');\n    return {\n      then(): Promise<HTMLImageElement> {\n        return this;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    } as any;\n  }\n  const img = new Image();\n  const result = new Promise<HTMLImageElement>((resolve) => {\n    img.onload = (): void => {\n      resolve(img);\n    };\n  });\n  img.onerror = (): void => {\n    const url = src.length > 200 ? `${src.substr(0, 200)}...` : src;\n    console.warn(`cannot load: ${url}`);\n    throw new Error(`IMAGE LOAD ERROR: ${url}`);\n  };\n  img.src = src;\n  return result;\n}\n\nfunction getCacheOrLoad0(cache: LRUCache<MaybePromise<HTMLImageElement>>, src: MaybePromise<string>): MaybePromise<HTMLImageElement> {\n  return then(src, (src) => {\n    const c = cache.get(src);\n    if (c) {\n      return c;\n    }\n    const result = loadImage(src).then((img) => {\n      cache.put(src, img);\n      return img;\n    });\n    cache.put(src, result);\n    return result;\n  });\n}\n\nexport function getCacheOrLoad(cacheName: string, cacheSize: number, src: MaybePromise<string>): MaybePromise<HTMLImageElement> {\n  const cache = allCache[cacheName] || (allCache[cacheName] = new LRUCache<MaybePromise<HTMLImageElement>>(cacheSize));\n  return getCacheOrLoad0(cache, src);\n}\n","import type { CellContext, GridCanvasHelperAPI, ListGridAPI, MaybePromise } from '../../ts-types';\nimport { BaseColumn } from './BaseColumn';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { ImageStyle } from '../style/ImageStyle';\nimport { calcStartPosition } from '../../internal/canvases';\nimport { getCacheOrLoad } from '../../internal/imgs';\n\nconst MAX_LRU_CACHE_SIZE = 50;\nfunction getImage(url: MaybePromise<string>): MaybePromise<HTMLImageElement> {\n  return getCacheOrLoad('ImageColumn', MAX_LRU_CACHE_SIZE, url);\n}\n\nfunction calcKeepAspectRatioSize(\n  width: number,\n  height: number,\n  maxWidth: number,\n  maxHeight: number\n): {\n    width: number;\n    height: number;\n  } {\n  let newWidth = width;\n  let newHeight = height;\n  if (newWidth > maxWidth) {\n    newWidth = maxWidth;\n    newHeight = (newWidth * height) / width;\n  }\n  if (newHeight > maxHeight) {\n    newHeight = maxHeight;\n    newWidth = (newHeight * width) / height;\n  }\n  return {\n    width: newWidth,\n    height: newHeight\n  };\n}\n\nexport class ImageColumn<T> extends BaseColumn<T, HTMLImageElement> {\n  get StyleClass(): typeof ImageStyle {\n    return ImageStyle;\n  }\n  onDrawCell(cellValue: MaybePromise<string>, info: DrawCellInfo<T>, context: CellContext, grid: ListGridAPI<T>): void | Promise<void> {\n    return super.onDrawCell(getImage(cellValue), info, context, grid);\n  }\n  clone(): ImageColumn<T> {\n    return new ImageColumn(this);\n  }\n  drawInternal(value: HTMLImageElement, context: CellContext, style: ImageStyle, helper: GridCanvasHelperAPI, _grid: ListGridAPI<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    if (value) {\n      const { textAlign, textBaseline, margin, bgColor } = style;\n      if (bgColor) {\n        drawCellBase({\n          bgColor\n        });\n      }\n      helper.drawWithClip(context, (ctx) => {\n        ctx.textAlign = textAlign;\n        ctx.textBaseline = textBaseline;\n        const rect = context.getRect();\n        if (style.imageSizing === 'keep-aspect-ratio') {\n          const { width, height } = calcKeepAspectRatioSize(value.width, value.height, rect.width - margin * 2, rect.height - margin * 2);\n          const pos = calcStartPosition(ctx, rect, width, height, {\n            offset: margin\n          });\n          ctx.drawImage(value, 0, 0, value.width, value.height, pos.x, pos.y, width, height);\n        } else {\n          ctx.drawImage(value, 0, 0, value.width, value.height, rect.left + margin, rect.top + margin, rect.width - margin * 2, rect.height - margin * 2);\n        }\n      });\n    }\n  }\n}\n","import type { ColumnMenuItemOption, ColumnMenuItemOptions } from '../ts-types';\n/** @private */\nfunction extend<T, U>(a: T, b: U): T & U {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const o: any = {};\n  for (const k in a) {\n    o[k] = a[k];\n  }\n  for (const k in b) {\n    o[k] = b[k];\n  }\n  return o;\n}\n\n/**\n * Normalize the given menu options.\n * @param {*} options menu options to given\n * @returns {Array} Normalized options\n * @private\n */\nexport function normalize(options: ColumnMenuItemOptions | undefined): ColumnMenuItemOption[] {\n  if (!options) {\n    return [];\n  }\n  if (Array.isArray(options)) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (options as any).map(\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      (e: any): ColumnMenuItemOption => extend(e, { label: e.caption || e.label })\n    );\n  }\n  if (typeof options === 'string') {\n    return normalize(JSON.parse(options));\n  }\n  const result = [];\n  for (const k in options) {\n    result.push({\n      value: k,\n      label: options[k]\n    });\n  }\n  return result;\n}\n\n/**\n * Normalize the given menu options.\n * @param {*} options menu options to given\n * @returns {Array} Normalized options\n * @private\n */\nexport function normalizeToFn<T>(options: ColumnMenuItemOptions | ((record: T | undefined) => ColumnMenuItemOptions) | undefined): (record: T | undefined) => ColumnMenuItemOption[] {\n  if (typeof options === 'function') {\n    return (record: T | undefined): ColumnMenuItemOption[] => normalize(options(record));\n  }\n  return (): ColumnMenuItemOption[] => normalize(options);\n}\n","import * as utils from './columnUtils';\nimport type { CellContext, ColumnMenuItemOptions, GridCanvasHelperAPI, ListGridAPI, MenuColumnOption, SimpleColumnMenuItemOption } from '../../ts-types';\nimport { BaseColumn } from './BaseColumn';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { MenuStyle } from '../style/MenuStyle';\nimport { normalize } from '../../internal/menu-items';\n\nexport class MenuColumn<T> extends BaseColumn<T, unknown> {\n  private _options: SimpleColumnMenuItemOption[];\n  constructor(option: MenuColumnOption = {}) {\n    super(option);\n    this._options = normalize(option.options);\n  }\n  get StyleClass(): typeof MenuStyle {\n    return MenuStyle;\n  }\n  clone(): MenuColumn<T> {\n    return new MenuColumn(this);\n  }\n  get options(): SimpleColumnMenuItemOption[] {\n    return this._options;\n  }\n  withOptions(options: ColumnMenuItemOptions): MenuColumn<T> {\n    const c = this.clone();\n    c._options = normalize(options);\n    return c;\n  }\n  drawInternal(value: string, context: CellContext, style: MenuStyle, helper: GridCanvasHelperAPI, _grid: ListGridAPI<T>, { drawCellBase, getIcon }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, font, bgColor, padding, textOverflow, appearance } = style;\n    let { color } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n    const text = this._convertInternal(value);\n    helper.testFontLoad(font, text, context);\n    utils.loadIcons(getIcon(), context, helper, (icons, context) => {\n      const basePadding = helper.toBoxPixelArray(padding || 0, context, font);\n      const textPadding = basePadding.slice(0);\n      textPadding[1] += 26; // icon padding\n      const iconPadding = basePadding.slice(0);\n      iconPadding[1] += 8;\n      if (color == null && (value == null || value === '')) {\n        color = 'rgba(0, 0, 0, .38)';\n      }\n      helper.text(text, context, {\n        textAlign,\n        textBaseline,\n        color,\n        font,\n        padding: textPadding,\n        textOverflow,\n        icons\n      });\n\n      if (appearance === 'menulist-button') {\n        // draw dropdown arrow icon\n        helper.text('', context, {\n          textAlign: 'right',\n          textBaseline,\n          color,\n          font,\n          icons: [\n            {\n              path: 'M0 2 5 7 10 2z',\n              width: 10,\n              color: 'rgba(0, 0, 0, .54)'\n            }\n          ],\n          padding: iconPadding\n        });\n      } else if (appearance !== 'none') {\n        // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n        console.warn(`unsupported appearance:${appearance}`);\n      }\n    });\n  }\n  convertInternal(value: unknown): unknown {\n    return value;\n  }\n  _convertInternal(value: unknown): string {\n    const options = this._options;\n    for (let i = 0; i < options.length; i++) {\n      const option = options[i];\n      if (option.value === value) {\n        value = option.label;\n        break;\n      }\n    }\n    return super.convertInternal(value) as string;\n  }\n  getCopyCellValue(value: unknown): string {\n    return this._convertInternal(value);\n  }\n}\n","import * as utils from './columnUtils';\nimport type { CellContext, GridCanvasHelperAPI, ListGridAPI } from '../../ts-types';\nimport { BaseColumn } from './BaseColumn';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { MultilineTextStyle } from '../style/MultilineTextStyle';\n\nexport class MultilineTextColumn<T> extends BaseColumn<T, string> {\n  constructor(option = {}) {\n    super(option);\n  }\n  get StyleClass(): typeof MultilineTextStyle {\n    return MultilineTextStyle;\n  }\n  clone(): MultilineTextColumn<T> {\n    return new MultilineTextColumn(this);\n  }\n  drawInternal(value: string, context: CellContext, style: MultilineTextStyle, helper: GridCanvasHelperAPI, _grid: ListGridAPI<T>, { drawCellBase, getIcon }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, color, font, bgColor, padding, lineHeight, autoWrapText, lineClamp, textOverflow } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n    const multilines = value.replace(/\\r?\\n/g, '\\n').replace(/\\r/g, '\\n').split('\\n');\n    helper.testFontLoad(font, value, context);\n    utils.loadIcons(getIcon(), context, helper, (icons, context) => {\n      helper.multilineText(multilines, context, {\n        textAlign,\n        textBaseline,\n        color,\n        font,\n        padding,\n        lineHeight,\n        autoWrapText,\n        lineClamp,\n        textOverflow,\n        icons\n      });\n    });\n  }\n}\n","import { Column } from './Column';\nimport type { NumberColumnOption } from '../../ts-types';\nimport { NumberStyle } from '../style/NumberStyle';\nlet defaultFotmat: Intl.NumberFormat;\nexport class NumberColumn<T> extends Column<T> {\n  private _format?: Intl.NumberFormat;\n  static get defaultFotmat(): Intl.NumberFormat {\n    return defaultFotmat || (defaultFotmat = new Intl.NumberFormat());\n  }\n  static set defaultFotmat(fmt: Intl.NumberFormat) {\n    defaultFotmat = fmt;\n  }\n  constructor(option: NumberColumnOption = {}) {\n    super(option);\n    this._format = option.format;\n  }\n  get StyleClass(): typeof NumberStyle {\n    return NumberStyle;\n  }\n  clone(): NumberColumn<T> {\n    return new NumberColumn(this);\n  }\n  get format(): Intl.NumberFormat | undefined {\n    return this._format;\n  }\n  withFormat(format: Intl.NumberFormat): NumberColumn<T> {\n    const c = this.clone();\n    c._format = format;\n    return c;\n  }\n  convertInternal(value: undefined): string {\n    const num = Number(value);\n    if (isNaN(num)) {\n      return super.convertInternal(value);\n    }\n    const format = this._format || NumberColumn.defaultFotmat;\n    return format.format(num);\n  }\n}\n","import type { CellContext, GridCanvasHelperAPI, ListGridAPI, PercentCompleteBarColumnOption } from '../../ts-types';\nimport { getOrApply, str } from '../../internal/utils';\nimport { Column } from './Column';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { PercentCompleteBarStyle } from '../style/PercentCompleteBarStyle';\n\nconst MARGIN = 2;\n\nexport class PercentCompleteBarColumn<T> extends Column<T> {\n  private _min: number;\n  private _max: number;\n  private _formatter: (value: string) => string;\n  constructor(option: PercentCompleteBarColumnOption = {}) {\n    super(option);\n    this._min = option.min || 0;\n    this._max = option.max || this._min + 100;\n    this._formatter = option.formatter || ((v: string): string => v);\n  }\n  get StyleClass(): typeof PercentCompleteBarStyle {\n    return PercentCompleteBarStyle;\n  }\n  clone(): PercentCompleteBarColumn<T> {\n    return new PercentCompleteBarColumn(this);\n  }\n  drawInternal(value: string, context: CellContext, style: PercentCompleteBarStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void {\n    super.drawInternal(this._formatter(value), context, style, helper, grid, info);\n    const { barColor, barBgColor, barHeight } = style;\n\n    let svalue = `${value}`;\n    if (str.endsWith(svalue, '%')) {\n      svalue = svalue.substr(0, svalue.length - 1);\n    }\n    const num = Number(svalue);\n    if (isNaN(num)) {\n      return;\n    }\n    const rate = num < this._min ? 0 : num > this._max ? 1 : (num - this._min) / (this._max - this._min);\n\n    helper.drawWithClip(context, (ctx) => {\n      const rect = context.getRect();\n\n      const barMaxWidth = rect.width - MARGIN * 2 - 1; /**/\n      const barTop = rect.bottom - MARGIN - barHeight - 1; /**/\n      const barLeft = rect.left + MARGIN;\n      ctx.fillStyle = getOrApply(barBgColor, rate * 100) || '#f0f3f5';\n      ctx.beginPath();\n      ctx.rect(barLeft, barTop, barMaxWidth, barHeight);\n      ctx.fill();\n\n      const barSize = Math.min(barMaxWidth * rate, barMaxWidth);\n      ctx.fillStyle = getOrApply(barColor, rate * 100) || '#20a8d8';\n      ctx.beginPath();\n      ctx.rect(barLeft, barTop, barSize, barHeight);\n      ctx.fill();\n    });\n  }\n}\n","import type { CellContext, GridCanvasHelperAPI } from '../../ts-types';\nimport type { DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { BaseColumn } from './BaseColumn';\nimport { RadioStyle } from '../style/RadioStyle';\nimport { getRadioColumnStateId } from '../../internal/symbolManager';\nimport { toBoolean } from '../utils';\n\nconst RADIO_COLUMN_STATE_ID = getRadioColumnStateId();\n\nexport class RadioColumn<T> extends BaseColumn<T, boolean> {\n  get StyleClass(): typeof RadioStyle {\n    return RadioStyle;\n  }\n  clone(): RadioColumn<T> {\n    return new RadioColumn(this);\n  }\n  convertInternal(value: unknown): boolean {\n    return toBoolean(value);\n  }\n  drawInternal(value: boolean, context: CellContext, style: RadioStyle, helper: GridCanvasHelperAPI, grid: GridInternal<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, checkColor, uncheckBorderColor, checkBorderColor, uncheckBgColor, checkBgColor, bgColor } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    const { col, row } = context;\n    const range = grid.getCellRange(col, row);\n    const cellKey = `${range.start.col}:${range.start.row}`;\n    const elapsed = grid[RADIO_COLUMN_STATE_ID]?.elapsed[cellKey];\n\n    const opt: Parameters<GridCanvasHelperAPI['radioButton']>[2] = {\n      textAlign,\n      textBaseline,\n      checkColor,\n      uncheckBorderColor,\n      checkBorderColor,\n      uncheckBgColor,\n      checkBgColor\n    };\n    if (elapsed != null) {\n      opt.animElapsedTime = elapsed;\n    }\n    helper.radioButton(value, context, opt);\n  }\n}\n","import type {\n  BaseColumnOption,\n  BranchGraphColumnOption,\n  ButtonColumnOption,\n  ColumnTypeOption,\n  IconColumnOption,\n  MenuColumnOption,\n  NumberColumnOption,\n  PercentCompleteBarColumnOption\n} from '../ts-types';\nimport type { BaseColumn } from './type/BaseColumn';\nimport { BranchGraphColumn } from './type/BranchGraphColumn';\nimport { ButtonColumn } from './type/ButtonColumn';\nimport { CheckColumn } from './type/CheckColumn';\nimport { Column } from './type/Column';\nimport { IconColumn } from './type/IconColumn';\nimport { ImageColumn } from './type/ImageColumn';\nimport { MenuColumn } from './type/MenuColumn';\nimport { MultilineTextColumn } from './type/MultilineTextColumn';\nimport { NumberColumn } from './type/NumberColumn';\nimport { PercentCompleteBarColumn } from './type/PercentCompleteBarColumn';\nimport { RadioColumn } from './type/RadioColumn';\n\nconst TYPES = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  DEFAULT: new Column<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  NUMBER: new NumberColumn<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  CHECK: new CheckColumn<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  RADIO: new RadioColumn<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  BUTTON: new ButtonColumn<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  IMAGE: new ImageColumn<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  MULTILINETEXT: new MultilineTextColumn<any>()\n};\n\n/**\n * column types\n * @namespace cheetahGrid.columns.type\n * @memberof cheetahGrid.columns\n */\nexport {\n  Column,\n  NumberColumn,\n  CheckColumn,\n  RadioColumn,\n  ButtonColumn,\n  ImageColumn,\n  PercentCompleteBarColumn,\n  IconColumn,\n  BranchGraphColumn,\n  MenuColumn,\n  MultilineTextColumn,\n  // types\n  BaseColumnOption,\n  BranchGraphColumnOption,\n  ButtonColumnOption,\n  IconColumnOption,\n  MenuColumnOption,\n  NumberColumnOption,\n  PercentCompleteBarColumnOption\n};\nexport function of<T>(\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  columnType: ColumnTypeOption | BaseColumn<T, any> | null | undefined\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n): BaseColumn<T, any> {\n  if (!columnType) {\n    return TYPES.DEFAULT;\n  } else if (typeof columnType === 'string') {\n    const key = columnType.toUpperCase() as keyof typeof TYPES;\n    return TYPES[key] || of(null);\n  } else {\n    return columnType;\n  }\n}\n","import type { CellAddress, ColumnMenuItemOption, ColumnTypeAPI, EventListenerId, InlineMenuEditorOption, LayoutObjectId, ListGridAPI, SimpleColumnMenuItemOption } from '../../ts-types';\nimport type { GridInternal, InputEditorState } from '../../ts-types-internal';\nimport { array, cellEquals, event, isPromise, obj, then } from '../../internal/utils';\nimport { isDisabledRecord, isReadOnlyRecord } from './action-utils';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\nimport { Editor } from './Editor';\nimport { InlineMenuElement } from './internal/InlineMenuElement';\nimport { MenuColumn } from '../type';\nimport { getInlineMenuEditorStateId } from '../../internal/symbolManager';\nimport { normalizeToFn } from '../../internal/menu-items';\nconst _ = getInlineMenuEditorStateId();\n\nfunction getState<T>(grid: GridInternal<T>): InputEditorState {\n  let state = grid[_];\n  if (!state) {\n    state = {};\n    obj.setReadonly(grid, _, state);\n  }\n  return state;\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet globalElement: InlineMenuElement<any> | null = null;\nlet bindGridCount = 0;\nfunction attachMenu<T>(grid: ListGridAPI<T>, cell: CellAddress, editor: InlineMenuEditor<T>, value: string, record: T | undefined): void {\n  const state = getState(grid);\n  if (!globalElement) {\n    globalElement = new InlineMenuElement();\n  }\n  if (!state.element) {\n    state.element = globalElement;\n    bindGridCount++;\n    grid.addDisposable({\n      dispose() {\n        bindGridCount--;\n        if (!bindGridCount) {\n          globalElement?.dispose();\n          globalElement = null;\n          state.element = null;\n        }\n      }\n    });\n  }\n\n  globalElement.attach(grid, editor, cell.col, cell.row, value, record);\n}\nfunction detachMenu(gridFocus?: boolean): void {\n  if (globalElement) {\n    globalElement.detach(gridFocus);\n  }\n}\n\nconst KEY_ENTER = 13;\nconst KEY_F2 = 113;\n\nexport class InlineMenuEditor<T> extends Editor<T> {\n  private _classList?: string | string[];\n  private _options: (record: T | undefined) => ColumnMenuItemOption[];\n  constructor(option: InlineMenuEditorOption<T> = {}) {\n    super(option);\n    this._classList = option.classList;\n    this._options = normalizeToFn(option.options);\n  }\n  dispose(): void {\n    // noop\n  }\n  get classList(): string[] | undefined {\n    if (!this._classList) {\n      return undefined;\n    }\n    return Array.isArray(this._classList) ? this._classList : [this._classList];\n  }\n  set classList(classList: string[] | undefined) {\n    this._classList = classList;\n  }\n  get options(): (record: T | undefined) => ColumnMenuItemOption[] {\n    return this._options;\n  }\n  set options(options: (record: T | undefined) => ColumnMenuItemOption[]) {\n    this._options = normalizeToFn(options);\n  }\n  clone(): InlineMenuEditor<T> {\n    return new InlineMenuEditor(this);\n  }\n  onChangeDisabledInternal(): void {\n    // cancel input\n    detachMenu(true);\n  }\n  onChangeReadOnlyInternal(): void {\n    // cancel input\n    detachMenu(true);\n  }\n  bindGridEvent(grid: ListGridAPI<T>, cellId: LayoutObjectId): EventListenerId[] {\n    const open = (cell: CellAddress): boolean => {\n      if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n        return false;\n      }\n      grid.doGetCellValue(cell.col, cell.row, (value) => {\n        const record = grid.getRowRecord(cell.row);\n        if (isPromise(record)) {\n          return;\n        }\n        attachMenu(grid, cell, this, value, record);\n      });\n      return true;\n    };\n\n    function isTarget(col: number, row: number): boolean {\n      return grid.getLayoutCellId(col, row) === cellId;\n    }\n    return [\n      grid.listen(DG_EVENT_TYPE.CLICK_CELL, (cell) => {\n        if (!isTarget(cell.col, cell.row)) {\n          return;\n        }\n        open({\n          col: cell.col,\n          row: cell.row\n        });\n      }),\n      grid.listen(DG_EVENT_TYPE.KEYDOWN, (e) => {\n        if (e.keyCode !== KEY_F2 && e.keyCode !== KEY_ENTER) {\n          return;\n        }\n        const sel = grid.selection.select;\n        if (!isTarget(sel.col, sel.row)) {\n          return;\n        }\n\n        if (\n          open({\n            col: sel.col,\n            row: sel.row\n          })\n        ) {\n          e.stopCellMoving();\n        }\n      }),\n      grid.listen(DG_EVENT_TYPE.SELECTED_CELL, (_e) => {\n        detachMenu();\n      }),\n      grid.listen(DG_EVENT_TYPE.SCROLL, () => {\n        detachMenu(true);\n      }),\n\n      // mouse move\n      grid.listen(DG_EVENT_TYPE.MOUSEOVER_CELL, (e) => {\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        if (isReadOnlyRecord(this.readOnly, grid, e.row) || isDisabledRecord(this.disabled, grid, e.row)) {\n          return;\n        }\n        grid.getElement().style.cursor = 'pointer';\n      }),\n      grid.listen(DG_EVENT_TYPE.MOUSEMOVE_CELL, (e) => {\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        if (isReadOnlyRecord(this.readOnly, grid, e.row) || isDisabledRecord(this.disabled, grid, e.row)) {\n          return;\n        }\n        if (!grid.getElement().style.cursor) {\n          grid.getElement().style.cursor = 'pointer';\n        }\n      }),\n      grid.listen(DG_EVENT_TYPE.MOUSEOUT_CELL, (e) => {\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        grid.getElement().style.cursor = '';\n      }),\n\n      // paste value\n      grid.listen(DG_EVENT_TYPE.PASTE_CELL, (e) => {\n        if (e.multi) {\n          // ignore multi cell values\n          return;\n        }\n        const selectionRange = grid.selection.range;\n        if (!cellEquals(selectionRange.start, selectionRange.end)) {\n          // ignore multi paste values\n          return;\n        }\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n        if (isReadOnlyRecord(this.readOnly, grid, e.row) || isDisabledRecord(this.disabled, grid, e.row)) {\n          return;\n        }\n        const record = grid.getRowRecord(e.row);\n        if (isPromise(record)) {\n          return;\n        }\n        const pasteOpt = this._pasteDataToOptionValue(e.normalizeValue, grid, e, record);\n        if (pasteOpt) {\n          event.cancel(e.event);\n          then(\n            grid.doChangeValue(e.col, e.row, () => pasteOpt.value),\n            () => {\n              const range = grid.getCellRange(e.col, e.row);\n              grid.invalidateCellRange(range);\n            }\n          );\n        }\n      })\n    ];\n  }\n  onPasteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress, value: string): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    const record = grid.getRowRecord(cell.row);\n    if (isPromise(record)) {\n      return;\n    }\n    const pasteOpt = this._pasteDataToOptionValue(value, grid, cell, record);\n    if (pasteOpt) {\n      grid.doChangeValue(cell.col, cell.row, () => pasteOpt.value);\n    }\n  }\n  onDeleteCellRangeBox(grid: ListGridAPI<T>, cell: CellAddress): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    const record = grid.getRowRecord(cell.row);\n    if (isPromise(record)) {\n      return;\n    }\n    const pasteOpt = this._pasteDataToOptionValue('', grid, cell, record);\n    if (pasteOpt) {\n      grid.doChangeValue(cell.col, cell.row, () => pasteOpt.value);\n    }\n  }\n  private _pasteDataToOptionValue(value: string, grid: ListGridAPI<T>, cell: CellAddress, record: T | undefined): SimpleColumnMenuItemOption | undefined {\n    const options = this._options(record);\n    const pasteOpt = _textToOptionValue(value, options);\n    if (pasteOpt) {\n      return pasteOpt;\n    }\n    const columnType = grid.getColumnType(cell.col, cell.row);\n    if (hasOptions(columnType)) {\n      // Find with caption.\n      const pasteValue = normalizePasteValueStr(value);\n      const captionOpt = array.find(columnType.options, (opt) => normalizePasteValueStr(opt.label) === pasteValue);\n      if (captionOpt) {\n        return _textToOptionValue(captionOpt.value, options);\n      }\n    }\n    return undefined;\n  }\n}\nfunction _textToOptionValue(value: string, options: SimpleColumnMenuItemOption[]): SimpleColumnMenuItemOption | undefined {\n  const pasteValue = normalizePasteValueStr(value);\n  const pasteOpt = array.find(options, (opt) => normalizePasteValueStr(opt.value) === pasteValue);\n  if (pasteOpt) {\n    return pasteOpt;\n  }\n  return undefined;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction normalizePasteValueStr(value: any): string {\n  if (value == null) {\n    return '';\n  }\n  return `${value}`.trim();\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction hasOptions(columnType: ColumnTypeAPI): columnType is MenuColumn<any> {\n  if (columnType instanceof MenuColumn) {\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  if (Array.isArray((columnType as any).options)) {\n    return true;\n  }\n\n  return false;\n}\n","import type { ActionListener, CellAddress, EventListenerId, GetRadioEditorGroup, LayoutObjectId, RadioEditorOption } from '../../ts-types';\nimport { bindCellClickAction, bindCellKeyAction } from './actionBind';\nimport { cellEquals, event, extend, isPromise, obj, then } from '../../internal/utils';\nimport { isDisabledRecord, isReadOnlyRecord, toggleValue } from './action-utils';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\nimport { Editor } from './Editor';\nimport type { GridInternal } from '../../ts-types-internal';\nimport { animate } from '../../internal/animate';\nimport { getRadioColumnStateId } from '../../internal/symbolManager';\nimport { toBoolean } from '../utils';\n\nconst RADIO_COLUMN_STATE_ID = getRadioColumnStateId();\n\nexport class RadioEditor<T> extends Editor<T> {\n  protected _group: GetRadioEditorGroup<T> | undefined;\n  private _checkAction: ActionListener | undefined;\n  constructor(option: RadioEditorOption<T> = {}) {\n    super(option);\n    this._group = option.group;\n    this._checkAction = option.checkAction;\n  }\n  clone(): RadioEditor<T> {\n    return new RadioEditor(this);\n  }\n  /** @deprecated Use checkAction instead. */\n  get group(): GetRadioEditorGroup<T> | undefined {\n    return this._group;\n  }\n  /** @deprecated Use checkAction instead. */\n  set group(group: GetRadioEditorGroup<T> | undefined) {\n    this._group = group;\n  }\n  get checkAction(): ActionListener | undefined {\n    return this._checkAction;\n  }\n  set checkAction(checkAction: ActionListener | undefined) {\n    this._checkAction = checkAction;\n  }\n  bindGridEvent(grid: GridInternal<T>, cellId: LayoutObjectId): EventListenerId[] {\n    let _state = grid[RADIO_COLUMN_STATE_ID];\n    if (!_state) {\n      _state = { block: {}, elapsed: {} };\n      obj.setReadonly(grid, RADIO_COLUMN_STATE_ID, _state);\n    }\n    const state = _state;\n\n    const action = (cell: CellAddress): void => {\n      this._action(grid, cell);\n    };\n\n    function isTarget(col: number, row: number): boolean {\n      return grid.getLayoutCellId(col, row) === cellId;\n    }\n    return [\n      ...bindCellClickAction(grid, cellId, {\n        action,\n        mouseOver: (e) => {\n          if (isDisabledRecord(this.disabled, grid, e.row)) {\n            return false;\n          }\n          state.mouseActiveCell = {\n            col: e.col,\n            row: e.row\n          };\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n          return true;\n        },\n        mouseOut: (e) => {\n          delete state.mouseActiveCell;\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n        }\n      }),\n      ...bindCellKeyAction(grid, cellId, {\n        action\n      }),\n\n      // paste value\n      grid.listen(DG_EVENT_TYPE.PASTE_CELL, (e) => {\n        if (e.multi) {\n          // ignore multi cell values\n          return;\n        }\n        const selectionRange = grid.selection.range;\n        if (!cellEquals(selectionRange.start, selectionRange.end)) {\n          // ignore multi paste values\n          return;\n        }\n        if (!isTarget(e.col, e.row)) {\n          return;\n        }\n\n        const pasteValue = e.normalizeValue.trim();\n        if (!toBoolean(pasteValue)) {\n          return;\n        }\n        event.cancel(e.event);\n\n        action({\n          col: e.col,\n          row: e.row\n        });\n      })\n    ];\n  }\n  onPasteCellRangeBox(grid: GridInternal<T>, cell: CellAddress, value: string): void {\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row)) {\n      return;\n    }\n    const pasteValue = value.trim();\n    if (!toBoolean(pasteValue)) {\n      return;\n    }\n    this._action(grid, {\n      col: cell.col,\n      row: cell.row\n    });\n  }\n  onDeleteCellRangeBox(): void {\n    // noop\n  }\n  private _action(grid: GridInternal<T>, cell: CellAddress): void {\n    const state = grid[RADIO_COLUMN_STATE_ID]!;\n    const range = grid.getCellRange(cell.col, cell.row);\n    const cellKey = `${range.start.col}:${range.start.row}`;\n\n    if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row) || state.block[cellKey]) {\n      return;\n    }\n\n    grid.doGetCellValue(cell.col, cell.row, (value) => {\n      if (toBoolean(value)) {\n        return;\n      }\n      if (this._checkAction) {\n        // User behavior\n        const record = grid.getRowRecord(cell.row);\n        this._checkAction(record, extend(cell, { grid }));\n        return;\n      }\n      if (this._group) {\n        // Backward compatibility\n        const state = grid[RADIO_COLUMN_STATE_ID]!;\n\n        const targets = this._group({ grid, col: cell.col, row: cell.row });\n        targets.forEach(({ col, row }) => {\n          const range = grid.getCellRange(col, row);\n          const cellKey = `${range.start.col}:${range.start.row}`;\n\n          if (isReadOnlyRecord(this.readOnly, grid, cell.row) || isDisabledRecord(this.disabled, grid, cell.row) || state.block[cellKey]) {\n            return;\n          }\n\n          actionCell(grid, col, row, col === cell.col && row === cell.row);\n        });\n        return;\n      }\n\n      // default behavior\n      const field = grid.getField(cell.col, cell.row)!;\n      const recordStartRow = grid.getRecordStartRowByRecordIndex(grid.getRecordIndexByRow(cell.row));\n\n      /** Original DataSource */\n      const { dataSource } = grid.dataSource;\n\n      const girdRecords = getAllRecordsFromGrid(grid);\n\n      for (let index = 0; index < dataSource.length; index++) {\n        const record = dataSource.get(index);\n        const showData = girdRecords.find((d) => d.record === record);\n        if (showData) {\n          actionCell(grid, cell.col, showData.row, showData.row === recordStartRow);\n        } else {\n          // Hidden record\n          then(dataSource.getField(index, field), (value) => {\n            if (!toBoolean(value)) {\n              return;\n            }\n            dataSource.setField(index, field, toggleValue(value));\n          });\n        }\n      }\n    });\n  }\n}\n\nfunction getAllRecordsFromGrid<T>(grid: GridInternal<T>) {\n  const result = [];\n  const { rowCount, recordRowCount } = grid;\n  for (let targetRow = grid.frozenRowCount; targetRow < rowCount; targetRow += recordRowCount) {\n    const record = grid.getRowRecord(targetRow);\n    result.push({ row: targetRow, record });\n  }\n  return result;\n}\n\nfunction actionCell<T>(grid: GridInternal<T>, col: number, row: number, flag: boolean): void {\n  grid.doGetCellValue(col, row, (value) => {\n    if (toBoolean(value) === flag) {\n      return;\n    }\n\n    const state = grid[RADIO_COLUMN_STATE_ID]!;\n    const range = grid.getCellRange(col, row);\n    const cellKey = `${range.start.col}:${range.start.row}`;\n    const ret = grid.doChangeValue(col, row, toggleValue);\n    if (ret) {\n      const onChange = (): void => {\n        // checkbox animation\n        animate(200, (point) => {\n          if (point === 1) {\n            delete state.elapsed[cellKey];\n          } else {\n            state.elapsed[cellKey] = point;\n          }\n          grid.invalidateCellRange(range);\n        });\n      };\n      if (isPromise(ret)) {\n        state.block[cellKey] = true;\n        ret.then(() => {\n          delete state.block[cellKey];\n          onChange();\n        });\n      } else {\n        onChange();\n      }\n    }\n  });\n}\n","import type { ListGridAPI, MaybePromise } from '../../../ts-types';\nimport { browser, event, then } from '../../../internal/utils';\nimport { EventHandler } from '../../../internal/EventHandler';\nimport { createElement } from '../../../internal/dom';\nimport { setInputValue } from './input-value-handler';\n\nconst CLASSNAME = 'cheetah-grid__small-dialog-input';\nconst INPUT_CLASSNAME = `${CLASSNAME}__input`;\nconst HIDDEN_CLASSNAME = `${CLASSNAME}--hidden`;\nconst SHOWN_CLASSNAME = `${CLASSNAME}--shown`;\n\nconst KEY_ENTER = 13;\nconst KEY_ESC = 27;\n\nfunction _focus(input: HTMLInputElement, handler: EventHandler): void {\n  const focus = (): void => {\n    input.focus();\n\n    const end = input.value.length;\n    try {\n      if (typeof input.selectionStart !== 'undefined') {\n        input.selectionStart = end;\n        input.selectionEnd = end;\n        return;\n      }\n    } catch (e) {\n      //ignore\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    if ((document as any).selection) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const range = (input as any).createTextRange();\n      range.collapse();\n      range.moveEnd('character', end);\n      range.moveStart('character', end);\n      range.select();\n    }\n  };\n  handler.tryWithOffEvents(input, 'blur', () => {\n    focus();\n  });\n}\n\nimport './SmallDialogInputElement.css';\n\nfunction createDialogElement(): HTMLDivElement {\n  // require('@/columns/action/internal/SmallDialogInputElement.css')\n  const element = createElement('div', {\n    classList: [CLASSNAME, HIDDEN_CLASSNAME]\n  });\n  const input = createElement('input', { classList: INPUT_CLASSNAME });\n  input.readOnly = true;\n  input.tabIndex = -1;\n  element.appendChild(input);\n  return element;\n}\n\ntype GetValueResult<T, R> = (value: string, info: { grid: ListGridAPI<T>; col: number; row: number }) => R;\n\ntype EditorProps<T> = {\n  type?: string;\n  classList?: string[];\n  helperText?: string | GetValueResult<T, string>;\n  inputValidator?: GetValueResult<T, MaybePromise<string>>;\n  validator?: GetValueResult<T, MaybePromise<string>>;\n};\n\ntype ActiveData<T> = {\n  grid: ListGridAPI<T>;\n  col: number;\n  row: number;\n  editor: EditorProps<T>;\n};\n\nfunction bindProps<T>(grid: ListGridAPI<T>, dialog: HTMLDivElement, input: HTMLInputElement, editor: EditorProps<T>): void {\n  const { classList, helperText } = editor;\n  if (classList) {\n    dialog.classList.add(...classList);\n  }\n  if (helperText && typeof helperText !== 'function') {\n    dialog.dataset.helperText = helperText;\n  }\n  setInputAttrs(editor, grid, input);\n}\n\nfunction unbindProps<T>(_grid: ListGridAPI<T>, dialog: HTMLDivElement, input: HTMLInputElement, editor: EditorProps<T>): void {\n  const { classList } = editor;\n  if (classList) {\n    dialog.classList.remove(...classList);\n  }\n  delete dialog.dataset.helperText;\n  input.type = '';\n}\n\nfunction setInputAttrs<T>(editor: EditorProps<T>, _grid: ListGridAPI<T>, input: HTMLInputElement): void {\n  const { type } = editor;\n  input.type = type || '';\n}\n\nexport class SmallDialogInputElement<T> {\n  private _handler: EventHandler;\n  private _dialog: HTMLDivElement;\n  private _input: HTMLInputElement;\n  private _beforePropEditor?: EditorProps<T> | null;\n  private _activeData?: ActiveData<T> | null;\n  private _attaching?: boolean;\n  private _beforeValue?: string | null;\n\n  static setInputAttrs<T>(editor: EditorProps<T>, grid: ListGridAPI<T>, input: HTMLInputElement): void {\n    setInputAttrs(editor, grid, input);\n  }\n\n  constructor() {\n    this._handler = new EventHandler();\n    this._dialog = createDialogElement();\n    this._input = this._dialog.querySelector(`.${INPUT_CLASSNAME}`) as HTMLInputElement;\n    this._bindDialogEvents();\n  }\n\n  dispose(): void {\n    const dialog = this._dialog;\n    this.detach();\n    this._handler.dispose();\n    // @ts-expect-error -- ignore\n    delete this._dialog;\n    // @ts-expect-error -- ignore\n    delete this._input;\n    this._beforePropEditor = null;\n    if (dialog.parentElement) {\n      dialog.parentElement.removeChild(dialog);\n    }\n  }\n\n  attach(grid: ListGridAPI<T>, editor: EditorProps<T>, col: number, row: number, value: string): void {\n    const handler = this._handler;\n    const dialog = this._dialog;\n    const input = this._input;\n\n    if (this._beforePropEditor) {\n      unbindProps(grid, dialog, input, this._beforePropEditor);\n    }\n\n    delete dialog.dataset.errorMessage;\n    dialog.classList.remove(SHOWN_CLASSNAME);\n    dialog.classList.add(HIDDEN_CLASSNAME);\n    input.readOnly = true;\n    input.tabIndex = 0;\n    const { element, rect } = grid.getAttachCellsArea(grid.getCellRange(col, row));\n    dialog.style.top = `${rect.top.toFixed()}px`;\n    dialog.style.left = `${rect.left.toFixed()}px`;\n    dialog.style.width = `${rect.width.toFixed()}px`;\n    input.style.height = `${rect.height.toFixed()}px`;\n    element.appendChild(dialog);\n\n    setInputValue(input, value);\n\n    input.style.font = grid.font || '16px sans-serif';\n    const activeData = { grid, col, row, editor };\n    this._onInputValue(input, activeData);\n    if (!browser.IE) {\n      _focus(input, handler);\n    } else {\n      // On the paste-event on IE, since it may not be focused, it will be delayed and focused.\n      setTimeout(() => _focus(input, handler));\n    }\n    dialog.classList.add(SHOWN_CLASSNAME);\n    dialog.classList.remove(HIDDEN_CLASSNAME);\n    input.readOnly = false;\n\n    bindProps(grid, dialog, input, editor);\n\n    this._activeData = activeData;\n    this._beforePropEditor = editor;\n\n    this._attaching = true;\n    setTimeout(() => {\n      delete this._attaching;\n    });\n  }\n\n  detach(gridFocus?: boolean): void {\n    if (this._isActive()) {\n      const dialog = this._dialog;\n      const input = this._input;\n\n      dialog.classList.remove(SHOWN_CLASSNAME);\n      dialog.classList.add(HIDDEN_CLASSNAME);\n      input.readOnly = true;\n      input.tabIndex = -1;\n\n      const { grid, col, row } = this._activeData!;\n\n      const range = grid.getCellRange(col, row);\n      grid.invalidateCellRange(range);\n      if (gridFocus) {\n        grid.focus();\n      }\n    }\n    this._activeData = null;\n    this._beforeValue = null;\n  }\n\n  _doChangeValue(): MaybePromise<boolean> {\n    if (!this._isActive()) {\n      return false;\n    }\n    const input = this._input;\n    const { value } = input;\n    return then(this._validate(value), (res) => {\n      if (res && value === input.value) {\n        const { grid, col, row } = this._activeData!;\n        grid.doChangeValue(col, row, () => value);\n        return true;\n      }\n      return false;\n    });\n  }\n\n  _isActive(): boolean {\n    const dialog = this._dialog;\n    if (!dialog || !dialog.parentElement) {\n      return false;\n    }\n    if (!this._activeData) {\n      return false;\n    }\n    return true;\n  }\n\n  _bindDialogEvents(): void {\n    const handler = this._handler;\n    const dialog = this._dialog;\n    const input = this._input;\n    const stopPropagationOnly = (e: Event): void => e.stopPropagation(); // grid\n    handler.on(dialog, 'click', stopPropagationOnly);\n    handler.on(dialog, 'dblclick', stopPropagationOnly);\n    handler.on(dialog, 'mousedown', stopPropagationOnly);\n    handler.on(dialog, 'touchstart', stopPropagationOnly);\n\n    handler.on(input, 'compositionstart', (_e) => {\n      input.classList.add('composition');\n    });\n    handler.on(input, 'compositionend', (_e) => {\n      input.classList.remove('composition');\n      this._onInputValue(input);\n    });\n    const onKeyupAndPress = (_e: KeyboardEvent): void => {\n      if (input.classList.contains('composition')) {\n        return;\n      }\n      this._onInputValue(input);\n    };\n    handler.on(input, 'keyup', onKeyupAndPress);\n    handler.on(input, 'keypress', onKeyupAndPress);\n    handler.on(input, 'keydown', (e) => {\n      if (input.classList.contains('composition')) {\n        return;\n      }\n      const keyCode = event.getKeyCode(e);\n      if (keyCode === KEY_ESC) {\n        this.detach(true);\n        event.cancel(e);\n      } else if (keyCode === KEY_ENTER) {\n        this._onKeydownEnter(e);\n      } else {\n        this._onInputValue(input);\n      }\n    });\n  }\n\n  _onKeydownEnter(e: KeyboardEvent): void {\n    if (this._attaching) {\n      return;\n    }\n    const input = this._input;\n    const { value } = input;\n    then(this._doChangeValue(), (r) => {\n      if (r && value === input.value) {\n        const grid = this._isActive() ? this._activeData!.grid : null;\n        this.detach(true);\n\n        if (grid?.keyboardOptions?.moveCellOnEnter) {\n          grid.onKeyDownMove(e);\n        }\n      }\n    });\n    event.cancel(e);\n  }\n\n  _onInputValue(input: HTMLInputElement, activeData?: ActiveData<T>): void {\n    const before = this._beforeValue;\n    const { value } = input;\n    if (before !== value) {\n      this._onInputValueChange(value, activeData);\n    }\n    this._beforeValue = value;\n  }\n\n  _onInputValueChange(after: string, activeData?: ActiveData<T>): void {\n    activeData = (activeData || this._activeData)!;\n    const dialog = this._dialog;\n    const { grid, col, row, editor } = activeData;\n    if (typeof editor.helperText === 'function') {\n      const helperText = editor.helperText(after, { grid, col, row });\n      if (helperText) {\n        dialog.dataset.helperText = helperText;\n      } else {\n        delete dialog.dataset.helperText;\n      }\n    }\n    if ('errorMessage' in dialog.dataset) {\n      this._validate(after, true);\n    }\n  }\n\n  _validate(value: string, inputOnly?: boolean): MaybePromise<boolean> {\n    const dialog = this._dialog;\n    const input = this._input;\n    const { grid, col, row, editor } = this._activeData!;\n    let message: MaybePromise<string> = '';\n    if (editor.inputValidator) {\n      message = editor.inputValidator(value, { grid, col, row });\n    }\n    return then(message, (message: MaybePromise<string>) => {\n      if (!message && editor.validator && !inputOnly) {\n        message = editor.validator(value, { grid, col, row });\n      }\n      return then(message, (message) => {\n        if (message && value === input.value) {\n          dialog.dataset.errorMessage = message;\n        } else {\n          delete dialog.dataset.errorMessage;\n        }\n        return !message;\n      });\n    });\n  }\n}\n","import type { CellAddress, ListGridAPI, MaybePromise, SmallDialogInputEditorOption } from '../../ts-types';\nimport type { GridInternal, InputEditorState } from '../../ts-types-internal';\nimport { BaseInputEditor } from './BaseInputEditor';\nimport { SmallDialogInputElement } from './internal/SmallDialogInputElement';\nimport { getSmallDialogInputEditorStateId } from '../../internal/symbolManager';\nimport { obj } from '../../internal/utils';\nconst _ = getSmallDialogInputEditorStateId();\n\nfunction getState<T>(grid: GridInternal<T>): InputEditorState {\n  let state = grid[_];\n  if (!state) {\n    state = {};\n    obj.setReadonly(grid, _, state);\n  }\n  return state;\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nlet globalElement: SmallDialogInputElement<any> | null = null;\nlet bindGridCount = 0;\nfunction attachInput<T>(grid: ListGridAPI<T>, cell: CellAddress, editor: SmallDialogInputEditor<T>, value: string): void {\n  const state = getState(grid);\n  if (!globalElement) {\n    globalElement = new SmallDialogInputElement();\n  }\n  if (!state.element) {\n    state.element = globalElement;\n    bindGridCount++;\n    grid.addDisposable({\n      dispose() {\n        bindGridCount--;\n        if (!bindGridCount) {\n          globalElement?.dispose();\n          globalElement = null;\n          state.element = null;\n        }\n      }\n    });\n  }\n\n  globalElement.attach(grid, editor, cell.col, cell.row, value);\n}\nfunction detachInput(gridFocus?: boolean): void {\n  if (globalElement) {\n    globalElement.detach(gridFocus);\n  }\n}\n\ntype GetValueResult<T, R> = (value: string, info: { grid: ListGridAPI<T>; col: number; row: number }) => R;\nexport class SmallDialogInputEditor<T> extends BaseInputEditor<T> {\n  private _helperText?: string | GetValueResult<T, string>;\n  private _inputValidator?: GetValueResult<T, MaybePromise<string>>;\n  private _validator?: GetValueResult<T, MaybePromise<string>>;\n  private _classList?: string | string[];\n  private _type?: string;\n  constructor(option: SmallDialogInputEditorOption<T> = {}) {\n    super(option);\n    this._helperText = option.helperText;\n    this._inputValidator = option.inputValidator;\n    this._validator = option.validator;\n    this._classList = option.classList;\n    this._type = option.type;\n  }\n  dispose(): void {\n    //noop\n  }\n  get classList(): string[] | undefined {\n    if (!this._classList) {\n      return undefined;\n    }\n    return Array.isArray(this._classList) ? this._classList : [this._classList];\n  }\n  set classList(classList: string[] | undefined) {\n    this._classList = classList;\n  }\n  get type(): string | undefined {\n    return this._type;\n  }\n  set type(type: string | undefined) {\n    this._type = type;\n  }\n  get helperText(): string | GetValueResult<T, string> | undefined {\n    return this._helperText;\n  }\n  get inputValidator(): GetValueResult<T, MaybePromise<string>> | undefined {\n    return this._inputValidator;\n  }\n  get validator(): GetValueResult<T, MaybePromise<string>> | undefined {\n    return this._validator;\n  }\n  clone(): SmallDialogInputEditor<T> {\n    return new SmallDialogInputEditor(this);\n  }\n  onInputCellInternal(grid: ListGridAPI<T>, cell: CellAddress, inputValue: string): void {\n    attachInput(grid, cell, this, inputValue);\n  }\n  onOpenCellInternal(grid: ListGridAPI<T>, cell: CellAddress): void {\n    grid.doGetCellValue(cell.col, cell.row, (value) => {\n      attachInput(grid, cell, this, value);\n    });\n  }\n  onChangeSelectCellInternal(_grid: ListGridAPI<T>, _cell: CellAddress, _selected: boolean): void {\n    // cancel input\n    detachInput();\n  }\n  onGridScrollInternal(_grid: ListGridAPI<T>): void {\n    // cancel input\n    detachInput(true);\n  }\n  onChangeDisabledInternal(): void {\n    // cancel input\n    detachInput(true);\n  }\n  onChangeReadOnlyInternal(): void {\n    // cancel input\n    detachInput(true);\n  }\n  onSetInputAttrsInternal(grid: ListGridAPI<T>, _cell: CellAddress, input: HTMLInputElement): void {\n    SmallDialogInputElement.setInputAttrs(this, grid, input);\n  }\n}\n","import type {\n  ActionOption,\n  BaseActionOption,\n  ButtonActionOption,\n  ColumnActionOption,\n  EditorOption,\n  InlineInputEditorOption,\n  InlineMenuEditorOption,\n  RecordBoolean,\n  SmallDialogInputEditorOption\n} from '../ts-types';\nimport { Action } from './action/Action';\nimport { BaseAction } from './action/BaseAction';\nimport { ButtonAction } from './action/ButtonAction';\nimport { CheckEditor } from './action/CheckEditor';\nimport { Editor } from './action/Editor';\nimport { InlineInputEditor } from './action/InlineInputEditor';\nimport { InlineMenuEditor } from './action/InlineMenuEditor';\nimport { RadioEditor } from './action/RadioEditor';\nimport { SmallDialogInputEditor } from './action/SmallDialogInputEditor';\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nclass ImmutableCheckEditor extends CheckEditor<any> {\n  get disabled(): RecordBoolean {\n    return this._disabled;\n  }\n\n  get readOnly(): RecordBoolean {\n    return this._readOnly;\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nclass ImmutableRadioEditor extends RadioEditor<any> {\n  get disabled(): RecordBoolean {\n    return this._disabled;\n  }\n\n  get readOnly(): RecordBoolean {\n    return this._readOnly;\n  }\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nclass ImmutableInputEditor extends SmallDialogInputEditor<any> {\n  get disabled(): RecordBoolean {\n    return this._disabled;\n  }\n\n  get readOnly(): RecordBoolean {\n    return this._readOnly;\n  }\n}\n\nexport const ACTIONS = {\n  CHECK: new ImmutableCheckEditor(),\n  INPUT: new ImmutableInputEditor(),\n  RADIO: new ImmutableRadioEditor()\n};\n/**\n * column actions\n * @namespace cheetahGrid.columns.action\n * @memberof cheetahGrid.columns\n */\nexport {\n  BaseAction,\n  Editor,\n  Action,\n  CheckEditor,\n  RadioEditor,\n  ButtonAction,\n  SmallDialogInputEditor,\n  InlineInputEditor,\n  InlineMenuEditor,\n  // types\n  ActionOption,\n  BaseActionOption,\n  ButtonActionOption,\n  EditorOption,\n  InlineInputEditorOption,\n  InlineMenuEditorOption,\n  SmallDialogInputEditorOption\n};\n\nexport function of<T>(columnAction: ColumnActionOption | BaseAction<T> | null | undefined): BaseAction<T> | undefined {\n  if (!columnAction) {\n    return undefined;\n  } else if (typeof columnAction === 'string') {\n    const key = columnAction.toUpperCase() as keyof typeof ACTIONS;\n    return ACTIONS[key] || of(null);\n  } else {\n    return columnAction;\n  }\n}\n","import * as action from './columns/action';\nimport * as style from './columns/style';\nimport * as type from './columns/type';\n\n/**\n * columns\n */\nexport const columns = { action, type, style };\n","import { array } from './utils';\n\nconst TYPE_PAREN = 0;\nconst TYPE_UNIT = 1;\nconst TYPE_OPERATOR = 2;\nconst TYPE_NUMBER = 3;\n\nconst NODE_TYPE_UNIT = 10;\nconst NODE_TYPE_BINARY_EXPRESSION = 11;\nconst NODE_TYPE_NUMBER = 12;\n\ntype Ops = '-' | '+' | '*' | '/';\ntype ParenToken = {\n  value: '(' | ')';\n  type: typeof TYPE_PAREN;\n};\ntype UnitToken = {\n  unit: string;\n  value: number;\n  type: typeof TYPE_UNIT;\n};\ntype OpToken = {\n  value: Ops;\n  type: typeof TYPE_OPERATOR;\n};\ntype NumToken = {\n  value: number;\n  type: typeof TYPE_NUMBER;\n};\ntype Token = ParenToken | UnitToken | OpToken | NumToken;\ntype UnitNode = {\n  nodeType: typeof NODE_TYPE_UNIT;\n  unit: string;\n  value: number;\n};\ntype BinaryNode = {\n  nodeType: typeof NODE_TYPE_BINARY_EXPRESSION;\n  left: Node;\n  op: OpToken;\n  right: Node;\n};\ntype NumNode = {\n  nodeType: typeof NODE_TYPE_NUMBER;\n  value: number;\n};\ntype Node = UnitNode | BinaryNode | NumNode;\n\nconst TABULATION = 0x09;\nconst CARRIAGE_RETURN = 0x0d;\nconst LINE_FEED = 0x0a;\nconst FORM_FEED = 0x0c;\nconst SPACE = 0x20;\nconst PERCENT = 0x25;\nconst FULL_STOP = 0x2e;\nconst DIGIT_0 = 0x30;\nconst DIGIT_9 = 0x39;\nconst LATIN_CAPITAL_A = 0x41;\nconst LATIN_CAPITAL_Z = 0x5a;\nconst LATIN_SMALL_A = 0x61;\nconst LATIN_SMALL_Z = 0x7a;\nfunction isUpperLetter(cp: number): boolean {\n  return cp >= LATIN_CAPITAL_A && cp <= LATIN_CAPITAL_Z;\n}\nfunction isLowerLetter(cp: number): boolean {\n  return cp >= LATIN_SMALL_A && cp <= LATIN_SMALL_Z;\n}\nfunction isLetter(cp: number): boolean {\n  return isLowerLetter(cp) || isUpperLetter(cp);\n}\nfunction isWhitespace(cp: number): boolean {\n  return cp === TABULATION || cp === LINE_FEED || cp === FORM_FEED || cp === CARRIAGE_RETURN || cp === SPACE;\n}\nfunction isDigit(cp: number): boolean {\n  return cp >= DIGIT_0 && cp <= DIGIT_9;\n}\nfunction isDot(cp: number): boolean {\n  return cp === FULL_STOP;\n}\nfunction isUnit(cp: number): boolean {\n  return isLetter(cp) || cp === PERCENT;\n}\n\nfunction createError(calc: string): Error {\n  return new Error(`calc parse error: ${calc}`);\n}\n\n/**\n * tokenize\n * @param {string} calc calc expression\n * @returns {Array} tokens\n * @private\n */\nfunction tokenize(calc: string): Token[] {\n  const exp = calc.replace(/calc\\(/g, '(').trim();\n\n  const tokens: Token[] = [];\n  const len = exp.length;\n  for (let index = 0; index < len; index++) {\n    const c = exp[index];\n    const cp = c.charCodeAt(0);\n    if (c === '(' || c === ')') {\n      tokens.push({ value: c, type: TYPE_PAREN });\n    } else if (c === '*' || c === '/') {\n      tokens.push({ value: c, type: TYPE_OPERATOR });\n    } else if (c === '+' || c === '-') {\n      index = parseSign(c, index + 1) - 1;\n    } else if (isDigit(cp) || isDot(cp)) {\n      index = parseNum(c, index + 1) - 1;\n    } else if (isWhitespace(cp)) {\n      // skip\n    } else {\n      throw createError(calc);\n    }\n  }\n\n  function parseSign(sign: '+' | '-', start: number): number {\n    if (start < len) {\n      const c = exp[start];\n      const cp = c.charCodeAt(0);\n      if (isDigit(cp) || isDot(cp)) {\n        return parseNum(sign + c, start + 1);\n      }\n    }\n    tokens.push({ value: sign, type: TYPE_OPERATOR });\n    return start;\n  }\n  function parseNum(num: string, start: number): number {\n    let index = start;\n    for (; index < len; index++) {\n      const c = exp[index];\n      const cp = c.charCodeAt(0);\n      if (isDigit(cp)) {\n        num += c;\n      } else if (c === '.') {\n        if (num.indexOf('.') >= 0) {\n          throw createError(calc);\n        }\n        num += c;\n      } else if (isUnit(cp)) {\n        return parseUnit(num, c, index + 1);\n      } else {\n        break;\n      }\n    }\n    if (num === '.') {\n      throw createError(calc);\n    }\n    tokens.push({ value: parseFloat(num), type: TYPE_NUMBER });\n    return index;\n  }\n  function parseUnit(num: string, unit: string, start: number): number {\n    let index = start;\n    for (; index < len; index++) {\n      const c = exp[index];\n      const cp = c.charCodeAt(0);\n      if (isUnit(cp)) {\n        unit += c;\n      } else {\n        break;\n      }\n    }\n    tokens.push({ value: parseFloat(num), unit, type: TYPE_UNIT });\n    return index;\n  }\n  return tokens;\n}\n\nconst PRECEDENCE = {\n  '*': 3,\n  '/': 3,\n  '+': 2,\n  '-': 2\n};\n\nfunction lex(tokens: Token[], calc: string): Node {\n  function buildBinaryExpNode(stack: (Node | OpToken)[]): BinaryNode {\n    const right = stack.pop() as Node;\n    const op = stack.pop() as OpToken;\n    const left = stack.pop() as Node;\n\n    if (!left || !left.nodeType || !op || op.type !== TYPE_OPERATOR || !right || !right.nodeType) {\n      throw createError(calc);\n    }\n    return {\n      nodeType: NODE_TYPE_BINARY_EXPRESSION,\n      left,\n      op,\n      right\n    };\n  }\n\n  const stack: (Node | OpToken)[] = [];\n\n  while (tokens.length) {\n    const token = tokens.shift() as Token;\n    if (token.type === TYPE_PAREN && token.value === '(') {\n      let deep = 0;\n      const closeIndex = array.findIndex(tokens, (t) => {\n        if (t.type === TYPE_PAREN && t.value === '(') {\n          deep++;\n        } else if (t.type === TYPE_PAREN && t.value === ')') {\n          if (!deep) {\n            return true;\n          }\n          deep--;\n        }\n        return false;\n      });\n      if (closeIndex === -1) {\n        throw createError(calc);\n      }\n\n      stack.push(lex(tokens.splice(0, closeIndex), calc));\n      tokens.shift();\n    } else if (token.type === TYPE_OPERATOR) {\n      if (stack.length >= 3) {\n        const beforeOp = (stack[stack.length - 2] as OpToken).value;\n        if (PRECEDENCE[token.value] <= PRECEDENCE[beforeOp]) {\n          stack.push(buildBinaryExpNode(stack));\n        }\n      }\n      stack.push(token);\n    } else if (token.type === TYPE_UNIT) {\n      const { value: num, unit } = token;\n      stack.push({\n        nodeType: NODE_TYPE_UNIT,\n        value: num,\n        unit\n      });\n    } else if (token.type === TYPE_NUMBER) {\n      stack.push({\n        nodeType: NODE_TYPE_NUMBER,\n        value: token.value\n      });\n    }\n  }\n  while (stack.length > 1) {\n    stack.push(buildBinaryExpNode(stack));\n  }\n  return stack[0] as Node;\n}\n\nfunction parse(calcStr: string): Node {\n  const tokens = tokenize(calcStr);\n  return lex(tokens, calcStr);\n}\n\nfunction calcNode(node: Node, context: CalcContext): number {\n  if (node.nodeType === NODE_TYPE_BINARY_EXPRESSION) {\n    const left = calcNode(node.left, context);\n    const right = calcNode(node.right, context);\n\n    switch (node.op.value) {\n      case '+':\n        return left + right;\n      case '-':\n        return left - right;\n      case '*':\n        return left * right;\n      case '/':\n        return left / right;\n      default:\n        // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n        throw new Error(`calc error. unknown operator: ${node.op.value}`);\n    }\n  } else if (node.nodeType === NODE_TYPE_UNIT) {\n    switch (node.unit) {\n      case '%':\n        return (node.value * context.full) / 100;\n      case 'em':\n        return node.value * context.em;\n      case 'px':\n        return node.value;\n      default:\n        throw new Error(`calc error. unknown unit: ${node.unit}`);\n    }\n  } else if (node.nodeType === NODE_TYPE_NUMBER) {\n    return node.value;\n  }\n  throw new Error('calc error.');\n}\n\nfunction toPxInternal(value: string, context: CalcContext): number {\n  const ast = parse(value);\n  return calcNode(ast, context);\n}\n\ntype CalcContext = {\n  full: number;\n  em: number;\n};\n\nexport function toPx(value: string | number, context: CalcContext): number {\n  if (typeof value === 'string') {\n    return toPxInternal(value.trim(), context);\n  }\n  return value - 0;\n}\n","import type { AnyFunction } from '../ts-types';\nimport { EventHandler } from './EventHandler';\nimport { isNode } from './utils';\nconst handler = new EventHandler();\n\nlet ratio = 1;\nfunction setRatio(): void {\n  if (isNode) {\n    ratio = 1;\n  } else {\n    ratio = Math.ceil(window.devicePixelRatio || 1);\n    if (ratio > 1 && ratio % 2 !== 0) {\n      ratio += 1;\n    }\n  }\n}\nsetRatio();\nif (!isNode) {\n  handler.on(window, 'resize', setRatio);\n}\n\nexport function transform(canvas: HTMLCanvasElement): HTMLCanvasElement {\n  const ctx = canvas.getContext('2d') as CanvasRenderingContext2D;\n\n  const { getAttribute, setAttribute } = canvas;\n  canvas.getAttribute = function (name: string): string | null {\n    let result = getAttribute.call(this, name);\n    if (name === 'width' || name === 'height') {\n      result = `${Number(result) / ratio}`;\n    }\n    return result;\n  };\n  canvas.setAttribute = function (name, val: string): void {\n    const wh = name === 'width' || name === 'height';\n    if (wh) {\n      val = `${Number(val) * ratio}`;\n    }\n    const result = setAttribute.call(this, name, val);\n    if (wh) {\n      ctx.scale(ratio, ratio);\n    }\n    return result;\n  };\n\n  Object.defineProperty(canvas, 'width', {\n    get(): number {\n      return Number(canvas.getAttribute('width'));\n    },\n    set: (val: number) => {\n      canvas.setAttribute('width', `${Math.floor(val)}`);\n    },\n    configurable: true,\n    enumerable: true\n  });\n  Object.defineProperty(canvas, 'height', {\n    get(): number {\n      return Number(canvas.getAttribute('height'));\n    },\n    set: (val: number) => {\n      canvas.setAttribute('height', `${Math.floor(val)}`);\n    },\n    configurable: true,\n    enumerable: true\n  });\n  const { drawImage } = ctx;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  ctx.drawImage = function (img: CanvasImageSource, ...args: any[]): void {\n    if (img !== canvas || ratio === 1) {\n      return (drawImage as AnyFunction).call(this, img, ...args);\n    }\n    this.save();\n    try {\n      this.scale(1 / ratio, 1 / ratio);\n      if (args.length > 4) {\n        args[4] *= ratio;\n        args[5] *= ratio;\n      } else {\n        args[0] *= ratio;\n        args[1] *= ratio;\n      }\n      return (drawImage as AnyFunction).call(this, img, ...args);\n    } finally {\n      this.restore();\n    }\n  };\n\n  return canvas;\n}\n","function getScrollBarWidth(): number {\n  const dummy = document.createElement('div');\n  const { style } = dummy;\n  style.position = 'absolute';\n  style.height = '9999px';\n  style.width = 'calc(100vw - 100%)';\n  style.opacity = '0';\n  dummy.textContent = 'x';\n  document.body.appendChild(dummy);\n  const { width } = (document.defaultView || window).getComputedStyle(dummy, '');\n  document.body.removeChild(dummy);\n  return parseInt(width, 10);\n}\n\nlet SCROLLBAR_SIZE: number;\nimport './style.css';\n\nfunction initDocumentInternal(): void {\n  // require(\"@/internal/style.css\");\n  SCROLLBAR_SIZE = getScrollBarWidth() || 10;\n  const style = document.createElement('style');\n  style.setAttribute('type', 'text/css');\n  style.setAttribute('data-name', 'cheetah-grid');\n  style.innerHTML = `\n.cheetah-grid .grid-scroll-end-point {\n\twidth: ${SCROLLBAR_SIZE}px;\n\theight: ${SCROLLBAR_SIZE}px;\n}\n.cheetah-grid > canvas {\n\twidth: -webkit-calc(100% - ${SCROLLBAR_SIZE}px);\n\twidth: calc(100% - ${SCROLLBAR_SIZE}px);\n\theight: -webkit-calc(100% - ${SCROLLBAR_SIZE}px);\n\theight: calc(100% - ${SCROLLBAR_SIZE}px);\n}\n\t\t`;\n\n  document.head.appendChild(style);\n}\n\nlet initDocumentVar = initDocumentInternal;\n\nexport function initDocument(): void {\n  initDocumentVar();\n  initDocumentVar = Function.prototype as () => void;\n}\n\nexport function getScrollBarSize(): number {\n  return SCROLLBAR_SIZE;\n}\n","const indexFirst = (arr: number[], elm: number): number => {\n  let low = 0;\n  let high = arr.length - 1;\n  while (low <= high) {\n    const i = Math.floor((low + high) / 2);\n    if (arr[i] === elm) {\n      return i;\n    } else if (arr[i] > elm) {\n      high = i - 1;\n    } else {\n      low = i + 1;\n    }\n  }\n  return high < 0 ? 0 : high;\n};\n\nexport class NumberMap<T> {\n  private _keys: number[] = [];\n  private _vals: { [key: number]: T } = {};\n  private _sorted = false;\n  put(key: number, value: T): void {\n    if (!(key in this._vals)) {\n      this._keys.push(key);\n      this._sorted = false;\n    }\n    this._vals[key] = value;\n  }\n  get(key: number): T | undefined {\n    return this._vals[key];\n  }\n  has(key: number): boolean {\n    return this._vals[key] != null;\n  }\n  each(keyFrom: number, keyTo: number, fn: (t: T, k: number) => void): void {\n    const { _keys: keys } = this;\n    const { length } = keys;\n    if (!this._sorted) {\n      keys.sort((a, b) => {\n        if (a < b) {\n          return -1;\n        }\n        if (a > b) {\n          return 1;\n        }\n        return 0;\n      });\n      this._sorted = true;\n    }\n\n    for (let i = indexFirst(keys, keyFrom); i < length; i++) {\n      const key = keys[i];\n      if (keyFrom <= key && key <= keyTo) {\n        fn(this.get(key) as T, key);\n      } else if (keyTo < key) {\n        return;\n      }\n    }\n  }\n}\n","import type { RectProps } from '../ts-types';\n\nexport class Rect implements RectProps {\n  private _left: number;\n  private _top: number;\n  private _width: number;\n  private _height: number;\n  private _right: number | undefined;\n  private _bottom: number | undefined;\n  constructor(left: number, top: number, width: number, height: number) {\n    this._left = left;\n    this._top = top;\n    this._width = width;\n    this._height = height;\n  }\n  static bounds(left: number, top: number, right: number, bottom: number): Rect {\n    return new Rect(left, top, right - left, bottom - top);\n  }\n  static max(rect1: Rect, rect2: Rect): Rect {\n    return Rect.bounds(Math.min(rect1.left, rect2.left), Math.min(rect1.top, rect2.top), Math.max(rect1.right, rect2.right), Math.max(rect1.bottom, rect2.bottom));\n  }\n  get left(): number {\n    return this._left;\n  }\n  set left(left: number) {\n    const { right } = this;\n    this._left = left;\n    this.right = right;\n  }\n  get top(): number {\n    return this._top;\n  }\n  set top(top: number) {\n    const { bottom } = this;\n    this._top = top;\n    this.bottom = bottom;\n  }\n  get width(): number {\n    return this._width;\n  }\n  set width(width: number) {\n    this._width = width;\n    this._right = undefined;\n  }\n  get height(): number {\n    return this._height;\n  }\n  set height(height: number) {\n    this._height = height;\n    this._bottom = undefined;\n  }\n  get right(): number {\n    return this._right !== undefined ? this._right : (this._right = this.left + this.width);\n  }\n  set right(right: number) {\n    this._right = right;\n    this.width = right - this.left;\n  }\n  get bottom(): number {\n    return this._bottom !== undefined ? this._bottom : (this._bottom = this.top + this.height);\n  }\n  set bottom(bottom: number) {\n    this._bottom = bottom;\n    this.height = bottom - this.top;\n  }\n  offsetLeft(offset: number): void {\n    this._left += offset;\n    this._right = undefined;\n  }\n  offsetTop(offset: number): void {\n    this._top += offset;\n    this._bottom = undefined;\n  }\n  copy(): Rect {\n    return new Rect(this.left, this.top, this.width, this.height);\n  }\n  intersection(rect: Rect): Rect | null {\n    const x0 = Math.max(this.left, rect.left);\n    const x1 = Math.min(this.left + this.width, rect.left + rect.width);\n    if (x0 <= x1) {\n      const y0 = Math.max(this.top, rect.top);\n      const y1 = Math.min(this.top + this.height, rect.top + rect.height);\n      if (y0 <= y1) {\n        return Rect.bounds(x0, y0, x1, y1);\n      }\n    }\n    return null;\n  }\n  contains(another: Rect): boolean {\n    return this.left <= another.left && this.left + this.width >= another.left + another.width && this.top <= another.top && this.top + this.height >= another.top + another.height;\n  }\n  inPoint(x: number, y: number): boolean {\n    return this.left <= x && this.left + this.width >= x && this.top <= y && this.top + this.height >= y;\n  }\n}\n","import * as style from './style';\nimport { EventHandler } from './EventHandler';\nimport { browser } from './utils';\n\nconst MAX_SCROLL = browser.heightLimit - 1000;\n\nexport class Scrollable {\n  private _handler: EventHandler;\n  private _scrollable: HTMLDivElement;\n  private _height: number;\n  private _width: number;\n  private _endPointElement: HTMLDivElement;\n  private _p = 1;\n  constructor() {\n    this._handler = new EventHandler();\n\n    this._scrollable = document.createElement('div');\n    this._scrollable.classList.add('grid-scrollable');\n    this._height = 0;\n    this._width = 0;\n\n    this._endPointElement = document.createElement('div');\n    this._endPointElement.classList.add('grid-scroll-end-point');\n    this._update();\n    this._scrollable.appendChild(this._endPointElement);\n\n    // const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? 'DOMMouseScroll' : 'mousewheel'; //FF doesn't recognize mousewheel as of FF3.x\n    // this._handler.on(this._scrollable, mousewheelevt, (evt) => {\n    // const delta = evt.detail ? evt.detail * (-120) : evt.wheelDelta;\n    // const point = Math.min(Math.abs(delta) / 12, this.scrollHeight / 5);\n    // this.scrollTop += delta < 0 ? point : -point;\n    // });\n  }\n  calcTop(top: number): number {\n    const relativeTop = top - this.scrollTop;\n    return this._scrollable.scrollTop + relativeTop;\n  }\n  getElement(): HTMLDivElement {\n    return this._scrollable;\n  }\n  setScrollSize(width: number, height: number): void {\n    this._width = width;\n    this._height = height;\n    this._update();\n  }\n  get scrollWidth(): number {\n    return this._width;\n  }\n  set scrollWidth(width: number) {\n    this._width = width;\n    this._update();\n  }\n  get scrollHeight(): number {\n    return this._height;\n  }\n  set scrollHeight(height: number) {\n    this._height = height;\n    this._update();\n  }\n  get scrollLeft(): number {\n    return Math.max(Math.ceil(this._scrollable.scrollLeft), 0);\n  }\n  set scrollLeft(scrollLeft: number) {\n    this._scrollable.scrollLeft = scrollLeft;\n  }\n  get scrollTop(): number {\n    return Math.max(Math.ceil(this._scrollable.scrollTop / this._p), 0);\n  }\n  set scrollTop(scrollTop: number) {\n    this._scrollable.scrollTop = scrollTop * this._p;\n  }\n  onScroll(fn: (evt: Event) => void): void {\n    this._handler.on(this._scrollable, 'scroll', fn);\n  }\n  dispose(): void {\n    this._handler.dispose();\n  }\n  private _update(): void {\n    let domHeight;\n    if (this._height > MAX_SCROLL) {\n      const sbSize = style.getScrollBarSize();\n      const { offsetHeight } = this._scrollable;\n      const vScrollRange = MAX_SCROLL - offsetHeight + sbSize;\n      const rScrollRange = this._height - offsetHeight + sbSize;\n      this._p = vScrollRange / rScrollRange;\n      domHeight = MAX_SCROLL;\n    } else {\n      this._p = 1;\n      domHeight = this._height;\n    }\n\n    this._endPointElement.style.top = `${domHeight.toFixed()}px`;\n    this._endPointElement.style.left = `${this._width.toFixed()}px`;\n  }\n}\n","import type { PasteRangeBoxValues } from '../ts-types';\n\nexport function parsePasteRangeBoxValues(value: string): PasteRangeBoxValues {\n  const normalizeValue = value.replace(/\\r?\\n$/, '');\n  const lines = normalizeValue.split(/(?:\\r?\\n)|[\\u2028\\u2029]/g);\n  const values = lines.map((line) => line.split(/\\t/g));\n  const colCount = values.reduce((n, cells) => Math.max(n, cells.length), 0);\n  return {\n    colCount,\n    rowCount: values.length,\n    getCellValue(offsetCol: number, offsetRow: number): string {\n      return values[offsetRow]?.[offsetCol] || '';\n    }\n  };\n}\n","import * as calc from '../internal/calc';\nimport * as hiDPI from '../internal/hiDPI';\nimport * as style from '../internal/style';\nimport type {\n  AfterSelectedCellEvent,\n  AnyFunction,\n  BeforeSelectedCellEvent,\n  CellAddress,\n  CellContext,\n  CellRange,\n  DrawGridAPI,\n  DrawGridEventHandlersEventMap,\n  DrawGridEventHandlersReturnMap,\n  DrawGridKeyboardOptions,\n  EventListenerId,\n  KeyboardEventListener,\n  KeydownEvent,\n  PasteCellEvent,\n  PasteRangeBoxValues\n} from '../ts-types';\nimport { array, browser, event, isDescendantElement, isPromise } from '../internal/utils';\n\nimport { DG_EVENT_TYPE } from './DG_EVENT_TYPE';\nimport { EventHandler } from '../internal/EventHandler';\nimport { EventTarget } from './EventTarget';\nimport { NumberMap } from '../internal/NumberMap';\nimport { Rect } from '../internal/Rect';\nimport { Scrollable } from '../internal/Scrollable';\nimport { getFontSize } from '../internal/canvases';\n//protected symbol\nimport { getProtectedSymbol } from '../internal/symbolManager';\nimport { parsePasteRangeBoxValues } from '../internal/paste-utils';\n\nconst {\n  /** @private */\n  isTouchEvent,\n  /** @private */\n  getMouseButtons,\n  /** @private */\n  getKeyCode,\n  /** @private */\n  cancel: cancelEvent\n} = event;\n/** @private */\nconst _ = getProtectedSymbol();\n\n/** @private */\nfunction createRootElement(): HTMLElement {\n  const element = document.createElement('div');\n  element.classList.add('cheetah-grid');\n  return element;\n}\n\n/** @private */\nconst KEY_BS = 8;\n/** @private */\nconst KEY_TAB = 9;\n/** @private */\nconst KEY_ENTER = 13;\n/** @private */\nconst KEY_END = 35;\n/** @private */\nconst KEY_HOME = 36;\n/** @private */\nconst KEY_LEFT = 37;\n/** @private */\nconst KEY_UP = 38;\n/** @private */\nconst KEY_RIGHT = 39;\n/** @private */\nconst KEY_DOWN = 40;\n/** @private */\nconst KEY_DEL = 46;\n/** @private */\nconst KEY_ALPHA_A = 65;\n/** @private */\nconst KEY_ALPHA_C = 67;\n/** @private */\nconst KEY_ALPHA_V = 86;\n\n//private methods\n/** @private */\nfunction _vibrate(e: TouchEvent | MouseEvent): void {\n  if (navigator.vibrate && isTouchEvent(e)) {\n    navigator.vibrate(50);\n  }\n}\n\n/** @private */\nfunction _getTargetRowAt(this: DrawGrid, absoluteY: number): { row: number; top: number } | null {\n  const internal = this.getTargetRowAtInternal(absoluteY);\n  if (internal != null) {\n    return internal;\n  }\n  const findBefore = (\n    startRow: number,\n    startBottom: number\n  ): {\n    top: number;\n    row: number;\n  } | null => {\n    let bottom = startBottom;\n    for (let row = startRow; row >= 0; row--) {\n      const height = _getRowHeight.call(this, row);\n      const top = bottom - height;\n      if (top <= absoluteY && absoluteY < bottom) {\n        return {\n          top,\n          row\n        };\n      }\n      bottom = top;\n    }\n    return null;\n  };\n  const findAfter = (\n    startRow: number,\n    startBottom: number\n  ): {\n    top: number;\n    row: number;\n  } | null => {\n    let top = startBottom - _getRowHeight.call(this, startRow);\n    const { rowCount } = this[_];\n    for (let row = startRow; row < rowCount; row++) {\n      const height = _getRowHeight.call(this, row);\n      const bottom = top + height;\n      if (top <= absoluteY && absoluteY < bottom) {\n        return {\n          top,\n          row\n        };\n      }\n      top = bottom;\n    }\n    return null;\n  };\n  const candRow = Math.min(Math.ceil(absoluteY / this[_].defaultRowHeight), this.rowCount - 1);\n  const bottom = _getRowsHeight.call(this, 0, candRow);\n  if (absoluteY >= bottom) {\n    return findAfter(candRow, bottom);\n  } else {\n    return findBefore(candRow, bottom);\n  }\n}\n\n/** @private */\nfunction _getTargetColAt(\n  grid: DrawGrid,\n  absoluteX: number\n): {\n    left: number;\n    col: number;\n  } | null {\n  let left = 0;\n  const { colCount } = grid[_];\n  for (let col = 0; col < colCount; col++) {\n    const width = _getColWidth(grid, col);\n    const right = left + width;\n    if (right > absoluteX) {\n      return {\n        left,\n        col\n      };\n    }\n    left = right;\n  }\n  return null;\n}\n\n/** @private */\nfunction _getTargetFrozenRowAt(\n  grid: DrawGrid,\n  absoluteY: number\n): {\n    top: number;\n    row: number;\n  } | null {\n  if (!grid[_].frozenRowCount) {\n    return null;\n  }\n  let { top } = grid[_].scroll;\n  const rowCount = grid[_].frozenRowCount;\n  for (let row = 0; row < rowCount; row++) {\n    const height = _getRowHeight.call(grid, row);\n    const bottom = top + height;\n    if (bottom > absoluteY) {\n      return {\n        top,\n        row\n      };\n    }\n    top = bottom;\n  }\n  return null;\n}\n\n/** @private */\nfunction _getTargetFrozenColAt(\n  grid: DrawGrid,\n  absoluteX: number\n): {\n    left: number;\n    col: number;\n  } | null {\n  if (!grid[_].frozenColCount) {\n    return null;\n  }\n  let { left } = grid[_].scroll;\n  const colCount = grid[_].frozenColCount;\n  for (let col = 0; col < colCount; col++) {\n    const width = _getColWidth(grid, col);\n    const right = left + width;\n    if (right > absoluteX) {\n      return {\n        left,\n        col\n      };\n    }\n    left = right;\n  }\n  return null;\n}\n\n/** @private */\nfunction _getFrozenRowsRect(grid: DrawGrid): Rect | null {\n  if (!grid[_].frozenRowCount) {\n    return null;\n  }\n  const { top } = grid[_].scroll;\n  let height = 0;\n  const rowCount = grid[_].frozenRowCount;\n  for (let row = 0; row < rowCount; row++) {\n    height += _getRowHeight.call(grid, row);\n  }\n  return new Rect(grid[_].scroll.left, top, grid[_].canvas.width, height);\n}\n\n/** @private */\nfunction _getFrozenColsRect(grid: DrawGrid): Rect | null {\n  if (!grid[_].frozenColCount) {\n    return null;\n  }\n  const { left } = grid[_].scroll;\n  let width = 0;\n  const colCount = grid[_].frozenColCount;\n  for (let col = 0; col < colCount; col++) {\n    width += _getColWidth(grid, col);\n  }\n  return new Rect(left, grid[_].scroll.top, width, grid[_].canvas.height);\n}\n\n/** @private */\nfunction _getCellDrawing(grid: DrawGrid, col: number, row: number): DrawCellContext | null {\n  if (!grid[_].drawCells[row]) {\n    return null;\n  }\n  return grid[_].drawCells[row][col];\n}\n\n/** @private */\nfunction _putCellDrawing(grid: DrawGrid, col: number, row: number, context: DrawCellContext): void {\n  if (!grid[_].drawCells[row]) {\n    grid[_].drawCells[row] = {};\n  }\n  grid[_].drawCells[row][col] = context;\n}\n\n/** @private */\nfunction _removeCellDrawing(grid: DrawGrid, col: number, row: number): void {\n  if (!grid[_].drawCells[row]) {\n    return;\n  }\n  delete grid[_].drawCells[row][col];\n  if (Object.keys(grid[_].drawCells[row]).length === 0) {\n    delete grid[_].drawCells[row];\n  }\n}\n\n/** @private */\nfunction _drawCell(\n  this: DrawGrid,\n  ctx: CanvasRenderingContext2D,\n  col: number,\n  absoluteLeft: number,\n  width: number,\n  row: number,\n  absoluteTop: number,\n  height: number,\n  visibleRect: Rect,\n  skipAbsoluteTop: number,\n  skipAbsoluteLeft: number,\n  drawLayers: DrawLayers\n): void {\n  const rect = new Rect(absoluteLeft - visibleRect.left, absoluteTop - visibleRect.top, width, height);\n\n  const drawRect = Rect.bounds(Math.max(absoluteLeft, skipAbsoluteLeft) - visibleRect.left, Math.max(absoluteTop, skipAbsoluteTop) - visibleRect.top, rect.right, rect.bottom);\n\n  if (drawRect.height > 0 && drawRect.width > 0) {\n    ctx.save();\n    try {\n      const cellDrawing = _getCellDrawing(this, col, row);\n      if (cellDrawing) {\n        cellDrawing.cancel();\n      }\n      const dcContext = new DrawCellContext(col, row, ctx, rect, drawRect, !!cellDrawing, this[_].selection, drawLayers);\n      const p = this.onDrawCell(col, row, dcContext);\n      if (isPromise(p)) {\n        //\n        _putCellDrawing(this, col, row, dcContext);\n\n        const pCol = col;\n        dcContext._delayMode(this, () => {\n          _removeCellDrawing(this, pCol, row);\n        });\n        p.then(() => {\n          dcContext.terminate();\n        });\n      }\n    } finally {\n      ctx.restore();\n    }\n  }\n}\n\n/** @private */\nfunction _drawRow(\n  grid: DrawGrid,\n  ctx: CanvasRenderingContext2D,\n  initFrozenCol: { left: number; col: number } | null,\n  initCol: { left: number; col: number },\n  drawRight: number,\n  row: number,\n  absoluteTop: number,\n  height: number,\n  visibleRect: Rect,\n  skipAbsoluteTop: number,\n  drawLayers: DrawLayers\n): void {\n  const { colCount } = grid[_];\n  const drawOuter = (col: number, absoluteLeft: number): void => {\n    //\n    if (col >= colCount - 1 && grid[_].canvas.width > absoluteLeft - visibleRect.left) {\n      const outerLeft = absoluteLeft - visibleRect.left;\n      ctx.save();\n      ctx.beginPath();\n      ctx.fillStyle = grid.underlayBackgroundColor || '#F6F6F6';\n      ctx.rect(outerLeft, absoluteTop - visibleRect.top, grid[_].canvas.width - outerLeft, height);\n      ctx.fill();\n      ctx.restore();\n    }\n  };\n\n  let skipAbsoluteLeft = 0;\n  if (initFrozenCol) {\n    let absoluteLeft = initFrozenCol.left;\n    const count = grid[_].frozenColCount;\n    for (let { col } = initFrozenCol; col < count; col++) {\n      const width = _getColWidth(grid, col);\n\n      _drawCell.call(grid, ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect, skipAbsoluteTop, 0, drawLayers);\n\n      absoluteLeft += width;\n      if (drawRight <= absoluteLeft) {\n        //\n        drawOuter(col, absoluteLeft);\n        return;\n      }\n    }\n    skipAbsoluteLeft = absoluteLeft;\n  }\n\n  let absoluteLeft = initCol.left;\n  for (let { col } = initCol; col < colCount; col++) {\n    const width = _getColWidth(grid, col);\n    _drawCell.call(grid, ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect, skipAbsoluteTop, skipAbsoluteLeft, drawLayers);\n\n    absoluteLeft += width;\n    if (drawRight <= absoluteLeft) {\n      //\n      drawOuter(col, absoluteLeft);\n      return;\n    }\n  }\n  drawOuter(colCount - 1, absoluteLeft);\n}\n\n/** @private */\nfunction _getInitContext(this: DrawGrid): CanvasRenderingContext2D {\n  return this._getInitContext();\n}\n\n/** @private */\nfunction _invalidateRect(grid: DrawGrid, drawRect: Rect): void {\n  const visibleRect = _getVisibleRect(grid);\n  const { rowCount } = grid[_];\n  const ctx = _getInitContext.call(grid);\n\n  const initRow = _getTargetRowAt.call(grid, Math.max(visibleRect.top, drawRect.top)) || {\n    top: _getRowsHeight.call(grid, 0, rowCount - 1),\n    row: rowCount\n  };\n  const initCol = _getTargetColAt(grid, Math.max(visibleRect.left, drawRect.left)) || {\n    left: _getColsWidth(grid, 0, grid[_].colCount - 1),\n    col: grid[_].colCount\n  };\n  const drawBottom = Math.min(visibleRect.bottom, drawRect.bottom);\n  const drawRight = Math.min(visibleRect.right, drawRect.right);\n\n  const initFrozenRow = _getTargetFrozenRowAt(grid, Math.max(visibleRect.top, drawRect.top));\n  const initFrozenCol = _getTargetFrozenColAt(grid, Math.max(visibleRect.left, drawRect.left));\n\n  const drawLayers = new DrawLayers();\n\n  const drawOuter = (row: number, absoluteTop: number): void => {\n    //\n    if (row >= rowCount - 1 && grid[_].canvas.height > absoluteTop - visibleRect.top) {\n      const outerTop = absoluteTop - visibleRect.top;\n      ctx.save();\n      ctx.beginPath();\n      ctx.fillStyle = grid.underlayBackgroundColor || '#F6F6F6';\n      ctx.rect(0, outerTop, grid[_].canvas.width, grid[_].canvas.height - outerTop);\n      ctx.fill();\n      ctx.restore();\n    }\n  };\n\n  let skipAbsoluteTop = 0;\n  if (initFrozenRow) {\n    let absoluteTop = initFrozenRow.top;\n    const count = grid[_].frozenRowCount;\n    for (let { row } = initFrozenRow; row < count; row++) {\n      const height = _getRowHeight.call(grid, row);\n      _drawRow(grid, ctx, initFrozenCol, initCol, drawRight, row, absoluteTop, height, visibleRect, 0, drawLayers);\n      absoluteTop += height;\n      if (drawBottom <= absoluteTop) {\n        //\n        drawOuter(row, absoluteTop);\n        drawLayers.draw(ctx);\n        return;\n      }\n    }\n    skipAbsoluteTop = absoluteTop;\n  }\n\n  let absoluteTop = initRow.top;\n  for (let { row } = initRow; row < rowCount; row++) {\n    const height = _getRowHeight.call(grid, row);\n\n    //\n    _drawRow(grid, ctx, initFrozenCol, initCol, drawRight, row, absoluteTop, height, visibleRect, skipAbsoluteTop, drawLayers);\n\n    absoluteTop += height;\n    if (drawBottom <= absoluteTop) {\n      //\n      drawOuter(row, absoluteTop);\n      drawLayers.draw(ctx);\n      return;\n    }\n  }\n  drawOuter(rowCount - 1, absoluteTop);\n\n  drawLayers.draw(ctx);\n}\n\n/** @private */\nfunction _toPxWidth(grid: DrawGrid, width: string | number): number {\n  return Math.round(calc.toPx(width, grid[_].calcWidthContext));\n}\n\n/** @private */\nfunction _adjustColWidth(grid: DrawGrid, col: number, orgWidth: number): number {\n  const limits = _getColWidthLimits(grid, col);\n  return Math.max(_applyColWidthLimits(limits, orgWidth), 0);\n}\n\n/** @private */\nfunction _applyColWidthLimits(limits: { min?: number; max?: number } | void | null, orgWidth: number): number {\n  if (!limits) {\n    return orgWidth;\n  }\n\n  if (limits.min) {\n    if (limits.min > orgWidth) {\n      return limits.min;\n    }\n  }\n  if (limits.max) {\n    if (limits.max < orgWidth) {\n      return limits.max;\n    }\n  }\n  return orgWidth;\n}\n\n/**\n * Gets the definition of the column width.\n * @param {DrawGrid} grid grid instance\n * @param {number} col number of column\n * @returns {string|number} width definition\n * @private\n */\nfunction _getColWidthDefine(grid: DrawGrid, col: number): string | number {\n  const width = grid[_].colWidthsMap.get(col);\n  if (width) {\n    return width;\n  }\n  return grid.defaultColWidth;\n}\n\n/**\n * Gets the column width limits.\n * @param {DrawGrid} grid grid instance\n * @param {number} col number of column\n * @returns {object|null} the column width limits\n * @private\n */\nfunction _getColWidthLimits(\n  grid: DrawGrid,\n  col: number\n):\n  | {\n    min?: undefined;\n    minDef?: undefined;\n    max?: undefined;\n    maxDef?: undefined;\n  }\n  | {\n    min: number;\n    minDef: string | number;\n    max?: undefined;\n    maxDef?: undefined;\n  }\n  | {\n    min?: undefined;\n    minDef?: undefined;\n    max: number;\n    maxDef: string | number;\n  }\n  | null {\n  const limit = grid[_].colWidthsLimit[col];\n  if (!limit) {\n    return null;\n  }\n\n  const result: {\n    min?: number;\n    max?: number;\n    minDef?: string | number;\n    maxDef?: string | number;\n  } = {};\n\n  if (limit.min) {\n    result.min = _toPxWidth(grid, limit.min);\n    result.minDef = limit.min;\n  }\n  if (limit.max) {\n    result.max = _toPxWidth(grid, limit.max);\n    result.maxDef = limit.max;\n  }\n  return result as never;\n}\n\n/**\n * Checks if the given width definition is `auto`.\n * @param {string|number} width width definition to check\n * @returns {boolean} `true ` if the given width definition is `auto`\n * @private\n */\nfunction isAutoDefine(width: string | number): width is 'auto' {\n  return Boolean(width && typeof width === 'string' && width.toLowerCase() === 'auto');\n}\n\n/**\n * Creates a formula to calculate the auto width.\n * @param {DrawGrid} grid grid instance\n * @returns {string} formula\n * @private\n */\nfunction _calcAutoColWidthExpr(grid: DrawGrid, shortCircuit = true): string {\n  const fullWidth = grid[_].calcWidthContext.full;\n  let sumMin = 0;\n  const others: (string | number)[] = [];\n  let autoCount = 0;\n  const hasLimitsOnAuto = [];\n  for (let col = 0; col < grid[_].colCount; col++) {\n    const def = _getColWidthDefine(grid, col);\n    const limits = _getColWidthLimits(grid, col);\n\n    if (isAutoDefine(def)) {\n      if (limits) {\n        hasLimitsOnAuto.push(limits);\n        if (limits.min) {\n          sumMin += limits.min;\n        }\n      }\n      autoCount++;\n    } else {\n      let expr = def;\n      if (limits) {\n        const orgWidth = _toPxWidth(grid, expr);\n        const newWidth = _applyColWidthLimits(limits, orgWidth);\n        if (orgWidth !== newWidth) {\n          expr = `${newWidth}px`;\n        }\n        sumMin += newWidth;\n      }\n      others.push(expr);\n    }\n    if (shortCircuit && sumMin > fullWidth) {\n      // Returns 0px because it has consumed the full width.\n      return '0px';\n    }\n  }\n  if (hasLimitsOnAuto.length && others.length) {\n    const autoPx = (fullWidth - _toPxWidth(grid, `calc(${others.map((c) => (typeof c === 'number' ? `${c}px` : c)).join(' + ')})`)) / autoCount;\n    hasLimitsOnAuto.forEach((limits) => {\n      if (limits.min && autoPx < limits.min) {\n        others.push(limits.minDef);\n        autoCount--;\n      } else if (limits.max && limits.max < autoPx) {\n        others.push(limits.maxDef);\n        autoCount--;\n      }\n    });\n    if (shortCircuit && autoCount <= 0) {\n      return `${autoPx}px`;\n    }\n  }\n  if (others.length) {\n    const strDefs: string[] = [];\n    let num = 0;\n    others.forEach((c) => {\n      if (typeof c === 'number') {\n        num += c;\n      } else {\n        strDefs.push(c);\n      }\n    });\n    strDefs.push(`${num}px`);\n    return `calc((100% - (${strDefs.join(' + ')})) / ${autoCount})`;\n  } else {\n    return `${100 / autoCount}%`;\n  }\n}\n\n/**\n * Calculate the pixels of width from the definition of width.\n * @param {DrawGrid} grid grid instance\n * @param {string|number} width width definition\n * @returns {number} the pixels of width\n * @private\n */\nfunction _colWidthDefineToPxWidth(grid: DrawGrid, width: string | number): number {\n  if (isAutoDefine(width)) {\n    return _toPxWidth(grid, _calcAutoColWidthExpr(grid));\n  }\n  return _toPxWidth(grid, width);\n}\n\n/** @private */\nfunction _getColWidth(grid: DrawGrid, col: number): number {\n  const width = _getColWidthDefine(grid, col);\n  return _adjustColWidth(grid, col, _colWidthDefineToPxWidth(grid, width));\n}\n\n/** @private */\nfunction _setColWidth(grid: DrawGrid, col: number, width: string | number): void {\n  grid[_].colWidthsMap.put(col, width);\n}\n\n/**\n * Overwrites the definition of a column whose width is set to `auto` with the current auto width formula.\n * @param {DrawGrid} grid grid instance\n * @returns {void}\n * @private\n */\nfunction _storeAutoColWidthExprs(grid: DrawGrid): void {\n  let expr: string | null = null;\n  for (let col = 0; col < grid[_].colCount; col++) {\n    const def = _getColWidthDefine(grid, col);\n    if (isAutoDefine(def)) {\n      _setColWidth(grid, col, expr || (expr = _calcAutoColWidthExpr(grid, false)));\n    }\n  }\n}\n\n/** @private */\nfunction _getColsWidth(grid: DrawGrid, startCol: number, endCol: number): number {\n  const defaultColPxWidth = _colWidthDefineToPxWidth(grid, grid.defaultColWidth);\n  const colCount = endCol - startCol + 1;\n  let w = defaultColPxWidth * colCount;\n  grid[_].colWidthsMap.each(startCol, endCol, (width, col) => {\n    w += _adjustColWidth(grid, col, _colWidthDefineToPxWidth(grid, width)) - defaultColPxWidth;\n  });\n  for (let col = startCol; col <= endCol; col++) {\n    if (grid[_].colWidthsMap.has(col)) {\n      continue;\n    }\n    const adj = _adjustColWidth(grid, col, defaultColPxWidth);\n    if (adj !== defaultColPxWidth) {\n      w += adj - defaultColPxWidth;\n    }\n  }\n  return w;\n}\n\n/** @private */\nfunction _getRowHeight(this: DrawGrid, row: number): number {\n  const internal = this.getRowHeightInternal(row);\n  if (internal != null) {\n    return internal;\n  }\n  const height = this[_].rowHeightsMap.get(row);\n  if (height) {\n    return height;\n  }\n  return this[_].defaultRowHeight;\n}\n\n/** @private */\nfunction _setRowHeight(grid: DrawGrid, row: number, height: number): void {\n  grid[_].rowHeightsMap.put(row, height);\n}\n\n/** @private */\nfunction _getRowsHeight(this: DrawGrid, startRow: number, endRow: number): number {\n  const internal = this.getRowsHeightInternal(startRow, endRow);\n  if (internal != null) {\n    return internal;\n  }\n  const rowCount = endRow - startRow + 1;\n  let h = this[_].defaultRowHeight * rowCount;\n  this[_].rowHeightsMap.each(startRow, endRow, (height: number): void => {\n    h += height - this[_].defaultRowHeight;\n  });\n  return h;\n}\n\n/** @private */\nfunction _getScrollWidth(grid: DrawGrid): number {\n  return _getColsWidth(grid, 0, grid[_].colCount - 1);\n}\n\n/** @private */\nfunction _getScrollHeight(this: DrawGrid, row?: number): number {\n  const internal = this.getScrollHeightInternal(row);\n  if (internal != null) {\n    return internal;\n  }\n  let h = this[_].defaultRowHeight * this[_].rowCount;\n  this[_].rowHeightsMap.each(0, this[_].rowCount - 1, (height) => {\n    h += height - this[_].defaultRowHeight;\n  });\n  return h;\n}\n\n/** @private */\nfunction _onScroll(grid: DrawGrid, _e: Event): void {\n  const lastLeft = grid[_].scroll.left;\n  const lastTop = grid[_].scroll.top;\n  const moveX = grid[_].scrollable.scrollLeft - lastLeft;\n  const moveY = grid[_].scrollable.scrollTop - lastTop;\n\n  //\n  grid[_].scroll = {\n    left: grid[_].scrollable.scrollLeft,\n    top: grid[_].scrollable.scrollTop\n  };\n  const visibleRect = _getVisibleRect(grid);\n  if (Math.abs(moveX) >= visibleRect.width || Math.abs(moveY) >= visibleRect.height) {\n    //\n    _invalidateRect(grid, visibleRect);\n  } else {\n    //\n    grid[_].context.drawImage(grid[_].canvas, -moveX, -moveY);\n\n    if (moveX !== 0) {\n      //\n      const redrawRect = visibleRect.copy();\n      if (moveX < 0) {\n        redrawRect.width = -moveX;\n        if (grid[_].frozenColCount > 0) {\n          //\n          const frozenRect = _getFrozenColsRect(grid)!;\n          redrawRect.width += frozenRect.width;\n        }\n      } else if (moveX > 0) {\n        redrawRect.left = redrawRect.right - moveX;\n      }\n\n      //\n      _invalidateRect(grid, redrawRect);\n\n      if (moveX > 0) {\n        if (grid[_].frozenColCount > 0) {\n          //\n          _invalidateRect(grid, _getFrozenColsRect(grid)!);\n        }\n      }\n    }\n    if (moveY !== 0) {\n      //\n      const redrawRect = visibleRect.copy();\n      if (moveY < 0) {\n        redrawRect.height = -moveY;\n        if (grid[_].frozenRowCount > 0) {\n          //\n          const frozenRect = _getFrozenRowsRect(grid)!;\n          redrawRect.height += frozenRect.height;\n        }\n      } else if (moveY > 0) {\n        redrawRect.top = redrawRect.bottom - moveY;\n      }\n\n      //\n      _invalidateRect(grid, redrawRect);\n\n      if (moveY > 0) {\n        if (grid[_].frozenRowCount > 0) {\n          //\n          _invalidateRect(grid, _getFrozenRowsRect(grid)!);\n        }\n      }\n    }\n  }\n}\n\n/** @private */\n// eslint-disable-next-line complexity\nfunction _onKeyDownMove(this: DrawGrid, e: KeyboardEvent): void {\n  const { shiftKey } = e;\n  const keyCode = getKeyCode(e);\n  const focusCell = shiftKey ? this.selection.focus : this.selection.select;\n  if (keyCode === KEY_LEFT) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, null, 'W');\n    } else {\n      if (!hmove.call(this, 'W')) {\n        return;\n      }\n    }\n    cancelEvent(e);\n  } else if (keyCode === KEY_UP) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, 'N', null);\n    } else {\n      if (!vmove.call(this, 'N')) {\n        return;\n      }\n    }\n    cancelEvent(e);\n  } else if (keyCode === KEY_RIGHT) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, null, 'E');\n    } else {\n      if (!hmove.call(this, 'E')) {\n        return;\n      }\n    }\n    cancelEvent(e);\n  } else if (keyCode === KEY_DOWN) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, 'S', null);\n    } else {\n      if (!vmove.call(this, 'S')) {\n        return;\n      }\n    }\n    cancelEvent(e);\n  } else if (keyCode === KEY_HOME) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, 'N', 'W');\n    } else {\n      move(this, null, 'W');\n    }\n    cancelEvent(e);\n  } else if (keyCode === KEY_END) {\n    if (e.ctrlKey || e.metaKey) {\n      move(this, 'S', 'E');\n    } else {\n      move(this, null, 'E');\n    }\n    cancelEvent(e);\n  } else if (this.keyboardOptions?.moveCellOnTab && keyCode === KEY_TAB) {\n    if (shiftKey) {\n      if (!hmove.call(this, 'W', false)) {\n        const row = this.getMoveUpRowByKeyDownInternal(focusCell);\n        if (0 > row) {\n          return;\n        }\n        _moveFocusCell.call(this, this.colCount - 1, row, false);\n      }\n    } else {\n      if (!hmove.call(this, 'E', false)) {\n        const row = this.getMoveDownRowByKeyDownInternal(focusCell);\n        if (this.rowCount <= row) {\n          return;\n        }\n        _moveFocusCell.call(this, 0, row, false);\n      }\n    }\n    cancelEvent(e);\n  } else if (this.keyboardOptions?.moveCellOnEnter && keyCode === KEY_ENTER) {\n    if (shiftKey) {\n      if (!vmove.call(this, 'N', false)) {\n        const col = this.getMoveLeftColByKeyDownInternal(focusCell);\n        if (0 > col) {\n          return;\n        }\n        _moveFocusCell.call(this, col, this.rowCount - 1, false);\n      }\n    } else {\n      if (!vmove.call(this, 'S', false)) {\n        const col = this.getMoveRightColByKeyDownInternal(focusCell);\n        if (this.colCount <= col) {\n          return;\n        }\n        _moveFocusCell.call(this, col, Math.min(this.frozenRowCount, this.rowCount - 1), false);\n      }\n    }\n    cancelEvent(e);\n  } else if (this.keyboardOptions?.selectAllOnCtrlA && keyCode === KEY_ALPHA_A && (e.ctrlKey || e.metaKey)) {\n    this.selection.range = {\n      start: { col: 0, row: 0 },\n      end: { col: this.colCount - 1, row: this.rowCount - 1 }\n    };\n    this.invalidate();\n    cancelEvent(e);\n  }\n\n  function move(grid: DrawGrid, vDir: 'N' | 'S' | null, hDir: 'W' | 'E' | null): void {\n    const row = vDir === 'S' ? grid.rowCount - 1 : vDir === 'N' ? 0 : focusCell.row;\n    const col = hDir === 'E' ? grid.colCount - 1 : hDir === 'W' ? 0 : focusCell.col;\n    _moveFocusCell.call(grid, col, row, shiftKey);\n  }\n\n  function vmove(this: DrawGrid, vDir: 'N' | 'S', shiftKeyFlg: boolean = shiftKey): boolean {\n    let row: number;\n    if (vDir === 'S') {\n      row = this.getMoveDownRowByKeyDownInternal(focusCell);\n      if (this.rowCount <= row) {\n        return false;\n      }\n    } else {\n      row = this.getMoveUpRowByKeyDownInternal(focusCell);\n      if (row < 0) {\n        return false;\n      }\n    }\n    const { col } = focusCell;\n    _moveFocusCell.call(this, col, row, shiftKeyFlg);\n    return true;\n  }\n\n  function hmove(this: DrawGrid, hDir: 'W' | 'E', shiftKeyFlg: boolean = shiftKey): boolean {\n    let col: number;\n    if (hDir === 'E') {\n      col = this.getMoveRightColByKeyDownInternal(focusCell);\n      if (this.colCount <= col) {\n        return false;\n      }\n    } else {\n      col = this.getMoveLeftColByKeyDownInternal(focusCell);\n      if (col < 0) {\n        return false;\n      }\n    }\n    const { row } = focusCell;\n    _moveFocusCell.call(this, col, row, shiftKeyFlg);\n    return true;\n  }\n}\n\n/** @private */\nfunction _moveFocusCell(this: DrawGrid, col: number, row: number, shiftKey: boolean): void {\n  const offset = this.getOffsetInvalidateCells();\n\n  function extendRange(range: CellRange): CellRange {\n    if (offset > 0) {\n      range.start.col -= offset;\n      range.start.row -= offset;\n      range.end.col += offset;\n      range.end.row += offset;\n    }\n    return range;\n  }\n\n  const beforeRange = extendRange(this.selection.range);\n  const beforeRect = this.getCellRangeRect(beforeRange);\n\n  this.selection._setFocusCell(col, row, shiftKey);\n  this.makeVisibleCell(col, row);\n  this.focusCell(col, row);\n\n  const afterRange = extendRange(this.selection.range);\n  const afterRect = this.getCellRangeRect(afterRange);\n\n  if (afterRect.intersection(beforeRect)) {\n    const invalidateRect = Rect.max(afterRect, beforeRect);\n    _invalidateRect(this, invalidateRect);\n  } else {\n    _invalidateRect(this, beforeRect);\n    _invalidateRect(this, afterRect);\n  }\n}\n\n/** @private */\nfunction _updatedSelection(this: DrawGrid): void {\n  const { focusControl } = this[_];\n  const { col: selCol, row: selRow } = this[_].selection.select;\n  const results = this.fireListeners(DG_EVENT_TYPE.EDITABLEINPUT_CELL, {\n    col: selCol,\n    row: selRow\n  });\n\n  const editMode = array.findIndex(results, (v) => !!v) >= 0;\n  focusControl.editMode = editMode;\n\n  if (editMode) {\n    focusControl.storeInputStatus();\n    focusControl.setDefaultInputStatus();\n    this.fireListeners(DG_EVENT_TYPE.MODIFY_STATUS_EDITABLEINPUT_CELL, {\n      col: selCol,\n      row: selRow,\n      input: focusControl.input\n    });\n  }\n}\n\n/** @private */\nfunction _getMouseAbstractPoint(grid: DrawGrid, evt: TouchEvent | MouseEvent): { x: number; y: number } | null {\n  let e: MouseEvent | Touch;\n  if (isTouchEvent(evt)) {\n    e = evt.changedTouches[0];\n  } else {\n    e = evt;\n  }\n  const clientX = e.clientX || e.pageX + window.scrollX;\n  const clientY = e.clientY || e.pageY + window.scrollY;\n  const rect = grid[_].canvas.getBoundingClientRect();\n  if (rect.right <= clientX) {\n    return null;\n  }\n  if (rect.bottom <= clientY) {\n    return null;\n  }\n  const x = clientX - rect.left + grid[_].scroll.left;\n  const y = clientY - rect.top + grid[_].scroll.top;\n  return { x, y };\n}\n\n/** @private */\nfunction _bindEvents(this: DrawGrid): void {\n  // eslint-disable-next-line consistent-this, @typescript-eslint/no-this-alias\n  const grid = this;\n  const { handler, element, scrollable } = grid[_];\n  const getCellEventArgsSet = <EVT extends TouchEvent | MouseEvent>(\n    e: EVT\n  ): {\n    abstractPos?: { x: number; y: number };\n    cell?: CellAddress;\n    eventArgs?: CellAddress & { event: EVT };\n  } => {\n    const abstractPos = _getMouseAbstractPoint(grid, e);\n    if (!abstractPos) {\n      return {};\n    }\n    const cell = grid.getCellAt(abstractPos.x, abstractPos.y);\n    if (cell.col < 0 || cell.row < 0) {\n      return {\n        abstractPos,\n        cell\n      };\n    }\n    const eventArgs = {\n      col: cell.col,\n      row: cell.row,\n      event: e\n    };\n    return {\n      abstractPos,\n      cell,\n      eventArgs\n    };\n  };\n  const canResizeColumn = (col: number): boolean => {\n    if (grid[_].disableColumnResize) {\n      return false;\n    }\n    const limit = grid[_].colWidthsLimit[col];\n    if (!limit || !limit.min || !limit.max) {\n      return true;\n    }\n    return limit.max !== limit.min;\n  };\n  handler.on(element, 'mousedown', (e) => {\n    const eventArgsSet = getCellEventArgsSet(e);\n    const { abstractPos, eventArgs } = eventArgsSet;\n    if (!abstractPos) {\n      return;\n    }\n    if (eventArgs) {\n      const results = grid.fireListeners(DG_EVENT_TYPE.MOUSEDOWN_CELL, eventArgs);\n      if (array.findIndex(results, (v) => !v) >= 0) {\n        return;\n      }\n    }\n    if (getMouseButtons(e) !== 1) {\n      return;\n    }\n    const resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);\n    if (resizeCol >= 0 && canResizeColumn(resizeCol)) {\n      //\n      grid[_].columnResizer.start(resizeCol, e);\n    } else {\n      //\n      grid[_].cellSelector.start(e);\n    }\n  });\n  handler.on(element, 'mouseup', (e) => {\n    if (!grid.hasListeners(DG_EVENT_TYPE.MOUSEUP_CELL)) {\n      return;\n    }\n    const { eventArgs } = getCellEventArgsSet(e);\n    if (eventArgs) {\n      grid.fireListeners(DG_EVENT_TYPE.MOUSEUP_CELL, eventArgs);\n    }\n  });\n  let doubleTapBefore: (CellAddress & { event: TouchEvent | MouseEvent }) | null | undefined = null;\n  // let longTouchId: NodeJS.Timeout | null = null;\n  let longTouchId: number = 0;\n  handler.on(element, 'touchstart', (e) => {\n    if (!doubleTapBefore) {\n      doubleTapBefore = getCellEventArgsSet(e).eventArgs;\n      setTimeout(() => {\n        doubleTapBefore = null;\n      }, 350);\n    } else {\n      const { eventArgs } = getCellEventArgsSet(e);\n      if (eventArgs && eventArgs.col === doubleTapBefore.col && eventArgs.row === doubleTapBefore.row) {\n        grid.fireListeners(DG_EVENT_TYPE.DBLTAP_CELL, eventArgs);\n      }\n\n      doubleTapBefore = null;\n\n      if (e.defaultPrevented) {\n        return;\n      }\n    }\n\n    longTouchId = window.setTimeout(() => {\n      //\n      longTouchId = 0;\n      const abstractPos = _getMouseAbstractPoint(grid, e);\n      if (!abstractPos) {\n        return;\n      }\n\n      const resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y, 15);\n      if (resizeCol >= 0 && canResizeColumn(resizeCol)) {\n        //\n        grid[_].columnResizer.start(resizeCol, e);\n      } else {\n        //\n        grid[_].cellSelector.start(e);\n      }\n    }, 500);\n  });\n\n  function cancel(_e: Event): void {\n    if (longTouchId) {\n      window.clearTimeout(longTouchId);\n      longTouchId = 0;\n    }\n  }\n\n  handler.on(element, 'touchcancel', cancel);\n  handler.on(element, 'touchmove', cancel);\n  handler.on(element, 'touchend', (e) => {\n    if (longTouchId) {\n      window.clearTimeout(longTouchId);\n      grid[_].cellSelector.select(e);\n      longTouchId = 0;\n    }\n  });\n\n  let isMouseover = false;\n  let mouseEnterCell: CellAddress | null = null;\n  let mouseOverCell: CellAddress | null = null;\n\n  function onMouseenterCell(cell: CellAddress, related?: CellAddress): void {\n    grid.fireListeners(DG_EVENT_TYPE.MOUSEENTER_CELL, {\n      col: cell.col,\n      row: cell.row,\n      related\n    });\n    mouseEnterCell = cell;\n  }\n\n  function onMouseleaveCell(related?: CellAddress): CellAddress | undefined {\n    const beforeMouseCell = mouseEnterCell;\n    mouseEnterCell = null;\n    if (beforeMouseCell) {\n      grid.fireListeners(DG_EVENT_TYPE.MOUSELEAVE_CELL, {\n        col: beforeMouseCell.col,\n        row: beforeMouseCell.row,\n        related\n      });\n    }\n    return beforeMouseCell || undefined;\n  }\n\n  function onMouseoverCell(cell: CellAddress, related?: CellAddress): void {\n    grid.fireListeners(DG_EVENT_TYPE.MOUSEOVER_CELL, {\n      col: cell.col,\n      row: cell.row,\n      related\n    });\n    mouseOverCell = cell;\n  }\n\n  function onMouseoutCell(related?: CellAddress): CellAddress | undefined {\n    const beforeMouseCell = mouseOverCell;\n    mouseOverCell = null;\n    if (beforeMouseCell) {\n      grid.fireListeners(DG_EVENT_TYPE.MOUSEOUT_CELL, {\n        col: beforeMouseCell.col,\n        row: beforeMouseCell.row,\n        related\n      });\n    }\n    return beforeMouseCell || undefined;\n  }\n\n  const scrollElement = scrollable.getElement();\n  handler.on(scrollElement, 'mouseover', (_e: MouseEvent): void => {\n    isMouseover = true;\n  });\n  handler.on(scrollElement, 'mouseout', (_e: MouseEvent): void => {\n    isMouseover = false;\n    onMouseoutCell();\n  });\n\n  handler.on(element, 'mouseleave', (_e: MouseEvent): void => {\n    onMouseleaveCell();\n  });\n\n  handler.on(element, 'mousemove', (e) => {\n    const eventArgsSet = getCellEventArgsSet(e);\n    const { abstractPos, eventArgs } = eventArgsSet;\n    if (eventArgs) {\n      const beforeMouseCell = mouseEnterCell;\n      if (beforeMouseCell) {\n        grid.fireListeners(DG_EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);\n        if (beforeMouseCell.col !== eventArgs.col || beforeMouseCell.row !== eventArgs.row) {\n          const enterCell = {\n            col: eventArgs.col,\n            row: eventArgs.row\n          };\n          const outCell = onMouseoutCell(enterCell);\n          const leaveCell = onMouseleaveCell(enterCell);\n          onMouseenterCell(enterCell, leaveCell);\n          if (isMouseover) {\n            onMouseoverCell(enterCell, outCell);\n          }\n        } else if (isMouseover && !mouseOverCell) {\n          onMouseoverCell({\n            col: eventArgs.col,\n            row: eventArgs.row\n          });\n        }\n      } else {\n        const enterCell = {\n          col: eventArgs.col,\n          row: eventArgs.row\n        };\n        onMouseenterCell(enterCell);\n        if (isMouseover) {\n          onMouseoverCell(enterCell);\n        }\n        grid.fireListeners(DG_EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);\n      }\n    } else {\n      onMouseoutCell();\n      onMouseleaveCell();\n    }\n    if (grid[_].columnResizer.moving(e) || grid[_].cellSelector.moving(e)) {\n      return;\n    }\n    const { style } = element;\n    if (!abstractPos) {\n      if (style.cursor === 'col-resize') {\n        style.cursor = '';\n      }\n      return;\n    }\n    const resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);\n    if (resizeCol >= 0 && canResizeColumn(resizeCol)) {\n      style.cursor = 'col-resize';\n    } else {\n      if (style.cursor === 'col-resize') {\n        style.cursor = '';\n      }\n    }\n  });\n  handler.on(element, 'click', (e) => {\n    if (grid[_].columnResizer.lastMoving(e) || grid[_].cellSelector.lastMoving(e)) {\n      return;\n    }\n    if (!grid.hasListeners(DG_EVENT_TYPE.CLICK_CELL)) {\n      return;\n    }\n    const { eventArgs } = getCellEventArgsSet(e);\n    if (!eventArgs) {\n      return;\n    }\n    grid.fireListeners(DG_EVENT_TYPE.CLICK_CELL, eventArgs);\n  });\n  handler.on(element, 'contextmenu', (e) => {\n    if (!grid.hasListeners(DG_EVENT_TYPE.CONTEXTMENU_CELL)) {\n      return;\n    }\n    const { eventArgs } = getCellEventArgsSet(e);\n    if (!eventArgs) {\n      return;\n    }\n    grid.fireListeners(DG_EVENT_TYPE.CONTEXTMENU_CELL, eventArgs);\n  });\n  handler.on(element, 'dblclick', (e) => {\n    if (!grid.hasListeners(DG_EVENT_TYPE.DBLCLICK_CELL)) {\n      return;\n    }\n    const { eventArgs } = getCellEventArgsSet(e);\n    if (!eventArgs) {\n      return;\n    }\n    grid.fireListeners(DG_EVENT_TYPE.DBLCLICK_CELL, eventArgs);\n  });\n  grid[_].focusControl.onKeyDown((evt: KeydownEvent) => {\n    grid.fireListeners(DG_EVENT_TYPE.KEYDOWN, evt);\n  });\n  grid[_].selection.listen(DG_EVENT_TYPE.SELECTED_CELL, (data) => {\n    grid.fireListeners(DG_EVENT_TYPE.SELECTED_CELL, data, data.selected);\n  });\n\n  scrollable.onScroll((e) => {\n    _onScroll(grid, e);\n    grid.fireListeners(DG_EVENT_TYPE.SCROLL, { event: e });\n  });\n  grid[_].focusControl.onKeyDownMove((e) => {\n    _onKeyDownMove.call(grid, e);\n  });\n  grid.listen('copydata', (range) => {\n    const copyRange = grid.getCopyRangeInternal(range);\n    let copyValue = '';\n    for (let { row } = copyRange.start; row <= copyRange.end.row; row++) {\n      for (let { col } = copyRange.start; col <= copyRange.end.col; col++) {\n        const copyCellValue = grid.getCopyCellValue(col, row, copyRange);\n        if (typeof Promise !== 'undefined' && copyCellValue instanceof Promise) {\n          //\n        } else {\n          // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n          const strCellValue = `${copyCellValue}`;\n          if (/^\\[object .*\\]$/.exec(strCellValue)) {\n            //object \n          } else {\n            copyValue += strCellValue;\n          }\n        }\n\n        if (col < copyRange.end.col) {\n          copyValue += '\\t';\n        }\n      }\n      copyValue += '\\n';\n    }\n    return copyValue;\n  });\n  grid[_].focusControl.onCopy((_e: ClipboardEvent): string | void => array.find(grid.fireListeners('copydata', grid[_].selection.range), (r) => r != null));\n  grid[_].focusControl.onPaste(({ value, event }: { value: string; event: ClipboardEvent }) => {\n    const normalizeValue = value.replace(/\\r?\\n$/, '');\n    const { col, row } = grid[_].selection.select;\n    const multi = /[\\r\\n\\u2028\\u2029\\t]/.test(normalizeValue); // is multi cell values\n    let rangeBoxValues: PasteRangeBoxValues | null = null;\n    const pasteCellEvent: PasteCellEvent = {\n      col,\n      row,\n      value,\n      normalizeValue,\n      multi,\n      get rangeBoxValues(): PasteRangeBoxValues {\n        return rangeBoxValues ?? (rangeBoxValues = parsePasteRangeBoxValues(normalizeValue));\n      },\n      event\n    };\n    grid.fireListeners(DG_EVENT_TYPE.PASTE_CELL, pasteCellEvent);\n  });\n  grid[_].focusControl.onInput((value) => {\n    const { col, row } = grid[_].selection.select;\n    grid.fireListeners(DG_EVENT_TYPE.INPUT_CELL, { col, row, value });\n  });\n  grid[_].focusControl.onDelete((event) => {\n    const { col, row } = grid[_].selection.select;\n    grid.fireListeners(DG_EVENT_TYPE.DELETE_CELL, { col, row, event });\n  });\n  grid[_].focusControl.onFocus((e: FocusEvent) => {\n    grid.fireListeners(DG_EVENT_TYPE.FOCUS_GRID, e);\n    grid[_].focusedGrid = true;\n\n    const { col, row } = grid[_].selection.select;\n    grid.invalidateCell(col, row);\n  });\n  grid[_].focusControl.onBlur((e) => {\n    grid.fireListeners(DG_EVENT_TYPE.BLUR_GRID, e);\n    grid[_].focusedGrid = false;\n\n    const { col, row } = grid[_].selection.select;\n    grid.invalidateCell(col, row);\n  });\n}\n\n/** @private */\nfunction _getResizeColAt(grid: DrawGrid, abstractX: number, abstractY: number, offset = 5): number {\n  if (grid[_].frozenRowCount <= 0) {\n    return -1;\n  }\n  const frozenRect = _getFrozenRowsRect(grid)!;\n  if (!frozenRect.inPoint(abstractX, abstractY)) {\n    return -1;\n  }\n  const cell = grid.getCellAt(abstractX, abstractY);\n  const cellRect = grid.getCellRect(cell.col, cell.row);\n  if (abstractX < cellRect.left + offset) {\n    return cell.col - 1;\n  }\n  if (cellRect.right - offset < abstractX) {\n    return cell.col;\n  }\n  return -1;\n}\n\n/** @private */\nfunction _getVisibleRect(grid: DrawGrid): Rect {\n  const {\n    scroll: { left, top },\n    canvas: { width, height }\n  } = grid[_];\n  return new Rect(left, top, width, height);\n}\n\n/** @private */\nfunction _getScrollableVisibleRect(grid: DrawGrid): Rect {\n  let frozenColsWidth = 0;\n  if (grid[_].frozenColCount > 0) {\n    //\n    const frozenRect = _getFrozenColsRect(grid)!;\n    frozenColsWidth = frozenRect.width;\n  }\n  let frozenRowsHeight = 0;\n  if (grid[_].frozenRowCount > 0) {\n    //\n    const frozenRect = _getFrozenRowsRect(grid)!;\n    frozenRowsHeight = frozenRect.height;\n  }\n  return new Rect(grid[_].scrollable.scrollLeft + frozenColsWidth, grid[_].scrollable.scrollTop + frozenRowsHeight, grid[_].canvas.width - frozenColsWidth, grid[_].canvas.height - frozenRowsHeight);\n}\n\n/** @private */\nfunction _toRelativeRect(grid: DrawGrid, absoluteRect: Rect): Rect {\n  const rect = absoluteRect.copy();\n  const visibleRect = _getVisibleRect(grid);\n  rect.offsetLeft(-visibleRect.left);\n  rect.offsetTop(-visibleRect.top);\n\n  return rect;\n}\n\n//end private methods\n//\n//\n//\n//\n\n/**\n * managing mouse down moving\n * @private\n */\nclass BaseMouseDownMover {\n  protected _grid: DrawGrid;\n  private _handler: EventHandler;\n  private _events: {\n    mousemove?: EventListenerId;\n    mouseup?: EventListenerId;\n    touchmove?: EventListenerId;\n    touchend?: EventListenerId;\n    touchcancel?: EventListenerId;\n  };\n  private _started: boolean;\n  private _moved: boolean;\n  private _mouseEndPoint?: { x: number; y: number } | null;\n\n  constructor(grid: DrawGrid) {\n    this._grid = grid;\n    this._handler = new EventHandler();\n    this._events = {};\n    this._started = false;\n    this._moved = false;\n  }\n\n  moving(_e: MouseEvent | TouchEvent): boolean {\n    return !!this._started;\n  }\n\n  lastMoving(e: MouseEvent | TouchEvent): boolean {\n    // mouseupclick\n    if (this.moving(e)) {\n      return true;\n    }\n    const last = this._mouseEndPoint;\n    if (!last) {\n      return false;\n    }\n    const pt = _getMouseAbstractPoint(this._grid, e);\n    return pt != null && pt.x === last.x && pt.y === last.y;\n  }\n\n  protected _bindMoveAndUp(e: MouseEvent | TouchEvent): void {\n    const events = this._events;\n    const handler = this._handler;\n    if (!isTouchEvent(e)) {\n      events.mousemove = handler.on(document.body, 'mousemove', (e) => this._mouseMove(e));\n      events.mouseup = handler.on(document.body, 'mouseup', (e) => this._mouseUp(e));\n    } else {\n      events.touchmove = handler.on(document.body, 'touchmove', (e) => this._mouseMove(e), { passive: false });\n      events.touchend = handler.on(document.body, 'touchend', (e) => this._mouseUp(e));\n      events.touchcancel = handler.on(document.body, 'touchcancel', (e) => this._mouseUp(e));\n    }\n    this._started = true;\n    this._moved = false;\n  }\n\n  private _mouseMove(e: MouseEvent | TouchEvent): void {\n    if (!isTouchEvent(e)) {\n      if (getMouseButtons(e) !== 1) {\n        this._mouseUp(e);\n        return;\n      }\n    }\n    this._moved = this._moveInternal(e) || this._moved; /*calculation on after*/\n\n    cancelEvent(e);\n  }\n\n  protected _moveInternal(_e: MouseEvent | TouchEvent): boolean {\n    //protected\n    return false;\n  }\n\n  private _mouseUp(e: MouseEvent | TouchEvent): void {\n    const events = this._events;\n    const handler = this._handler;\n    handler.off(events.mousemove);\n    handler.off(events.touchmove);\n    handler.off(events.mouseup);\n    handler.off(events.touchend);\n    // handler.off(this._events.mouseleave);\n    handler.off(events.touchcancel);\n\n    this._started = false;\n\n    this._upInternal(e);\n\n    // mouseupclick\n    if (this._moved) {\n      //\n      this._mouseEndPoint = _getMouseAbstractPoint(this._grid, e);\n      setTimeout(() => {\n        this._mouseEndPoint = null;\n      }, 10);\n    }\n  }\n\n  protected _upInternal(_e: MouseEvent | TouchEvent): void {\n    //protected\n  }\n\n  dispose(): void {\n    this._handler.dispose();\n  }\n}\n\n/**\n * managing cell selection operation with mouse\n * @private\n */\nclass CellSelector extends BaseMouseDownMover {\n  private _cell?: CellAddress;\n\n  start(e: MouseEvent | TouchEvent): void {\n    const cell = this._getTargetCell(e);\n    if (!cell) {\n      return;\n    }\n    _moveFocusCell.call(this._grid, cell.col, cell.row, e.shiftKey);\n\n    this._bindMoveAndUp(e);\n\n    this._cell = cell;\n\n    cancelEvent(e);\n    _vibrate(e);\n  }\n\n  select(e: MouseEvent | TouchEvent): void {\n    const cell = this._getTargetCell(e);\n    if (!cell) {\n      return;\n    }\n    _moveFocusCell.call(this._grid, cell.col, cell.row, e.shiftKey);\n    this._cell = cell;\n  }\n\n  protected _moveInternal(e: MouseEvent | TouchEvent): boolean {\n    const cell = this._getTargetCell(e);\n    if (!cell) {\n      return false;\n    }\n    const { col: oldCol, row: oldRow } = this._cell!;\n    const { col: newCol, row: newRow } = cell;\n    if (oldCol === newCol && oldRow === newRow) {\n      return false;\n    }\n    const grid = this._grid;\n    _moveFocusCell.call(grid, newCol, newRow, true);\n\n    //make visible\n    const makeVisibleCol = ((): number => {\n      if (newCol < oldCol && 0 < newCol) {\n        // move left\n        return newCol - 1;\n      } else if (oldCol < newCol && newCol + 1 < grid.colCount) {\n        // move right\n        return newCol + 1;\n      }\n      return newCol;\n    })();\n    const makeVisibleRow = ((): number => {\n      if (newRow < oldRow && 0 < newRow) {\n        // move up\n        return newRow - 1;\n      } else if (oldRow < newRow && newRow + 1 < grid.rowCount) {\n        // move down\n        return newRow + 1;\n      }\n      return newRow;\n    })();\n    if (makeVisibleCol !== newCol || makeVisibleRow !== newRow) {\n      grid.makeVisibleCell(makeVisibleCol, makeVisibleRow);\n    }\n    this._cell = cell;\n    return true;\n  }\n\n  private _getTargetCell(e: MouseEvent | TouchEvent): CellAddress | null {\n    const grid = this._grid;\n    const abstractPos = _getMouseAbstractPoint(grid, e);\n    if (!abstractPos) {\n      return null;\n    }\n    const cell = grid.getCellAt(abstractPos.x, abstractPos.y);\n    if (cell.col < 0 || cell.row < 0) {\n      return null;\n    }\n    return cell;\n  }\n}\n\n/**\n * managing row width changing operation with mouse\n * @private\n */\nclass ColumnResizer extends BaseMouseDownMover {\n  private _targetCol: number;\n  private _x = -1;\n  private _preX = -1;\n  private _invalidateAbsoluteLeft = -1;\n\n  constructor(grid: DrawGrid) {\n    super(grid);\n    this._targetCol = -1;\n  }\n\n  start(col: number, e: MouseEvent | TouchEvent): void {\n    let pageX;\n    if (!isTouchEvent(e)) {\n      ({ pageX } = e);\n    } else {\n      ({ pageX } = e.changedTouches[0]);\n    }\n\n    this._x = pageX;\n    this._preX = 0;\n\n    this._bindMoveAndUp(e);\n\n    this._targetCol = col;\n    this._invalidateAbsoluteLeft = _getColsWidth(this._grid, 0, col - 1);\n\n    cancelEvent(e);\n    _vibrate(e);\n  }\n\n  protected _moveInternal(e: MouseEvent | TouchEvent): boolean {\n    const pageX = isTouchEvent(e) ? e.changedTouches[0].pageX : e.pageX;\n\n    const x = pageX - this._x;\n    const moveX = x - this._preX;\n    this._preX = x;\n    const pre = this._grid.getColWidth(this._targetCol);\n    let afterSize = _adjustColWidth(this._grid, this._targetCol, pre + moveX);\n    if (afterSize < 10 && moveX < 0) {\n      afterSize = 10;\n    }\n    _storeAutoColWidthExprs(this._grid);\n    _setColWidth(this._grid, this._targetCol, afterSize);\n\n    const rect = _getVisibleRect(this._grid);\n    rect.left = this._invalidateAbsoluteLeft;\n    _invalidateRect(this._grid, rect);\n\n    this._grid.fireListeners(DG_EVENT_TYPE.RESIZE_COLUMN, {\n      col: this._targetCol\n    });\n\n    return true;\n  }\n\n  protected _upInternal(_e: MouseEvent | TouchEvent): void {\n    const grid = this._grid;\n    if (grid.updateScroll()) {\n      grid.invalidate();\n    }\n  }\n}\n\n/** @private */\nfunction setSafeInputValue(input: HTMLInputElement, value: string): void {\n  const { type } = input;\n  input.type = '';\n  input.value = value;\n  if (type) {\n    input.type = type;\n  }\n}\n\n/**\n * Manage focus\n * @private\n */\nclass FocusControl extends EventTarget {\n  private _grid: DrawGrid;\n  private _scrollable: Scrollable;\n  private _handler: EventHandler;\n  private _input: HTMLInputElement;\n  private _isComposition?: boolean;\n  private _compositionEnd?: number;\n  private _inputStatus?: { [key: string]: string };\n  private _keyDownMoveCallback?: KeyboardEventListener;\n\n  constructor(grid: DrawGrid, parentElement: HTMLElement, scrollable: Scrollable) {\n    super();\n    this._grid = grid;\n    this._scrollable = scrollable;\n    const handler = (this._handler = new EventHandler());\n    const input = (this._input = document.createElement('input'));\n    input.classList.add('grid-focus-control');\n    input.readOnly = true;\n    parentElement.appendChild(input);\n\n    handler.on(input, 'compositionstart', (_e: Event): void => {\n      input.classList.add('composition');\n      input.style.font = grid.font || '16px sans-serif';\n      this._isComposition = true;\n      if (this._compositionEnd) {\n        clearTimeout(this._compositionEnd);\n        delete this._compositionEnd;\n      }\n      grid.focus();\n    });\n    let lastInputValue: string | undefined;\n    const inputClear = (storeLastInputValue: boolean): void => {\n      lastInputValue = input.value;\n      if (this._isComposition) {\n        return;\n      }\n\n      if (lastInputValue !== '') {\n        setSafeInputValue(input, '');\n      }\n      if (!storeLastInputValue) {\n        lastInputValue = '';\n      }\n    };\n\n    const handleCompositionEnd = (): void => {\n      this._isComposition = false;\n      input.classList.remove('composition');\n      input.style.font = '';\n      const { value } = input;\n\n      inputClear(false);\n\n      if (!input.readOnly) {\n        this.fireListeners('input', value);\n      }\n\n      if (this._compositionEnd) {\n        clearTimeout(this._compositionEnd);\n        delete this._compositionEnd;\n      }\n    };\n    handler.on(input, 'compositionend', (_e: Event): void => {\n      this._compositionEnd = window.setTimeout(handleCompositionEnd, 1);\n    });\n    handler.on(input, 'keypress', (e) => {\n      if (this._isComposition) {\n        return;\n      }\n      if (!input.readOnly && e.key && e.key.length === 1) {\n        if (e.ctrlKey || e.metaKey) {\n          if (e.key === 'c') {\n            //copy! for Firefox & Safari\n          } else if (e.key === 'v') {\n            //paste! for Firefox & Safari\n          }\n        } else {\n          if (e.key === ' ') {\n            // Since the full-width space cannot be determined, it is processed by \"input\".\n            return;\n          }\n          this.fireListeners('input', e.key);\n          cancelEvent(e);\n        }\n      }\n      inputClear(true);\n    });\n    handler.on(input, 'keydown', (e) => {\n      if (this._isComposition) {\n        if (this._compositionEnd) {\n          handleCompositionEnd();\n          cancelEvent(e);\n        }\n        return;\n      }\n      const keyCode = getKeyCode(e);\n      let stopCellMove = false;\n      const evt: KeydownEvent = {\n        keyCode,\n        event: e,\n        stopCellMoving() {\n          stopCellMove = true;\n        }\n      };\n      this.fireListeners('keydown', evt);\n\n      if (!input.readOnly && lastInputValue) {\n        // for Safari\n        this.fireListeners('input', lastInputValue);\n      }\n      if (!stopCellMove) this.fireKeyDownMove(keyCode, e);\n      if (this._grid.keyboardOptions?.deleteCellValueOnDel && (keyCode === KEY_DEL || keyCode === KEY_BS)) {\n        this.fireListeners('delete', e);\n      }\n\n      inputClear(true);\n    });\n    handler.on(input, 'keyup', (_e) => {\n      if (this._isComposition) {\n        if (this._compositionEnd) {\n          handleCompositionEnd();\n        }\n      }\n      inputClear(true);\n    });\n\n    handler.on(input, 'input', (e: InputEvent) => {\n      if (e.data === ' ' || e.data === '') {\n        // Since the full-width space cannot be determined on \"keypress\", it is processed by \"input\".\n        this.fireListeners('input', e.data);\n      }\n      inputClear(true);\n    });\n    if (browser.IE) {\n      handler.on(document, 'keydown', (e) => {\n        if (e.target !== input) {\n          return;\n        }\n        const keyCode = getKeyCode(e);\n        if (keyCode === KEY_ALPHA_C && e.ctrlKey) {\n          // When text is not selected copy-event is not emit, on IE.\n          setSafeInputValue(input, 'dummy');\n          input.select();\n          setTimeout(() => {\n            setSafeInputValue(input, '');\n          }, 100);\n        } else if (keyCode === KEY_ALPHA_V && e.ctrlKey) {\n          // When input is read-only paste-event is not emit, on IE.\n          if (input.readOnly) {\n            input.readOnly = false;\n            setTimeout(() => {\n              input.readOnly = true;\n              setSafeInputValue(input, '');\n            }, 10);\n          }\n        }\n      });\n    }\n    if (browser.Edge) {\n      handler.once(document, 'keydown', (e) => {\n        if (!isDescendantElement(parentElement, e.target as HTMLElement)) {\n          return;\n        }\n        // When the input has focus on the first page opening, the paste-event and copy-event is not emit, on Edge.\n        const dummyInput = document.createElement('input');\n        grid.getElement().appendChild(dummyInput);\n        dummyInput.focus();\n        input.focus();\n        dummyInput.parentElement?.removeChild(dummyInput);\n      });\n    }\n    handler.on(document, 'paste', (e) => {\n      if (!isDescendantElement(parentElement, e.target)) {\n        return;\n      }\n      let pasteText: string | undefined = undefined;\n      if (browser.IE) {\n        // IE\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        pasteText = (window as any).clipboardData.getData('Text');\n      } else {\n        const { clipboardData } = e;\n        if (clipboardData.items) {\n          // Chrome & Firefox & Edge\n          pasteText = clipboardData.getData('text/plain');\n        } else {\n          // Safari\n          if (-1 !== Array.prototype.indexOf.call(clipboardData.types, 'text/plain')) {\n            pasteText = clipboardData.getData('Text');\n          }\n        }\n      }\n      if (pasteText != null && pasteText.length) {\n        this.fireListeners('paste', { value: pasteText, event: e });\n      }\n    });\n    handler.on(document, 'copy', (e) => {\n      if (this._isComposition) {\n        return;\n      }\n      if (!isDescendantElement(parentElement, e.target)) {\n        return;\n      }\n      setSafeInputValue(input, '');\n      const data = array.find(this.fireListeners('copy'), (r) => r != null);\n      if (data != null) {\n        cancelEvent(e);\n        if (browser.IE) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (window as any).clipboardData.setData('Text', data); // IE\n        } else {\n          e.clipboardData.setData('text/plain', data); // Chrome, Firefox\n        }\n      }\n    });\n    handler.on(input, 'focus', (e) => {\n      this.fireListeners('focus', e);\n    });\n    handler.on(input, 'blur', (e) => {\n      this.fireListeners('blur', e);\n    });\n  }\n\n  fireKeyDownMove(keyCode: number, e: KeyboardEvent): void {\n    const fn = this._keyDownMoveCallback;\n    if (!fn) {\n      return;\n    }\n    if (this._isComposition) {\n      return;\n    }\n    if (keyCode === KEY_LEFT || keyCode === KEY_UP || keyCode === KEY_RIGHT || keyCode === KEY_DOWN || keyCode === KEY_HOME || keyCode === KEY_END) {\n      fn(e);\n    } else if (this._grid.keyboardOptions?.moveCellOnTab && keyCode === KEY_TAB) {\n      fn(e);\n    } else if (this._grid.keyboardOptions?.moveCellOnEnter && keyCode === KEY_ENTER) {\n      fn(e);\n    } else if (this._grid.keyboardOptions?.selectAllOnCtrlA && keyCode === KEY_ALPHA_A && (e.ctrlKey || e.metaKey)) {\n      fn(e);\n    }\n  }\n\n  onKeyDownMove(fn: KeyboardEventListener): void {\n    this._keyDownMoveCallback = fn;\n  }\n\n  onKeyDown(fn: (e: KeydownEvent) => void): EventListenerId {\n    return this.listen('keydown', fn);\n  }\n\n  onInput(fn: (value: string) => void): EventListenerId {\n    return this.listen('input', fn);\n  }\n\n  onDelete(fn: (e: KeyboardEvent) => void): EventListenerId {\n    return this.listen('delete', fn);\n  }\n\n  onCopy(fn: (e: ClipboardEvent) => void): EventListenerId {\n    return this.listen('copy', fn);\n  }\n\n  onPaste(fn: (e: { value: string; event: ClipboardEvent }) => void): EventListenerId {\n    return this.listen('paste', fn);\n  }\n\n  onFocus(fn: (e: FocusEvent) => void): EventListenerId {\n    return this.listen('focus', fn);\n  }\n\n  onBlur(fn: (e: FocusEvent) => void): EventListenerId {\n    return this.listen('blur', fn);\n  }\n\n  focus(): void {\n    // this._input.value = '';\n    this._input.focus();\n  }\n\n  setFocusRect(rect: Rect): void {\n    const input = this._input;\n    const top = this._scrollable.calcTop(rect.top);\n    input.style.top = `${(top - style.getScrollBarSize()).toFixed()}px`; //position:relative IE position:relative\n    input.style.left = `${rect.left.toFixed()}px`;\n    input.style.width = `${rect.width.toFixed()}px`;\n    input.style.height = `${rect.height.toFixed()}px`;\n  }\n\n  get editMode(): boolean {\n    return !this._input.readOnly;\n  }\n\n  set editMode(editMode: boolean) {\n    this._input.readOnly = !editMode;\n  }\n\n  resetInputStatus(): void {\n    const el = this._input;\n    if (!el.classList.contains('grid-focus-control--stored-status')) {\n      return;\n    }\n    const composition = el.classList.contains('composition');\n\n    const atts = el.attributes;\n    const removeNames = [];\n    for (let i = 0, n = atts.length; i < n; i++) {\n      const att = atts[i];\n      if (!this._inputStatus?.hasOwnProperty(att.nodeName)) {\n        removeNames.push(att.name);\n      }\n    }\n    removeNames.forEach((removeName) => {\n      el.removeAttribute(removeName);\n    });\n    for (const name in this._inputStatus) {\n      el.setAttribute(name, this._inputStatus[name]);\n    }\n    if (composition) {\n      el.classList.add('composition');\n      el.style.font = this._grid.font || '16px sans-serif';\n    } else {\n      el.classList.remove('composition');\n    }\n    el.classList.remove('grid-focus-control--stored-status');\n  }\n\n  storeInputStatus(): void {\n    const el = this._input;\n    if (el.classList.contains('grid-focus-control--stored-status')) {\n      return;\n    }\n    const inputStatus: FocusControl['_inputStatus'] = (this._inputStatus = {});\n    const atts = el.attributes;\n    for (let i = 0, n = atts.length; i < n; i++) {\n      const att = atts[i];\n      inputStatus[att.name] = att.value;\n    }\n    el.classList.add('grid-focus-control--stored-status');\n  }\n\n  setDefaultInputStatus(): void {\n    // \n    // this._input.style.font = this._grid.font || '16px sans-serif';\n  }\n\n  get input(): HTMLInputElement {\n    return this._input;\n  }\n\n  dispose(): void {\n    super.dispose();\n    this._handler.dispose();\n  }\n}\n\n/**\n * Selected area management\n */\nclass Selection extends EventTarget {\n  private _grid: DrawGrid;\n  private _sel: CellAddress;\n  private _focus: CellAddress;\n  private _start: CellAddress;\n  private _end: CellAddress;\n  private _isWraped?: boolean;\n\n  constructor(grid: DrawGrid) {\n    super();\n    this._grid = grid;\n\n    this._sel = { col: 0, row: 0 };\n    this._focus = { col: 0, row: 0 };\n\n    this._start = { col: 0, row: 0 };\n    this._end = { col: 0, row: 0 };\n  }\n\n  get range(): CellRange {\n    const start = this._start;\n    const end = this._end;\n    const startCol = Math.min(start.col, end.col);\n    const startRow = Math.min(start.row, end.row);\n    const endCol = Math.max(start.col, end.col);\n    const endRow = Math.max(start.row, end.row);\n    return {\n      start: {\n        col: startCol,\n        row: startRow\n      },\n      end: {\n        col: endCol,\n        row: endRow\n      }\n    };\n  }\n\n  set range(range) {\n    const startCol = Math.min(range.start.col, range.end.col);\n    const startRow = Math.min(range.start.row, range.end.row);\n    const endCol = Math.max(range.start.col, range.end.col);\n    const endRow = Math.max(range.start.row, range.end.row);\n\n    this._wrapFireSelectedEvent(() => {\n      this._sel = {\n        col: startCol,\n        row: startRow\n      };\n      this._focus = {\n        col: startCol,\n        row: startRow\n      };\n      this._start = {\n        col: startCol,\n        row: startRow\n      };\n      this._end = {\n        col: endCol,\n        row: endRow\n      };\n\n      _updatedSelection.call(this._grid);\n    });\n  }\n\n  get focus(): CellAddress {\n    const { col, row } = this._focus;\n    return { col, row };\n  }\n\n  get select(): CellAddress {\n    const { col, row } = this._sel;\n    return { col, row };\n  }\n\n  set select(cell: CellAddress) {\n    this._wrapFireSelectedEvent(() => {\n      const { col = 0, row = 0 } = cell;\n      this._setSelectCell(col, row);\n      this._setFocusCell(col, row, true);\n\n      _updatedSelection.call(this._grid);\n    });\n  }\n\n  _setSelectCell(col: number, row: number): void {\n    this._wrapFireSelectedEvent(() => {\n      this._sel = { col, row };\n      this._start = { col, row };\n    });\n  }\n\n  _setFocusCell(col: number, row: number, keepSelect: boolean): void {\n    this._wrapFireSelectedEvent(() => {\n      if (!keepSelect) {\n        this._setSelectCell(col, row);\n      }\n      this._focus = { col, row };\n      this._end = { col, row };\n    });\n  }\n\n  _wrapFireSelectedEvent(callback: AnyFunction): void {\n    if (this._isWraped) {\n      callback();\n    } else {\n      this._isWraped = true;\n      try {\n        const before: BeforeSelectedCellEvent = {\n          col: this._sel.col,\n          row: this._sel.row,\n          selected: false,\n          after: null as never\n        };\n        callback();\n        const after: AfterSelectedCellEvent = {\n          col: this._sel.col,\n          row: this._sel.row,\n          selected: true,\n          before: {\n            col: before.col,\n            row: before.row\n          }\n        };\n        before.after = {\n          col: after.col,\n          row: after.row\n        };\n        this.fireListeners(DG_EVENT_TYPE.SELECTED_CELL, before);\n        this.fireListeners(DG_EVENT_TYPE.SELECTED_CELL, after);\n      } finally {\n        this._isWraped = false;\n      }\n    }\n  }\n\n  _updateGridRange(): boolean {\n    const { rowCount, colCount } = this._grid;\n    const points = [this._sel, this._focus, this._start, this._end];\n    let needChange = false;\n    for (let i = 0; i < points.length; i++) {\n      if (colCount <= points[i].col || rowCount <= points[i].row) {\n        needChange = true;\n        break;\n      }\n    }\n    if (!needChange) {\n      return false;\n    }\n    this._wrapFireSelectedEvent(() => {\n      points.forEach((p) => {\n        p.col = Math.min(colCount - 1, p.col);\n        p.row = Math.min(rowCount - 1, p.row);\n      });\n    });\n    return true;\n  }\n}\n\n/** @private */\ntype DrawLayerFunction = (ctx: CanvasRenderingContext2D) => void;\n\n/**\n * This class manages the drawing process for each layer\n */\n/** @private */\nclass DrawLayers {\n  private _layers: { [level: number]: DrawLayer };\n\n  constructor() {\n    this._layers = {};\n  }\n\n  addDraw(level: number, fn: DrawLayerFunction): void {\n    const l = this._layers[level] || (this._layers[level] = new DrawLayer(level));\n    l.addDraw(fn);\n  }\n\n  draw(ctx: CanvasRenderingContext2D): void {\n    const list = [];\n    for (const k in this._layers) {\n      list.push(this._layers[k]);\n    }\n    list.sort((a, b) => a.level - b.level);\n    list.forEach((l) => l.draw(ctx));\n  }\n}\n\n/** @private */\nclass DrawLayer {\n  private _level: number;\n  private _list: DrawLayerFunction[];\n\n  constructor(level: number) {\n    this._level = level;\n    this._list = [];\n  }\n\n  get level(): number {\n    return this._level;\n  }\n\n  addDraw(fn: DrawLayerFunction): void {\n    this._list.push(fn);\n  }\n\n  draw(ctx: CanvasRenderingContext2D): void {\n    this._list.forEach((fn) => {\n      ctx.save();\n      try {\n        fn(ctx);\n      } finally {\n        ctx.restore();\n      }\n    });\n  }\n}\n\n/**\n * Context of cell drawing\n * @private\n */\nclass DrawCellContext implements CellContext {\n  private _col: number;\n  private _row: number;\n  private _mode: number;\n  private _ctx: CanvasRenderingContext2D | null;\n  private _rect: Rect | null;\n  private _drawRect: Rect | null;\n  private _drawing: boolean;\n  private _selection: Selection;\n  private _drawLayers: DrawLayers;\n  private _childContexts: DrawCellContext[];\n  private _cancel?: boolean;\n  private _grid?: DrawGrid;\n  private _onTerminate?: () => void;\n  private _rectFilter: ((base: Rect) => Rect) | null = null;\n  //  private _grid: any;\n  //  private _onTerminate: any;\n  /**\n   * constructor\n   * @param {number} col index of column\n   * @param {number} row index of row\n   * @param {CanvasRenderingContext2D} ctx context\n   * @param {Rect} rect rect of cell area\n   * @param {Rect} drawRect rect of drawing area\n   * @param {boolean} drawing `true` if drawing is in progress\n   * @param {object} selection the selection\n   * @param {Array} drawLayers array of draw layers\n   * @private\n   */\n  constructor(col: number, row: number, ctx: CanvasRenderingContext2D, rect: Rect | null, drawRect: Rect | null, drawing: boolean, selection: Selection, drawLayers: DrawLayers) {\n    this._col = col;\n    this._row = row;\n    this._mode = 0;\n    this._ctx = ctx;\n    this._rect = rect;\n    this._drawRect = drawRect;\n    this._drawing = drawing;\n    this._selection = selection;\n    this._drawLayers = drawLayers;\n    this._childContexts = [];\n  }\n\n  get drawing(): boolean {\n    if (this._mode === 0) {\n      return this._drawing;\n    } else {\n      return true;\n    }\n  }\n\n  get row(): number {\n    return this._row;\n  }\n\n  get col(): number {\n    return this._col;\n  }\n\n  cancel(): void {\n    this._cancel = true;\n    this._childContexts.forEach((ctx) => {\n      ctx.cancel();\n    });\n  }\n\n  /**\n   * select status.\n   * @return {object} select status\n   */\n  getSelection(): { select: CellAddress; range: CellRange } {\n    return {\n      select: this._selection.select,\n      range: this._selection.range\n    };\n  }\n\n  /**\n   * Canvas context.\n   * @return {CanvasRenderingContext2D} Canvas context.\n   */\n  getContext(): CanvasRenderingContext2D {\n    if (this._mode === 0) {\n      return this._ctx!;\n    } else {\n      return _getInitContext.call(this._grid!);\n    }\n  }\n\n  /**\n   * Rectangle of cell.\n   * @return {Rect} rect Rectangle of cell.\n   */\n  getRect(): Rect {\n    const rectFilter = this._rectFilter;\n    return rectFilter ? rectFilter(this._getRectInternal()) : this._getRectInternal();\n  }\n\n  setRectFilter(rectFilter: (base: Rect) => Rect): void {\n    this._rectFilter = rectFilter;\n  }\n\n  /**\n   * Rectangle of Drawing range.\n   * @return {Rect} Rectangle of Drawing range.\n   */\n  getDrawRect(): Rect | null {\n    if (this._cancel) {\n      return null;\n    }\n    if (this._mode === 0) {\n      return this._drawRect;\n    } else {\n      if (this._isOutOfRange()) {\n        return null;\n      }\n\n      const absoluteRect = this._grid!.getCellRect(this._col, this._row);\n      return this._toRelativeDrawRect(absoluteRect);\n    }\n  }\n\n  private _isOutOfRange(): boolean {\n    const { colCount, rowCount } = this._grid!;\n    return colCount <= this._col || rowCount <= this._row;\n  }\n\n  /**\n   * get Context of current state\n   * @return {DrawCellContext} current DrawCellContext.\n   */\n  toCurrentContext(): DrawCellContext {\n    if (this._mode === 0) {\n      return this;\n    } else {\n      const absoluteRect = this._grid!.getCellRect(this._col, this._row);\n      const rect = _toRelativeRect(this._grid!, absoluteRect);\n      const drawRect = this._isOutOfRange() ? null : this._toRelativeDrawRect(absoluteRect);\n      const context = new DrawCellContext(this._col, this._row, this.getContext(), rect, drawRect, this.drawing, this._selection, this._drawLayers);\n      // toCurrentContext  toCurrentContext\n      context.toCurrentContext = this.toCurrentContext.bind(this);\n      this._childContexts.push(context);\n      if (this._cancel) {\n        context.cancel();\n      }\n      context._rectFilter = this._rectFilter;\n      return context;\n    }\n  }\n\n  addLayerDraw(level: number, fn: DrawLayerFunction): void {\n    this._drawLayers.addDraw(level, fn);\n  }\n\n  private _toRelativeDrawRect(absoluteRect: Rect): Rect | null {\n    const visibleRect = _getVisibleRect(this._grid!);\n    let rect = absoluteRect.copy();\n    if (!rect.intersection(visibleRect)) {\n      return null;\n    }\n\n    const grid = this._grid!;\n\n    const isFrozenCell = grid.isFrozenCell(this._col, this._row);\n    if (grid.frozenColCount >= 0 && (!isFrozenCell || !isFrozenCell.col)) {\n      const fRect = grid.getCellRect(grid.frozenColCount - 1, this._row);\n      rect = Rect.bounds(Math.max(rect.left, fRect.right), rect.top, rect.right, rect.bottom);\n    }\n    if (grid.frozenRowCount >= 0 && (!isFrozenCell || !isFrozenCell.row)) {\n      const fRect = grid.getCellRect(this._col, grid.frozenRowCount - 1);\n      rect = Rect.bounds(rect.left, Math.max(rect.top, fRect.bottom), rect.right, rect.bottom);\n    }\n\n    if (!rect.intersection(visibleRect)) {\n      return null;\n    }\n    rect.offsetLeft(-visibleRect.left);\n    rect.offsetTop(-visibleRect.top);\n\n    return rect;\n  }\n\n  _delayMode(grid: DrawGrid, onTerminate: () => void): void {\n    this._mode = 1;\n    this._ctx = null;\n    this._rect = null;\n    this._drawRect = null;\n    this._grid = grid;\n    this._onTerminate = onTerminate;\n  }\n\n  /**\n   * terminate\n   * @return {void}\n   */\n  terminate(): void {\n    if (this._mode !== 0) {\n      this._onTerminate?.();\n    }\n  }\n\n  private _getRectInternal(): Rect {\n    if (this._mode === 0) {\n      return this._rect!;\n    } else {\n      if (this._rect) {\n        return this._rect;\n      }\n      return this._grid!.getCellRelativeRect(this._col, this._row);\n    }\n  }\n}\n\n/** @protected */\ninterface DrawGridProtected {\n  element: HTMLElement;\n  scrollable: Scrollable;\n  handler: EventHandler;\n  selection: Selection;\n  focusControl: FocusControl;\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n  rowCount: number;\n  colCount: number;\n  frozenColCount: number;\n  frozenRowCount: number;\n  defaultRowHeight: number;\n  defaultColWidth: string | number;\n  font?: string;\n  underlayBackgroundColor?: string;\n  keyboardOptions?: DrawGridKeyboardOptions;\n  disableColumnResize?: boolean;\n\n  rowHeightsMap: NumberMap<number>;\n  colWidthsMap: NumberMap<string | number>;\n  colWidthsLimit: {\n    [col: number]: {\n      max?: string | number;\n      min?: string | number;\n    };\n  };\n  calcWidthContext: {\n    _: DrawGridProtected;\n    full: number;\n    em: number;\n  };\n\n  columnResizer: ColumnResizer;\n  cellSelector: CellSelector;\n\n  drawCells: { [row: number]: { [col: number]: DrawCellContext } };\n  cellTextOverflows: { [at: string]: string };\n  focusedGrid: boolean;\n\n  config:\n  | {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    [name: string]: any;\n  }\n  | undefined;\n  scroll: {\n    left: number;\n    top: number;\n  };\n  disposables?: { dispose(): void }[] | null;\n}\n\nexport { DrawGridProtected };\n\nexport interface DrawGridConstructorOptions {\n  rowCount?: number;\n  colCount?: number;\n  frozenColCount?: number;\n  frozenRowCount?: number;\n  /**\n   * Default grid row height. default 40\n   */\n  defaultRowHeight?: number;\n  /**\n   * Default grid col width. default 80\n   */\n  defaultColWidth?: string | number;\n  font?: string;\n  underlayBackgroundColor?: string;\n  keyboardOptions?: DrawGridKeyboardOptions;\n  /**\n   * Canvas parent element\n   */\n  parentElement?: HTMLElement | null;\n  /**\n   * Disable column resizing\n   */\n  disableColumnResize?: boolean;\n}\n\n/** @private */\nconst protectedKey = _;\n\n/**\n * DrawGrid\n * @classdesc cheetahGrid.core.DrawGrid\n * @memberof cheetahGrid.core\n */\nexport abstract class DrawGrid extends EventTarget implements DrawGridAPI {\n  protected [protectedKey]: DrawGridProtected;\n\n  static get EVENT_TYPE(): typeof DG_EVENT_TYPE {\n    return DG_EVENT_TYPE;\n  }\n\n  constructor(options: DrawGridConstructorOptions = {}) {\n    super();\n    const {\n      rowCount = 10,\n      colCount = 10,\n      frozenColCount = 0,\n      frozenRowCount = 0,\n      defaultRowHeight = 40,\n      defaultColWidth = 80,\n      font,\n      underlayBackgroundColor,\n      keyboardOptions,\n      parentElement,\n      disableColumnResize\n    } = options;\n    const protectedSpace = (this[_] = {} as DrawGridProtected);\n    style.initDocument();\n    protectedSpace.element = createRootElement();\n    protectedSpace.scrollable = new Scrollable();\n    protectedSpace.handler = new EventHandler();\n    protectedSpace.selection = new Selection(this);\n    protectedSpace.focusControl = new FocusControl(this, protectedSpace.scrollable.getElement(), protectedSpace.scrollable);\n\n    protectedSpace.canvas = hiDPI.transform(document.createElement('canvas'));\n    protectedSpace.context = protectedSpace.canvas.getContext('2d', {\n      alpha: false\n    })!;\n\n    protectedSpace.rowCount = rowCount;\n    protectedSpace.colCount = colCount;\n    protectedSpace.frozenColCount = frozenColCount;\n    protectedSpace.frozenRowCount = frozenRowCount;\n\n    protectedSpace.defaultRowHeight = defaultRowHeight;\n    protectedSpace.defaultColWidth = defaultColWidth;\n\n    protectedSpace.font = font;\n    protectedSpace.underlayBackgroundColor = underlayBackgroundColor;\n\n    protectedSpace.keyboardOptions = keyboardOptions;\n    protectedSpace.disableColumnResize = disableColumnResize;\n\n    /////\n    protectedSpace.rowHeightsMap = new NumberMap();\n    protectedSpace.colWidthsMap = new NumberMap();\n    protectedSpace.colWidthsLimit = {};\n    protectedSpace.calcWidthContext = {\n      _: protectedSpace,\n      get full(): number {\n        return this._.canvas.width;\n      },\n      get em(): number {\n        return getFontSize(this._.context, this._.font).width;\n      }\n    };\n\n    protectedSpace.columnResizer = new ColumnResizer(this);\n    protectedSpace.cellSelector = new CellSelector(this);\n\n    protectedSpace.drawCells = {};\n    protectedSpace.cellTextOverflows = {};\n    protectedSpace.focusedGrid = false;\n\n    protectedSpace.element.appendChild(protectedSpace.canvas);\n    protectedSpace.element.appendChild(protectedSpace.scrollable.getElement());\n    protectedSpace.scroll = {\n      left: 0,\n      top: 0\n    };\n    this.updateScroll();\n    if (parentElement) {\n      parentElement.appendChild(protectedSpace.element);\n      this.updateSize();\n    } else {\n      this.updateSize();\n    }\n    _bindEvents.call(this);\n    this.bindEventsInternal();\n  }\n\n  /**\n   * Get root element.\n   * @returns {HTMLElement} root element\n   */\n  getElement(): HTMLElement {\n    return this[_].element;\n  }\n\n  /**\n   * Get canvas element.\n   */\n  get canvas(): HTMLCanvasElement {\n    return this[_].canvas;\n  }\n\n  /**\n   * Focus the grid.\n   * @return {void}\n   */\n  focus(): void {\n    const { col, row } = this[_].selection.select;\n    this.focusCell(col, row);\n  }\n\n  hasFocusGrid(): boolean {\n    return this[_].focusedGrid;\n  }\n\n  /**\n   * Get the selection instance.\n   */\n  get selection(): Selection {\n    return this[_].selection;\n  }\n\n  /**\n   * Get the number of rows.\n   */\n  get rowCount(): number {\n    return this[_].rowCount;\n  }\n\n  /**\n   * Set the number of rows.\n   */\n  set rowCount(rowCount: number) {\n    this[_].rowCount = rowCount;\n    this.updateScroll();\n    if (this[_].selection._updateGridRange()) {\n      const { col, row } = this[_].selection.focus;\n      this.makeVisibleCell(col, row);\n      this.setFocusCursor(col, row);\n    }\n  }\n\n  /**\n   * Get the number of columns.\n   */\n  get colCount(): number {\n    return this[_].colCount;\n  }\n\n  /**\n   * Set the number of columns.\n   */\n  set colCount(colCount: number) {\n    this[_].colCount = colCount;\n    this.updateScroll();\n    if (this[_].selection._updateGridRange()) {\n      const { col, row } = this[_].selection.focus;\n      this.makeVisibleCell(col, row);\n      this.setFocusCursor(col, row);\n    }\n  }\n\n  /**\n   * Get the number of frozen columns.\n   */\n  get frozenColCount(): number {\n    return this[_].frozenColCount;\n  }\n\n  /**\n   * Set the number of frozen columns.\n   */\n  set frozenColCount(frozenColCount: number) {\n    this[_].frozenColCount = frozenColCount;\n  }\n\n  /**\n   * Get the number of frozen rows.\n   */\n  get frozenRowCount(): number {\n    return this[_].frozenRowCount;\n  }\n\n  /**\n   * Set the number of frozen rows.\n   */\n  set frozenRowCount(frozenRowCount: number) {\n    this[_].frozenRowCount = frozenRowCount;\n  }\n\n  /**\n   * Get the default row height.\n   *\n   */\n  get defaultRowHeight(): number {\n    return this[_].defaultRowHeight;\n  }\n\n  /**\n   * Set the default row height.\n   */\n  set defaultRowHeight(defaultRowHeight: number) {\n    this[_].defaultRowHeight = defaultRowHeight;\n  }\n\n  /**\n   * Get the default column width.\n   */\n  get defaultColWidth(): string | number {\n    return this[_].defaultColWidth;\n  }\n\n  /**\n   * Set the default column width.\n   */\n  set defaultColWidth(defaultColWidth: string | number) {\n    this[_].defaultColWidth = defaultColWidth;\n  }\n\n  /**\n   * Get the font definition as a string.\n   */\n  get font(): string | undefined {\n    return this[_].font;\n  }\n\n  /**\n   * Set the font definition with the given string.\n   */\n  set font(font: string | undefined) {\n    this[_].font = font;\n  }\n\n  /**\n   * Get the background color of the underlay.\n   */\n  get underlayBackgroundColor(): string | undefined {\n    return this[_].underlayBackgroundColor;\n  }\n\n  /**\n   * Set the background color of the underlay.\n   */\n  set underlayBackgroundColor(underlayBackgroundColor: string | undefined) {\n    this[_].underlayBackgroundColor = underlayBackgroundColor;\n  }\n\n  get keyboardOptions(): DrawGridKeyboardOptions | null {\n    return this[_].keyboardOptions ?? null;\n  }\n\n  set keyboardOptions(keyboardOptions: DrawGridKeyboardOptions | null) {\n    this[_].keyboardOptions = keyboardOptions ?? undefined;\n  }\n\n  configure(name: 'fadeinWhenCallbackInPromise', value?: boolean): boolean;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  configure(name: string, value?: any): any {\n    const cfg = this[_].config || (this[_].config = {});\n    if (value != null) {\n      cfg[name] = value;\n    }\n    return cfg[name];\n  }\n\n  /**\n   * Apply the changed size.\n   * @return {void}\n   */\n  updateSize(): void {\n    //\n    const { canvas } = this[_];\n    canvas.style.width = '';\n    canvas.style.height = '';\n    const width = Math.floor(canvas.offsetWidth || canvas.parentElement!.offsetWidth - style.getScrollBarSize() /*for legacy*/);\n    const height = Math.floor(canvas.offsetHeight || canvas.parentElement!.offsetHeight - style.getScrollBarSize() /*for legacy*/);\n\n    canvas.width = width;\n    canvas.height = height;\n\n    //style\n    canvas.style.width = `${width}px`;\n    canvas.style.height = `${height}px`;\n\n    const sel = this[_].selection.select;\n    this[_].focusControl.setFocusRect(this.getCellRect(sel.col, sel.row));\n  }\n\n  /**\n   * Apply the changed scroll size.\n   * @return {boolean} `true` if there was a change in the scroll size\n   */\n  updateScroll(): boolean {\n    const { scrollable } = this[_];\n    const newHeight = _getScrollHeight.call(this);\n    const newWidth = _getScrollWidth(this);\n    if (newHeight === scrollable.scrollHeight && newWidth === scrollable.scrollWidth) {\n      return false;\n    }\n    scrollable.setScrollSize(newWidth, newHeight);\n    this[_].scroll = {\n      left: scrollable.scrollLeft,\n      top: scrollable.scrollTop\n    };\n    return true;\n  }\n\n  /**\n   * Get the row height of the given the row index.\n   * @param  {number} row The row index\n   * @return {number} The row height\n   */\n  getRowHeight(row: number): number {\n    return _getRowHeight.call(this, row);\n  }\n\n  /**\n   * Set the row height of the given the row index.\n   * @param  {number} row The row index\n   * @param  {number} height The row height\n   * @return {void}\n   */\n  setRowHeight(row: number, height: number): void {\n    _setRowHeight(this, row, height);\n  }\n\n  /**\n   * Get the column width of the given the column index.\n   * @param  {number} col The column index\n   * @return {number} The column width\n   */\n  getColWidth(col: number): number {\n    return _getColWidth(this, col);\n  }\n\n  /**\n   * Set the column widtht of the given the column index.\n   * @param  {number} col The column index\n   * @param  {number} width The column width\n   * @return {void}\n   */\n  setColWidth(col: number, width: string | number): void {\n    _setColWidth(this, col, width);\n  }\n\n  /**\n   * Get the column max width of the given the column index.\n   * @param  {number} col The column index\n   * @return {number} The column max width\n   */\n  getMaxColWidth(col: number): string | number | undefined {\n    const obj = this[_].colWidthsLimit[col];\n    return (obj && obj.max) || undefined;\n  }\n\n  /**\n   * Set the column max widtht of the given the column index.\n   * @param  {number} col The column index\n   * @param  {number} maxwidth The column max width\n   * @return {void}\n   */\n  setMaxColWidth(col: number, maxwidth: string | number): void {\n    const obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});\n    obj.max = maxwidth;\n  }\n\n  /**\n   * Get the column min width of the given the column index.\n   * @param  {number} col The column index\n   * @return {number} The column min width\n   */\n  getMinColWidth(col: number): string | number | undefined {\n    const obj = this[_].colWidthsLimit[col];\n    return (obj && obj.min) || undefined;\n  }\n\n  /**\n   * Set the column min widtht of the given the column index.\n   * @param  {number} col The column index\n   * @param  {number} minwidth The column min width\n   * @return {void}\n   */\n  setMinColWidth(col: number, minwidth: string | number): void {\n    const obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});\n    obj.min = minwidth;\n  }\n\n  /**\n   * Get the rect of the cell.\n   * @param {number} col index of column, of the cell\n   * @param {number} row index of row, of the cell\n   * @returns {Rect} the rect of the cell.\n   */\n  getCellRect(col: number, row: number): Rect {\n    const isFrozenCell = this.isFrozenCell(col, row);\n\n    let absoluteLeft = _getColsWidth(this, 0, col - 1);\n    const width = _getColWidth(this, col);\n    if (isFrozenCell && isFrozenCell.col) {\n      absoluteLeft += this[_].scroll.left;\n    }\n\n    let absoluteTop = _getRowsHeight.call(this, 0, row - 1);\n    const height = _getRowHeight.call(this, row);\n    if (isFrozenCell && isFrozenCell.row) {\n      absoluteTop += this[_].scroll.top;\n    }\n    return new Rect(absoluteLeft, absoluteTop, width, height);\n  }\n\n  /**\n   * Get the relative rectangle of the cell.\n   * @param {number} col index of column, of the cell\n   * @param {number} row index of row, of the cell\n   * @returns {Rect} the rect of the cell.\n   */\n  getCellRelativeRect(col: number, row: number): Rect {\n    return _toRelativeRect(this, this.getCellRect(col, row));\n  }\n\n  /**\n   * Get the rectangle of the cells area.\n   * @param {number} startCol index of the starting column, of the cell\n   * @param {number} startRow index of the starting row, of the cell\n   * @param {number} endCol index of the ending column, of the cell\n   * @param {number} endRow index of the ending row, of the cell\n   * @returns {Rect} the rect of the cells.\n   */\n  getCellsRect(startCol: number, startRow: number, endCol: number, endRow: number): Rect {\n    const isFrozenStartCell = this.isFrozenCell(startCol, startRow);\n    const isFrozenEndCell = this.isFrozenCell(endCol, endRow);\n\n    let absoluteLeft = _getColsWidth(this, 0, startCol - 1);\n    let width = _getColsWidth(this, startCol, endCol);\n    if (isFrozenStartCell && isFrozenStartCell.col) {\n      const scrollLeft = this[_].scroll.left;\n      absoluteLeft += scrollLeft;\n      if (!isFrozenEndCell || !isFrozenEndCell.col) {\n        width -= scrollLeft;\n        width = Math.max(width, _getColsWidth(this, startCol, this.frozenColCount - 1));\n      }\n    }\n    let absoluteTop = _getRowsHeight.call(this, 0, startRow - 1);\n    let height = _getRowsHeight.call(this, startRow, endRow);\n    if (isFrozenStartCell && isFrozenStartCell.row) {\n      const scrollTop = this[_].scroll.top;\n      absoluteTop += scrollTop;\n      if (!isFrozenEndCell || !isFrozenEndCell.row) {\n        height -= scrollTop;\n        height = Math.max(height, _getColsWidth(this, startRow, this.frozenRowCount - 1));\n      }\n    }\n    return new Rect(absoluteLeft, absoluteTop, width, height);\n  }\n\n  getCellRangeRect(range: CellRange): Rect {\n    return this.getCellsRect(range.start.col, range.start.row, range.end.col, range.end.row);\n  }\n\n  isFrozenCell(\n    col: number,\n    row: number\n  ): {\n      row: boolean;\n      col: boolean;\n    } | null {\n    const { frozenRowCount, frozenColCount } = this[_];\n    const isFrozenRow = frozenRowCount > 0 && row < frozenRowCount;\n    const isFrozenCol = frozenColCount > 0 && col < frozenColCount;\n    if (isFrozenRow || isFrozenCol) {\n      return {\n        row: isFrozenRow,\n        col: isFrozenCol\n      };\n    } else {\n      return null;\n    }\n  }\n\n  getRowAt(absoluteY: number): number {\n    const frozen = _getTargetFrozenRowAt(this, absoluteY);\n    if (frozen) {\n      return frozen.row;\n    }\n    const row = _getTargetRowAt.call(this, absoluteY);\n    return row ? row.row : -1;\n  }\n\n  getColAt(absoluteX: number): number {\n    const frozen = _getTargetFrozenColAt(this, absoluteX);\n    if (frozen) {\n      return frozen.col;\n    }\n    const col = _getTargetColAt(this, absoluteX);\n    return col ? col.col : -1;\n  }\n\n  getCellAt(absoluteX: number, absoluteY: number): CellAddress {\n    return {\n      row: this.getRowAt(absoluteY),\n      col: this.getColAt(absoluteX)\n    };\n  }\n\n  /**\n   * Scroll to where cell is visible.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index\n   * @return {void}\n   */\n  makeVisibleCell(col: number, row: number): void {\n    const isFrozenCell = this.isFrozenCell(col, row);\n    if (isFrozenCell && isFrozenCell.col && isFrozenCell.row) {\n      return;\n    }\n    const rect = this.getCellRect(col, row);\n    const visibleRect = _getScrollableVisibleRect(this);\n    if (visibleRect.contains(rect)) {\n      return;\n    }\n    const { scrollable } = this[_];\n    if (!isFrozenCell || !isFrozenCell.col) {\n      if (rect.left < visibleRect.left) {\n        scrollable.scrollLeft -= visibleRect.left - rect.left;\n      } else if (visibleRect.right < rect.right) {\n        scrollable.scrollLeft -= visibleRect.right - rect.right;\n      }\n    }\n    if (!isFrozenCell || !isFrozenCell.row) {\n      if (rect.top < visibleRect.top) {\n        scrollable.scrollTop -= visibleRect.top - rect.top;\n      } else if (visibleRect.bottom < rect.bottom) {\n        scrollable.scrollTop -= visibleRect.bottom - rect.bottom;\n      }\n    }\n  }\n\n  /**\n   * Moves the focus cursor to the given cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index\n   * @return {void}\n   */\n  setFocusCursor(col: number, row: number): void {\n    const { focusControl } = this[_];\n    const oldEditMode = focusControl.editMode;\n\n    focusControl.setFocusRect(this.getCellRect(col, row));\n\n    _updatedSelection.call(this);\n\n    if (oldEditMode && !focusControl.editMode) {\n      focusControl.resetInputStatus();\n    }\n  }\n\n  /**\n   * Focus the cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index\n   * @return {void}\n   */\n  focusCell(col: number, row: number): void {\n    this.setFocusCursor(col, row);\n\n    // Failure occurs in IE if focus is not last\n    this[_].focusControl.focus();\n  }\n\n  /**\n   * Redraws the range of the given cell.\n   * @param  {number} col The column index of cell.\n   * @param  {number} row The row index of cell.\n   * @return {void}\n   */\n  invalidateCell(col: number, row: number): void {\n    this.invalidateGridRect(col, row);\n  }\n\n  /**\n   * Redraws the range of the given cells.\n   * @param {number} startCol index of the starting column, of the cell\n   * @param {number} startRow index of the starting row, of the cell\n   * @param {number} endCol index of the ending column, of the cell\n   * @param {number} endRow index of the ending row, of the cell\n   * @return {void}\n   */\n  invalidateGridRect(startCol: number, startRow: number, endCol = startCol, endRow = startRow): void {\n    const offset = this.getOffsetInvalidateCells();\n    if (offset > 0) {\n      startCol -= offset;\n      startRow -= offset;\n      endCol += offset;\n      endRow += offset;\n    }\n\n    const visibleRect = _getVisibleRect(this);\n    const cellsRect = this.getCellsRect(startCol, startRow, endCol, endRow);\n    const invalidateTarget = visibleRect.intersection(cellsRect);\n    if (invalidateTarget) {\n      const { frozenColCount, frozenRowCount } = this[_];\n      if (frozenColCount > 0 && endCol >= frozenColCount) {\n        const frozenRect = _getFrozenColsRect(this)!;\n        if (frozenRect.intersection(invalidateTarget)) {\n          invalidateTarget.left = Math.min(frozenRect.right - 1, invalidateTarget.left);\n        }\n      }\n\n      if (frozenRowCount > 0 && endRow >= frozenRowCount) {\n        const frozenRect = _getFrozenRowsRect(this)!;\n        if (frozenRect.intersection(invalidateTarget)) {\n          invalidateTarget.top = Math.min(frozenRect.bottom - 1, invalidateTarget.top);\n        }\n      }\n\n      _invalidateRect(this, invalidateTarget);\n    }\n  }\n\n  invalidateCellRange(range: CellRange): void {\n    this.invalidateGridRect(range.start.col, range.start.row, range.end.col, range.end.row);\n  }\n\n  /**\n   * Redraws the whole grid.\n   * @return {void}\n   */\n  invalidate(): void {\n    const visibleRect = _getVisibleRect(this);\n    _invalidateRect(this, visibleRect);\n  }\n\n  /**\n   * Get the number of scrollable rows fully visible in the grid. visibleRowCount does not include the frozen rows counted by the frozenRowCount property. It does not include any partially visible rows on the bottom of the grid.\n   * @returns {number}\n   */\n  get visibleRowCount(): number {\n    const { frozenRowCount } = this;\n    const visibleRect = _getVisibleRect(this);\n    const visibleTop = frozenRowCount > 0 ? visibleRect.top + _getRowsHeight.call(this, 0, frozenRowCount - 1) : visibleRect.top;\n\n    const initRow = _getTargetRowAt.call(this, visibleTop);\n    if (!initRow) {\n      return 0;\n    }\n    const startRow = Math.max(initRow.top >= visibleTop ? initRow.row : initRow.row + 1, frozenRowCount);\n    let absoluteTop = _getRowsHeight.call(this, 0, startRow - 1);\n    let count = 0;\n    const { rowCount } = this;\n    for (let row = startRow; row < rowCount; row++) {\n      const height = _getRowHeight.call(this, row);\n      const bottom = absoluteTop + height;\n      if (visibleRect.bottom < bottom) {\n        break;\n      }\n      count++;\n      absoluteTop = bottom;\n    }\n    return count;\n  }\n\n  /**\n   * Get the number of scrollable columns fully visible in the grid. visibleColCount does not include the frozen columns counted by the frozenColCount property. It does not include any partially visible columns on the right of the grid.\n   * @returns {number}\n   */\n  get visibleColCount(): number {\n    const { frozenColCount } = this;\n    const visibleRect = _getVisibleRect(this);\n    const visibleLeft = frozenColCount > 0 ? visibleRect.left + _getColsWidth(this, 0, frozenColCount - 1) : visibleRect.left;\n\n    const initCol = _getTargetColAt(this, visibleLeft);\n    if (!initCol) {\n      return 0;\n    }\n    const startCol = Math.max(initCol.left >= visibleLeft ? initCol.col : initCol.col + 1, frozenColCount);\n    let absoluteLeft = _getColsWidth(this, 0, startCol - 1);\n    let count = 0;\n    const { colCount } = this;\n    for (let col = startCol; col < colCount; col++) {\n      const width = _getColWidth(this, col);\n      const right = absoluteLeft + width;\n      if (visibleRect.right < right) {\n        break;\n      }\n      count++;\n      absoluteLeft = right;\n    }\n    return count;\n  }\n\n  /**\n   * Get the index of the first row in the scrollable region that is visible.\n   * @returns {number}\n   */\n  get topRow(): number {\n    const { frozenRowCount } = this;\n    const visibleRect = _getVisibleRect(this);\n    const visibleTop = frozenRowCount > 0 ? visibleRect.top + _getRowsHeight.call(this, 0, frozenRowCount - 1) : visibleRect.top;\n\n    const initRow = _getTargetRowAt.call(this, visibleTop);\n    if (!initRow) {\n      return 0;\n    }\n    return Math.max(initRow.top >= visibleTop ? initRow.row : initRow.row + 1, frozenRowCount);\n  }\n\n  /**\n   * Get the index of the first column in the scrollable region that is visible.\n   * @returns {number}\n   */\n  get leftCol(): number {\n    const { frozenColCount } = this;\n    const visibleRect = _getVisibleRect(this);\n    const visibleLeft = frozenColCount > 0 ? visibleRect.left + _getColsWidth(this, 0, frozenColCount - 1) : visibleRect.left;\n\n    const initCol = _getTargetColAt(this, visibleLeft);\n    if (!initCol) {\n      return 0;\n    }\n    return Math.max(initCol.left >= visibleLeft ? initCol.col : initCol.col + 1, frozenColCount);\n  }\n\n  /**\n   * gets or sets the number of pixels that an element's content is scrolled vertically\n   */\n  get scrollTop(): number {\n    return this[_].scrollable.scrollTop;\n  }\n\n  set scrollTop(scrollTop: number) {\n    this[_].scrollable.scrollTop = scrollTop;\n  }\n\n  /**\n   * gets or sets the number of pixels that an element's content is scrolled from its left edge\n   */\n  get scrollLeft(): number {\n    return this[_].scrollable.scrollLeft;\n  }\n\n  set scrollLeft(scrollLeft: number) {\n    this[_].scrollable.scrollLeft = scrollLeft;\n  }\n\n  /**\n   * Get the value of cell with the copy action.\n   * <p>\n   * Please implement\n   * </p>\n   *\n   * @protected\n   * @param col Column index of cell.\n   * @param row Row index of cell.\n   * @param range Copy range.\n   * @return {string} the value of cell\n   */\n  protected getCopyCellValue(_col: number, _row: number, _range: CellRange): string | Promise<string> | void {\n    //Please implement get cell value!!\n  }\n\n  /**\n   * Draw a cell\n   * <p>\n   * Please implement cell drawing.\n   * </p>\n   *\n   * @protected\n   * @param  {number} col Column index of cell.\n   * @param  {number} row Row index of cell.\n   * @param  {DrawCellContext} context context of cell drawing.\n   * @return {void}\n   */\n  protected abstract onDrawCell(col: number, row: number, context: CellContext): Promise<void> | void;\n\n  /**\n   * Get the overflowed text in the cell rectangle, from the given cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index\n   * @return {string | null} The text overflowing the cell rect.\n   */\n  getCellOverflowText(col: number, row: number): string | null {\n    const key = `${col}:${row}`;\n    return this[_].cellTextOverflows[key] || null;\n  }\n\n  /**\n   * Set the overflowed text in the cell rectangle, to the given cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index\n   * @param  {string} overflowText The overflowed text in the cell rectangle.\n   * @return {void}\n   */\n  setCellOverflowText(col: number, row: number, overflowText: string | false): void {\n    const key = `${col}:${row}`;\n    if (overflowText) {\n      this[_].cellTextOverflows[key] = typeof overflowText === 'string' ? overflowText.trim() : overflowText;\n    } else {\n      delete this[_].cellTextOverflows[key];\n    }\n  }\n\n  addDisposable(disposable: { dispose(): void }): void {\n    if (!disposable || !disposable.dispose || typeof disposable.dispose !== 'function') {\n      throw new Error('not disposable!');\n    }\n    const disposables = (this[_].disposables = this[_].disposables || []);\n    disposables.push(disposable);\n  }\n\n  /**\n   * Dispose the grid instance.\n   * @returns {void}\n   */\n  dispose(): void {\n    super.dispose();\n    const protectedSpace = this[_];\n    protectedSpace.handler.dispose();\n    protectedSpace.scrollable.dispose();\n    protectedSpace.focusControl.dispose();\n    protectedSpace.columnResizer.dispose();\n    protectedSpace.cellSelector.dispose();\n    if (protectedSpace.disposables) {\n      protectedSpace.disposables.forEach((disposable) => disposable.dispose());\n      protectedSpace.disposables = null;\n    }\n\n    const { parentElement } = protectedSpace.element;\n    if (parentElement) {\n      parentElement.removeChild(protectedSpace.element);\n    }\n  }\n\n  getAttachCellsArea(range: CellRange): {\n    element: HTMLElement;\n    rect: Rect;\n  } {\n    return {\n      element: this.getElement(),\n      rect: _toRelativeRect(this, this.getCellRangeRect(range))\n    };\n  }\n\n  onKeyDownMove(evt: KeyboardEvent): void {\n    _onKeyDownMove.call(this, evt);\n  }\n\n  protected bindEventsInternal(): void {\n    //nop\n  }\n\n  protected getTargetRowAtInternal(_absoluteY: number): { row: number; top: number } | void {\n    // \n  }\n\n  protected getRowsHeightInternal(_startRow: number, _endRow: number): number | void {\n    // \n  }\n\n  protected getRowHeightInternal(_row: number): number | void {\n    // \n  }\n\n  protected getScrollHeightInternal(_row?: number): number | void {\n    // \n  }\n\n  protected getMoveLeftColByKeyDownInternal({ col }: CellAddress): number {\n    return col - 1;\n  }\n\n  protected getMoveRightColByKeyDownInternal({ col }: CellAddress): number {\n    return col + 1;\n  }\n\n  protected getMoveUpRowByKeyDownInternal({ row }: CellAddress): number {\n    return row - 1;\n  }\n\n  protected getMoveDownRowByKeyDownInternal({ row }: CellAddress): number {\n    return row + 1;\n  }\n\n  protected getOffsetInvalidateCells(): number {\n    return 0;\n  }\n\n  protected getCopyRangeInternal(range: CellRange): CellRange {\n    return range;\n  }\n\n  protected _getInitContext(): CanvasRenderingContext2D {\n    const ctx = this[_].context;\n    //\n    ctx.fillStyle = 'white';\n    ctx.strokeStyle = 'black';\n    ctx.textAlign = 'left';\n    ctx.textBaseline = 'top';\n    ctx.lineWidth = 1;\n    ctx.font = this.font || '16px sans-serif';\n    return ctx;\n  }\n\n  fireListeners<TYPE extends keyof DrawGridEventHandlersEventMap>(type: TYPE, ...event: DrawGridEventHandlersEventMap[TYPE]): DrawGridEventHandlersReturnMap[TYPE][] {\n    return super.fireListeners(type, ...event);\n  }\n}\n","import { DrawGrid } from './core/DrawGrid';\nimport { DG_EVENT_TYPE as EVENT_TYPE } from './core/DG_EVENT_TYPE';\n\nexport const core = { DrawGrid, EVENT_TYPE };\n","import { calcBasePosition, calcStartPosition, getFontSize } from '../internal/canvases';\nimport type { ColorDef } from '../ts-types';\nimport type { PaddingOption } from '../internal/canvases';\nconst { ceil, PI } = Math;\n\nexport function strokeColorsRect(\n  ctx: CanvasRenderingContext2D,\n  borderColors: [ColorDef | null, ColorDef | null, ColorDef | null, ColorDef | null],\n  left: number,\n  top: number,\n  width: number,\n  height: number\n): void {\n  type Position = { x: number; y: number };\n  function strokeRectLines(positions: [Position, Position, Position, Position, Position]): void {\n    for (let i = 0; i < borderColors.length; i++) {\n      const color = borderColors[i];\n      const preColor = borderColors[i - 1];\n      if (color) {\n        if (preColor !== color) {\n          if (preColor) {\n            ctx.strokeStyle = preColor;\n            ctx.stroke();\n          }\n          const pos1 = positions[i];\n          ctx.beginPath();\n          ctx.moveTo(pos1.x, pos1.y);\n        }\n        const pos2 = positions[i + 1];\n        ctx.lineTo(pos2.x, pos2.y);\n      } else {\n        if (preColor) {\n          ctx.strokeStyle = preColor;\n          ctx.stroke();\n        }\n      }\n    }\n    const preColor = borderColors[borderColors.length - 1];\n    if (preColor) {\n      ctx.strokeStyle = preColor;\n      ctx.stroke();\n    }\n  }\n  if (borderColors[0] === borderColors[1] && borderColors[0] === borderColors[2] && borderColors[0] === borderColors[3]) {\n    if (borderColors[0]) {\n      ctx.strokeStyle = borderColors[0];\n      ctx.strokeRect(left, top, width, height);\n    }\n  } else {\n    strokeRectLines([\n      { x: left, y: top },\n      { x: left + width, y: top },\n      { x: left + width, y: top + height },\n      { x: left, y: top + height },\n      { x: left, y: top }\n    ]);\n  }\n}\nexport function roundRect(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number, radius: number): void {\n  ctx.beginPath();\n  ctx.arc(left + radius, top + radius, radius, -PI, -0.5 * PI, false);\n  ctx.arc(left + width - radius, top + radius, radius, -0.5 * PI, 0, false);\n  ctx.arc(left + width - radius, top + height - radius, radius, 0, 0.5 * PI, false);\n  ctx.arc(left + radius, top + height - radius, radius, 0.5 * PI, PI, false);\n  ctx.closePath();\n}\nexport function fillRoundRect(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number, radius: number): void {\n  roundRect(ctx, left, top, width, height, radius);\n  ctx.fill();\n}\nexport function strokeRoundRect(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number, radius: number): void {\n  roundRect(ctx, left, top, width, height, radius);\n  ctx.stroke();\n}\nexport function fillCircle(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number): void {\n  const min = Math.min(width, height) / 2;\n  ctx.beginPath();\n  ctx.arc(left + min, top + min, min, 0, 2 * Math.PI);\n  ctx.closePath();\n  ctx.fill();\n}\nexport function strokeCircle(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number): void {\n  const min = Math.min(width, height) / 2;\n  ctx.beginPath();\n  ctx.arc(left + min, top + min, min, 0, 2 * Math.PI);\n  ctx.closePath();\n  ctx.stroke();\n}\n\nexport type FillTextRectOption = {\n  offset?: number;\n  padding?: PaddingOption;\n};\nexport function fillTextRect(ctx: CanvasRenderingContext2D, text: string, left: number, top: number, width: number, height: number, { offset = 2, padding }: FillTextRectOption = {}): void {\n  const rect = {\n    left,\n    top,\n    width,\n    height,\n    right: left + width,\n    bottom: top + height\n  };\n  ctx.save();\n  try {\n    ctx.beginPath();\n    ctx.rect(rect.left, rect.top, rect.width, rect.height);\n    //clip\n    ctx.clip();\n\n    //\n    const pos = calcBasePosition(ctx, rect, {\n      offset,\n      padding\n    });\n\n    ctx.fillText(text, pos.x, pos.y);\n  } finally {\n    ctx.restore();\n  }\n}\n\nexport type DrawInlineImageRectOption = {\n  offset?: number;\n  padding?: PaddingOption;\n};\nexport function drawInlineImageRect(\n  ctx: CanvasRenderingContext2D,\n  image: CanvasImageSource,\n  srcLeft: number,\n  srcTop: number,\n  srcWidth: number,\n  srcHeight: number,\n  destWidth: number,\n  destHeight: number,\n  left: number,\n  top: number,\n  width: number,\n  height: number,\n  { offset = 2, padding }: DrawInlineImageRectOption = {}\n): void {\n  const rect = {\n    left,\n    top,\n    width,\n    height,\n    right: left + width,\n    bottom: top + height\n  };\n  ctx.save();\n  try {\n    ctx.beginPath();\n    ctx.rect(rect.left, rect.top, rect.width, rect.height);\n    //clip\n    ctx.clip();\n\n    //\n    const pos = calcStartPosition(ctx, rect, destWidth, destHeight, {\n      offset,\n      padding\n    });\n\n    ctx.drawImage(image, srcLeft, srcTop, srcWidth, srcHeight, pos.x, pos.y, destWidth, destHeight);\n  } finally {\n    ctx.restore();\n  }\n}\n\n/**\n * Returns an object containing the width of the checkbox.\n * @param  {CanvasRenderingContext2D} ctx canvas context\n * @return {Object} Object containing the width of the checkbox\n * @memberof cheetahGrid.tools.canvashelper\n */\nexport function measureCheckbox(ctx: CanvasRenderingContext2D): {\n  width: number;\n} {\n  return {\n    width: getFontSize(ctx, null).width\n  };\n}\n\n/**\n * Returns an object containing the width of the radio button.\n * @param  {CanvasRenderingContext2D} ctx canvas context\n * @return {Object} Object containing the width of the radio button\n * @memberof cheetahGrid.tools.canvashelper\n */\nexport function measureRadioButton(ctx: CanvasRenderingContext2D): {\n  width: number;\n} {\n  return {\n    width: getFontSize(ctx, null).width\n  };\n}\n\nexport type DrawCheckboxOption = {\n  uncheckBgColor?: ColorDef;\n  checkBgColor?: ColorDef;\n  borderColor?: ColorDef;\n  boxSize?: number;\n};\n/**\n * draw Checkbox\n * @param  {CanvasRenderingContext2D} ctx canvas context\n * @param  {number} x The x coordinate where to start drawing the checkbox (relative to the canvas)\n * @param  {number} y The y coordinate where to start drawing the checkbox (relative to the canvas)\n * @param  {boolean|number} check checkbox check status\n * @param  {object} option option\n * @return {void}\n * @memberof cheetahGrid.tools.canvashelper\n */\nexport function drawCheckbox(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  check: number | boolean,\n  { uncheckBgColor = '#FFF', checkBgColor = 'rgb(76, 73, 72)', borderColor = '#000', boxSize = measureCheckbox(ctx).width }: DrawCheckboxOption = {}\n): void {\n  const checkPoint = typeof check === 'number' ? (check > 1 ? 1 : check) : 1;\n\n  ctx.save();\n  try {\n    ctx.fillStyle = check ? checkBgColor : uncheckBgColor;\n    const leftX = ceil(x);\n    const topY = ceil(y);\n    const size = ceil(boxSize);\n\n    fillRoundRect(ctx, leftX - 1, topY - 1, size + 1, size + 1, boxSize / 5);\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = borderColor;\n    strokeRoundRect(ctx, leftX - 0.5, topY - 0.5, size, size, boxSize / 5);\n    if (check) {\n      ctx.lineWidth = ceil(boxSize / 10);\n      ctx.strokeStyle = uncheckBgColor;\n      let leftWidth = boxSize / 4;\n      let rightWidth = (boxSize / 2) * 0.9;\n      const leftLeftPos = x + boxSize * 0.2;\n      const leftTopPos = y + boxSize / 2;\n\n      if (checkPoint < 0.5) {\n        leftWidth *= checkPoint * 2;\n      }\n\n      ctx.beginPath();\n      ctx.moveTo(leftLeftPos, leftTopPos);\n      ctx.lineTo(leftLeftPos + leftWidth, leftTopPos + leftWidth);\n      if (checkPoint > 0.5) {\n        if (checkPoint < 1) {\n          rightWidth *= (checkPoint - 0.5) * 2;\n        }\n        ctx.lineTo(leftLeftPos + leftWidth + rightWidth, leftTopPos + leftWidth - rightWidth);\n      }\n      ctx.stroke();\n    }\n  } finally {\n    ctx.restore();\n  }\n}\n\nexport type DrawRadioButtonOption = {\n  checkColor?: ColorDef;\n  borderColor?: ColorDef;\n  bgColor?: ColorDef;\n  boxSize?: number;\n};\n/**\n * draw Radio button\n * @param  {CanvasRenderingContext2D} ctx canvas context\n * @param  {number} x The x coordinate where to start drawing the radio button (relative to the canvas)\n * @param  {number} y The y coordinate where to start drawing the radio button (relative to the canvas)\n * @param  {boolean|number} check radio button check status\n * @param  {object} option option\n * @return {void}\n * @memberof cheetahGrid.tools.canvashelper\n */\nexport function drawRadioButton(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  check: number | boolean,\n  { checkColor = 'rgb(76, 73, 72)', borderColor = '#000', bgColor = '#FFF', boxSize = measureRadioButton(ctx).width }: DrawRadioButtonOption = {}\n): void {\n  const ratio = typeof check === 'number' ? (check > 1 ? 1 : check) : 1;\n\n  ctx.save();\n  try {\n    ctx.fillStyle = bgColor;\n    const leftX = ceil(x);\n    const topY = ceil(y);\n    const size = ceil(boxSize);\n    fillCircle(ctx, leftX - 1, topY - 1, size + 1, size + 1);\n\n    ctx.lineWidth = 1;\n    ctx.strokeStyle = borderColor;\n    strokeCircle(ctx, leftX - 0.5, topY - 0.5, size, size);\n    if (check) {\n      const checkSize = (size * ratio) / 2;\n      const padding = (size - checkSize) / 2;\n      ctx.fillStyle = checkColor;\n      fillCircle(ctx, ceil((leftX - 0.5 + padding) * 100) / 100, ceil((topY - 0.5 + padding) * 100) / 100, ceil(checkSize * 100) / 100, ceil(checkSize * 100) / 100);\n    }\n  } finally {\n    ctx.restore();\n  }\n}\n\nexport type DrawButtonOption = {\n  backgroundColor?: ColorDef;\n  bgColor?: ColorDef;\n  radius?: number;\n  shadow?: {\n    color?: string;\n    blur?: number;\n    offsetX?: number;\n    offsetY?: number;\n    offset?: { x?: number; y?: number };\n  };\n};\n/**\n * draw Button\n */\nexport function drawButton(ctx: CanvasRenderingContext2D, left: number, top: number, width: number, height: number, option: DrawButtonOption = {}): void {\n  const { backgroundColor = '#FFF', bgColor = backgroundColor, radius = 4, shadow = {} } = option;\n  ctx.save();\n  try {\n    ctx.fillStyle = bgColor;\n\n    if (shadow) {\n      const { color = 'rgba(0, 0, 0, 0.24)', blur = 1, offsetX = 0, offsetY = 2, offset: { x: ox = offsetX, y: oy = offsetY } = {} } = shadow;\n      ctx.shadowColor = color;\n      ctx.shadowBlur = blur; //\n      ctx.shadowOffsetX = ox;\n      ctx.shadowOffsetY = oy;\n    }\n\n    fillRoundRect(ctx, ceil(left), ceil(top), ceil(width), ceil(height), radius);\n  } finally {\n    ctx.restore();\n  }\n}\nexport const canvasHelper = {\n  drawButton,\n  drawCheckbox,\n  drawInlineImageRect,\n  drawRadioButton,\n  fillRoundRect,\n  fillTextRect,\n  measureCheckbox,\n  measureRadioButton,\n  roundRect,\n  strokeColorsRect,\n  strokeRoundRect,\n  fillCircle,\n  strokeCircle\n};\nexport type CanvasHelper = {\n  roundRect: typeof roundRect;\n  fillRoundRect: typeof fillRoundRect;\n  strokeRoundRect: typeof strokeRoundRect;\n  drawCheckbox: typeof drawCheckbox;\n  measureCheckbox: typeof measureCheckbox;\n  fillTextRect: typeof fillTextRect;\n  drawButton: typeof drawButton;\n  drawInlineImageRect: typeof drawInlineImageRect;\n  strokeColorsRect: typeof strokeColorsRect;\n};\n","import { canvasHelper, CanvasHelper } from './tools/canvashelper';\n\n/**\n * tools\n // * @namespace cheetahGrid.tools\n // * @memberof cheetahGrid\n */\n// export { canvashelper };\n/**\n * tools\n */\nexport const tools: { canvasHelper: CanvasHelper } = { canvasHelper };\n","import type { ColorPropertyDefine, ColorsPropertyDefine, PartialThemeDefine, RequiredThemeDefine, StylePropertyFunctionArg, ThemeDefine } from '../ts-types';\nimport { getChainSafe } from '../internal/utils';\nimport { get as getSymbol } from '../internal/symbolManager';\n//private symbol\nconst _ = getSymbol();\n\nfunction getProp<T extends ColorPropertyDefine | ColorsPropertyDefine>(obj: PartialThemeDefine, superObj: ThemeDefine, names: string[], defNames?: string[]): T {\n  return getChainSafe(obj, ...names) || getChainSafe(superObj, ...names) || (defNames && getChainSafe(obj, ...defNames)) || (defNames && getChainSafe(superObj, ...defNames));\n}\n\nexport class Theme implements RequiredThemeDefine {\n  private [_]: {\n    obj: PartialThemeDefine;\n    superTheme: ThemeDefine;\n  };\n  private _checkbox: RequiredThemeDefine['checkbox'] | null = null;\n  private _radioButton: RequiredThemeDefine['radioButton'] | null = null;\n  private _button: RequiredThemeDefine['button'] | null = null;\n  private _header: RequiredThemeDefine['header'] | null = null;\n  private _messages: RequiredThemeDefine['messages'] | null = null;\n  constructor(obj: ThemeDefine);\n  constructor(obj: PartialThemeDefine, superTheme: ThemeDefine);\n  constructor(obj: PartialThemeDefine | ThemeDefine, superTheme?: ThemeDefine) {\n    this[_] = {\n      obj,\n      superTheme: superTheme as ThemeDefine\n    };\n  }\n  get font(): string {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['font']);\n  }\n  get underlayBackgroundColor(): string {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['underlayBackgroundColor']);\n  }\n  // color\n  get color(): ColorPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['color']);\n  }\n  get frozenRowsColor(): ColorPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['frozenRowsColor'], ['color']);\n  }\n  // background\n  get defaultBgColor(): ColorPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['defaultBgColor']);\n  }\n  get frozenRowsBgColor(): ColorPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['frozenRowsBgColor'], ['defaultBgColor']);\n  }\n  get selectionBgColor(): ColorPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['selectionBgColor'], ['defaultBgColor']);\n  }\n  get highlightBgColor(): ColorPropertyDefine {\n    if (this.hasProperty(['highlightBgColor'])) {\n      const { obj, superTheme } = this[_];\n      return getProp(obj, superTheme, ['highlightBgColor']);\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (args: StylePropertyFunctionArg): any => {\n      const color = args.row < args.grid.frozenRowCount ? this.frozenRowsBgColor : this.defaultBgColor;\n      if (typeof color === 'function') {\n        return color(args);\n      }\n      return color;\n    };\n  }\n  // border\n  get borderColor(): ColorsPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['borderColor']);\n  }\n  get frozenRowsBorderColor(): ColorsPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['frozenRowsBorderColor'], ['borderColor']);\n  }\n  get highlightBorderColor(): ColorsPropertyDefine {\n    const { obj, superTheme } = this[_];\n    return getProp(obj, superTheme, ['highlightBorderColor'], ['borderColor']);\n  }\n  get checkbox(): RequiredThemeDefine['checkbox'] {\n    const { obj, superTheme } = this[_];\n    return (\n      this._checkbox ||\n      (this._checkbox = {\n        get uncheckBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['checkbox', 'uncheckBgColor'], ['defaultBgColor']);\n        },\n        get checkBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['checkbox', 'checkBgColor'], ['borderColor']);\n        },\n        get borderColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['checkbox', 'borderColor'], ['borderColor']);\n        }\n      })\n    );\n  }\n  get radioButton(): RequiredThemeDefine['radioButton'] {\n    const { obj, superTheme } = this[_];\n    return (\n      this._radioButton ||\n      (this._radioButton = {\n        get checkColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['radioButton', 'checkColor'], ['color']);\n        },\n        get uncheckBorderColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['radioButton', 'uncheckBorderColor'], ['borderColor']);\n        },\n        get checkBorderColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['radioButton', 'checkBorderColor'], ['borderColor']);\n        },\n        get uncheckBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['radioButton', 'uncheckBgColor'], ['defaultBgColor']);\n        },\n        get checkBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['radioButton', 'checkBgColor'], ['defaultBgColor']);\n        }\n      })\n    );\n  }\n  get button(): RequiredThemeDefine['button'] {\n    const { obj, superTheme } = this[_];\n    return (\n      this._button ||\n      (this._button = {\n        get color(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['button', 'color'], ['color']);\n        },\n        get bgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['button', 'bgColor'], ['defaultBgColor']);\n        }\n      })\n    );\n  }\n  get header(): RequiredThemeDefine['header'] {\n    const { obj, superTheme } = this[_];\n    return (\n      this._header ||\n      (this._header = {\n        get sortArrowColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['header', 'sortArrowColor'], ['color']);\n        }\n      })\n    );\n  }\n  get messages(): RequiredThemeDefine['messages'] {\n    const { obj, superTheme } = this[_];\n    return (\n      this._messages ||\n      (this._messages = {\n        get infoBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['messages', 'infoBgColor']);\n        },\n        get errorBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['messages', 'errorBgColor']);\n        },\n        get warnBgColor(): ColorPropertyDefine {\n          return getProp(obj, superTheme, ['messages', 'warnBgColor']);\n        }\n      })\n    );\n  }\n  hasProperty(names: string[]): boolean {\n    const { obj, superTheme } = this[_];\n    return hasThemeProperty(obj, names) || hasThemeProperty(superTheme, names);\n  }\n  extends(obj: PartialThemeDefine): Theme {\n    return new Theme(obj, this);\n  }\n}\n\nfunction hasThemeProperty(obj: PartialThemeDefine, names: string[]): boolean {\n  if (obj instanceof Theme) {\n    return obj.hasProperty(names);\n  } else {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let o: any = obj;\n    if (!o) {\n      return false;\n    }\n    for (let index = 0; index < names.length; index++) {\n      const name = names[index];\n      o = o[name];\n      if (!o) {\n        return false;\n      }\n    }\n    return !!o;\n  }\n}\n","/*eslint no-bitwise:0*/\n\nimport type { StylePropertyFunctionArg, ThemeDefine } from '../ts-types';\n\nfunction DEFAULT_BG_COLOR(args: StylePropertyFunctionArg): string {\n  const { row, grid } = args;\n  if (row < grid.frozenRowCount) {\n    return '#FFF';\n  }\n  const index = grid.getRecordIndexByRow(row);\n  if (!(index & 1)) {\n    return '#FFF';\n  } else {\n    return '#F6F6F6';\n  }\n}\nconst cacheLinearGradient: { [key: string]: CanvasGradient } = {};\n\nfunction getLinearGradient(context: CanvasRenderingContext2D, left: number, top: number, right: number, bottom: number, colorStops: { [key: number]: string }): CanvasGradient {\n  let stop;\n  const stopsKey = [];\n  for (stop in colorStops) {\n    stopsKey.push(`${stop}@${colorStops[stop]}`);\n  }\n  const key = `${left}/${top}/${right}/${bottom}/${stopsKey.join(',')}`;\n  const ret = cacheLinearGradient[key];\n  if (ret) {\n    return ret;\n  }\n  const grad = context.createLinearGradient(left, top, left, bottom);\n  for (stop in colorStops) {\n    grad.addColorStop(Number(stop), colorStops[stop]);\n  }\n  return (cacheLinearGradient[key] = grad);\n}\nfunction FROZEN_ROWS_BG_COLOR(args: StylePropertyFunctionArg): CanvasGradient {\n  const {\n    col,\n    grid,\n    grid: { frozenRowCount },\n    context\n  } = args;\n  const { left, top } = grid.getCellRelativeRect(col, 0);\n  const { bottom } = grid.getCellRelativeRect(col, frozenRowCount - 1);\n\n  return getLinearGradient(context, left, top, left, bottom, {\n    0: '#FFF',\n    1: '#D3D3D3'\n  });\n}\n/**\n * basic theme\n * @name BASIC\n * @memberof cheetahGrid.themes.choices\n */\nexport default {\n  color: '#000',\n  // frozenRowsColor: '#000',\n\n  defaultBgColor: DEFAULT_BG_COLOR,\n  frozenRowsBgColor: FROZEN_ROWS_BG_COLOR,\n  selectionBgColor: '#CCE0FF',\n\n  borderColor: '#000',\n  // frozenRowsBorderColor: '#000',\n  highlightBorderColor: '#5E9ED6',\n\n  checkbox: {\n    uncheckBgColor: '#FFF',\n    checkBgColor: 'rgb(76, 73, 72)',\n    borderColor: '#000'\n  },\n  radioButton: {\n    checkColor: 'rgb(76, 73, 72)',\n    checkBorderColor: '#000',\n    uncheckBorderColor: '#000',\n    uncheckBgColor: '#FFF',\n    checkBgColor: '#FFF'\n  },\n  button: {\n    color: '#FFF',\n    bgColor: '#2196F3'\n  },\n  header: {\n    sortArrowColor: 'rgba(0, 0, 0, 0.38)'\n  },\n  underlayBackgroundColor: '#F6F6F6'\n} as ThemeDefine;\n","/*eslint no-bitwise:0*/\n\nimport type { StylePropertyFunctionArg, ThemeDefine } from '../ts-types';\n\nfunction FROZEN_ROWS_BORDER_COLOR(args: StylePropertyFunctionArg): string[] {\n  const {\n    row,\n    grid: { frozenRowCount }\n  } = args;\n  if (frozenRowCount - 1 === row) {\n    return ['#f2f2f2', '#f2f2f2', '#ccc7c7', '#f2f2f2'];\n  } else {\n    return ['#f2f2f2'];\n  }\n}\nfunction BORDER_COLOR(args: StylePropertyFunctionArg): (string | null)[] {\n  const { col, row, grid } = args;\n  const { colCount, frozenColCount, recordRowCount } = grid;\n  let top: string | null = '#ccc7c7';\n  let bottom: string | null = '#ccc7c7';\n  if (recordRowCount > 1) {\n    const startRow = grid.getRecordStartRowByRecordIndex(grid.getRecordIndexByRow(row));\n    const endRow = startRow + recordRowCount - 1;\n    if (startRow !== row) {\n      top = null;\n    }\n    if (endRow !== row) {\n      bottom = null;\n    }\n  }\n  if (frozenColCount - 1 === col) {\n    return [top, '#f2f2f2', bottom, null];\n  }\n  if (colCount - 1 === col) {\n    return [top, '#f2f2f2', bottom, null];\n  }\n\n  return [top, null, bottom, null];\n}\n/**\n * material design theme\n * @name MATERIAL_DESIGN\n * @memberof cheetahGrid.themes.choices\n */\nexport default {\n  color: 'rgba(0, 0, 0, 0.87)',\n  frozenRowsColor: 'rgba(0, 0, 0, 0.54)',\n\n  defaultBgColor: '#FFF',\n  // frozenRowsBgColor: '#FFF',\n  selectionBgColor: '#CCE0FF',\n\n  borderColor: BORDER_COLOR,\n  frozenRowsBorderColor: FROZEN_ROWS_BORDER_COLOR,\n  highlightBorderColor: '#5E9ED6',\n\n  checkbox: {\n    // uncheckBgColor: '#FFF',\n    checkBgColor: 'rgb(76, 73, 72)',\n    borderColor: 'rgba(0, 0, 0, 0.26)'\n  },\n  radioButton: {\n    checkColor: 'rgb(76, 73, 72)',\n    checkBorderColor: 'rgb(76, 73, 72)',\n    uncheckBorderColor: 'rgb(189, 189, 189)'\n    // uncheckBgColor: \"#FFF\",\n    // checkBgColor: \"#FFF\",\n  },\n  button: {\n    color: '#FFF',\n    bgColor: '#2196F3'\n  },\n  header: {\n    sortArrowColor: 'rgba(0, 0, 0, 0.38)'\n  },\n  underlayBackgroundColor: '#FFF'\n} as ThemeDefine;\n","import type { Theme } from '../themes/theme';\n\nexport const themes: { [key: string]: Theme } = {};\n","import { extend, getIgnoreCase } from './internal/utils';\nimport { Theme } from './themes/theme';\nimport type { ThemeDefine } from './ts-types';\nimport basicTheme from './themes/BASIC';\nimport materialDesignTheme from './themes/MATERIAL_DESIGN';\nimport { themes as plugins } from './plugins/themes';\n\nexport const BASIC = new Theme(basicTheme);\nexport const MATERIAL_DESIGN = new Theme(materialDesignTheme);\n\nconst builtin: { [key: string]: Theme } = {\n  BASIC,\n  MATERIAL_DESIGN\n};\nlet defTheme = MATERIAL_DESIGN;\n\nexport const theme = { Theme };\n\nexport function of(value: ThemeDefine | string | undefined | null): Theme | null {\n  if (!value) {\n    return null;\n  }\n  if (typeof value === 'string') {\n    const t = getIgnoreCase(getChoices(), value);\n    if (t) {\n      return t;\n    }\n    return null;\n  }\n  if (value instanceof Theme) {\n    return value;\n  }\n  return new Theme(value);\n}\n\nexport function getDefault(): Theme {\n  return defTheme;\n}\n\nexport function setDefault(defaultTheme: Theme): void {\n  defTheme = of(defaultTheme) || defTheme;\n}\n\nexport function getChoices(): { [key: string]: Theme } {\n  return extend(builtin, plugins);\n}\n\nexport const themes = {\n  BASIC,\n  MATERIAL_DESIGN,\n  theme,\n  of,\n  getDefault,\n  getChoices\n};\n","import type { MaybePromise } from '../ts-types';\nimport { isPromise } from './utils';\n\nfunction createArray<T>(get: (i: number) => T, length: number): T[] {\n  const array = new Array<T>(length);\n  for (let i = 0; i < length; i++) {\n    array[i] = get(i);\n  }\n  return array;\n}\nfunction createArrayPromise<R>(get: (i: number) => MaybePromise<R>, getField: undefined, length: number): Promise<{ v: R; f: R }[]>;\nfunction createArrayPromise<R, F>(get: (i: number) => MaybePromise<R>, getField: (r: R) => MaybePromise<F>, length: number): Promise<{ v: R; f: F }[]>;\nfunction createArrayPromise<R, F>(\n  get: (i: number) => MaybePromise<R>,\n  getField: ((r: R) => MaybePromise<F>) | undefined,\n  length: number\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n): Promise<any[]> {\n  return new Promise((resolve) => {\n    const plist = [];\n    const array = new Array<{ v: MaybePromise<R>; f: MaybePromise<R> }>(length);\n    for (let i = 0; i < length; i++) {\n      const data = get(i);\n      const record = {\n        v: data,\n        f: data\n      };\n      array[i] = record;\n      if (isPromise(data)) {\n        plist.push(\n          data.then((v) => {\n            record.v = v;\n            record.f = v;\n          })\n        );\n      }\n    }\n    Promise.all(plist)\n      .then(() =>\n        getField == null\n          ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          (array as any)\n          : // eslint-disable-next-line @typescript-eslint/no-explicit-any\n          setArrayField(array as any, getField)\n      )\n      .then(resolve);\n  });\n}\nfunction setArrayField<R, F>(array: { v: R; f: R | F }[], getField: (r: R) => MaybePromise<F>): Promise<{ v: R; f: F }[]> {\n  return new Promise((resolve) => {\n    const { length } = array;\n    const plist = [];\n    for (let i = 0; i < length; i++) {\n      const record = array[i];\n      const f = getField(record.v);\n      if (isPromise(f)) {\n        plist.push(\n          f.then((v) => {\n            record.f = v;\n          })\n        );\n      } else {\n        record.f = f;\n      }\n    }\n    Promise.all(plist).then(() => resolve(array as { v: R; f: F }[]));\n  });\n}\nexport function sortArray<T>(array: T[], compare: (a: T, b: T) => number): void {\n  Array.prototype.sort.call(array, compare);\n}\n\nexport function sort<R, _F>(get: (i: number) => R, set: (i: number, r: R) => void, length: number, compare: (a: R, b: R) => number): void;\nexport function sort<R, F>(get: (i: number) => R, set: (i: number, r: R) => void, length: number, compare: (a: F, b: F) => number, getField: (r: R) => F): void;\nexport function sort<R, F>(get: (i: number) => R, set: (i: number, r: R) => void, length: number, compare: ((a: R, b: R) => number) | ((a: F, b: F) => number), getField?: (r: R) => F): void {\n  const old = createArray(get, length);\n  if (getField != null) {\n    old.sort((r1, r2) => (compare as (a: F, b: F) => number)(getField(r1), getField(r2)));\n  } else {\n    old.sort(compare as (a: R, b: R) => number);\n  }\n  for (let i = 0; i < length; i++) {\n    set(i, old[i]);\n  }\n}\n\nexport function sortPromise<R, _F>(get: (i: number) => MaybePromise<R>, set: (i: number, r: R) => void, length: number, compare: (a: R, b: R) => number): void;\nexport function sortPromise<R, F>(\n  get: (i: number) => MaybePromise<R>,\n  set: (i: number, r: R) => void,\n  length: number,\n  compare: (a: F, b: F) => number,\n  getField: (r: R) => MaybePromise<F | undefined>\n): Promise<void>;\nexport function sortPromise<R, F>(\n  get: (i: number) => MaybePromise<R>,\n  set: (i: number, r: R) => void,\n  length: number,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  compare: any,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getField?: any\n): Promise<void> {\n  if (typeof Promise !== 'undefined') {\n    return createArrayPromise(get, getField, length).then((array) => {\n      array.sort((r1, r2) => compare(r1.f, r2.f));\n      for (let i = 0; i < length; i++) {\n        set(i, array[i].v);\n      }\n    });\n  } else {\n    sort(get as (i: number) => R, set, length, compare as (a: F, b: F) => number, getField as (r: R) => F);\n    const dummyPromise: Promise<undefined> = {\n      then(fn: () => void): Promise<undefined> {\n        fn();\n        return dummyPromise;\n      },\n      catch(): Promise<undefined> {\n        return dummyPromise;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    } as any;\n    return dummyPromise;\n  }\n}\n","import * as sort from '../internal/sort';\nimport type { DataSourceAPI, FieldAssessor, FieldData, FieldDef, MaybePromise, MaybePromiseOrCall, MaybePromiseOrCallOrUndef, MaybePromiseOrUndef } from '../ts-types';\nimport { applyChainSafe, array, emptyFn, getOrApply, isPromise, obj } from '../internal/utils';\nimport { EventTarget } from '../core/EventTarget';\nimport type { PromiseCacheValue } from './internal/types';\n\n/** @private */\nfunction isFieldAssessor<T>(field: FieldDef<T>): field is FieldAssessor<T> {\n  if (obj.isObject(field)) {\n    if ((field as FieldAssessor<T>).get && (field as FieldAssessor<T>).set) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/** @private */\nconst EVENT_TYPE = {\n  UPDATE_LENGTH: 'update_length',\n  UPDATED_LENGTH: 'updated_length',\n  UPDATED_ORDER: 'updated_order'\n} as const;\n\n/** @private */\ntype PromiseBack<V> = (value: PromiseCacheValue<V>) => void;\n\n/** @private */\nfunction getValue<V>(value: MaybePromiseOrCallOrUndef<V, []>, setPromiseBack: PromiseBack<V>): MaybePromiseOrUndef<V> {\n  const maybePromiseValue = getOrApply(value);\n  if (isPromise(maybePromiseValue)) {\n    const promiseValue = maybePromiseValue.then((r: V | undefined) => {\n      setPromiseBack(r);\n      return r;\n    });\n    //\n    setPromiseBack(promiseValue);\n    return promiseValue;\n  } else {\n    return maybePromiseValue;\n  }\n}\n\n/** @private */\nfunction getField<T, F extends FieldDef<T>>(\n  record: MaybePromiseOrUndef<T>,\n  field: F,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  setPromiseBack: PromiseBack<any>\n): FieldData {\n  if (record == null) {\n    return undefined;\n  }\n  if (isPromise(record)) {\n    return record.then((r: T | undefined) => getField(r, field, setPromiseBack));\n  }\n  const fieldGet = isFieldAssessor<T>(field) ? field.get : field;\n  if ((fieldGet as never) in record) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const fieldResult = (record as any)[fieldGet];\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return getValue(fieldResult, setPromiseBack);\n  }\n  if (typeof fieldGet === 'function') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const fieldResult = (fieldGet as any)(record);\n    return getValue(fieldResult, setPromiseBack);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n  const ss = `${fieldGet}`.split('.');\n  if (ss.length <= 1) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const fieldResult = (record as any)[fieldGet];\n    return getValue(fieldResult, setPromiseBack);\n  }\n  const fieldResult = applyChainSafe(\n    record,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (val, name) => getField(val, name, emptyFn as any),\n    ...ss\n  );\n  return getValue(fieldResult, setPromiseBack);\n}\n\n/** @private */\nfunction setField<T, F extends FieldDef<T>>(\n  record: T | undefined,\n  field: F,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any\n): boolean {\n  if (record == null) {\n    return false;\n  }\n\n  const fieldSet = isFieldAssessor<T>(field) ? field.set : field;\n  if ((fieldSet as never) in record) {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (record as any)[fieldSet] = value;\n  } else if (typeof fieldSet === 'function') {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return (fieldSet as any)(record, value);\n  } else if (typeof fieldSet === 'string') {\n    const ss = `${fieldSet}`.split('.');\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    let obj: any = record;\n    const { length } = ss;\n    for (let i = 0; i < length; i++) {\n      const f = ss[i];\n      if (i === length - 1) {\n        obj[f] = value;\n      } else {\n        obj = obj[f] || (obj[f] = {});\n      }\n    }\n  } else {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (record as any)[fieldSet] = value;\n  }\n  return true;\n}\n/** @private */\nfunction _getIndex(sortedIndexMap: null | number[], index: number): number {\n  if (!sortedIndexMap) {\n    return index;\n  }\n  const mapIndex = sortedIndexMap[index];\n  return mapIndex != null ? mapIndex : index;\n}\n\nexport interface DataSourceParam<T> {\n  get: (index: number) => T;\n  length: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  source?: any;\n}\n\n/**\n * grid data source\n *\n * @classdesc cheetahGrid.data.DataSource\n * @memberof cheetahGrid.data\n */\nexport class DataSource<T> extends EventTarget implements DataSourceAPI<T> {\n  private _get: (index: number) => MaybePromiseOrCall<T, []>;\n  private _length: number;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private readonly _source: any;\n  protected _sortedIndexMap: null | number[] = null;\n  static get EVENT_TYPE(): typeof EVENT_TYPE {\n    return EVENT_TYPE;\n  }\n  static ofArray<T>(array: T[]): DataSource<T> {\n    return new DataSource<T>({\n      get: (index: number): T => array[index],\n      length: array.length,\n      source: array\n    });\n  }\n  constructor(obj?: DataSourceParam<T> | DataSource<T>) {\n    super();\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    this._get = obj?.get.bind(obj) || (undefined as any);\n    this._length = obj?.length || 0;\n    this._source = obj?.source ?? obj;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  get source(): any {\n    return this._source;\n  }\n  get(index: number): MaybePromiseOrUndef<T> {\n    return this.getOriginal(_getIndex(this._sortedIndexMap, index));\n  }\n  getField<F extends FieldDef<T>>(index: number, field: F): FieldData {\n    return this.getOriginalField(_getIndex(this._sortedIndexMap, index), field);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  hasField(index: number, field: FieldDef<T>): boolean {\n    return this.hasOriginalField(_getIndex(this._sortedIndexMap, index), field);\n  }\n  setField<F extends FieldDef<T>>(\n    index: number,\n    field: F,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    value: any\n  ): MaybePromise<boolean> {\n    return this.setOriginalField(_getIndex(this._sortedIndexMap, index), field, value);\n  }\n  sort(field: FieldDef<T>, order: 'desc' | 'asc'): MaybePromise<void> {\n    const sortedIndexMap = new Array<number>(this._length);\n\n    const orderFn: (v1: T, v2: T) => -1 | 0 | 1 =\n      order !== 'desc' ? (v1: T, v2: T): -1 | 0 | 1 => (v1 === v2 ? 0 : v1 > v2 ? 1 : -1) : (v1: T, v2: T): -1 | 0 | 1 => (v1 === v2 ? 0 : v1 < v2 ? 1 : -1);\n\n    return sort\n      .sortPromise(\n        (index) => (sortedIndexMap[index] != null ? sortedIndexMap[index] : (sortedIndexMap[index] = index)),\n        (index, rel) => {\n          sortedIndexMap[index] = rel;\n        },\n        this._length,\n        orderFn,\n        (index) => this.getOriginalField(index, field)\n      )\n      .then(() => {\n        this._sortedIndexMap = sortedIndexMap;\n        this.fireListeners(EVENT_TYPE.UPDATED_ORDER);\n      });\n  }\n  get length(): number {\n    return this._length;\n  }\n  set length(length: number) {\n    if (this._length === length) {\n      return;\n    }\n\n    const results = this.fireListeners(EVENT_TYPE.UPDATE_LENGTH, length);\n    if (array.findIndex(results, (v) => !v) >= 0) {\n      return;\n    }\n    this._length = length;\n    this.fireListeners(EVENT_TYPE.UPDATED_LENGTH, this._length);\n  }\n  get dataSource(): DataSource<T> {\n    return this;\n  }\n  dispose(): void {\n    super.dispose();\n  }\n  protected getOriginal(index: number): MaybePromiseOrUndef<T> {\n    return getValue(this._get(index), (val: PromiseCacheValue<T>) => {\n      this.recordPromiseCallBackInternal(index, val);\n    });\n  }\n  protected getOriginalField<F extends FieldDef<T>>(index: number, field: F): FieldData {\n    if (field == null) {\n      return undefined;\n    }\n    const record = this.getOriginal(index);\n    return getField(record, field, (val) => {\n      this.fieldPromiseCallBackInternal(index, field, val);\n    });\n  }\n  protected hasOriginalField(index: number, field: FieldDef<T>): boolean {\n    if (field == null) {\n      return false;\n    }\n    if (typeof field === 'function') {\n      return true;\n    }\n    const record = this.getOriginal(index);\n    return Boolean(record && (field as never) in record);\n  }\n  protected setOriginalField<F extends FieldDef<T>>(\n    index: number,\n    field: F,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    value: any\n  ): MaybePromise<boolean> {\n    if (field == null) {\n      return false;\n    }\n    const record = this.getOriginal(index);\n    if (isPromise(record)) {\n      return record.then((r) => setField(r, field, value));\n    }\n    return setField(record, field, value);\n  }\n  protected fieldPromiseCallBackInternal<F extends FieldDef<T>>(\n    _index: number,\n    _field: F,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    _value: PromiseCacheValue<any>\n  ): void {\n    //\n  }\n  protected recordPromiseCallBackInternal(_index: number, _record: PromiseCacheValue<T>): void {\n    //\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  static EMPTY = new DataSource<any>({\n    get(): void {\n      /*noop */\n    },\n    length: 0\n  });\n}\n","import type { FieldData, FieldDef, MaybePromise, MaybePromiseOrUndef } from '../ts-types';\nimport { DataSource } from './DataSource';\nimport type { DataSourceParam } from './DataSource';\nimport type { PromiseCacheValue } from './internal/types';\n\n/** @private */\nfunction _setFieldCache<T, F extends FieldDef<T>>(\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  fCache: { [index: number]: Map<FieldDef<T>, any> },\n  index: number,\n  field: F,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: PromiseCacheValue<any>\n): void {\n  const recCache = fCache[index] || (fCache[index] = new Map());\n  recCache.set(field, value);\n}\n/**\n * grid data source for caching Promise data\n *\n * @classdesc cheetahGrid.data.CachedDataSource\n * @memberof cheetahGrid.data\n */\nexport class CachedDataSource<T> extends DataSource<T> {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _rCache: { [index: number]: any };\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private _fCache: { [index: number]: Map<FieldDef<T>, any> };\n  static get EVENT_TYPE(): typeof DataSource.EVENT_TYPE {\n    return DataSource.EVENT_TYPE;\n  }\n  static ofArray<T>(array: T[]): CachedDataSource<T> {\n    return new CachedDataSource({\n      get: (index: number): T => array[index],\n      length: array.length,\n      source: array\n    });\n  }\n  constructor(opt?: DataSourceParam<T>) {\n    super(opt);\n    this._rCache = {};\n    this._fCache = {};\n  }\n  protected getOriginal(index: number): MaybePromiseOrUndef<T> {\n    if (this._rCache && this._rCache[index]) {\n      return this._rCache[index];\n    }\n    return super.getOriginal(index);\n  }\n  protected getOriginalField<F extends FieldDef<T>>(index: number, field: F): FieldData {\n    const rowCache = this._fCache && this._fCache[index];\n    if (rowCache) {\n      const cache = rowCache.get(field);\n      if (cache) {\n        return cache;\n      }\n    }\n    return super.getOriginalField(index, field);\n  }\n  protected setOriginalField<F extends FieldDef<T>>(\n    index: number,\n    field: F,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    value: any\n  ): MaybePromise<boolean> {\n    const fCache = this._fCache;\n    if (fCache && fCache[index]) {\n      delete fCache[index]; // clear row cache\n    }\n    return super.setOriginalField(index, field, value);\n  }\n  clearCache(): void {\n    if (this._rCache) {\n      this._rCache = {};\n    }\n    if (this._fCache) {\n      this._fCache = {};\n    }\n  }\n  protected fieldPromiseCallBackInternal<F extends FieldDef<T>>(\n    index: number,\n    field: F,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    value: PromiseCacheValue<any>\n  ): void {\n    _setFieldCache(this._fCache, index, field, value);\n  }\n  protected recordPromiseCallBackInternal(\n    index: number,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    record: PromiseCacheValue<T>\n  ): void {\n    this._rCache[index] = record;\n  }\n  dispose(): void {\n    super.dispose();\n  }\n}\n","import type { BaseActionOption, EventListenerId, LayoutObjectId, ListGridAPI } from '../../ts-types';\n\nexport class BaseAction<T> {\n  protected _disabled: boolean;\n  constructor(option: BaseActionOption = {}) {\n    this._disabled = !!option.disabled || false;\n  }\n  get disabled(): boolean {\n    return this._disabled;\n  }\n  set disabled(disabled: boolean) {\n    this._disabled = disabled;\n    this.onChangeDisabledInternal();\n  }\n  clone(): BaseAction<T> {\n    return new BaseAction(this);\n  }\n  bindGridEvent(_grid: ListGridAPI<T>, _cellId: LayoutObjectId): EventListenerId[] {\n    return [];\n  }\n  onChangeDisabledInternal(): void {\n    // impl\n  }\n}\n","import type { CellAddress, EventListenerId, LayoutObjectId, ListGridAPI } from '../../ts-types';\nimport { DG_EVENT_TYPE } from '../../core/DG_EVENT_TYPE';\nimport { event } from '../../internal/utils';\nconst KEY_ENTER = 13;\nconst KEY_SPACE = 32;\nexport function bindCellClickAction<T>(\n  grid: ListGridAPI<T>,\n  cellId: LayoutObjectId,\n  {\n    action,\n    mouseOver,\n    mouseOut\n  }: {\n    action: (cell: CellAddress) => void;\n    mouseOver?: (cell: CellAddress) => boolean;\n    mouseOut?: (cell: CellAddress) => void;\n  }\n): EventListenerId[] {\n  function isTarget(col: number, row: number): boolean {\n    return grid.getLayoutCellId(col, row) === cellId;\n  }\n  let inMouse: boolean;\n  return [\n    // click\n    grid.listen(DG_EVENT_TYPE.CLICK_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      action({\n        col: e.col,\n        row: e.row\n      });\n    }),\n    // mouse move\n    grid.listen(DG_EVENT_TYPE.MOUSEOVER_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (mouseOver) {\n        if (\n          !mouseOver({\n            col: e.col,\n            row: e.row\n          })\n        ) {\n          return;\n        }\n      }\n      grid.getElement().style.cursor = 'pointer';\n      inMouse = true;\n    }),\n    //MOUSEENTER'col-resize'move\n    grid.listen(DG_EVENT_TYPE.MOUSEMOVE_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (inMouse && !grid.getElement().style.cursor) {\n        grid.getElement().style.cursor = 'pointer';\n      }\n    }),\n    grid.listen(DG_EVENT_TYPE.MOUSEOUT_CELL, (e) => {\n      if (!isTarget(e.col, e.row)) {\n        return;\n      }\n      if (mouseOut) {\n        mouseOut({\n          col: e.col,\n          row: e.row\n        });\n      }\n      grid.getElement().style.cursor = '';\n      inMouse = false;\n    })\n  ];\n}\nexport function bindCellKeyAction<T>(\n  grid: ListGridAPI<T>,\n  cellId: LayoutObjectId,\n  {\n    action,\n    acceptKeys = []\n  }: {\n    action: (cell: CellAddress) => void;\n    acceptKeys?: number[];\n  }\n): EventListenerId[] {\n  function isTarget(col: number, row: number): boolean {\n    return grid.getLayoutCellId(col, row) === cellId;\n  }\n  acceptKeys = [...acceptKeys, KEY_ENTER, KEY_SPACE];\n  return [\n    // enter key down\n    grid.listen(DG_EVENT_TYPE.KEYDOWN, (e) => {\n      if (acceptKeys.indexOf(e.keyCode) === -1) {\n        return;\n      }\n      if (grid.keyboardOptions?.moveCellOnEnter && e.keyCode === KEY_ENTER) {\n        // When moving with the enter key, no action is taken with the enter key.\n        return;\n      }\n      const sel = grid.selection.select;\n      if (!isTarget(sel.col, sel.row)) {\n        return;\n      }\n      action({\n        col: sel.col,\n        row: sel.row\n      });\n      event.cancel(e.event);\n    })\n  ];\n}\n","import type { CellAddress, EventListenerId, LayoutObjectId } from '../../ts-types';\nimport type { CheckHeaderState, GridInternal } from '../../ts-types-internal';\nimport { bindCellClickAction, bindCellKeyAction } from './actionBind';\nimport { BaseAction } from './BaseAction';\nimport { animate } from '../../internal/animate';\nimport { getCheckHeaderStateId } from '../../internal/symbolManager';\nimport { obj } from '../../internal/utils';\n\nconst CHECK_HEADER_STATE_ID = getCheckHeaderStateId();\n\nfunction getState<T>(grid: GridInternal<T>): CheckHeaderState {\n  let state = grid[CHECK_HEADER_STATE_ID];\n  if (!state) {\n    state = { elapsed: {}, block: {} };\n    obj.setReadonly(grid, CHECK_HEADER_STATE_ID, state);\n  }\n  return state;\n}\n\nexport class CheckHeaderAction<T> extends BaseAction<T> {\n  clone(): CheckHeaderAction<T> {\n    return new CheckHeaderAction(this);\n  }\n  bindGridEvent(grid: GridInternal<T>, cellId: LayoutObjectId): EventListenerId[] {\n    const state = getState(grid);\n\n    const action = ({ col, row }: CellAddress): void => {\n      const range = grid.getCellRange(col, row);\n      const cellKey = `${range.start.col}:${range.start.row}`;\n      if (this.disabled || state.block[cellKey]) {\n        return;\n      }\n      const checked = grid.getHeaderValue(range.start.col, range.start.row);\n      grid.setHeaderValue(range.start.col, range.start.row, !checked);\n\n      const onChange = (): void => {\n        // checkbox animation\n        animate(200, (point) => {\n          if (point === 1) {\n            delete state.elapsed[cellKey];\n          } else {\n            state.elapsed[cellKey] = point;\n          }\n          grid.invalidateCellRange(range);\n        });\n      };\n      onChange();\n    };\n    return [\n      ...bindCellClickAction(grid, cellId, {\n        action,\n        mouseOver: (e) => {\n          if (this.disabled) {\n            return false;\n          }\n          state.mouseActiveCell = {\n            col: e.col,\n            row: e.row\n          };\n\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n          return true;\n        },\n        mouseOut: (e) => {\n          delete state.mouseActiveCell;\n          const range = grid.getCellRange(e.col, e.row);\n          grid.invalidateCellRange(range);\n        }\n      }),\n      ...bindCellKeyAction(grid, cellId, {\n        action\n      })\n    ];\n  }\n}\n","import type { CellAddress, EventListenerId, LayoutObjectId, ListGridAPI, SortHeaderActionOption, SortOption, SortState } from '../../ts-types';\nimport { BaseAction } from './BaseAction';\nimport { bindCellClickAction } from './actionBind';\n\nexport class SortHeaderAction<T> extends BaseAction<T> {\n  private _sort: SortOption<T>;\n  constructor(option: SortHeaderActionOption<T> = {}) {\n    super(option);\n    this._sort = option.sort ?? true;\n  }\n  get sort(): SortOption<T> {\n    return this._sort;\n  }\n  set sort(sort: SortOption<T>) {\n    this._sort = sort;\n    this.onChangeDisabledInternal();\n  }\n  clone(): SortHeaderAction<T> {\n    return new SortHeaderAction(this);\n  }\n  _executeSort(newState: SortState, grid: ListGridAPI<T>): void {\n    if (typeof this._sort === 'function') {\n      this._sort({\n        order: newState.order || 'asc',\n        col: newState.col,\n        row: newState.row,\n        grid\n      });\n    } else {\n      const fieldRow = Math.min(grid.recordRowCount - 1, newState.row) + grid.frozenRowCount;\n      const field = grid.getField(newState.col, fieldRow);\n      if (field == null) {\n        return;\n      }\n      grid.dataSource.sort(field, newState.order || 'asc');\n    }\n  }\n  bindGridEvent(grid: ListGridAPI<T>, cellId: LayoutObjectId): EventListenerId[] {\n    function isTarget(col: number, row: number): boolean {\n      return grid.getLayoutCellId(col, row) === cellId;\n    }\n    const action = (cell: CellAddress): void => {\n      if (this.disabled) {\n        return;\n      }\n      const state = grid.sortState as SortState;\n      let newState: SortState;\n      const range = grid.getCellRange(cell.col, cell.row);\n      if (isTarget(state.col, cell.row)) {\n        newState = {\n          col: range.start.col,\n          row: range.start.row,\n          order: state.order === 'asc' ? 'desc' : 'asc'\n        };\n      } else {\n        newState = {\n          col: range.start.col,\n          row: range.start.row,\n          order: 'asc'\n        };\n      }\n      grid.sortState = newState;\n      this._executeSort(newState, grid);\n      grid.invalidateGridRect(0, 0, grid.colCount - 1, grid.rowCount - 1);\n    };\n\n    return [\n      ...bindCellClickAction(grid, cellId, {\n        action,\n        mouseOver: (_e) => {\n          if (this.disabled) {\n            return false;\n          }\n          return true;\n        }\n      })\n    ];\n  }\n}\n","import type { BaseActionOption, HeaderActionOption, SortHeaderActionOption, SortOption } from '../ts-types';\nimport { BaseAction } from './action/BaseAction';\nimport type { BaseHeaderDefine } from '../list-grid/layout-map/api';\nimport { CheckHeaderAction } from './action/CheckHeaderAction';\nimport { SortHeaderAction } from './action/SortHeaderAction';\n\nclass ImmutableSortHeaderAction<T> extends SortHeaderAction<T> {\n  get disabled(): boolean {\n    return this._disabled;\n  }\n}\n\nclass ImmutableCheckHeaderAction<T> extends CheckHeaderAction<T> {\n  get disabled(): boolean {\n    return this._disabled;\n  }\n}\n\nexport interface ImmutableHeaderActions {\n  SORT: ImmutableSortHeaderAction<any>;\n  CHECK: ImmutableCheckHeaderAction<any>;\n  // SWITCH: ImmutableSwitchHeaderAction<any>\n}\n\nexport const ACTIONS = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  SORT: new ImmutableSortHeaderAction<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  CHECK: new ImmutableCheckHeaderAction<any>()\n};\n/**\n * column actions\n * @namespace cheetahGrid.columns.action\n * @memberof cheetahGrid.columns\n */\nexport {\n  BaseAction,\n  SortHeaderAction,\n  CheckHeaderAction,\n  // types\n  BaseActionOption,\n  SortHeaderActionOption\n};\n\nexport function of<T>(headerAction: HeaderActionOption | BaseAction<T> | null | undefined): BaseAction<T> | undefined {\n  if (!headerAction) {\n    return undefined;\n  } else if (typeof headerAction === 'string') {\n    const key = headerAction.toUpperCase() as keyof typeof ACTIONS;\n    return ACTIONS[key] || of(null);\n  } else {\n    return headerAction;\n  }\n}\n\nexport function ofCell<T>(headerCell: BaseHeaderDefine<T>): BaseAction<T> | undefined {\n  if (headerCell.sort) {\n    if (typeof headerCell.sort === 'function') {\n      const sortMethod = headerCell.sort;\n      // 0.9.0 Backward compatibility\n      const sort: SortOption<T> = ({ order, col, grid }): void => sortMethod.call(headerCell, order, col, grid);\n      return new ImmutableSortHeaderAction({ sort });\n    }\n    return ACTIONS.SORT;\n  }\n  return of(headerCell.headerAction);\n}\n","import type { BaseStyleOption, ColorDef, ColumnStyle } from '../../ts-types';\nimport { EventTarget } from '../../core/EventTarget';\n\nconst EVENT_TYPE = {\n  CHANGE_STYLE: 'change_style'\n};\n\nlet defaultStyle: BaseStyle;\nexport class BaseStyle extends EventTarget implements ColumnStyle {\n  private _bgColor?: ColorDef;\n  static get EVENT_TYPE(): { CHANGE_STYLE: string } {\n    return EVENT_TYPE;\n  }\n  static get DEFAULT(): BaseStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new BaseStyle());\n  }\n  constructor({ bgColor }: BaseStyleOption = {}) {\n    super();\n    this._bgColor = bgColor;\n  }\n  get bgColor(): ColorDef | undefined {\n    return this._bgColor;\n  }\n  set bgColor(bgColor: ColorDef | undefined) {\n    this._bgColor = bgColor;\n    this.doChangeStyle();\n  }\n  doChangeStyle(): void {\n    this.fireListeners(EVENT_TYPE.CHANGE_STYLE);\n  }\n  clone(): BaseStyle {\n    return new BaseStyle(this);\n  }\n}\n","import { BaseStyle } from './BaseStyle';\nimport type { StdBaseStyleOption } from '../../ts-types';\n\nlet defaultStyle: StdBaseStyle;\nexport class StdBaseStyle extends BaseStyle {\n  private _textAlign: CanvasTextAlign;\n  private _textBaseline: CanvasTextBaseline;\n  static get DEFAULT(): StdBaseStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new StdBaseStyle());\n  }\n  constructor(style: StdBaseStyleOption = {}) {\n    super(style);\n    this._textAlign = style.textAlign || 'left';\n    this._textBaseline = style.textBaseline || 'middle';\n  }\n  get textAlign(): CanvasTextAlign {\n    return this._textAlign;\n  }\n  set textAlign(textAlign: CanvasTextAlign) {\n    this._textAlign = textAlign;\n    this.doChangeStyle();\n  }\n  get textBaseline(): CanvasTextBaseline {\n    return this._textBaseline;\n  }\n  set textBaseline(textBaseline: CanvasTextBaseline) {\n    this._textBaseline = textBaseline;\n    this.doChangeStyle();\n  }\n  clone(): StdBaseStyle {\n    return new StdBaseStyle(this);\n  }\n}\n","import type { ColorDef, HeaderStdStyleOption, TextOverflow } from '../../ts-types';\nimport { StdBaseStyle } from './StdBaseStyle';\nlet defaultStyle: Style;\nexport class Style extends StdBaseStyle {\n  private _color?: ColorDef;\n  private _font?: string;\n  private _textOverflow: TextOverflow;\n  static get DEFAULT(): Style {\n    return defaultStyle ? defaultStyle : (defaultStyle = new Style());\n  }\n  constructor(style: HeaderStdStyleOption = {}) {\n    super(style);\n    this._color = style.color;\n    this._font = style.font;\n    this._textOverflow = style.textOverflow || 'ellipsis';\n  }\n  get color(): ColorDef | undefined {\n    return this._color;\n  }\n  set color(color: ColorDef | undefined) {\n    this._color = color;\n    this.doChangeStyle();\n  }\n  get font(): string | undefined {\n    return this._font;\n  }\n  set font(font: string | undefined) {\n    this._font = font;\n    this.doChangeStyle();\n  }\n  get textOverflow(): TextOverflow {\n    return this._textOverflow;\n  }\n  set textOverflow(textOverflow: TextOverflow) {\n    this._textOverflow = textOverflow;\n    this.doChangeStyle();\n  }\n  clone(): Style {\n    return new Style(this);\n  }\n}\n","import type { CheckHeaderStyleOption, ColorDef } from '../../ts-types';\nimport { Style } from './Style';\nimport { defaults } from '../../internal/utils';\n\nlet defaultStyle: CheckHeaderStyle;\nexport class CheckHeaderStyle extends Style {\n  private _uncheckBgColor?: ColorDef;\n  private _checkBgColor?: ColorDef;\n  private _borderColor?: ColorDef;\n  static get DEFAULT(): CheckHeaderStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new CheckHeaderStyle());\n  }\n  constructor(style: CheckHeaderStyleOption = {}) {\n    super(defaults(style, { textAlign: 'center' }));\n    const { uncheckBgColor, checkBgColor, borderColor } = style;\n    this._uncheckBgColor = uncheckBgColor;\n    this._checkBgColor = checkBgColor;\n    this._borderColor = borderColor;\n  }\n  get uncheckBgColor(): ColorDef | undefined {\n    return this._uncheckBgColor;\n  }\n  set uncheckBgColor(uncheckBgColor: ColorDef | undefined) {\n    this._uncheckBgColor = uncheckBgColor;\n    this.doChangeStyle();\n  }\n  get checkBgColor(): ColorDef | undefined {\n    return this._checkBgColor;\n  }\n  set checkBgColor(checkBgColor: ColorDef | undefined) {\n    this._checkBgColor = checkBgColor;\n    this.doChangeStyle();\n  }\n  get borderColor(): ColorDef | undefined {\n    return this._borderColor;\n  }\n  set borderColor(borderColor: ColorDef | undefined) {\n    this._borderColor = borderColor;\n    this.doChangeStyle();\n  }\n  clone(): CheckHeaderStyle {\n    return new CheckHeaderStyle(this);\n  }\n}\n","import type { LineClamp, MultilineTextHeaderStyleOption } from '../../ts-types';\nimport { Style } from './Style';\n\nlet defaultStyle: MultilineTextHeaderStyle;\nexport class MultilineTextHeaderStyle extends Style {\n  private _lineHeight: string | number;\n  private _autoWrapText: boolean;\n  private _lineClamp?: LineClamp;\n  static get DEFAULT(): MultilineTextHeaderStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new MultilineTextHeaderStyle());\n  }\n  constructor(style: MultilineTextHeaderStyleOption = {}) {\n    super(style);\n    this._lineHeight = style.lineHeight || '1em';\n    this._autoWrapText = style.autoWrapText || false;\n    this._lineClamp = style.lineClamp;\n  }\n  clone(): MultilineTextHeaderStyle {\n    return new MultilineTextHeaderStyle(this);\n  }\n  get lineHeight(): string | number {\n    return this._lineHeight;\n  }\n  set lineHeight(lineHeight: string | number) {\n    this._lineHeight = lineHeight;\n    this.doChangeStyle();\n  }\n  get lineClamp(): LineClamp | undefined {\n    return this._lineClamp;\n  }\n  set lineClamp(lineClamp: LineClamp | undefined) {\n    this._lineClamp = lineClamp;\n    this.doChangeStyle();\n  }\n  get autoWrapText(): boolean {\n    return this._autoWrapText;\n  }\n  set autoWrapText(autoWrapText: boolean) {\n    this._autoWrapText = autoWrapText;\n    this.doChangeStyle();\n  }\n}\n","import type { ColorDef, SortHeaderStyleOption } from '../../ts-types';\nimport { Style } from './Style';\n\nlet defaultStyle: SortHeaderStyle;\nexport class SortHeaderStyle extends Style {\n  private _sortArrowColor?: ColorDef;\n  static get DEFAULT(): SortHeaderStyle {\n    return defaultStyle ? defaultStyle : (defaultStyle = new SortHeaderStyle());\n  }\n  constructor(style: SortHeaderStyleOption = {}) {\n    super(style);\n    this._sortArrowColor = style.sortArrowColor;\n  }\n  get sortArrowColor(): ColorDef | undefined {\n    return this._sortArrowColor;\n  }\n  set sortArrowColor(sortArrowColor: ColorDef | undefined) {\n    this._sortArrowColor = sortArrowColor;\n    this.doChangeStyle();\n  }\n  clone(): SortHeaderStyle {\n    return new SortHeaderStyle(this);\n  }\n}\n","import type { BaseStyleOption, CheckHeaderStyleOption, HeaderStyleOption, SortHeaderStyleOption } from '../ts-types';\nimport { BaseStyle } from './style/BaseStyle';\nimport { CheckHeaderStyle } from './style/CheckHeaderStyle';\nimport { MultilineTextHeaderStyle } from './style/MultilineTextHeaderStyle';\nimport { SortHeaderStyle } from './style/SortHeaderStyle';\nimport { Style } from './style/Style';\n\nexport {\n  BaseStyle,\n  Style,\n  SortHeaderStyle,\n  CheckHeaderStyle,\n  // types\n  BaseStyleOption,\n  CheckHeaderStyleOption,\n  MultilineTextHeaderStyle,\n  SortHeaderStyleOption\n};\n\nexport function of(headerStyle: HeaderStyleOption | null | undefined, StyleClass: typeof BaseStyle): BaseStyle {\n  if (headerStyle) {\n    if (headerStyle instanceof Style) {\n      return headerStyle;\n    } else if (typeof headerStyle === 'function') {\n      return of(headerStyle(), StyleClass);\n    }\n    return new StyleClass(headerStyle);\n  } else {\n    return StyleClass.DEFAULT;\n  }\n}\n","import * as styleContents from '../style';\nimport type { CellContext, EventListenerId, GridCanvasHelperAPI, HeaderStyleOption, LayoutObjectId, ListGridAPI } from '../../ts-types';\nimport { BaseStyle } from '../style/BaseStyle';\nimport type { DrawCellInfo } from '../../ts-types-internal';\n\nexport abstract class BaseHeader<T> {\n  constructor(_options = {}) {\n    this.onDrawCell = this.onDrawCell.bind(this); //\n  }\n  get StyleClass(): typeof BaseStyle {\n    return BaseStyle;\n  }\n  onDrawCell(cellValue: unknown, info: DrawCellInfo<T>, context: CellContext, grid: ListGridAPI<T>): void {\n    const { style, drawCellBase } = info;\n    const helper = grid.getGridCanvasHelper();\n    drawCellBase();\n    //\n    this.drawInternal(this.convertInternal(cellValue), context, styleContents.of(style as HeaderStyleOption, this.StyleClass), helper, grid, info);\n  }\n  convertInternal(value: unknown): string {\n    if (typeof value === 'function') {\n      value = value();\n    }\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n    return value != null ? `${value}` : '';\n  }\n  abstract drawInternal(value: string, context: CellContext, style: BaseStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void;\n  bindGridEvent(_grid: ListGridAPI<T>, _cellId: LayoutObjectId): EventListenerId[] {\n    return [];\n  }\n}\n","import type { CellContext, ColorPropertyDefine, GridCanvasHelperAPI } from '../../ts-types';\nimport type { CheckHeaderState, DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { BaseHeader } from './BaseHeader';\nimport { CheckHeaderStyle } from '../style/CheckHeaderStyle';\nimport { getCheckHeaderStateId } from '../../internal/symbolManager';\nimport { obj } from '../../internal/utils';\n\nconst CHECK_HEADER_STATE_ID = getCheckHeaderStateId();\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getState<T>(grid: GridInternal<T>): CheckHeaderState {\n  let state = grid[CHECK_HEADER_STATE_ID];\n  if (!state) {\n    state = { elapsed: {}, block: {} };\n    obj.setReadonly(grid, CHECK_HEADER_STATE_ID, state);\n  }\n  return state;\n}\nexport class CheckHeader<T> extends BaseHeader<T> {\n  get StyleClass(): typeof CheckHeaderStyle {\n    return CheckHeaderStyle;\n  }\n  clone(): CheckHeader<T> {\n    return new CheckHeader(this);\n  }\n  drawInternal(\n    value: string,\n    context: CellContext,\n    style: CheckHeaderStyle,\n    helper: GridCanvasHelperAPI,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    grid: GridInternal<T>,\n    { drawCellBase }: DrawCellInfo<T>\n  ): void {\n    const { textAlign, textBaseline, borderColor, checkBgColor, uncheckBgColor, bgColor, color, font, textOverflow } = style;\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    const { col, row } = context;\n    const range = grid.getCellRange(col, row);\n    const cellKey = `${range.start.col}:${range.start.row}`;\n    const {\n      elapsed: { [cellKey]: elapsed }\n    } = getState(grid);\n\n    const checked = grid.getHeaderValue(range.start.col, range.start.row);\n\n    const opt: {\n      animElapsedTime?: number;\n      uncheckBgColor?: ColorPropertyDefine;\n      checkBgColor?: ColorPropertyDefine;\n      borderColor?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n    } = {\n      textAlign,\n      textBaseline,\n      borderColor,\n      checkBgColor,\n      uncheckBgColor\n    };\n    if (elapsed != null) {\n      opt.animElapsedTime = elapsed;\n    }\n    const inlineCheck = helper.buildCheckBoxInline(!!checked, context, opt);\n\n    helper.text([inlineCheck, value], context, {\n      textAlign,\n      textBaseline,\n      color,\n      font,\n      textOverflow\n    });\n  }\n}\n","import type { CellContext, GridCanvasHelperAPI, ListGridAPI } from '../../ts-types';\nimport { BaseHeader } from './BaseHeader';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { Style } from '../style/Style';\n\nexport class Header<T> extends BaseHeader<T> {\n  get StyleClass(): typeof Style {\n    return Style;\n  }\n  drawInternal(value: string, context: CellContext, style: Style, helper: GridCanvasHelperAPI, _grid: ListGridAPI<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, color, font, bgColor, textOverflow } = style;\n\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    helper.text(value, context, {\n      textAlign,\n      textBaseline,\n      color,\n      font,\n      textOverflow\n    });\n  }\n}\n","import type { CellContext, GridCanvasHelperAPI } from '../../ts-types';\nimport type { DrawCellInfo, GridInternal } from '../../ts-types-internal';\nimport { BaseHeader } from './BaseHeader';\nimport { MultilineTextHeaderStyle } from '../style/MultilineTextHeaderStyle';\n\nexport class MultilineTextHeader<T> extends BaseHeader<T> {\n  get StyleClass(): typeof MultilineTextHeaderStyle {\n    return MultilineTextHeaderStyle;\n  }\n  clone(): MultilineTextHeader<T> {\n    return new MultilineTextHeader(this);\n  }\n  drawInternal(value: string, context: CellContext, style: MultilineTextHeaderStyle, helper: GridCanvasHelperAPI, _grid: GridInternal<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline, color, font, bgColor, lineHeight, autoWrapText, lineClamp, textOverflow } = style;\n\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n    const multilines = value.replace(/\\r?\\n/g, '\\n').replace(/\\r/g, '\\n').split('\\n');\n    helper.testFontLoad(font, value, context);\n    helper.multilineText(multilines, context, {\n      textAlign,\n      textBaseline,\n      color,\n      font,\n      lineHeight,\n      autoWrapText,\n      lineClamp,\n      textOverflow\n    });\n  }\n}\n","import type { CellContext, GridCanvasHelperAPI, ListGridAPI, SortState } from '../../ts-types';\nimport { BaseHeader } from './BaseHeader';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { SortHeaderStyle } from '../style/SortHeaderStyle';\nimport { cellInRange } from '../../internal/utils';\nimport { getFontSize } from '../../internal/canvases';\n\nexport class SortHeader<T> extends BaseHeader<T> {\n  get StyleClass(): typeof SortHeaderStyle {\n    return SortHeaderStyle;\n  }\n  drawInternal(value: string, context: CellContext, style: SortHeaderStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, { drawCellBase }: DrawCellInfo<T>): void {\n    const { textAlign, textBaseline = 'middle', color, bgColor, font, textOverflow, sortArrowColor } = style;\n\n    if (bgColor) {\n      drawCellBase({\n        bgColor\n      });\n    }\n\n    const state = grid.sortState as SortState;\n    let order = undefined;\n    const { col, row } = context;\n    const range = grid.getCellRange(col, row);\n    if (cellInRange(range, state.col, state.row)) {\n      ({ order } = state);\n    }\n\n    const ctx = context.getContext();\n    const arrowSize = getFontSize(ctx, font).width * 1.2;\n\n    helper.text(value, context, {\n      textAlign,\n      textBaseline,\n      color,\n      font,\n      textOverflow,\n      icons: [\n        {\n          name: order != null ? (order === 'asc' ? 'arrow_downward' : 'arrow_upward') : undefined,\n          width: arrowSize,\n          color: helper.getColor(sortArrowColor || helper.theme.header.sortArrowColor, col, row, ctx) || 'rgba(0, 0, 0, 0.38)'\n        }\n      ]\n    });\n  }\n}\n","import { BaseHeader } from './type/BaseHeader';\nimport type { BaseHeaderDefine } from '../list-grid/layout-map/api';\nimport { CheckHeader } from './type/CheckHeader';\nimport { Header } from './type/Header';\nimport type { HeaderTypeOption } from '../ts-types';\nimport { MultilineTextHeader } from './type/MultilineTextHeader';\nimport { SortHeader } from './type/SortHeader';\n\nexport const TYPES = {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  DEFAULT: new Header<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  SORT: new SortHeader<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  CHECK: new CheckHeader<any>(),\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  MULTILINETEXT: new MultilineTextHeader<any>()\n};\nexport { BaseHeader, Header, SortHeader, CheckHeader, MultilineTextHeader };\n\nexport function of<T>(headerType: HeaderTypeOption | BaseHeader<T> | null | undefined): BaseHeader<T> {\n  if (!headerType) {\n    return TYPES.DEFAULT;\n  } else if (typeof headerType === 'string') {\n    const key = headerType.toUpperCase() as keyof typeof TYPES;\n    return TYPES[key] || of(null);\n  } else {\n    return headerType;\n  }\n}\n\nexport function ofCell<T>(headerCell: BaseHeaderDefine<T>): BaseHeader<T> {\n  if (headerCell.sort) {\n    return TYPES.SORT;\n  }\n\n  return of(headerCell.headerType);\n}\n","import { columns } from '../../../columns';\nimport * as headerType from '../../../header/type';\nimport type { ColumnData, HeaderData } from '../api';\n\nlet seqId = -1;\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function newEmptyHeaderData(): HeaderData<any> {\n  return {\n    id: seqId--,\n    define: {},\n    headerType: headerType.of(null) // default\n  };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function newEmptyColumnData(): ColumnData<any> {\n  return {\n    id: seqId--,\n    define: {},\n    columnType: columns.type.of(null), // default\n    style: null\n  };\n}\n\nexport class EmptyDataCache<T> {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private headers: HeaderData<T>[][] = [];\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  private columns: ColumnData<T>[][] = [];\n  getHeader(col: number, row: number): HeaderData<T> {\n    const rows = this.headers[row] || (this.headers[row] = []);\n    return rows[col] || (rows[col] = newEmptyHeaderData());\n  }\n  getBody(col: number, row: number): ColumnData<T> {\n    const rows = this.columns[row] || (this.columns[row] = []);\n    return rows[col] || (rows[col] = newEmptyColumnData());\n  }\n}\n","import { columns } from '../../../columns';\nimport * as headerAction from '../../../header/action';\nimport * as headerType from '../../../header/type';\nimport type { CellRange, LayoutObjectId } from '../../../ts-types';\nimport type { ColumnData, ColumnDefine, GroupHeaderDefine, HeaderData, HeadersDefine, LayoutMapAPI } from '../api';\nimport { EmptyDataCache } from './utils';\n\nlet seqId = 0;\nexport class SimpleHeaderLayoutMap<T> implements LayoutMapAPI<T> {\n  private _headerObjects: HeaderData<T>[];\n  private _headerObjectMap: { [key in LayoutObjectId]: HeaderData<T> };\n  private _headerCellIds: number[][];\n  private _columns: ColumnData<T>[];\n  readonly bodyRowCount: number = 1;\n  private _emptyDataCache = new EmptyDataCache();\n  constructor(header: HeadersDefine<T>) {\n    this._columns = [];\n    this._headerCellIds = [];\n\n    this._headerObjects = this._addHeaders(0, header, []);\n    this._headerObjectMap = this._headerObjects.reduce((o, e) => {\n      o[e.id as number] = e;\n      return o;\n    }, {} as { [key in LayoutObjectId]: HeaderData<T> });\n  }\n  get columnWidths(): ColumnData<T>[] {\n    return this._columns;\n  }\n  get headerRowCount(): number {\n    return this._headerCellIds.length;\n  }\n  get colCount(): number {\n    return this._columns.length;\n  }\n  get headerObjects(): HeaderData<T>[] {\n    return this._headerObjects;\n  }\n  get columnObjects(): ColumnData<T>[] {\n    return this._columns;\n  }\n  getCellId(col: number, row: number): LayoutObjectId {\n    if (this.headerRowCount <= row) {\n      return this._columns[col].id;\n    }\n    //in header\n    return this._headerCellIds[row][col];\n  }\n  getHeader(col: number, row: number): HeaderData<T> {\n    const id = this.getCellId(col, row);\n    return this._headerObjectMap[id as number] || this._emptyDataCache.getHeader(col, row);\n  }\n  getBody(col: number, _row: number): ColumnData<T> {\n    return this._columns[col] || this._emptyDataCache.getBody(col, 0);\n  }\n  getBodyLayoutRangeById(id: LayoutObjectId): CellRange {\n    for (let col = 0; col < this.colCount; col++) {\n      if (id === this._columns[col].id) {\n        return {\n          start: { col, row: 0 },\n          end: { col, row: 0 }\n        };\n      }\n    }\n    throw new Error(`can not found body layout @id=${id as number}`);\n  }\n  getCellRange(col: number, row: number): CellRange {\n    const result: CellRange = { start: { col, row }, end: { col, row } };\n    if (this.headerRowCount <= row) {\n      return result;\n    }\n    //in header\n    const id = this.getCellId(col, row);\n    for (let c = col - 1; c >= 0; c--) {\n      if (id !== this.getCellId(c, row)) {\n        break;\n      }\n      result.start.col = c;\n    }\n    for (let c = col + 1; c < this.colCount; c++) {\n      if (id !== this.getCellId(c, row)) {\n        break;\n      }\n      result.end.col = c;\n    }\n    for (let r = row - 1; r >= 0; r--) {\n      if (id !== this.getCellId(col, r)) {\n        break;\n      }\n      result.start.row = r;\n    }\n    for (let r = row + 1; r < this.headerRowCount; r++) {\n      if (id !== this.getCellId(col, r)) {\n        break;\n      }\n      result.end.row = r;\n    }\n    return result;\n  }\n  getRecordIndexByRow(row: number): number {\n    if (row < this.headerRowCount) {\n      return -1;\n    } else {\n      return row - this.headerRowCount;\n    }\n  }\n  getRecordStartRowByRecordIndex(index: number): number {\n    return this.headerRowCount + index;\n  }\n  private _addHeaders(row: number, header: HeadersDefine<T>, roots: number[]): HeaderData<T>[] {\n    const results: HeaderData<T>[] = [];\n    const rowCells = this._headerCellIds[row] || this._newRow(row);\n    header.forEach((hd) => {\n      const col = this._columns.length;\n      const id = seqId++;\n      const cell: HeaderData<T> = {\n        id,\n        caption: hd.caption,\n        field: hd.headerField || (hd as ColumnDefine<T>).field,\n        style: hd.headerStyle,\n        headerType: headerType.ofCell(hd),\n        action: headerAction.ofCell(hd),\n        define: hd\n      };\n      results[id] = cell;\n      rowCells[col] = id;\n      for (let r = row - 1; r >= 0; r--) {\n        this._headerCellIds[r][col] = roots[r];\n      }\n      if ((hd as GroupHeaderDefine<T>).columns) {\n        this._addHeaders(row + 1, (hd as GroupHeaderDefine<T>).columns, [...roots, id]).forEach((c) => results.push(c));\n      } else {\n        const colDef = hd as ColumnDefine<T>;\n        this._columns.push({\n          id: seqId++,\n          field: colDef.field,\n          width: colDef.width,\n          minWidth: colDef.minWidth,\n          maxWidth: colDef.maxWidth,\n          icon: colDef.icon,\n          message: colDef.message,\n          columnType: columns.type.of(colDef.columnType),\n          action: columns.action.of(colDef.action),\n          style: colDef.style,\n          define: colDef\n        });\n        for (let r = row + 1; r < this._headerCellIds.length; r++) {\n          this._headerCellIds[r][col] = id;\n        }\n      }\n    });\n    return results;\n  }\n  private _newRow(row: number): number[] {\n    const newRow: number[] = (this._headerCellIds[row] = []);\n    if (!this._columns.length) {\n      return newRow;\n    }\n    const prev = this._headerCellIds[row - 1];\n    for (let col = 0; col < prev.length; col++) {\n      newRow[col] = prev[col];\n    }\n    return newRow;\n  }\n}\n","import { columns } from '../../../columns';\nimport * as headerAction from '../../../header/action';\nimport * as headerType from '../../../header/type';\nimport type { CellDefine, ColumnData, HeaderBodyLayoutDefine, HeaderCellDefine, HeaderData, LayoutDefine, LayoutMapAPI, WidthData } from '../api';\nimport type { CellRange, LayoutObjectId } from '../../../ts-types';\nimport { EmptyDataCache } from './utils';\n\ninterface HasSpans {\n  colSpan?: number;\n  rowSpan?: number;\n  width?: number | string;\n  minWidth?: number | string;\n  maxWidth?: number | string;\n}\n\nfunction normalizeLayout<T>(layout: LayoutDefine<T>): HeaderBodyLayoutDefine<T> {\n  if (Array.isArray(layout)) {\n    return {\n      header: layout,\n      body: layout\n    };\n  }\n  return layout;\n}\n\nlet seqId = 0;\n\nclass LayoutObjectGrid<T, D extends HasSpans> {\n  objects: T[] = [];\n  objectGrid: T[][] = [];\n  objectMap: { [key in LayoutObjectId]: T } = {};\n  columnCount = 0;\n  columnWidths: WidthData[] = [];\n\n  constructor(layout: D[][], transform: (d: D, id: LayoutObjectId) => T) {\n    layout.forEach((rowLayout, row) => {\n      let col = 0;\n      rowLayout.forEach((cell) => {\n        const id = seqId++;\n        const obj = transform(cell, id);\n        this.objects.push(obj);\n        this.objectMap[id] = obj;\n        col = this._findStartCell(col, row);\n        const rowSpan = Number(cell.rowSpan ?? 1);\n        const colSpan = Number(cell.colSpan ?? 1);\n        const endRow = row + rowSpan;\n        const endCol = col + colSpan;\n        for (let rowIndex = row; rowIndex < endRow; rowIndex++) {\n          const objectGridRow = this._getObjectGridRow(rowIndex);\n          for (let colIndex = col; colIndex < endCol; colIndex++) {\n            objectGridRow[colIndex] = obj;\n          }\n        }\n        if (colSpan === 1) {\n          this._setWidthDataIfAbsent(col, cell);\n        }\n        this._useColumnIndex(endCol - 1);\n        col = endCol;\n      });\n    });\n  }\n\n  get rowCount(): number {\n    return this.objectGrid.length;\n  }\n\n  private _findStartCell(col: number, row: number): number {\n    const objectGridRow = this._getObjectGridRow(row);\n    for (let index = col; index < objectGridRow.length; index++) {\n      if (!objectGridRow[index]) {\n        return index;\n      }\n    }\n    return objectGridRow.length;\n  }\n\n  private _getObjectGridRow(row: number): T[] {\n    return this.objectGrid[row] || (this.objectGrid[row] = []);\n  }\n\n  private _useColumnIndex(col: number): void {\n    if (this.columnCount > col) {\n      return;\n    }\n    this.columnCount = col + 1;\n  }\n\n  private _setWidthDataIfAbsent(col: number, cell: HasSpans): void {\n    if (!this.columnWidths[col]) {\n      if (cell.width != null || cell.maxWidth != null || cell.minWidth != null) {\n        this.columnWidths[col] = {\n          width: cell.width,\n          maxWidth: cell.maxWidth,\n          minWidth: cell.minWidth\n        };\n      }\n    }\n  }\n}\n\nexport class MultiLayoutMap<T> implements LayoutMapAPI<T> {\n  private _header: LayoutObjectGrid<HeaderData<T>, HeaderCellDefine<T>>;\n  private _body: LayoutObjectGrid<ColumnData<T>, CellDefine<T>>;\n  private _columnWidths: WidthData[] = [];\n  private _columnCount: number;\n  private _emptyDataCache = new EmptyDataCache();\n\n  constructor(layout: LayoutDefine<T>) {\n    const hbLayouut = normalizeLayout(layout);\n    const header = (this._header = new LayoutObjectGrid(hbLayouut.header, (hd: HeaderCellDefine<T>, id: LayoutObjectId): HeaderData<T> => {\n      return {\n        id,\n        caption: hd.caption,\n        field: hd.headerField || (hd as CellDefine<T>).field,\n        style: hd.headerStyle,\n        headerType: headerType.ofCell(hd),\n        action: headerAction.ofCell(hd),\n        define: hd\n      };\n    }));\n    const body = (this._body = new LayoutObjectGrid(hbLayouut.body, (colDef: CellDefine<T>, id: LayoutObjectId): ColumnData<T> => {\n      return {\n        id,\n        field: colDef.field,\n        width: colDef.width,\n        minWidth: colDef.minWidth,\n        maxWidth: colDef.maxWidth,\n        icon: colDef.icon,\n        message: colDef.message,\n        columnType: columns.type.of(colDef.columnType),\n        action: columns.action.of(colDef.action),\n        style: colDef.style,\n        define: colDef\n      };\n    }));\n    const columnCount = (this._columnCount = Math.max(header.columnCount, body.columnCount));\n    for (let col = 0; col < columnCount; col++) {\n      const widthDef = header.columnWidths[col] || body.columnWidths[col] || {};\n      this._columnWidths[col] = widthDef;\n    }\n  }\n\n  get columnWidths(): WidthData[] {\n    return this._columnWidths;\n  }\n\n  get headerRowCount(): number {\n    return this._header.rowCount;\n  }\n\n  get bodyRowCount(): number {\n    return this._body.rowCount;\n  }\n\n  get colCount(): number {\n    return this._columnCount;\n  }\n\n  get headerObjects(): HeaderData<T>[] {\n    return this._header.objects;\n  }\n\n  get columnObjects(): ColumnData<T>[] {\n    return this._body.objects;\n  }\n\n  getCellId(col: number, row: number): LayoutObjectId {\n    if (this.headerRowCount <= row) {\n      const bodyRow = row - this.headerRowCount;\n      const bodyLayoutRow = bodyRow % this.bodyRowCount;\n      return this._body.objectGrid[bodyLayoutRow]?.[col]?.id;\n    }\n    //in header\n    return this._header.objectGrid[row]?.[col]?.id;\n  }\n\n  getHeader(col: number, row: number): HeaderData<T> {\n    const id = this.getCellId(col, row);\n    return this._header.objectMap[id as number] || this._emptyDataCache.getHeader(col, row);\n  }\n\n  getBody(col: number, row: number): ColumnData<T> {\n    const id = this.getCellId(col, row);\n    return this._body.objectMap[id as number] || this._emptyDataCache.getBody(col, row);\n  }\n\n  getBodyLayoutRangeById(id: LayoutObjectId): CellRange {\n    for (let row = 0; row < this.bodyRowCount; row++) {\n      const objectGridRow = this._body.objectGrid[row];\n      if (!objectGridRow) {\n        continue;\n      }\n      for (let col = 0; col < this.colCount; col++) {\n        if (id === objectGridRow[col]?.id) {\n          return this._getCellRange(this._body, col, row, 0);\n        }\n      }\n    }\n    throw new Error(`can not found body layout @id=${id as number}`);\n  }\n\n  getCellRange(col: number, row: number): CellRange {\n    if (this.headerRowCount <= row) {\n      const recordIndex = this.getRecordIndexByRow(row);\n      const startRow = this.getRecordStartRowByRecordIndex(recordIndex);\n      const bodyRow = row - this.headerRowCount;\n      const bodyLayoutRow = bodyRow % this.bodyRowCount;\n      return this._getCellRange(this._body, col, bodyLayoutRow, startRow);\n    }\n    //in header\n    return this._getCellRange(this._header, col, row, 0);\n  }\n\n  getRecordIndexByRow(row: number): number {\n    if (row < this.headerRowCount) {\n      return -1;\n    } else {\n      const bodyRow = row - this.headerRowCount;\n      return Math.floor(bodyRow / this.bodyRowCount);\n    }\n  }\n\n  getRecordStartRowByRecordIndex(index: number): number {\n    return this.headerRowCount + index * this.bodyRowCount;\n  }\n\n  private _getCellRange(\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    layout: LayoutObjectGrid<HeaderData<T> | ColumnData<T>, any>,\n    col: number,\n    layoutRow: number,\n    offsetRow: number\n  ): CellRange {\n    const result: CellRange = {\n      start: { col, row: layoutRow + offsetRow },\n      end: { col, row: layoutRow + offsetRow }\n    };\n    const { objectGrid } = layout;\n    const id = objectGrid[layoutRow]?.[col]?.id;\n    if (id == null) {\n      return result;\n    }\n    for (let c = col - 1; c >= 0; c--) {\n      if (id !== objectGrid[layoutRow]?.[c]?.id) {\n        break;\n      }\n      result.start.col = c;\n    }\n    for (let c = col + 1; c < layout.columnCount; c++) {\n      if (id !== objectGrid[layoutRow]?.[c]?.id) {\n        break;\n      }\n      result.end.col = c;\n    }\n    for (let r = layoutRow - 1; r >= 0; r--) {\n      if (id !== objectGrid[r]?.[col]?.id) {\n        break;\n      }\n      result.start.row = r + offsetRow;\n    }\n    for (let r = layoutRow + 1; r < layout.rowCount; r++) {\n      if (id !== objectGrid[r]?.[col]?.id) {\n        break;\n      }\n      result.end.row = r + offsetRow;\n    }\n    return result;\n  }\n}\n","import type { CellContext, ColorDef, GridCanvasHelperAPI } from '../../ts-types';\nimport { Rect } from '../../internal/Rect';\nexport function drawExclamationMarkBox(\n  context: CellContext,\n  style: {\n    bgColor: ColorDef;\n    color?: ColorDef;\n  },\n  helper: GridCanvasHelperAPI\n): void {\n  const { bgColor, color } = style;\n  const ctx = context.getContext();\n  const rect = context.getRect();\n  // draw box\n  ctx.fillStyle = bgColor;\n  const boxRect = (rect as Rect).copy();\n  boxRect.left = boxRect.right - 24;\n  ctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1);\n\n  // draw exclamation mark\n  const fillColor = color;\n  const height = 20;\n  const width = height / 5;\n  const left = boxRect.left + (boxRect.width - width) / 2;\n  const top = boxRect.top + (boxRect.height - height) / 2;\n  helper.fillRectWithState(new Rect(left, top, width, (height / 5) * 3), context, { fillColor });\n  helper.fillRectWithState(new Rect(left, top + (height / 5) * 4, width, height / 5), context, { fillColor });\n}\nexport function drawInformationMarkBox(\n  context: CellContext,\n  style: {\n    bgColor: ColorDef;\n    color?: ColorDef;\n  },\n  helper: GridCanvasHelperAPI\n): void {\n  const { bgColor, color } = style;\n  const ctx = context.getContext();\n  const rect = context.getRect();\n  // draw box\n  ctx.fillStyle = bgColor;\n  const boxRect = (rect as Rect).copy();\n  boxRect.left = boxRect.right - 24;\n  ctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1);\n\n  // draw i mark\n  const fillColor = color;\n  const height = 20;\n  const width = height / 5;\n  const left = boxRect.left + (boxRect.width - width) / 2;\n  const top = boxRect.top + (boxRect.height - height) / 2;\n  helper.fillRectWithState(new Rect(left, top, width, height / 5), context, {\n    fillColor\n  });\n  helper.fillRectWithState(new Rect(left, top + (height / 5) * 2, width, (height / 5) * 3), context, { fillColor });\n}\n","import type { CellContext, ColumnStyle, GridCanvasHelperAPI, ListGridAPI, MessageObject } from '../../ts-types';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport type { MessageElement } from './internal/MessageElement';\n\nexport abstract class BaseMessage<T> {\n  private _grid: ListGridAPI<T>;\n  private _messageElement: MessageElement | null = null;\n  constructor(grid: ListGridAPI<T>) {\n    this._grid = grid;\n  }\n  dispose(): void {\n    this.detachMessageElement();\n    if (this._messageElement) {\n      this._messageElement.dispose();\n    }\n    this._messageElement = null;\n  }\n  _getMessageElement(): MessageElement {\n    return this._messageElement || (this._messageElement = this.createMessageElementInternal());\n  }\n  abstract createMessageElementInternal(): MessageElement;\n  abstract drawCellMessageInternal(message: MessageObject, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void;\n  attachMessageElement(col: number, row: number, message: MessageObject): void {\n    const messageElement = this._getMessageElement();\n    messageElement.attach(this._grid, col, row, message);\n  }\n  moveMessageElement(col: number, row: number): void {\n    const messageElement = this._getMessageElement();\n    messageElement.move(this._grid, col, row);\n  }\n  detachMessageElement(): void {\n    const messageElement = this._getMessageElement();\n    messageElement._detach();\n  }\n  drawCellMessage(message: MessageObject, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void {\n    this.drawCellMessageInternal(message, context, style, helper, grid, info);\n  }\n}\n","import type { ListGridAPI, MessageObject } from '../../../ts-types';\nimport { EventHandler } from '../../../internal/EventHandler';\nimport { createElement } from '../../../internal/dom';\n\nconst CLASSNAME = 'cheetah-grid__message-element';\nconst MESSAGE_CLASSNAME = `${CLASSNAME}__message`;\nconst HIDDEN_CLASSNAME = `${CLASSNAME}--hidden`;\nconst SHOWN_CLASSNAME = `${CLASSNAME}--shown`;\nimport './MessageElement.css';\nfunction createMessageDomElement(): HTMLElement {\n  // require(\"@/columns/message/internal/MessageElement.css\");\n  const rootElement = createElement('div', {\n    classList: [CLASSNAME, HIDDEN_CLASSNAME]\n  });\n  const messageElement = createElement('span', {\n    classList: [MESSAGE_CLASSNAME]\n  });\n  rootElement.appendChild(messageElement);\n  return rootElement;\n}\n\nexport class MessageElement {\n  private _handler: EventHandler;\n  protected _rootElement: HTMLElement;\n  protected _messageElement: HTMLElement;\n  constructor() {\n    this._handler = new EventHandler();\n    const rootElement = (this._rootElement = createMessageDomElement());\n    this._messageElement = rootElement.querySelector(`.${MESSAGE_CLASSNAME}`) as HTMLElement;\n  }\n  dispose(): void {\n    this.detach();\n    this._handler.dispose();\n    // @ts-expect-error -- ignore\n    delete this._rootElement;\n    // @ts-expect-error -- ignore\n    delete this._messageElement;\n  }\n  attach<T>(grid: ListGridAPI<T>, col: number, row: number, message: MessageObject): void {\n    const rootElement = this._rootElement;\n    const messageElement = this._messageElement;\n\n    rootElement.classList.remove(SHOWN_CLASSNAME);\n    rootElement.classList.add(HIDDEN_CLASSNAME);\n\n    if (this._attachCell(grid, col, row)) {\n      rootElement.classList.add(SHOWN_CLASSNAME);\n      rootElement.classList.remove(HIDDEN_CLASSNAME);\n\n      messageElement.textContent = message.message;\n    } else {\n      this._detach();\n    }\n  }\n  move<T>(grid: ListGridAPI<T>, col: number, row: number): void {\n    const rootElement = this._rootElement;\n    if (this._attachCell(grid, col, row)) {\n      rootElement.classList.add(SHOWN_CLASSNAME);\n      rootElement.classList.remove(HIDDEN_CLASSNAME);\n    } else {\n      this._detach();\n    }\n  }\n  detach(): void {\n    this._detach();\n  }\n  _detach(): void {\n    const rootElement = this._rootElement;\n    if (rootElement.parentElement) {\n      rootElement.parentElement.removeChild(rootElement);\n      rootElement.classList.remove(SHOWN_CLASSNAME);\n      rootElement.classList.add(HIDDEN_CLASSNAME);\n    }\n  }\n  _attachCell<T>(grid: ListGridAPI<T>, col: number, row: number): boolean {\n    const rootElement = this._rootElement;\n    const { element, rect } = grid.getAttachCellsArea(grid.getCellRange(col, row));\n\n    const { bottom: top, left, width } = rect;\n    const { frozenRowCount, frozenColCount } = grid;\n    if (row >= frozenRowCount && frozenRowCount > 0) {\n      const { rect: frozenRect } = grid.getAttachCellsArea(grid.getCellRange(col, frozenRowCount - 1));\n      if (top < frozenRect.bottom) {\n        return false; //\n      }\n    } else {\n      if (top < 0) {\n        return false; //\n      }\n    }\n    if (col >= frozenColCount && frozenColCount > 0) {\n      const { rect: frozenRect } = grid.getAttachCellsArea(grid.getCellRange(frozenColCount - 1, row));\n      if (left < frozenRect.right) {\n        return false; //\n      }\n    } else {\n      if (left < 0) {\n        return false; //\n      }\n    }\n    const { offsetHeight, offsetWidth } = element;\n    if (offsetHeight < top) {\n      return false; //\n    }\n    if (offsetWidth < left) {\n      return false; //\n    }\n\n    rootElement.style.top = `${top.toFixed()}px`;\n    rootElement.style.left = `${left.toFixed()}px`;\n    rootElement.style.width = `${width.toFixed()}px`;\n    if (rootElement.parentElement !== element) {\n      element.appendChild(rootElement);\n    }\n    return true;\n  }\n}\n","import { MessageElement } from './MessageElement';\n\nconst CLASSNAME = 'cheetah-grid__error-message-element';\nconst MESSAGE_CLASSNAME = `${CLASSNAME}__message`;\nimport './ErrorMessageElement.css';\n\nexport class ErrorMessageElement extends MessageElement {\n  constructor() {\n    super();\n    // require('@/columns/message/internal/ErrorMessageElement.css')\n    this._rootElement.classList.add(CLASSNAME);\n    this._messageElement.classList.add(MESSAGE_CLASSNAME);\n  }\n}\n","import * as messageUtils from './messageUtils';\nimport type { CellContext, ColumnStyle, GridCanvasHelperAPI, ListGridAPI, MessageObject } from '../../ts-types';\nimport { BaseMessage } from './BaseMessage';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { ErrorMessageElement } from './internal/ErrorMessageElement';\nimport { cellInRange } from '../../internal/utils';\n\nconst RED_A100 = '#ff8a80';\n\nexport class ErrorMessage<T> extends BaseMessage<T> {\n  createMessageElementInternal(): ErrorMessageElement {\n    return new ErrorMessageElement();\n  }\n  drawCellMessageInternal(_message: MessageObject, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, _info: DrawCellInfo<T>): void {\n    const { bgColor } = style;\n    const { select } = context.getSelection();\n    if (!cellInRange(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {\n      helper.drawBorderWithClip(context, (ctx: CanvasRenderingContext2D): void => {\n        messageUtils.drawExclamationMarkBox(\n          context,\n          {\n            bgColor: helper.getColor(helper.theme.messages.errorBgColor, context.col, context.row, ctx) || RED_A100,\n            color: bgColor\n          },\n          helper\n        );\n      });\n    }\n  }\n}\n","import * as messageUtils from './messageUtils';\nimport type { CellContext, ColumnStyle, GridCanvasHelperAPI, ListGridAPI, MessageObject } from '../../ts-types';\nimport { BaseMessage } from './BaseMessage';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { MessageElement } from './internal/MessageElement';\nimport { cellInRange } from '../../internal/utils';\n\nconst GREY_L2 = '#e0e0e0';\n\nexport class InfoMessage<T> extends BaseMessage<T> {\n  createMessageElementInternal(): MessageElement {\n    return new MessageElement();\n  }\n\n  drawCellMessageInternal(_message: MessageObject, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, _info: DrawCellInfo<T>): void {\n    const { bgColor } = style;\n    const { select } = context.getSelection();\n    if (!cellInRange(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {\n      helper.drawBorderWithClip(context, (ctx: CanvasRenderingContext2D): void => {\n        messageUtils.drawInformationMarkBox(\n          context,\n          {\n            bgColor: helper.getColor(helper.theme.messages.infoBgColor, context.col, context.row, ctx) || GREY_L2,\n            color: bgColor\n          },\n          helper\n        );\n      });\n    }\n  }\n}\n","import { DG_EVENT_TYPE } from '../core/DG_EVENT_TYPE';\nimport type { DrawGridEvents } from '../core/DG_EVENT_TYPE';\nimport { extend } from '../internal/utils';\n\nexport interface ListGridEvents extends DrawGridEvents {\n  /**\n   * Indicates when the cell value was changed.\n   */\n  CHANGED_VALUE: 'changed_value';\n  /**\n   * Indicates when the header cell value was changed.\n   */\n  CHANGED_HEADER_VALUE: 'changed_header_value';\n}\n\nexport const LG_EVENT_TYPE: ListGridEvents = extend(DG_EVENT_TYPE, {\n  CHANGED_VALUE: 'changed_value' as const,\n  CHANGED_HEADER_VALUE: 'changed_header_value' as const\n});\n","import { MessageElement } from './MessageElement';\n\nconst CLASSNAME = 'cheetah-grid__warning-message-element';\nconst MESSAGE_CLASSNAME = `${CLASSNAME}__message`;\nimport './WarningMessageElement.css';\n\nexport class WarningMessageElement extends MessageElement {\n  constructor() {\n    super();\n    // require(\"@/columns/message/internal/WarningMessageElement.css\");\n    this._rootElement.classList.add(CLASSNAME);\n    this._messageElement.classList.add(MESSAGE_CLASSNAME);\n  }\n}\n","import * as messageUtils from './messageUtils';\nimport type { CellContext, ColumnStyle, GridCanvasHelperAPI, ListGridAPI, MessageObject } from '../../ts-types';\nimport { BaseMessage } from './BaseMessage';\nimport type { DrawCellInfo } from '../../ts-types-internal';\nimport { WarningMessageElement } from './internal/WarningMessageElement';\nimport { cellInRange } from '../../internal/utils';\n\nconst DEEP_ORANGE_A100 = '#ff9e80';\n\nexport class WarningMessage<T> extends BaseMessage<T> {\n  createMessageElementInternal(): WarningMessageElement {\n    return new WarningMessageElement();\n  }\n  drawCellMessageInternal(_message: MessageObject, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, _info: DrawCellInfo<T>): void {\n    const { bgColor } = style;\n    const { select } = context.getSelection();\n    if (!cellInRange(grid.getCellRange(context.col, context.row), select.col, select.row) || !grid.hasFocusGrid()) {\n      helper.drawBorderWithClip(context, (ctx: CanvasRenderingContext2D): void => {\n        messageUtils.drawExclamationMarkBox(\n          context,\n          {\n            bgColor: helper.getColor(helper.theme.messages.warnBgColor, context.col, context.row, ctx) || DEEP_ORANGE_A100,\n            color: bgColor\n          },\n          helper\n        );\n      });\n    }\n  }\n}\n","import type { MessageHandler as Base, DrawCellInfo } from '../../ts-types-internal';\nimport type { CellContext, ColumnStyle, GridCanvasHelperAPI, ListGridAPI, Message, MessageObject } from '../../ts-types';\nimport type { BaseMessage } from './BaseMessage';\nimport { ErrorMessage } from './ErrorMessage';\nimport { InfoMessage } from './InfoMessage';\nimport { LG_EVENT_TYPE } from '../../list-grid/LG_EVENT_TYPE';\nimport { WarningMessage } from './WarningMessage';\nimport { isPromise } from '../../internal/utils';\n\nconst EMPTY_MESSAGE: MessageObject = {\n  type: 'error',\n  message: null\n};\n\nconst MESSAGE_INSTANCE_FACTORY = {\n  error<T>(grid: ListGridAPI<T>): BaseMessage<T> {\n    return new ErrorMessage(grid);\n  },\n  info<T>(grid: ListGridAPI<T>): BaseMessage<T> {\n    return new InfoMessage(grid);\n  },\n  warning<T>(grid: ListGridAPI<T>): BaseMessage<T> {\n    return new WarningMessage(grid);\n  }\n};\n\nfunction normalizeMessage(message: Message): MessageObject {\n  if (!message || isPromise(message)) {\n    return EMPTY_MESSAGE;\n  }\n  if (typeof message === 'string') {\n    return {\n      type: 'error',\n      message,\n      original: message\n    };\n  }\n  const type = message.type || 'error';\n  if (type && type in MESSAGE_INSTANCE_FACTORY) {\n    return {\n      type: type.toLowerCase() as MessageObject['type'],\n      message: message.message,\n      original: message\n    };\n  }\n  return {\n    type: 'error',\n    // eslint-disable-next-line @typescript-eslint/restrict-template-expressions\n    message: `${message}`,\n    original: message\n  };\n}\nexport function hasMessage(message: Message): boolean {\n  return !!normalizeMessage(message).message;\n}\nexport class MessageHandler<T> implements Base<T> {\n  private _grid: ListGridAPI<T>;\n  private _messageInstances: {\n    [k in MessageObject['type']]?: BaseMessage<T>;\n  };\n  private _attachInfo: {\n    col: number;\n    row: number;\n    instance: BaseMessage<T>;\n  } | null = null;\n  constructor(grid: ListGridAPI<T>, getMessage: (col: number, row: number) => Message) {\n    this._grid = grid;\n    this._messageInstances = {};\n    this._bindGridEvent(grid, getMessage);\n  }\n  dispose(): void {\n    const messageInstances = this._messageInstances;\n    for (const k in messageInstances) {\n      messageInstances[k as MessageObject['type']]?.dispose();\n    }\n    // @ts-expect-error -- ignore\n    delete this._messageInstances;\n    // @ts-expect-error -- ignore\n    delete this._attachInfo;\n  }\n  drawCellMessage(message: Message, context: CellContext, style: ColumnStyle, helper: GridCanvasHelperAPI, grid: ListGridAPI<T>, info: DrawCellInfo<T>): void {\n    if (!hasMessage(message)) {\n      return;\n    }\n    const instance = this._getMessageInstanceOfMessage(message);\n    instance.drawCellMessage(normalizeMessage(message), context, style, helper, grid, info);\n  }\n  _attach(col: number, row: number, message: Message): void {\n    const info = this._attachInfo;\n    const instance = this._getMessageInstanceOfMessage(message);\n    if (info && info.instance !== instance) {\n      info.instance.detachMessageElement();\n    }\n    instance.attachMessageElement(col, row, normalizeMessage(message));\n    this._attachInfo = { col, row, instance };\n  }\n  _move(col: number, row: number): void {\n    const info = this._attachInfo;\n    if (!info || info.col !== col || info.row !== row) {\n      return;\n    }\n    const { instance } = info;\n    instance.moveMessageElement(col, row);\n  }\n  _detach(): void {\n    const info = this._attachInfo;\n    if (!info) {\n      return;\n    }\n    const { instance } = info;\n    instance.detachMessageElement();\n    this._attachInfo = null;\n  }\n  _bindGridEvent(grid: ListGridAPI<T>, getMessage: (col: number, row: number) => Message): void {\n    const onSelectMessage = (sel: { col: number; row: number }): void => {\n      const setMessageData = (msg: Message) => {\n        if (!hasMessage(msg)) {\n          this._detach();\n        } else {\n          this._attach(sel.col, sel.row, msg);\n        }\n      };\n\n      const message = getMessage(sel.col, sel.row);\n      if (isPromise(message)) {\n        this._detach();\n        message.then((msg) => {\n          const newSel = grid.selection.select;\n          if (newSel.col !== sel.col || newSel.row !== sel.row) {\n            return;\n          }\n          setMessageData(msg);\n        });\n        return;\n      }\n      setMessageData(message);\n    };\n    grid.listen(LG_EVENT_TYPE.SELECTED_CELL, (e) => {\n      if (!e.selected) {\n        return;\n      }\n      if (e.before.col === e.col && e.before.row === e.row) {\n        return;\n      }\n      onSelectMessage(e);\n    });\n    grid.listen(LG_EVENT_TYPE.SCROLL, () => {\n      const sel = grid.selection.select;\n      this._move(sel.col, sel.row);\n    });\n    grid.listen(LG_EVENT_TYPE.CHANGED_VALUE, (e) => {\n      const sel = grid.selection.select;\n      if (sel.col !== e.col || sel.row !== e.row) {\n        return;\n      }\n      onSelectMessage(e);\n    });\n    grid.listen(LG_EVENT_TYPE.FOCUS_GRID, (_e) => {\n      const sel = grid.selection.select;\n      onSelectMessage(sel);\n    });\n    grid.listen(LG_EVENT_TYPE.BLUR_GRID, (_e) => {\n      this._detach();\n    });\n  }\n  _getMessageInstanceOfMessage(message: Message): BaseMessage<T> {\n    const messageInstances = this._messageInstances;\n    const { type } = normalizeMessage(message);\n    return messageInstances[type] || (messageInstances[type] = MESSAGE_INSTANCE_FACTORY[type](this._grid));\n  }\n}\n","//see https://github.com/typekit/webfontloader\n\ntype Styles1 = {\n  display: 'block';\n  position: 'absolute';\n  top: '-9999px';\n  left: '-9999px';\n  width: 'auto';\n  height: 'auto';\n  margin: '0';\n  padding: '0';\n  'white-space': 'nowrap';\n  font: string;\n};\ntype Styles2 = {\n  'font-variant': 'normal';\n  'font-size': '300px';\n  'font-style': 'normal';\n  'font-weight': '400';\n  'line-height': 'normal';\n};\n\ntype StyleKeys = keyof Styles1 | keyof Styles2;\n\nfunction computeStyle(font: string): [Styles1, Styles2] {\n  return [\n    {\n      display: 'block',\n      position: 'absolute',\n      top: '-9999px',\n      left: '-9999px',\n      width: 'auto',\n      height: 'auto',\n      margin: '0',\n      padding: '0',\n      'white-space': 'nowrap',\n      font\n    },\n    {\n      'font-variant': 'normal',\n      'font-size': '300px',\n      'font-style': 'normal',\n      'font-weight': '400',\n      'line-height': 'normal'\n    }\n  ];\n}\n\nexport class FontRuler {\n  private el_: HTMLSpanElement;\n  constructor(font: string, testStr: string) {\n    const e = document.createElement('span');\n    e.setAttribute('aria-hidden', 'true');\n    e.textContent = testStr || 'BESbswy';\n\n    computeStyle(font).forEach((style: Styles1 | Styles2) => {\n      for (const k in style) {\n        const key = k as StyleKeys;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        e.style[key as any] = (style as any)[key];\n      }\n    });\n    document.body.appendChild(e);\n    this.el_ = e;\n  }\n  getWidth(): number {\n    return this.el_.offsetWidth;\n  }\n  remove(): void {\n    document.body.removeChild(this.el_);\n  }\n}\n","import { AnyFunction } from '../../../ts-types';\n//see https://github.com/typekit/webfontloader\n\n//http://defghi1977.html.xdomain.jp/tech/canvasMemo/canvasMemo.htm\nimport { FontRuler } from './FontRuler';\n\nconst LastResortFonts: { [key: string]: string } = {\n  SERIF: 'serif',\n  SANS_SERIF: 'sans-serif'\n};\n\nconst watchRunners: {\n  [font: string]: { [testStr: string]: FontWatchRunner };\n} = {};\n\nclass FontWatchRunner {\n  activeCallbacks: AnyFunction[];\n  inactiveCallbacks: AnyFunction[];\n  status: 'ok' | 'ng' | null;\n  lastResortWidths_: { [font: string]: number };\n  fontRulerA_: FontRuler;\n  fontRulerB_: FontRuler;\n  started_: number;\n\n  static async load(font: string, testStr: string, activeCallback: AnyFunction, inactiveCallback: AnyFunction): Promise<void> {\n    const c = watchRunners[font] || (watchRunners[font] = {});\n    testStr += '';\n    let runner;\n    if (await c[testStr]) {\n      runner = c[testStr];\n    } else {\n      runner = c[testStr] = new FontWatchRunner(font, testStr);\n    }\n    runner.then(activeCallback, inactiveCallback);\n  }\n\n  constructor(font: string, testStr: string) {\n    this.activeCallbacks = [];\n    this.inactiveCallbacks = [];\n    this.status = null;\n    this.lastResortWidths_ = {};\n\n    this.fontRulerA_ = new FontRuler(`${font},${LastResortFonts.SERIF}`, testStr);\n    this.fontRulerB_ = new FontRuler(`${font},${LastResortFonts.SANS_SERIF}`, testStr);\n    const lastResortRulerA = new FontRuler(`4px ${LastResortFonts.SERIF}`, testStr);\n    const lastResortRulerB = new FontRuler(`4px ${LastResortFonts.SANS_SERIF}`, testStr);\n\n    //start\n    this.lastResortWidths_[LastResortFonts.SERIF] = lastResortRulerA.getWidth();\n    this.lastResortWidths_[LastResortFonts.SANS_SERIF] = lastResortRulerB.getWidth();\n\n    lastResortRulerA.remove();\n    lastResortRulerB.remove();\n\n    this.started_ = Date.now();\n\n    this.check_();\n  }\n\n  then(activeCallback: AnyFunction, inactiveCallback: AnyFunction): void {\n    if (this.status) {\n      if (this.status !== 'ng') {\n        activeCallback();\n      } else {\n        inactiveCallback();\n      }\n    } else {\n      this.activeCallbacks.push(activeCallback);\n      this.inactiveCallbacks.push(inactiveCallback);\n    }\n  }\n\n  private check_(): void {\n    const widthA = this.fontRulerA_.getWidth();\n    const widthB = this.fontRulerB_.getWidth();\n\n    if (this.isFallbackFont_(widthA, widthB) || this.isLastResortFont_(widthA, widthB)) {\n      if (Date.now() - this.started_ >= 3000) {\n        // timeout\n        if (this.isLastResortFont_(widthA, widthB)) {\n          this.finish_(this.activeCallbacks);\n          this.status = 'ok';\n        } else {\n          this.finish_(this.inactiveCallbacks);\n          this.status = 'ng';\n        }\n      } else {\n        setTimeout(() => {\n          this.check_();\n        }, 50);\n      }\n    } else {\n      this.finish_(this.activeCallbacks);\n      this.status = 'ok';\n    }\n  }\n\n  isFallbackFont_(a: number, b: number): boolean {\n    return this.widthMatches_(a, LastResortFonts.SERIF) && this.widthMatches_(b, LastResortFonts.SANS_SERIF);\n  }\n\n  widthsMatchLastResortWidths_(a: number, b: number): boolean {\n    for (const font in LastResortFonts) {\n      if (LastResortFonts.hasOwnProperty(font)) {\n        if (this.widthMatches_(a, LastResortFonts[font]) && this.widthMatches_(b, LastResortFonts[font])) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  widthMatches_(width: number, lastResortFont: string): boolean {\n    return width === this.lastResortWidths_[lastResortFont];\n  }\n\n  isLastResortFont_(a: number, b: number): boolean {\n    return hasWebKitFallbackBug() && this.widthsMatchLastResortWidths_(a, b);\n  }\n\n  finish_(callbacks: AnyFunction[]): void {\n    setTimeout(() => {\n      this.fontRulerA_.remove();\n      this.fontRulerB_.remove();\n      callbacks.forEach((cb) => cb());\n    }, 0);\n  }\n}\n\nlet HAS_WEBKIT_FALLBACK_BUG: boolean | null = null;\n\nfunction hasWebKitFallbackBug(): boolean {\n  if (HAS_WEBKIT_FALLBACK_BUG === null) {\n    const match = /AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);\n\n    HAS_WEBKIT_FALLBACK_BUG = !!match && (parseInt(match[1], 10) < 536 || (parseInt(match[1], 10) === 536 && parseInt(match[2], 10) <= 11));\n  }\n  return HAS_WEBKIT_FALLBACK_BUG;\n}\n\nexport default FontWatchRunner;\n","import type { AnyFunction } from '../ts-types';\nimport { isNode } from './utils';\nimport FontWatchRunner from './legacy/fontwatch/FontWatchRunner';\n\nconst loads: { [key: string]: boolean } = {};\nlet load: (font: string, testStr: string, callback: AnyFunction) => void;\nlet check: (font: string, testStr: string) => boolean;\nif (isNode) {\n  load = function (_font: string, _testStr: string, callback: AnyFunction): void {\n    callback();\n  };\n  check = function (): boolean {\n    return false;\n  };\n} else {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const fontFaceSet = (document as any).fonts;\n  const legacy = !fontFaceSet;\n  load = legacy\n    ? function (font: string, testStr: string, callback: AnyFunction): void {\n      //for legacy(IE)\n      if (loads[`${font} @ ${testStr}`]) {\n        callback();\n        return;\n      }\n      // eslint-disable-next-line @typescript-eslint/no-var-requires\n      // require('./legacy/fontwatch/FontWatchRunner').load(\n      FontWatchRunner.load(\n        font,\n        testStr,\n        () => {\n          loads[`${font} @ ${testStr}`] = true;\n          callback();\n        },\n        () => {\n          loads[`${font} @ ${testStr}`] = true;\n          callback();\n        }\n      );\n    }\n    : function (font: string, _testStr: string, callback: AnyFunction): void {\n      if (loads.all || loads[font]) {\n        callback();\n        return;\n      }\n      fontFaceSet.ready.then(() => {\n        loads.all = true;\n      });\n      fontFaceSet.load(font).then(() => {\n        loads[font] = true;\n        callback();\n      });\n    };\n  check = legacy\n    ? function (font: string, testStr: string): boolean {\n      //for legacy(IE)\n      if (loads[`${font} @ ${testStr}`]) {\n        return true;\n      }\n      load(font, testStr, () => {});\n      return false;\n    }\n    : function (font: string, testStr: string): boolean {\n      if (loads.all || loads[font]) {\n        return true;\n      }\n      if (!fontFaceSet.check(font)) {\n        load(font, testStr, () => {});\n        return false;\n      }\n      return true;\n    };\n}\n\nexport { check, load };\n","import type { IconDefine } from '../ts-types';\n\nexport const icons: { [key: string]: IconDefine } = {};\n","const parser = new DOMParser();\nconst ELEMENT_NODE = 1;\n\nfunction findElement(el: Element, test: (child: Element) => boolean): Element | null {\n  for (let i = 0; i < el.childNodes.length; i++) {\n    const child = el.childNodes[i];\n    if (child.nodeType !== ELEMENT_NODE) {\n      continue;\n    }\n    if (test(child as Element)) {\n      return child as Element;\n    }\n    const r = findElement(child as Element, test);\n    if (r) {\n      return r;\n    }\n  }\n  return null;\n}\n\nclass Svg {\n  private _svg: HTMLElement;\n  private _glyphs: { [key: string]: Element };\n  private _glyphUnis: { [key: string]: Element };\n  private _fontFace: Element | null | undefined;\n  private _font: Element | null | undefined;\n  public constructor(svgCode: string) {\n    const document = parser.parseFromString(svgCode, 'image/svg+xml');\n    this._svg = document.documentElement as HTMLElement;\n    this._glyphs = {};\n    this._glyphUnis = {};\n  }\n  public get svg() {\n    return this._svg;\n  }\n  public get fontFaceElement() {\n    if (!this._fontFace) {\n      this._fontFace = this.findElement((child) => child.tagName.toLowerCase() === 'font-face');\n    }\n    return this._fontFace;\n  }\n  public get fontElement() {\n    if (!this._font) {\n      this._font = this.findElement((child) => child.tagName.toLowerCase() === 'font');\n    }\n    return this._font;\n  }\n  public findElement(test: (child: Element) => boolean): Element {\n    return findElement(this.svg, test) as Element;\n  }\n  public findGlyph(glyphName: string) {\n    return this._glyphs[glyphName] || (this._glyphs[glyphName] = this.findElement((child) => child.getAttribute('glyph-name') === glyphName));\n  }\n  public findGlyphByUnicode(unicode: string) {\n    return this._glyphUnis[unicode] || (this._glyphUnis[unicode] = this.findElement((child) => child.getAttribute('unicode') === unicode));\n  }\n  public walkAllGlyph(callback: (child: Element) => void) {\n    const walkGlyph = (el: Element, fn: (child: Element) => void) => {\n      for (let i = 0; i < el.childNodes.length; i++) {\n        const child = el.childNodes[i] as Element;\n        if (child.nodeType !== ELEMENT_NODE) {\n          continue;\n        }\n        const unicode = child.getAttribute('unicode');\n        if (unicode && child.getAttribute('d')) {\n          if (!this._glyphUnis[unicode]) {\n            this._glyphUnis[unicode] = child;\n          }\n          const glyphName = child.getAttribute('glyph-name');\n          if (glyphName && !this._glyphs[glyphName]) {\n            this._glyphs[glyphName] = child;\n          }\n          fn(child);\n        } else {\n          walkGlyph(child, fn);\n        }\n      }\n    };\n    walkGlyph(this.svg, callback);\n  }\n}\n\nexport default Svg;\n","import Svg from './Svg';\nconst ELEMENT_NODE = 1;\n\nfunction polygonToPath(polygon: Element) {\n  const points = polygon.getAttribute('points');\n  return `M${points}z`;\n}\n\nfunction polylineToPath(polyline: Element) {\n  const points = polyline.getAttribute('points');\n  return `M${points}`;\n}\n\nfunction circleToPath(circle: Element) {\n  const cx = Number(circle.getAttribute('cx'));\n  const cy = Number(circle.getAttribute('cy'));\n  const r = Number(circle.getAttribute('r'));\n\n  // https://tyru.github.io/svg-circle-misc-algorithm/\n  const SEGMENTS = 8;\n  const ANGLE = (2 * Math.PI) / SEGMENTS;\n  const anchorX = (theta: number) => r * Math.cos(theta);\n  const anchorY = (theta: number) => r * Math.sin(theta);\n  const controlX = (theta: number) => anchorX(theta) + r * Math.tan(ANGLE / 2) * Math.cos(theta - Math.PI / 2);\n  const controlY = (theta: number) => anchorY(theta) + r * Math.tan(ANGLE / 2) * Math.sin(theta - Math.PI / 2);\n\n  let paths = `M${cx + r} ${cy}`;\n  for (let index = 1; index <= SEGMENTS; index++) {\n    const theta = index * ANGLE;\n    paths += `Q${controlX(theta) + cx} ${controlY(theta) + cy} ${anchorX(theta) + cx} ${anchorY(theta) + cy}`;\n  }\n  return paths;\n}\n\nfunction getD(path: Element) {\n  const fill = path.getAttribute('fill');\n  if (fill === 'none') {\n    return '';\n  }\n  return (path.getAttribute('d') as string).replace(/[\\n\\r]/g, '');\n}\n\nfunction elementToPaths(el: Element) {\n  let path = '';\n  switch (el.tagName.toLowerCase()) {\n    case 'path':\n    case 'glyph':\n      path = getD(el);\n      break;\n    case 'circle':\n      path = circleToPath(el);\n      break;\n    case 'polygon':\n      path = polygonToPath(el);\n      break;\n    case 'polyline':\n      path = polylineToPath(el);\n      break;\n    case 'g':\n      for (let i = 0; i < el.childNodes.length; i++) {\n        const child = el.childNodes[i];\n        if (child.nodeType !== ELEMENT_NODE) {\n          continue;\n        }\n        if (!(child as Element).getAttribute('fill')) {\n          (child as Element).setAttribute('fill', el.getAttribute('fill') as string);\n        }\n        path += elementToPaths(child as Element);\n      }\n      break;\n    default:\n      window.console.warn(`unsupported:${el.tagName}`, `@ ${el.innerHTML}`);\n  }\n  return path;\n}\n\nfunction buildObject(\n  obj: {\n    offsetX?: number;\n    offsetY?: number;\n    width?: number;\n    height?: number;\n    d?: string;\n    isGlyph?: boolean;\n    html?: string;\n  } = {}\n) {\n  const icon: {\n    d: string;\n    height: number;\n    width: number;\n    html: string;\n    ud?: boolean; // upside Down\n    offsetX?: number;\n    offsetY?: number;\n  } = {\n    d: obj.d || '',\n    html: obj.html || '',\n    height: obj.height || 0,\n    width: obj.width || 0\n  };\n  if (obj.isGlyph) {\n    icon.ud = true;\n  }\n  if (obj.offsetX !== undefined) {\n    icon.offsetX = obj.offsetX;\n  }\n  if (obj.offsetY !== undefined) {\n    icon.offsetY = obj.offsetY;\n  }\n  return icon;\n}\n\nfunction glyphToJSON(\n  svgCode: string,\n  opt: {\n    glyphName?: string;\n    unicode?: string;\n  }\n) {\n  const svg = new Svg(svgCode);\n  function findGlyph() {\n    if (opt.glyphName) {\n      return svg.findGlyph(opt.glyphName);\n    } else if (opt.unicode) {\n      return svg.findGlyphByUnicode(opt.unicode);\n    }\n  }\n  const fontFace = svg.fontFaceElement || {\n    getAttribute(qualifiedName: string) {\n      return null;\n    }\n  };\n  const font = svg.fontElement || {\n    getAttribute(qualifiedName: string) {\n      return null;\n    }\n  };\n  const glyph = findGlyph() as Element;\n  // xyxy\n  // const bbox = (fontFace.getAttribute(\"bbox\") || \"\").split(\" \");\n  // bbox.st = {\n  // \tx: bbox[0] - 0,\n  // \ty: bbox[1] - 0,\n  // };\n  // bbox.ed = {\n  // \tx: bbox[2] - 0,\n  // \ty: bbox[3] - 0,\n  // };\n\n  const fontHorizAdvX = Number(font.getAttribute('horiz-adv-x')) || 0;\n  const fontVertAdvX = Number(font.getAttribute('vert-adv-x')) || 0;\n  const horizAdvX = Number(glyph.getAttribute('horiz-adv-x')) || fontHorizAdvX || 0;\n  const vertAdvX = Number(glyph.getAttribute('vert-adv-x')) || fontVertAdvX || 0;\n\n  const unitsPerEm = Number(fontFace.getAttribute('units-per-em')) || 1000;\n  // const ascent = Number(fontFace.getAttribute(\"ascent\")) || (unitsPerEm - vertAdvX);\n  const descent = Number(fontFace.getAttribute('descent')) || vertAdvX;\n\n  let size = unitsPerEm;\n  const contentSize = {\n    height: vertAdvX || unitsPerEm,\n    width: horizAdvX || unitsPerEm\n  };\n  if (horizAdvX > size) {\n    size = horizAdvX;\n  }\n  if (vertAdvX > size) {\n    size = vertAdvX;\n  }\n\n  let offsetX = 0; // -bbox.st.x || 0;\n  let offsetY = -descent;\n  offsetX += Math.round((size - contentSize.width) / 2);\n  offsetY += Math.round((size - contentSize.height) / 2);\n\n  const d = elementToPaths(glyph);\n\n  return buildObject({\n    d,\n    height: size,\n    html: glyph.outerHTML,\n    isGlyph: true,\n    offsetX,\n    offsetY,\n    width: size\n  });\n}\n\nfunction svgToJSON(svgCode: string) {\n  const svg = new Svg(svgCode).svg;\n  const viewBox = (svg.getAttribute('viewBox') || '').split(' ');\n  const width = Number(svg.getAttribute('width') || viewBox[2]) || 0;\n  const height = Number(svg.getAttribute('height') || viewBox[3]) || 0;\n  const offsetX = 0 - Number(viewBox[0]) || 0;\n  const offsetY = 0 - Number(viewBox[1]) || 0;\n\n  let d = '';\n  for (let i = 0; i < svg.childNodes.length; i++) {\n    const el = svg.childNodes[i];\n    if (el.nodeType !== ELEMENT_NODE) {\n      continue;\n    }\n    d += elementToPaths(el as Element);\n  }\n  return buildObject({\n    d,\n    height,\n    html: svgCode,\n    offsetX,\n    offsetY,\n    width\n  });\n}\n\nconst svgToIcon = (\n  svgCode: string,\n  opt: {\n    glyphName?: string;\n    unicode?: string;\n  } = {}\n) => {\n  if (opt.glyphName || opt.unicode) {\n    return glyphToJSON(svgCode, opt);\n  } else {\n    return svgToJSON(svgCode);\n  }\n};\n\nexport default svgToIcon;\n","/*\n/!*eslint-disable camelcase*!/\n\nimport type { IconDefine } from './ts-types'\nimport { extend } from './internal/utils'\nimport { icons as plugins } from './plugins/icons'\n\nconst builtins = {\n    get arrow_upward(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_arrow_upward_48px.svg')\n    },\n    get arrow_downward(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/navigation/svg/production/ic_arrow_downward_48px.svg')\n    },\n    get edit(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/image/svg/production/ic_edit_48px.svg')\n    },\n    get add(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/content/svg/production/ic_add_48px.svg')\n    },\n    get star(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_24px.svg')\n    },\n    get star_border(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_border_24px.svg')\n    },\n    get star_half(): IconDefine {\n        return require('cheetah-grid-icon-svg-loader!material-design-icons/toggle/svg/production/ic_star_half_24px.svg')\n    }\n}\n\nexport function get(): { [key: string]: IconDefine } {\n    return extend(builtins, plugins)\n}\n\nexport const svgIcons = {\n    get(): { [key: string]: IconDefine } {\n        return extend(builtins, plugins)\n    }\n}\n*/\nimport type { IconDefine } from './ts-types';\nimport { extend } from './internal/utils';\nimport { icons as plugins } from './plugins/icons';\nimport add from './icons/ic_add_48px.svg';\nimport edit from './icons/ic_edit_48px.svg';\nimport arrowDownward from './icons/ic_arrow_downward_48px.svg';\nimport arrowUpward from './icons/ic_arrow_upward_48px.svg';\nimport star from './icons/ic_star_24px.svg';\nimport starBorder from './icons/ic_star_border_24px.svg';\nimport starHalf from './icons/ic_star_half_24px.svg';\nimport svgToIcon from './tools/svgToIcon';\n\nconst builtins = {\n  add: svgToIcon(add),\n  arrowDownward: svgToIcon(arrowDownward),\n  arrowUpward: svgToIcon(arrowUpward),\n  edit: svgToIcon(edit),\n  star: svgToIcon(star),\n  starBorder: svgToIcon(starBorder),\n  starHalf: svgToIcon(starHalf)\n};\nexport const svgIcons = {\n  get(): { [key: string]: IconDefine } {\n    return extend(builtins, plugins);\n  }\n};\n","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij48cGF0aCBkPSJNMzggMjZIMjZ2MTJoLTRWMjZIMTB2LTRoMTJWMTBoNHYxMmgxMnY0eiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij48cGF0aCBmaWxsPSIjMDEwMTAxIiBkPSJNNDAgMjRsLTIuODItMi44MkwyNiAzMi4zNFY4aC00djI0LjM0TDEwLjg0IDIxLjE2IDggMjRsMTYgMTYgMTYtMTZ6Ii8+PC9zdmc+\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij48cGF0aCBkPSJNOCAyNGwyLjgzIDIuODNMMjIgMTUuNjZWNDBoNFYxNS42NmwxMS4xNyAxMS4xN0w0MCAyNCAyNCA4IDggMjR6Ii8+PC9zdmc+\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij48cGF0aCBkPSJNNiAzNC41VjQyaDcuNWwyMi4xMy0yMi4xMy03LjUtNy41TDYgMzQuNXptMzUuNDEtMjAuNDFjLjc4LS43OC43OC0yLjA1IDAtMi44M2wtNC42Ny00LjY3Yy0uNzgtLjc4LTIuMDUtLjc4LTIuODMgMGwtMy42NiAzLjY2IDcuNSA3LjUgMy42Ni0zLjY2eiIvPjwvc3ZnPg==\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMTIgMTcuMjdMMTguMTggMjFsLTEuNjQtNy4wM0wyMiA5LjI0bC03LjE5LS42MUwxMiAyIDkuMTkgOC42MyAyIDkuMjRsNS40NiA0LjczTDUuODIgMjF6Ii8+PC9zdmc+\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjIgOS4yNGwtNy4xOS0uNjJMMTIgMiA5LjE5IDguNjMgMiA5LjI0bDUuNDYgNC43M0w1LjgyIDIxIDEyIDE3LjI3IDE4LjE4IDIxbC0xLjYzLTcuMDNMMjIgOS4yNHpNMTIgMTUuNGwtMy43NiAyLjI3IDEtNC4yOC0zLjMyLTIuODggNC4zOC0uMzhMMTIgNi4xbDEuNzEgNC4wNCA0LjM4LjM4LTMuMzIgMi44OCAxIDQuMjhMMTIgMTUuNHoiLz48L3N2Zz4=\"","export default \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBkPSJNMjIgOS4yNGwtNy4xOS0uNjJMMTIgMiA5LjE5IDguNjMgMiA5LjI0bDUuNDYgNC43M0w1LjgyIDIxIDEyIDE3LjI3IDE4LjE4IDIxbC0xLjYzLTcuMDNMMjIgOS4yNHpNMTIgMTUuNFY2LjFsMS43MSA0LjA0IDQuMzguMzgtMy4zMiAyLjg4IDEgNC4yOEwxMiAxNS40eiIvPjwvc3ZnPg==\"","import { browser } from './utils';\n\nexport function getPath2D(): typeof Path2D {\n  if (typeof Path2D !== 'undefined' && !browser.Edge) {\n    return Path2D;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-var-requires\n  return require('./legacy/canvas/Path2DShim').Path2DShim;\n}\n\nexport function fill(\n  pathModule: {\n    width: number;\n    height: number;\n    ud?: boolean;\n    x?: number;\n    y?: number;\n    d: string;\n    path2d?: Path2D;\n  },\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  w: number,\n  h: number\n): void {\n  ctx.save();\n  try {\n    const { width, height } = pathModule;\n    const { ud: upsideDown, x: offsetX = 0, y: offsetY = 0 } = pathModule;\n    w = w || width;\n    h = h || height;\n    const xrate = w / width;\n    const yrate = h / (upsideDown ? -height : height);\n    x = x || 0;\n    y = upsideDown ? (y || 0) + -height * yrate : y || 0;\n\n    ctx.translate(x, y);\n    ctx.scale(xrate, yrate);\n    if (offsetX !== 0 || offsetY !== 0) {\n      ctx.translate(offsetX, offsetY);\n    }\n    const Path2D = getPath2D();\n    const path2d = (pathModule.path2d = pathModule.path2d || new Path2D(pathModule.d));\n    ctx.fill(path2d);\n  } finally {\n    ctx.restore();\n  }\n}\n","import type { AnyFunction, ColorDef, InlineAPI, RectProps } from '../ts-types';\nimport type { CanvasHelper } from '../tools/canvashelper';\nimport type { GenWordsResult } from '../internal/utils';\nimport { str } from '../internal/utils';\n\nfunction getWidth(ctx: CanvasRenderingContext2D, content: string): number {\n  return ctx.measureText(content).width;\n}\n\nfunction breakWidth(\n  ctx: CanvasRenderingContext2D,\n  content: string,\n  itr: GenWordsResult,\n  candidateIndex: number,\n  width: number\n): {\n    before: Inline | null;\n    after: Inline | null;\n  } {\n  const chars = [];\n  let ret = itr.next();\n  for (let i = 0; i < candidateIndex && ret !== null; i++, ret = itr.next()) {\n    chars.push(ret);\n  }\n  let beforeWidth = getWidth(ctx, chars.join(''));\n  if (beforeWidth > width) {\n    while (chars.length) {\n      const c = chars.pop();\n      beforeWidth -= getWidth(ctx, c || '');\n      if (beforeWidth <= width) {\n        break;\n      }\n    }\n  } else if (beforeWidth < width) {\n    while (ret !== null) {\n      const charWidth = getWidth(ctx, ret);\n      if (beforeWidth + charWidth > width) {\n        break;\n      }\n      chars.push(ret);\n      beforeWidth += charWidth;\n      ret = itr.next();\n    }\n  }\n  const beforeContent = chars.join('').replace(/\\s+$/, '');\n  const afterContent = content.slice(beforeContent.length).replace(/^\\s+/, '');\n  return {\n    before: beforeContent ? new Inline(beforeContent) : null,\n    after: afterContent ? new Inline(afterContent) : null\n  };\n}\n\nexport type InlineDrawOption = {\n  ctx: CanvasRenderingContext2D;\n  canvashelper: CanvasHelper;\n  rect: RectProps;\n  offset: number;\n  offsetLeft: number;\n  offsetRight: number;\n  offsetTop: number;\n  offsetBottom: number;\n};\nexport class Inline implements InlineAPI {\n  private _content: string;\n  constructor(content?: string) {\n    this._content = content != null ? content : '';\n  }\n  width({ ctx }: { ctx: CanvasRenderingContext2D }): number {\n    return getWidth(ctx, this._content);\n  }\n  font(): string | null {\n    return null;\n  }\n  color(): ColorDef | null {\n    return null;\n  }\n  canDraw(): boolean {\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onReady(_callback: AnyFunction): void {}\n  draw({ ctx, canvashelper, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n    canvashelper.fillTextRect(ctx, this._content, rect.left, rect.top, rect.width, rect.height, {\n      offset: offset + 1,\n      padding: {\n        left: offsetLeft,\n        right: offsetRight,\n        top: offsetTop,\n        bottom: offsetBottom\n      }\n    });\n  }\n  canBreak(): boolean {\n    return !!this._content;\n  }\n  splitIndex(index: number): {\n    before: Inline | null;\n    after: Inline | null;\n  } {\n    const content = this._content;\n    const itr = str.genChars(content);\n    const chars = [];\n    let ret = itr.next();\n    for (let i = 0; i < index && ret !== null; i++, ret = itr.next()) {\n      chars.push(ret);\n    }\n    const beforeContent = chars.join('');\n    const afterContent = content.slice(beforeContent.length);\n    return {\n      before: beforeContent ? new Inline(beforeContent) : null,\n      after: afterContent ? new Inline(afterContent) : null\n    };\n  }\n  breakWord(\n    ctx: CanvasRenderingContext2D,\n    width: number\n  ): {\n      before: Inline | null;\n      after: Inline | null;\n    } {\n    const content = this._content;\n    const allWidth = this.width({ ctx });\n    const candidate = Math.floor((this._content.length * width) / allWidth);\n    const itr = str.genWords(content);\n    return breakWidth(ctx, content, itr, candidate, width);\n  }\n  breakAll(\n    ctx: CanvasRenderingContext2D,\n    width: number\n  ): {\n      before: Inline | null;\n      after: Inline | null;\n    } {\n    const content = this._content;\n    const allWidth = this.width({ ctx });\n    const candidate = Math.floor((this._content.length * width) / allWidth);\n    const itr = str.genChars(content);\n    return breakWidth(ctx, content, itr, candidate, width);\n  }\n  toString(): string {\n    return this._content;\n  }\n}\n","import type { AnyFunction, ColorDef } from '../ts-types';\nimport { Inline } from './Inline';\nimport type { InlineDrawOption } from './Inline';\n\nexport type InlineDrawerFunction = (options: InlineDrawOption) => void;\nexport class InlineDrawer extends Inline {\n  private _draw: InlineDrawerFunction;\n  private _width: number;\n  // private _height: number;\n  private _color?: ColorDef;\n  constructor({\n    draw,\n    width,\n    // height,\n    color\n  }: {\n    draw: InlineDrawerFunction;\n    width: number;\n    height: number;\n    color?: ColorDef;\n  }) {\n    super();\n\n    this._draw = draw;\n    this._width = width;\n    // this._height = height;\n    this._color = color;\n  }\n  width(_arg: { ctx: CanvasRenderingContext2D }): number {\n    return this._width;\n  }\n  font(): string | null {\n    return null;\n  }\n  color(): ColorDef | null {\n    return this._color ?? null;\n  }\n  canDraw(): boolean {\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onReady(_callback: AnyFunction): void {}\n  draw({ ctx, canvashelper, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n    this._draw({\n      ctx,\n      canvashelper,\n      rect,\n      offset,\n      offsetLeft,\n      offsetRight,\n      offsetTop,\n      offsetBottom\n    });\n  }\n  canBreak(): boolean {\n    return false;\n  }\n  toString(): string {\n    return '';\n  }\n}\n","import * as fonts from '../internal/fonts';\nimport type { AnyFunction, ColorDef } from '../ts-types';\nimport { Inline } from './Inline';\nimport type { InlineDrawOption } from './Inline';\n\nexport type InlineIconConstructorOption = {\n  width?: number;\n  font?: string;\n  content?: string;\n  color?: ColorDef;\n};\nexport class InlineIcon extends Inline {\n  private _icon: InlineIconConstructorOption;\n  constructor(icon: InlineIconConstructorOption) {\n    super();\n    this._icon = icon || {};\n  }\n  width({ ctx }: { ctx: CanvasRenderingContext2D }): number {\n    const icon = this._icon;\n    if (icon.width) {\n      return icon.width;\n    }\n    if (icon.font && fonts.check(icon.font, icon.content || '')) {\n      ctx.save();\n      ctx.canvas.style.letterSpacing = 'normal';\n      try {\n        ctx.font = icon.font || ctx.font;\n        return ctx.measureText(icon.content || '').width;\n      } finally {\n        ctx.canvas.style.letterSpacing = '';\n        ctx.restore();\n      }\n    }\n    return 0; //unknown\n  }\n  font(): string | null {\n    return this._icon.font ?? null;\n  }\n  color(): ColorDef | null {\n    return this._icon.color ?? null;\n  }\n  canDraw(): boolean {\n    const icon = this._icon;\n    return icon.font ? fonts.check(icon.font, icon.content || '') : true;\n  }\n  onReady(callback: AnyFunction): void {\n    const icon = this._icon;\n    if (icon.font && !fonts.check(icon.font, icon.content || '')) {\n      fonts.load(icon.font, icon.content || '', callback);\n    }\n  }\n  draw({ ctx, canvashelper, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n    const icon = this._icon;\n    if (icon.content) {\n      ctx.canvas.style.letterSpacing = 'normal';\n      try {\n        // eslint-disable-next-line no-self-assign\n        ctx.font = ctx.font; // To apply letterSpacing, we need to reset it.\n        canvashelper.fillTextRect(ctx, icon.content, rect.left, rect.top, rect.width, rect.height, {\n          offset: offset + 1,\n          padding: {\n            left: offsetLeft,\n            right: offsetRight,\n            top: offsetTop,\n            bottom: offsetBottom\n          }\n        });\n      } finally {\n        ctx.canvas.style.letterSpacing = '';\n      }\n    }\n  }\n  canBreak(): boolean {\n    return false;\n  }\n  toString(): string {\n    return '';\n  }\n}\n","import type { AnyFunction, MaybePromise } from '../ts-types';\nimport { Inline } from './Inline';\nimport type { InlineDrawOption } from './Inline';\nimport { getCacheOrLoad } from '../internal/imgs';\nimport { isPromise } from '../internal/utils';\n\nexport type InlineImageConstructorOption = {\n  src: MaybePromise<string>;\n  width?: number;\n  height?: number;\n  imageLeft?: number;\n  imageTop?: number;\n  imageWidth?: number;\n  imageHeight?: number;\n};\n\nexport class InlineImage extends Inline {\n  private _src: MaybePromise<string>;\n  private _width?: number;\n  private _height?: number;\n  private _imageLeft?: number;\n  private _imageTop?: number;\n  private _imageWidth?: number;\n  private _imageHeight?: number;\n  private _onloaded: AnyFunction[];\n  private _inlineImgPromise: MaybePromise<HTMLImageElement> | null = null;\n  private _inlineImg: HTMLImageElement | null = null;\n  constructor({ src, width, height, imageLeft, imageTop, imageWidth, imageHeight }: InlineImageConstructorOption) {\n    super();\n    this._src = src;\n    this._width = width;\n    this._height = height;\n    this._imageLeft = imageLeft;\n    this._imageTop = imageTop;\n    this._imageWidth = imageWidth;\n    this._imageHeight = imageHeight;\n\n    this._onloaded = [];\n\n    if (isPromise(src)) {\n      src.then((s) => {\n        this._src = s;\n        this._loadImage(s);\n      });\n    } else {\n      this._loadImage(src);\n    }\n  }\n  _loadImage(src: string): void {\n    const img = (this._inlineImgPromise = getCacheOrLoad('InlineImage', 50, src));\n    if (isPromise(img)) {\n      img.then((i) => {\n        this._inlineImg = i;\n\n        this._onloaded.forEach((fn) => fn());\n      });\n    } else {\n      this._inlineImg = img;\n    }\n  }\n  width(_arg: { ctx: CanvasRenderingContext2D }): number {\n    return this._width || (this._inlineImg?.width ?? 0);\n  }\n  font(): string | null {\n    return null;\n  }\n  color(): string | null {\n    return null;\n  }\n  canDraw(): boolean {\n    return !!this._inlineImg;\n  }\n  onReady(callback: AnyFunction): void {\n    if (isPromise(this._src) || isPromise(this._inlineImgPromise)) {\n      this._onloaded.push(() => callback());\n    }\n  }\n  draw({ ctx, canvashelper, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n    const img = this._inlineImg as HTMLImageElement;\n    canvashelper.drawInlineImageRect(\n      ctx,\n      img,\n      this._imageLeft || 0,\n      this._imageTop || 0,\n      this._imageWidth || img.width,\n      this._imageHeight || img.height,\n      this._width || img.width,\n      this._height || img.height,\n      rect.left,\n      rect.top,\n      rect.width,\n      rect.height,\n      {\n        offset: offset + 1,\n        padding: {\n          left: offsetLeft,\n          right: offsetRight,\n          top: offsetTop,\n          bottom: offsetBottom\n        }\n      }\n    );\n  }\n  canBreak(): boolean {\n    return false;\n  }\n  toString(): string {\n    return '';\n  }\n}\n","import * as path2DManager from '../internal/path2DManager';\nimport type { AnyFunction, ColorDef } from '../ts-types';\nimport { Inline } from './Inline';\nimport type { InlineDrawOption } from './Inline';\nimport { calcStartPosition } from '../internal/canvases';\n\nexport type InlinePath2DConstructorOption = {\n  path: Path2D | string;\n  width: number;\n  height: number;\n  color?: ColorDef;\n};\n\nexport class InlinePath2D extends Inline {\n  private _path: Path2D;\n  private _width: number;\n  private _height: number;\n  private _color?: ColorDef;\n  constructor({ path, width, height, color }: InlinePath2DConstructorOption) {\n    super();\n    // IEPath2Dpolyfill\n    const Path2D = path2DManager.getPath2D();\n    this._path = new Path2D(path);\n    this._width = width;\n    this._height = height;\n    this._color = color;\n  }\n  width(_arg: { ctx: CanvasRenderingContext2D }): number {\n    return this._width;\n  }\n  font(): string | null {\n    return null;\n  }\n  color(): ColorDef | null {\n    return this._color ?? null;\n  }\n  canDraw(): boolean {\n    return true;\n  }\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  onReady(_callback: AnyFunction): void {}\n  draw({ ctx, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n    offset++;\n    const padding = {\n      left: offsetLeft,\n      right: offsetRight,\n      top: offsetTop,\n      bottom: offsetBottom\n    };\n    ctx.save();\n    try {\n      ctx.beginPath();\n      ctx.rect(rect.left, rect.top, rect.width, rect.height);\n      //clip\n      ctx.clip();\n\n      //\n      const pos = calcStartPosition(ctx, rect, this._width, this._height, {\n        offset,\n        padding\n      });\n      ctx.translate(pos.x, pos.y);\n      ctx.fill(this._path);\n    } finally {\n      ctx.restore();\n    }\n  }\n  canBreak(): boolean {\n    return false;\n  }\n  toString(): string {\n    return '';\n  }\n}\n","import { isPromise, then } from '../internal/utils';\nimport { InlineImage } from './InlineImage';\nimport type { MaybePromise } from '../ts-types';\n\nfunction buildSvgDataUrl(svg: string | Node): string {\n  const data = typeof svg === 'string' ? svg : new XMLSerializer().serializeToString(svg);\n  const url = `data:image/svg+xml;charset=utf-8,${encodeURIComponent(data)}`; //svgbase64\n  return url;\n}\nfunction getSvgElement(svg: string | SVGElement): SVGElement {\n  if (typeof svg === 'string') {\n    const parser = new DOMParser();\n    return parser.parseFromString(svg, 'image/svg+xml').children[0] as SVGElement;\n  } else {\n    return svg;\n  }\n}\n\nexport type InlineSvgConstructorOption = {\n  svg: MaybePromise<string | SVGElement>;\n  width?: number;\n  height?: number;\n};\n\nexport class InlineSvg extends InlineImage {\n  constructor({ svg, width, height }: InlineSvgConstructorOption) {\n    const svgElem = then(svg, getSvgElement);\n    const elmWidth = !isPromise(svgElem) ? svgElem.getAttribute('width') ?? undefined : undefined;\n    const elmHeight = !isPromise(svgElem) ? svgElem.getAttribute('height') ?? undefined : undefined;\n    const numElmWidth = elmWidth != null ? Number(elmWidth) : undefined;\n    const numElmHeight = elmHeight != null ? Number(elmHeight) : undefined;\n    super({\n      src: then(svg, buildSvgDataUrl),\n      width: width || numElmWidth,\n      height: height || numElmHeight,\n      imageWidth: numElmWidth,\n      imageHeight: numElmHeight\n    });\n  }\n  canBreak(): boolean {\n    return false;\n  }\n  toString(): string {\n    return '';\n  }\n}\n","import { svgIcons } from '../icons';\nimport * as path2DManager from '../internal/path2DManager';\nimport type { IconDefine } from '../ts-types';\nimport { Inline } from './Inline';\nimport type { InlineDrawOption } from './Inline';\nimport { InlineDrawer } from './InlineDrawer';\nimport { InlineIcon } from './InlineIcon';\nimport { InlineImage } from './InlineImage';\nimport { InlinePath2D } from './InlinePath2D';\nimport { InlineSvg } from './InlineSvg';\nimport type { PaddingOption } from '../internal/canvases';\nimport type { SimpleColumnIconOption } from '../ts-types-internal';\nimport { calcStartPosition } from '../internal/canvases';\n\nfunction drawRegisteredIcon(\n  ctx: CanvasRenderingContext2D,\n  icon: IconDefine,\n  drawWidth: number,\n  drawHeight: number,\n  left: number,\n  top: number,\n  width: number,\n  height: number,\n  { offset = 2, padding }: { offset?: number; padding?: PaddingOption } = {}\n): void {\n  const rect = {\n    left,\n    top,\n    width,\n    height,\n    right: left + width,\n    bottom: top + height\n  };\n  ctx.save();\n  try {\n    ctx.beginPath();\n    ctx.rect(rect.left, rect.top, rect.width, rect.height);\n    //clip\n    ctx.clip();\n\n    //\n    const pos = calcStartPosition(ctx, rect, drawWidth, drawHeight, {\n      offset,\n      padding\n    });\n    path2DManager.fill(icon, ctx, pos.x, pos.y, drawWidth, drawHeight);\n  } finally {\n    ctx.restore();\n  }\n}\n\nfunction isIconConstructorOption(icon: SimpleColumnIconOption): icon is SimpleColumnIconOption & { font: string; content: string } {\n  if (icon.font && icon.content) {\n    return true;\n  }\n  return false;\n}\n\nfunction isInlineImageConstructorOption(icon: SimpleColumnIconOption): icon is SimpleColumnIconOption & { src: string } {\n  if (icon.src) {\n    return true;\n  }\n  return false;\n}\n\nfunction isInlineSvgConstructorOption(icon: SimpleColumnIconOption): icon is SimpleColumnIconOption & {\n  path: string;\n  width: number;\n  height: number;\n} {\n  if (icon.path) {\n    return true;\n  }\n  return false;\n}\n\nexport function iconOf(icon: SimpleColumnIconOption | null): Inline | null {\n  if (icon instanceof Inline) {\n    return icon;\n  }\n  if (!icon) {\n    return null;\n  }\n  if (isIconConstructorOption(icon)) {\n    return new InlineIcon(icon);\n  }\n  if (isInlineImageConstructorOption(icon)) {\n    return new InlineImage({\n      src: icon.src,\n      width: icon.width,\n      height: icon.width\n    });\n  }\n  if (icon.svg) {\n    return new InlineSvg({\n      svg: icon.svg,\n      width: icon.width,\n      height: icon.width\n    });\n  }\n  if (isInlineSvgConstructorOption(icon)) {\n    return new InlinePath2D({\n      path: icon.path,\n      width: icon.width,\n      height: icon.width,\n      color: icon.color\n    });\n  }\n  const regedIcons = svgIcons.get();\n  if (icon.name && regedIcons[icon.name]) {\n    const regedIcon = regedIcons[icon.name];\n    const width = icon.width || Math.max(regedIcon.width, regedIcon.height);\n    return new InlineDrawer({\n      draw({ ctx, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n        drawRegisteredIcon(ctx, regedIcon, width, width, rect.left, rect.top, rect.width, rect.height, {\n          offset: offset + 1,\n          padding: {\n            left: offsetLeft,\n            right: offsetRight,\n            top: offsetTop,\n            bottom: offsetBottom\n          }\n        });\n      },\n      width,\n      height: width,\n      color: icon.color\n    });\n  }\n  return new InlineIcon(icon);\n}\n\nexport function of(content: string | Inline): Inline;\nexport function of(content?: string | Inline | null): null;\nexport function of(content?: string | Inline | null): Inline | null {\n  if (content == null) {\n    return null;\n  }\n  if (content instanceof Inline) {\n    return content;\n  }\n  return new Inline(content);\n}\n\nexport function buildInlines(icons: SimpleColumnIconOption[] | null | undefined, inline: Inline | string | (string | Inline)[]): Inline[] {\n  const result: Inline[] = [];\n  if (icons) {\n    result.push(...icons.map((icon) => iconOf(icon)).filter((i: Inline | null): i is Inline => i != null));\n  }\n  if (\n    Array.isArray(inline)\n    // && inline.filter(il => il instanceof Inline).length <- ?\n  ) {\n    result.push(...inline.map((il) => of(il)).filter((i) => i != null));\n  } else {\n    const il = of(inline);\n    if (il) {\n      result.push(il);\n    }\n  }\n  return result;\n}\n\nexport function string(inline: Inline | string | (string | Inline)[]): string {\n  return buildInlines(undefined, inline).join('');\n}\n","export type RGBA = { r: number; g: number; b: number; a: number };\nconst rgbMap: { [key: string]: RGBA } = {};\nfunction styleColorToRGB(color: string): RGBA | null {\n  const dummy = document.createElement('div');\n  const { style } = dummy;\n  style.color = color;\n  style.position = 'fixed';\n  style.height = '1px';\n  style.width = '1px';\n  style.opacity = '0';\n  document.body.appendChild(dummy);\n  const { color: styleColor } = (document.defaultView || window).getComputedStyle(dummy, '');\n  document.body.removeChild(dummy);\n  return colorToRGB0(styleColor || '');\n}\n\nfunction hexToNum(hex: string): number {\n  return parseInt(hex, 16);\n}\n\nfunction createRGB(r: number, g: number, b: number, a = 1): RGBA {\n  return { r, g, b, a };\n}\nfunction tripleHexToRGB({ 1: r, 2: g, 3: b }: string): RGBA {\n  return createRGB(hexToNum(r + r), hexToNum(g + g), hexToNum(b + b));\n}\nfunction sextupleHexToRGB({ 1: r1, 2: r2, 3: g1, 4: g2, 5: b1, 6: b2 }: string): RGBA {\n  return createRGB(hexToNum(r1 + r2), hexToNum(g1 + g2), hexToNum(b1 + b2));\n}\n\nfunction testRGB({ r, g, b, a }: RGBA): boolean {\n  return 0 <= r && r <= 255 && 0 <= g && g <= 255 && 0 <= b && b <= 255 && 0 <= a && a <= 1;\n}\nfunction rateToByte(r: number): number {\n  return Math.ceil((r * 255) / 100);\n}\nfunction colorToRGB0(color: string): RGBA | null {\n  if (/^#[0-9a-f]{3}$/i.exec(color)) {\n    return tripleHexToRGB(color);\n  }\n  if (/^#[0-9a-f]{6}$/i.exec(color)) {\n    return sextupleHexToRGB(color);\n  }\n  let ret = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/i.exec(color);\n  if (ret) {\n    const rgb = createRGB(Number(ret[1]), Number(ret[2]), Number(ret[3]));\n    if (testRGB(rgb)) {\n      return rgb;\n    }\n  }\n  ret = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d(\\.\\d)?)\\s*\\)$/i.exec(color);\n  if (ret) {\n    const rgb = createRGB(Number(ret[1]), Number(ret[2]), Number(ret[3]), Number(ret[4]));\n    if (testRGB(rgb)) {\n      return rgb;\n    }\n  }\n  ret = /^rgb\\(\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*\\)$/i.exec(color);\n  if (ret) {\n    const rgb = createRGB(rateToByte(Number(ret[1])), rateToByte(Number(ret[3])), rateToByte(Number(ret[5])));\n    if (testRGB(rgb)) {\n      return rgb;\n    }\n  }\n  ret = /^rgba\\(\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d(\\.\\d)?)\\s*\\)$/i.exec(color);\n  if (ret) {\n    const rgb = createRGB(rateToByte(Number(ret[1])), rateToByte(Number(ret[3])), rateToByte(Number(ret[5])), Number(ret[7]));\n    if (testRGB(rgb)) {\n      return rgb;\n    }\n  }\n  return null;\n}\nexport function colorToRGB(color: string): RGBA {\n  if (typeof color !== 'string') {\n    return createRGB(0, 0, 0, 0);\n  }\n  color = color.toLowerCase().trim();\n  if (rgbMap[color]) {\n    return rgbMap[color];\n  }\n  return colorToRGB0(color) || (rgbMap[color] = styleColorToRGB(color) as RGBA);\n}\n","import * as calc from './internal/calc';\nimport * as canvashelper from './tools/canvashelper';\nimport * as fonts from './internal/fonts';\nimport * as inlineUtils from './element/inlines';\nimport * as themes from './themes';\nimport type {\n  CellContext,\n  ColorDef,\n  ColorPropertyDefine,\n  ColorsPropertyDefine,\n  FontPropertyDefine,\n  GridCanvasHelperAPI,\n  LineClamp,\n  ListGridAPI,\n  RectProps,\n  RequiredThemeDefine,\n  StylePropertyFunctionArg,\n  TextOverflow\n} from './ts-types';\nimport type { Inline, InlineDrawOption } from './element/Inline';\nimport { calcStartPosition, getFontSize } from './internal/canvases';\nimport { cellEquals, cellInRange, getChainSafe, getOrApply, style } from './internal/utils';\nimport { InlineDrawer } from './element/InlineDrawer';\nimport type { RGBA } from './internal/color';\nimport { Rect } from './internal/Rect';\nimport type { SimpleColumnIconOption } from './ts-types-internal';\nimport { colorToRGB } from './internal/color';\n\nconst { toBoxArray } = style;\n\nconst INLINE_ELLIPSIS = inlineUtils.of('\\u2026');\n\ntype ColorsDef = ColorDef | (ColorDef | null)[];\n\nfunction invalidateCell<T>(context: CellContext, grid: ListGridAPI<T>): void {\n  const { col, row } = context;\n  grid.invalidateCell(col, row);\n}\nfunction getColor<T>(color: ColorPropertyDefine, col: number, row: number, grid: ListGridAPI<T>, context: CanvasRenderingContext2D): ColorDef;\nfunction getColor<T>(color: ColorsPropertyDefine, col: number, row: number, grid: ListGridAPI<T>, context: CanvasRenderingContext2D): ColorsDef;\nfunction getColor<T>(color: undefined, col: number, row: number, grid: ListGridAPI<T>, context: CanvasRenderingContext2D): undefined;\nfunction getColor<T>(\n  color: ColorPropertyDefine | ColorsPropertyDefine | undefined,\n  col: number,\n  row: number,\n  grid: ListGridAPI<T>,\n  context: CanvasRenderingContext2D\n): ColorDef | ColorsDef | undefined {\n  return getOrApply(color, {\n    col,\n    row,\n    grid,\n    context\n  });\n}\nfunction getFont<T>(font: FontPropertyDefine | undefined, col: number, row: number, grid: ListGridAPI<T>, context: CanvasRenderingContext2D): string | undefined {\n  if (font == null) {\n    return undefined;\n  }\n  return getOrApply(font, {\n    col,\n    row,\n    grid,\n    context\n  });\n}\nfunction getThemeColor<R, T extends ColorPropertyDefine | ColorsPropertyDefine | string>(grid: ListGridAPI<R>, ...names: string[]): T {\n  const gridThemeColor = getChainSafe(grid.theme, ...names);\n  if (gridThemeColor == null) {\n    // use default theme\n    return getChainSafe(themes.getDefault(), ...names);\n  }\n  if (typeof gridThemeColor !== 'function') {\n    return gridThemeColor;\n  }\n  let defaultThemeColor: ColorDef;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return ((args: StylePropertyFunctionArg): any => {\n    const color = gridThemeColor(args);\n    if (color != null) {\n      // use grid theme\n      return color;\n    }\n    // use default theme\n    defaultThemeColor = defaultThemeColor || getChainSafe(themes.getDefault(), ...names);\n    return getOrApply(defaultThemeColor, args);\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  }) as any;\n}\nfunction testFontLoad<T>(font: string | undefined, value: string, context: CellContext, grid: ListGridAPI<T>): boolean {\n  if (font) {\n    if (!fonts.check(font, value)) {\n      fonts.load(font, value, () => invalidateCell(context, grid));\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction drawInlines<T>(\n  ctx: CanvasRenderingContext2D,\n  inlines: Inline[],\n  rect: RectProps,\n  offset: number,\n  offsetTop: number,\n  offsetBottom: number,\n  col: number,\n  row: number,\n  grid: ListGridAPI<T>\n): void {\n  function drawInline(inline: Inline, offsetLeft: number, offsetRight: number): void {\n    if (inline.canDraw()) {\n      ctx.save();\n      try {\n        ctx.fillStyle = getColor(inline.color() || ctx.fillStyle, col, row, grid, ctx);\n        ctx.font = inline.font() || ctx.font;\n        inline.draw({\n          ctx,\n          canvashelper,\n          rect,\n          offset,\n          offsetLeft,\n          offsetRight,\n          offsetTop,\n          offsetBottom\n        });\n      } finally {\n        ctx.restore();\n      }\n    } else {\n      inline.onReady(() => grid.invalidateCell(col, row));\n      //noop\n    }\n  }\n  if (inlines.length === 1) {\n    //1\n    const inline = inlines[0];\n    drawInline(inline, 0, 0);\n  } else {\n    const inlineWidths = inlines.map((inline) => (inline.width({ ctx }) || 0) - 0);\n    let offsetRight = inlineWidths.reduce((a, b) => a + b);\n\n    let offsetLeft = 0;\n    inlines.forEach((inline, index) => {\n      const inlineWidth = inlineWidths[index];\n      offsetRight -= inlineWidth;\n      drawInline(inline, offsetLeft, offsetRight);\n      offsetLeft += inlineWidth;\n    });\n  }\n}\n\nfunction buildInlines(icons: SimpleColumnIconOption[] | undefined, inline: string): Inline[] {\n  return inlineUtils.buildInlines(icons, inline || '');\n}\n\nfunction inlineToString(inline: Inline | string): string {\n  return inlineUtils.string(inline);\n}\n\nfunction getOverflowInline(textOverflow?: TextOverflow): Inline {\n  if (!isAllowOverflow(textOverflow) || textOverflow === 'ellipsis') {\n    return INLINE_ELLIPSIS;\n  }\n  textOverflow = textOverflow.trim();\n  if (textOverflow.length === 1) {\n    return inlineUtils.of(textOverflow[0]);\n  }\n  return INLINE_ELLIPSIS;\n}\n\nfunction isAllowOverflow(textOverflow?: TextOverflow): textOverflow is string {\n  return Boolean(textOverflow && textOverflow !== 'clip' && typeof textOverflow === 'string');\n}\n\nfunction getOverflowInlinesIndex(\n  ctx: CanvasRenderingContext2D,\n  inlines: Inline[],\n  width: number\n): {\n    index: number;\n    lineWidth: number;\n    remWidth: number;\n  } | null {\n  const maxWidth = width - 3; /*buffer*/\n  let lineWidth = 0;\n  for (let i = 0; i < inlines.length; i++) {\n    const inline = inlines[i];\n    const inlineWidth = (inline.width({ ctx }) || 0) - 0;\n    if (lineWidth + inlineWidth > maxWidth) {\n      return {\n        index: i,\n        lineWidth,\n        remWidth: maxWidth - lineWidth\n      };\n    }\n    lineWidth += inlineWidth;\n  }\n  return null;\n}\n\nfunction isOverflowInlines(ctx: CanvasRenderingContext2D, inlines: Inline[], width: number): boolean {\n  return !!getOverflowInlinesIndex(ctx, inlines, width);\n}\n\nfunction breakWidthInlines(\n  ctx: CanvasRenderingContext2D,\n  inlines: Inline[],\n  width: number\n): {\n    beforeInlines: Inline[];\n    overflow: boolean;\n    afterInlines: Inline[];\n  } {\n  const indexData = getOverflowInlinesIndex(ctx, inlines, width);\n  if (!indexData) {\n    return {\n      beforeInlines: inlines,\n      overflow: false,\n      afterInlines: []\n    };\n  }\n  const { index, remWidth } = indexData;\n  const inline = inlines[index];\n  const beforeInlines = inlines.slice(0, index);\n  const afterInlines = [];\n  if (inline.canBreak()) {\n    let { before, after } = inline.breakWord(ctx, remWidth);\n    if (!before && !beforeInlines.length) {\n      ({ before, after } = inline.breakAll(ctx, remWidth));\n    }\n    if (!before && !beforeInlines.length) {\n      // Always return one char\n      ({ before, after } = inline.splitIndex(1));\n    }\n    if (before) {\n      beforeInlines.push(before);\n    }\n    if (after) {\n      afterInlines.push(after);\n    }\n    afterInlines.push(...inlines.slice(index + 1));\n  } else {\n    if (!beforeInlines.length) {\n      // Always return one char\n      beforeInlines.push(inline);\n    }\n    afterInlines.push(...inlines.slice(beforeInlines.length));\n  }\n  return {\n    beforeInlines,\n    overflow: true,\n    afterInlines\n  };\n}\n\nfunction truncateInlines(\n  ctx: CanvasRenderingContext2D,\n  inlines: Inline[],\n  width: number,\n  option?: TextOverflow\n): {\n    inlines: Inline[];\n    overflow: boolean;\n  } {\n  const indexData = getOverflowInlinesIndex(ctx, inlines, width);\n  if (!indexData) {\n    return {\n      inlines,\n      overflow: false\n    };\n  }\n  const { index, lineWidth } = indexData;\n  const inline = inlines[index];\n  const overflowInline = getOverflowInline(option);\n  const ellipsisWidth = overflowInline.width({ ctx });\n  const remWidth = width - lineWidth - ellipsisWidth;\n  const result = inlines.slice(0, index);\n  if (inline.canBreak()) {\n    const { before } = inline.breakAll(ctx, remWidth);\n    if (before) {\n      result.push(before);\n    }\n  }\n  result.push(overflowInline);\n  return {\n    inlines: result,\n    overflow: true\n  };\n}\n\nfunction _inlineRect<T>(\n  grid: ListGridAPI<T>,\n  ctx: CanvasRenderingContext2D,\n  inline: string,\n  rect: RectProps,\n  col: number,\n  row: number,\n  {\n    offset,\n    color,\n    textAlign,\n    textBaseline,\n    font,\n    textOverflow,\n    icons\n  }: {\n    offset: number;\n    color?: ColorPropertyDefine;\n    textAlign: CanvasTextAlign;\n    textBaseline: CanvasTextBaseline;\n    font?: string;\n    textOverflow?: TextOverflow;\n    icons?: SimpleColumnIconOption[];\n  }\n): void {\n  //style\n  ctx.fillStyle = getColor(color || ctx.fillStyle, col, row, grid, ctx);\n  ctx.textAlign = textAlign;\n  ctx.textBaseline = textBaseline;\n  ctx.font = font || ctx.font;\n\n  let inlines = buildInlines(icons, inline);\n  if (isAllowOverflow(textOverflow) && isOverflowInlines(ctx, inlines, rect.width)) {\n    const { inlines: truncInlines, overflow } = truncateInlines(ctx, inlines, rect.width, textOverflow);\n    inlines = truncInlines;\n    grid.setCellOverflowText(col, row, overflow && inlineToString(inline));\n  } else {\n    grid.setCellOverflowText(col, row, false);\n  }\n\n  drawInlines(ctx, inlines, rect, offset, 0, 0, col, row, grid);\n}\n\n// eslint-disable-next-line complexity\nfunction _multiInlineRect<T>(\n  grid: ListGridAPI<T>,\n  ctx: CanvasRenderingContext2D,\n  multiInlines: string[],\n  rect: RectProps,\n  col: number,\n  row: number,\n  {\n    offset,\n    color,\n    textAlign,\n    textBaseline,\n    font,\n    lineHeight,\n    autoWrapText,\n    lineClamp,\n    textOverflow,\n    icons\n  }: {\n    offset: number;\n    color?: ColorPropertyDefine;\n    textAlign: CanvasTextAlign;\n    textBaseline: CanvasTextBaseline;\n    font?: string;\n    lineHeight: number;\n    autoWrapText?: boolean;\n    lineClamp: LineClamp;\n    textOverflow?: TextOverflow;\n    icons?: SimpleColumnIconOption[];\n  }\n): void {\n  //style\n  ctx.fillStyle = getColor(color || ctx.fillStyle, col, row, grid, ctx);\n  ctx.textAlign = textAlign;\n  ctx.textBaseline = textBaseline;\n  ctx.font = font || ctx.font;\n\n  if (lineClamp === 'auto') {\n    const rectHeight = rect.height - offset * 2 - 2; /*offset added by Inline#draw*/\n    lineClamp = Math.max(Math.floor(rectHeight / lineHeight), 1);\n  }\n\n  let buildedMultiInlines: Inline[][];\n  if (autoWrapText || lineClamp > 0 || isAllowOverflow(textOverflow)) {\n    const { width } = rect;\n    buildedMultiInlines = [];\n    const procLineClamp =\n      lineClamp > 0\n        ? (inlines: Inline[], hasNext: boolean): boolean => {\n          if (buildedMultiInlines.length + 1 >= lineClamp) {\n            if (inlines.length === 0 && hasNext) {\n              buildedMultiInlines.push([getOverflowInline(textOverflow)]);\n              grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join('\\n'));\n            } else {\n              const { inlines: truncInlines, overflow } = truncateInlines(ctx, inlines, width, textOverflow);\n              buildedMultiInlines.push(hasNext && !overflow ? truncInlines.concat([getOverflowInline(textOverflow)]) : truncInlines);\n              if (overflow || hasNext) {\n                grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join('\\n'));\n              }\n            }\n            return false;\n          }\n          return true;\n        }\n        : (): boolean => true;\n    const procLine = autoWrapText\n      ? (inlines: Inline[], hasNext: boolean): boolean => {\n        if (!procLineClamp(inlines, hasNext)) {\n          return false;\n        }\n        while (inlines.length) {\n          if (!procLineClamp(inlines, hasNext)) {\n            return false;\n          }\n          const { beforeInlines, afterInlines } = breakWidthInlines(ctx, inlines, width);\n          buildedMultiInlines.push(beforeInlines);\n          inlines = afterInlines;\n        }\n        return true;\n      }\n      : isAllowOverflow(textOverflow)\n        ? (inlines: Inline[], hasNext: boolean): boolean => {\n          if (!procLineClamp(inlines, hasNext)) {\n            return false;\n          }\n          const { inlines: truncInlines, overflow } = truncateInlines(ctx, inlines, width, textOverflow);\n          buildedMultiInlines.push(truncInlines);\n          if (overflow) {\n            grid.setCellOverflowText(col, row, multiInlines.map(inlineToString).join('\\n'));\n          }\n          return true;\n        }\n        : (inlines: Inline[], hasNext: boolean): boolean => {\n          if (!procLineClamp(inlines, hasNext)) {\n            return false;\n          }\n          buildedMultiInlines.push(inlines);\n          return true;\n        };\n    grid.setCellOverflowText(col, row, false);\n    for (let lineRow = 0; lineRow < multiInlines.length; lineRow++) {\n      const inline = multiInlines[lineRow];\n      const buildedInline = buildInlines(lineRow === 0 ? icons : undefined, inline);\n      if (!procLine(buildedInline, lineRow + 1 < multiInlines.length)) {\n        break;\n      }\n    }\n  } else {\n    grid.setCellOverflowText(col, row, false);\n    buildedMultiInlines = multiInlines.map((inline, lineRow) => buildInlines(lineRow === 0 ? icons : undefined, inline));\n  }\n\n  let paddingTop = 0;\n  let paddingBottom = lineHeight * (buildedMultiInlines.length - 1);\n\n  if (ctx.textBaseline === 'top' || ctx.textBaseline === 'hanging') {\n    const em = getFontSize(ctx, ctx.font).height;\n    const pad = (lineHeight - em) / 2;\n    paddingTop += pad;\n    paddingBottom -= pad;\n  } else if (ctx.textBaseline === 'bottom' || ctx.textBaseline === 'alphabetic' || ctx.textBaseline === 'ideographic') {\n    const em = getFontSize(ctx, ctx.font).height;\n    const pad = (lineHeight - em) / 2;\n    paddingTop -= pad;\n    paddingBottom += pad;\n  }\n  buildedMultiInlines.forEach((buildedInline) => {\n    drawInlines(ctx, buildedInline, rect, offset, paddingTop, paddingBottom, col, row, grid);\n    paddingTop += lineHeight;\n    paddingBottom -= lineHeight;\n  });\n}\nfunction calcElapsedColor(startColor: string, endColor: string, elapsedTime: number): string {\n  const startColorRGB = colorToRGB(startColor);\n  const endColorRGB = colorToRGB(endColor);\n  const getRGB = (colorName: keyof RGBA): number => {\n    const start = startColorRGB[colorName];\n    const end = endColorRGB[colorName];\n    if (elapsedTime >= 1) {\n      return end;\n    }\n    if (elapsedTime <= 0) {\n      return start;\n    }\n    const diff = start - end;\n    return Math.ceil(start - diff * elapsedTime);\n  };\n  return `rgb(${getRGB('r')}, ${getRGB('g')}, ${getRGB('b')})`;\n}\nfunction drawCheckbox<T>(\n  ctx: CanvasRenderingContext2D,\n  rect: RectProps,\n  col: number,\n  row: number,\n  check: boolean,\n  helper: GridCanvasHelper<T>,\n  {\n    animElapsedTime = 1,\n    uncheckBgColor = helper.theme.checkbox.uncheckBgColor,\n    checkBgColor = helper.theme.checkbox.checkBgColor,\n    borderColor = helper.theme.checkbox.borderColor,\n    textAlign = 'center',\n    textBaseline = 'middle'\n  }: {\n    animElapsedTime?: number;\n    uncheckBgColor?: ColorPropertyDefine;\n    checkBgColor?: ColorPropertyDefine;\n    borderColor?: ColorPropertyDefine;\n    textAlign?: CanvasTextAlign;\n    textBaseline?: CanvasTextBaseline;\n  },\n  positionOpt = {}\n): void {\n  const boxWidth = canvashelper.measureCheckbox(ctx).width;\n  ctx.textAlign = textAlign;\n  ctx.textBaseline = textBaseline;\n  const pos = calcStartPosition(ctx, rect, boxWidth + 1 /*+1*/, boxWidth + 1 /*+1*/, positionOpt);\n  uncheckBgColor = helper.getColor(uncheckBgColor, col, row, ctx);\n  checkBgColor = helper.getColor(checkBgColor, col, row, ctx);\n  borderColor = helper.getColor(borderColor, col, row, ctx);\n  if (0 < animElapsedTime && animElapsedTime < 1) {\n    uncheckBgColor = check ? uncheckBgColor : calcElapsedColor(checkBgColor as string, uncheckBgColor as string, animElapsedTime);\n    checkBgColor = check ? calcElapsedColor(uncheckBgColor as string, checkBgColor as string, animElapsedTime) : checkBgColor;\n  }\n\n  canvashelper.drawCheckbox(ctx, pos.x, pos.y, check ? animElapsedTime : false, {\n    uncheckBgColor,\n    checkBgColor,\n    borderColor\n  });\n}\n\nfunction drawRadioButton<T>(\n  ctx: CanvasRenderingContext2D,\n  rect: RectProps,\n  col: number,\n  row: number,\n  check: boolean,\n  helper: GridCanvasHelper<T>,\n  {\n    animElapsedTime = 1,\n    checkColor = helper.theme.radioButton.checkColor,\n    uncheckBorderColor = helper.theme.radioButton.uncheckBorderColor,\n    checkBorderColor = helper.theme.radioButton.checkBorderColor,\n    uncheckBgColor = helper.theme.radioButton.uncheckBgColor,\n    checkBgColor = helper.theme.radioButton.checkBgColor,\n    textAlign = 'center',\n    textBaseline = 'middle'\n  }: {\n    animElapsedTime?: number;\n    checkColor?: ColorPropertyDefine;\n    uncheckBorderColor?: ColorPropertyDefine;\n    checkBorderColor?: ColorPropertyDefine;\n    uncheckBgColor?: ColorPropertyDefine;\n    checkBgColor?: ColorPropertyDefine;\n    textAlign?: CanvasTextAlign;\n    textBaseline?: CanvasTextBaseline;\n  },\n  positionOpt = {}\n): void {\n  const boxWidth = canvashelper.measureRadioButton(ctx).width;\n  ctx.textAlign = textAlign;\n  ctx.textBaseline = textBaseline;\n  const pos = calcStartPosition(ctx, rect, boxWidth + 1 /*+1*/, boxWidth + 1 /*+1*/, positionOpt);\n  checkColor = helper.getColor(checkColor, col, row, ctx);\n  uncheckBorderColor = helper.getColor(uncheckBorderColor, col, row, ctx);\n  checkBorderColor = helper.getColor(checkBorderColor, col, row, ctx);\n  uncheckBgColor = helper.getColor(uncheckBgColor, col, row, ctx);\n  checkBgColor = helper.getColor(checkBgColor, col, row, ctx);\n  let borderColor = check ? checkBorderColor : uncheckBorderColor;\n  let bgColor = check ? checkBgColor : uncheckBgColor;\n  if (0 < animElapsedTime && animElapsedTime < 1) {\n    borderColor = check\n      ? calcElapsedColor(uncheckBorderColor as string, checkBorderColor as string, animElapsedTime)\n      : calcElapsedColor(checkBorderColor as string, uncheckBorderColor as string, animElapsedTime);\n    bgColor = check ? calcElapsedColor(uncheckBgColor as string, checkBgColor as string, animElapsedTime) : calcElapsedColor(checkBgColor as string, uncheckBgColor as string, animElapsedTime);\n  }\n\n  canvashelper.drawRadioButton(ctx, pos.x, pos.y, check ? animElapsedTime : 1 - animElapsedTime, {\n    checkColor,\n    borderColor,\n    bgColor\n  });\n}\nclass ThemeResolver<T> implements RequiredThemeDefine {\n  private _grid: ListGridAPI<T>;\n  private _checkbox: RequiredThemeDefine['checkbox'] | null = null;\n  private _radioButton: RequiredThemeDefine['radioButton'] | null = null;\n  private _button: RequiredThemeDefine['button'] | null = null;\n  private _header: RequiredThemeDefine['header'] | null = null;\n  private _messages: RequiredThemeDefine['messages'] | null = null;\n  constructor(grid: ListGridAPI<T>) {\n    this._grid = grid;\n  }\n  getThemeColor<T extends ColorPropertyDefine | ColorsPropertyDefine | FontPropertyDefine>(...name: string[]): T {\n    return getThemeColor(this._grid, ...name);\n  }\n  get font(): string {\n    return getThemeColor(this._grid, 'font');\n  }\n  get underlayBackgroundColor(): string {\n    return getThemeColor(this._grid, 'underlayBackgroundColor');\n  }\n  // color\n  get color(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'color');\n  }\n  get frozenRowsColor(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'frozenRowsColor');\n  }\n  // background\n  get defaultBgColor(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'defaultBgColor');\n  }\n  get frozenRowsBgColor(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'frozenRowsBgColor');\n  }\n  get selectionBgColor(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'selectionBgColor');\n  }\n  get highlightBgColor(): ColorPropertyDefine {\n    return getThemeColor(this._grid, 'highlightBgColor');\n  }\n  // border\n  get borderColor(): ColorsPropertyDefine {\n    return getThemeColor(this._grid, 'borderColor');\n  }\n  get frozenRowsBorderColor(): ColorsPropertyDefine {\n    return getThemeColor(this._grid, 'frozenRowsBorderColor');\n  }\n  get highlightBorderColor(): ColorsPropertyDefine {\n    return getThemeColor(this._grid, 'highlightBorderColor');\n  }\n  get checkbox(): RequiredThemeDefine['checkbox'] {\n    const grid = this._grid;\n    return (\n      this._checkbox ||\n      (this._checkbox = {\n        get uncheckBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'checkbox', 'uncheckBgColor');\n        },\n        get checkBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'checkbox', 'checkBgColor');\n        },\n        get borderColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'checkbox', 'borderColor');\n        }\n      })\n    );\n  }\n  get radioButton(): RequiredThemeDefine['radioButton'] {\n    const grid = this._grid;\n    return (\n      this._radioButton ||\n      (this._radioButton = {\n        get checkColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'radioButton', 'checkColor');\n        },\n        get uncheckBorderColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'radioButton', 'uncheckBorderColor');\n        },\n        get checkBorderColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'radioButton', 'checkBorderColor');\n        },\n        get uncheckBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'radioButton', 'uncheckBgColor');\n        },\n        get checkBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'radioButton', 'checkBgColor');\n        }\n      })\n    );\n  }\n  get button(): RequiredThemeDefine['button'] {\n    const grid = this._grid;\n    return (\n      this._button ||\n      (this._button = {\n        get color(): ColorPropertyDefine {\n          return getThemeColor(grid, 'button', 'color');\n        },\n        get bgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'button', 'bgColor');\n        }\n      })\n    );\n  }\n  get header(): RequiredThemeDefine['header'] {\n    const grid = this._grid;\n    return (\n      this._header ||\n      (this._header = {\n        get sortArrowColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'header', 'sortArrowColor');\n        }\n      })\n    );\n  }\n  get messages(): RequiredThemeDefine['messages'] {\n    const grid = this._grid;\n    return (\n      this._messages ||\n      (this._messages = {\n        get infoBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'messages', 'infoBgColor');\n        },\n        get errorBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'messages', 'errorBgColor');\n        },\n        get warnBgColor(): ColorPropertyDefine {\n          return getThemeColor(grid, 'messages', 'warnBgColor');\n        }\n      })\n    );\n  }\n}\n\nfunction strokeRect(ctx: CanvasRenderingContext2D, color: ColorsDef, left: number, top: number, width: number, height: number): void {\n  if (!Array.isArray(color)) {\n    if (color) {\n      ctx.strokeStyle = color;\n      ctx.strokeRect(left, top, width, height);\n    }\n  } else {\n    const borderColors = toBoxArray(color);\n    canvashelper.strokeColorsRect(ctx, borderColors, left, top, width, height);\n  }\n}\n\nexport class GridCanvasHelper<T> implements GridCanvasHelperAPI {\n  private _grid: ListGridAPI<T>;\n  private _theme: RequiredThemeDefine;\n  constructor(grid: ListGridAPI<T>) {\n    this._grid = grid;\n    this._theme = new ThemeResolver(grid);\n  }\n  createCalculator(\n    context: CellContext,\n    font: string | undefined\n  ): {\n      calcWidth(width: number | string): number;\n      calcHeight(height: number | string): number;\n    } {\n    return {\n      calcWidth(width: number | string): number {\n        return calc.toPx(width, {\n          get full() {\n            const rect = context.getRect();\n            return rect.width;\n          },\n          get em() {\n            return getFontSize(context.getContext(), font).width;\n          }\n        });\n      },\n      calcHeight(height: number | string): number {\n        return calc.toPx(height, {\n          get full() {\n            const rect = context.getRect();\n            return rect.height;\n          },\n          get em() {\n            return getFontSize(context.getContext(), font).height;\n          }\n        });\n      }\n    };\n  }\n  getColor(color: ColorPropertyDefine, col: number, row: number, ctx: CanvasRenderingContext2D): ColorDef;\n  getColor(color: ColorsPropertyDefine, col: number, row: number, ctx: CanvasRenderingContext2D): ColorsDef;\n  getColor(color: ColorPropertyDefine | ColorsPropertyDefine, col: number, row: number, ctx: CanvasRenderingContext2D): ColorsDef {\n    return getColor(color, col, row, this._grid, ctx);\n  }\n  toBoxArray(obj: ColorsDef): [ColorDef | null, ColorDef | null, ColorDef | null, ColorDef | null] {\n    return toBoxArray(obj);\n  }\n  toBoxPixelArray(value: number | string | (number | string)[], context: CellContext, font: string | undefined): [number, number, number, number] {\n    if (typeof value === 'string' || Array.isArray(value)) {\n      const calculator = this.createCalculator(context, font);\n      const box = toBoxArray(value);\n      return [calculator.calcHeight(box[0]), calculator.calcWidth(box[1]), calculator.calcHeight(box[2]), calculator.calcWidth(box[3])];\n    }\n    return toBoxArray(value);\n  }\n  get theme(): RequiredThemeDefine {\n    return this._theme;\n  }\n  drawWithClip(context: CellContext, draw: (ctx: CanvasRenderingContext2D) => void): void {\n    const drawRect = context.getDrawRect();\n    if (!drawRect) {\n      return;\n    }\n    const ctx = context.getContext();\n\n    ctx.save();\n    try {\n      ctx.beginPath();\n      ctx.rect(drawRect.left, drawRect.top, drawRect.width, drawRect.height);\n      //clip\n      ctx.clip();\n\n      draw(ctx);\n    } finally {\n      ctx.restore();\n    }\n  }\n  drawBorderWithClip(context: CellContext, draw: (ctx: CanvasRenderingContext2D) => void): void {\n    const drawRect = context.getDrawRect();\n    if (!drawRect) {\n      return;\n    }\n    const rect = context.getRect();\n    const ctx = context.getContext();\n    ctx.save();\n    try {\n      //clip\n      ctx.beginPath();\n      let clipLeft = drawRect.left;\n      let clipWidth = drawRect.width;\n      if (drawRect.left === rect.left) {\n        clipLeft += -1;\n        clipWidth += 1;\n      }\n      let clipTop = drawRect.top;\n      let clipHeight = drawRect.height;\n      if (drawRect.top === rect.top) {\n        clipTop += -1;\n        clipHeight += 1;\n      }\n      ctx.rect(clipLeft, clipTop, clipWidth, clipHeight);\n      ctx.clip();\n\n      draw(ctx);\n    } finally {\n      ctx.restore();\n    }\n  }\n  text(\n    text: string,\n    context: CellContext,\n    {\n      padding,\n      offset = 2,\n      color,\n      textAlign = 'left',\n      textBaseline = 'middle',\n      font,\n      textOverflow = 'clip',\n      icons\n    }: {\n      padding?: number | string | (number | string)[];\n      offset?: number;\n      color?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n      font?: FontPropertyDefine;\n      textOverflow?: TextOverflow;\n      icons?: SimpleColumnIconOption[];\n    } = {}\n  ): void {\n    let rect = context.getRect();\n\n    const { col, row } = context;\n\n    if (!color) {\n      ({ color } = this.theme);\n      // header color\n      const isFrozenCell = this._grid.isFrozenCell(col, row);\n      if (isFrozenCell && isFrozenCell.row) {\n        color = this.theme.frozenRowsColor;\n      }\n    }\n\n    this.drawWithClip(context, (ctx) => {\n      font = getFont(font, context.col, context.row, this._grid, ctx);\n      if (padding) {\n        const paddingNums = this.toBoxPixelArray(padding, context, font);\n        const left = rect.left + paddingNums[3];\n        const top = rect.top + paddingNums[0];\n        const width = rect.width - paddingNums[1] - paddingNums[3];\n        const height = rect.height - paddingNums[0] - paddingNums[2];\n        rect = new Rect(left, top, width, height);\n      }\n      _inlineRect(this._grid, ctx, text, rect, col, row, {\n        offset,\n        color,\n        textAlign,\n        textBaseline,\n        font,\n        textOverflow,\n        icons\n      });\n    });\n  }\n  multilineText(\n    multilines: string[],\n    context: CellContext,\n    {\n      padding,\n      offset = 2,\n      color,\n      textAlign = 'left',\n      textBaseline = 'middle',\n      font,\n      lineHeight = '1em',\n      autoWrapText = false,\n      lineClamp = 0,\n      textOverflow = 'clip',\n      icons\n    }: {\n      padding?: number | string | (number | string)[];\n      offset?: number;\n      color?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n      font?: FontPropertyDefine;\n      lineHeight?: string | number;\n      autoWrapText?: boolean;\n      lineClamp?: LineClamp;\n      textOverflow?: TextOverflow;\n      icons?: SimpleColumnIconOption[];\n    } = {}\n  ): void {\n    let rect = context.getRect();\n\n    const { col, row } = context;\n\n    if (!color) {\n      ({ color } = this.theme);\n      // header color\n      const isFrozenCell = this._grid.isFrozenCell(col, row);\n      if (isFrozenCell && isFrozenCell.row) {\n        color = this.theme.frozenRowsColor;\n      }\n    }\n\n    this.drawWithClip(context, (ctx) => {\n      font = getFont(font, context.col, context.row, this._grid, ctx);\n      if (padding) {\n        const paddingNums = this.toBoxPixelArray(padding, context, font);\n        const left = rect.left + paddingNums[3];\n        const top = rect.top + paddingNums[0];\n        const width = rect.width - paddingNums[1] - paddingNums[3];\n        const height = rect.height - paddingNums[0] - paddingNums[2];\n        rect = new Rect(left, top, width, height);\n      }\n      const calculator = this.createCalculator(context, font);\n      lineHeight = calculator.calcHeight(lineHeight);\n      _multiInlineRect(this._grid, ctx, multilines, rect, col, row, {\n        offset,\n        color,\n        textAlign,\n        textBaseline,\n        font,\n        lineHeight,\n        autoWrapText,\n        lineClamp,\n        textOverflow,\n        icons\n      });\n    });\n  }\n  fillText(\n    text: string,\n    x: number,\n    y: number,\n    context: CellContext,\n    {\n      color,\n      textAlign = 'left',\n      textBaseline = 'top',\n      font\n    }: {\n      color?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n      font?: FontPropertyDefine;\n    } = {}\n  ): void {\n    const { col, row } = context;\n\n    if (!color) {\n      ({ color } = this.theme);\n      // header color\n      const isFrozenCell = this._grid.isFrozenCell(col, row);\n      if (isFrozenCell && isFrozenCell.row) {\n        color = this.theme.frozenRowsColor;\n      }\n    }\n    const ctx = context.getContext();\n    ctx.save();\n    try {\n      font = getFont(font, context.col, context.row, this._grid, ctx);\n      ctx.fillStyle = getColor(color, col, row, this._grid, ctx);\n      ctx.textAlign = textAlign;\n      ctx.textBaseline = textBaseline;\n      ctx.font = font || ctx.font;\n      ctx.fillText(text, x, y);\n    } finally {\n      ctx.restore();\n    }\n  }\n  fillCell(context: CellContext, { fillColor = this.theme.defaultBgColor }: { fillColor?: ColorPropertyDefine } = {}): void {\n    const rect = context.getRect();\n\n    this.drawWithClip(context, (ctx) => {\n      const { col, row } = context;\n      ctx.fillStyle = getColor(fillColor, col, row, this._grid, ctx);\n\n      ctx.beginPath();\n      ctx.rect(rect.left, rect.top, rect.width, rect.height);\n      ctx.fill();\n    });\n  }\n  fillCellWithState(context: CellContext, option: { fillColor?: ColorPropertyDefine } = {}): void {\n    option.fillColor = this.getFillColorState(context, option);\n    this.fillCell(context, option);\n  }\n  fillRect(rect: RectProps, context: CellContext, { fillColor = this.theme.defaultBgColor }: { fillColor?: ColorPropertyDefine } = {}): void {\n    const ctx = context.getContext();\n    ctx.save();\n    try {\n      const { col, row } = context;\n      ctx.fillStyle = getColor(fillColor, col, row, this._grid, ctx);\n\n      ctx.beginPath();\n      ctx.rect(rect.left, rect.top, rect.width, rect.height);\n      ctx.fill();\n    } finally {\n      ctx.restore();\n    }\n  }\n  fillRectWithState(rect: RectProps, context: CellContext, option: { fillColor?: ColorPropertyDefine } = {}): void {\n    option.fillColor = this.getFillColorState(context, option);\n\n    this.fillRect(rect, context, option);\n  }\n  getFillColorState(context: CellContext, option: { fillColor?: ColorPropertyDefine } = {}): ColorPropertyDefine {\n    const sel = context.getSelection();\n    const { col, row } = context;\n    if (!cellEquals(sel.select, context) && cellInRange(sel.range, col, row)) {\n      return this.theme.selectionBgColor;\n    }\n    if (option.fillColor) {\n      return option.fillColor;\n    }\n    if (cellEquals(sel.select, context)) {\n      return this.theme.highlightBgColor;\n    }\n    const isFrozenCell = this._grid.isFrozenCell(col, row);\n    if (isFrozenCell && isFrozenCell.row) {\n      return this.theme.frozenRowsBgColor;\n    }\n    return this.theme.defaultBgColor;\n  }\n  border(context: CellContext, { borderColor = this.theme.borderColor, lineWidth = 1 }: { borderColor?: ColorsPropertyDefine; lineWidth?: number } = {}): void {\n    const rect = context.getRect();\n\n    this.drawBorderWithClip(context, (ctx) => {\n      const { col, row } = context;\n      const borderColors = getColor(borderColor, col, row, this._grid, ctx);\n\n      if (lineWidth === 1) {\n        ctx.lineWidth = 1;\n        strokeRect(ctx, borderColors, rect.left - 0.5, rect.top - 0.5, rect.width, rect.height);\n      } else if (lineWidth === 2) {\n        ctx.lineWidth = 2;\n        strokeRect(ctx, borderColors, rect.left, rect.top, rect.width - 1, rect.height - 1);\n      } else {\n        ctx.lineWidth = lineWidth;\n        const startOffset = lineWidth / 2 - 1;\n        strokeRect(ctx, borderColors, rect.left + startOffset, rect.top + startOffset, rect.width - lineWidth + 1, rect.height - lineWidth + 1);\n      }\n    });\n  }\n  // Unused in main\n  borderWithState(context: CellContext, option: { borderColor?: ColorsPropertyDefine; lineWidth?: number } = {}): void {\n    const rect = context.getRect();\n    const sel = context.getSelection();\n    const { col, row } = context;\n\n    //\n    if (cellEquals(sel.select, context)) {\n      option.borderColor = this.theme.highlightBorderColor;\n      option.lineWidth = 2;\n      this.border(context, option);\n    } else {\n      // header color\n      const isFrozenCell = this._grid.isFrozenCell(col, row);\n      if (isFrozenCell?.row) {\n        option.borderColor = this.theme.frozenRowsBorderColor;\n      }\n\n      option.lineWidth = 1;\n      this.border(context, option);\n\n      //\n      const sel = this._grid.selection.select;\n      if (sel.col + 1 === col && sel.row === row) {\n        //\n        this.drawBorderWithClip(context, (ctx) => {\n          const borderColors = toBoxArray(getColor(this.theme.highlightBorderColor, sel.col, sel.row, this._grid, ctx));\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = borderColors[1] || ctx.strokeStyle;\n          ctx.beginPath();\n          ctx.moveTo(rect.left - 0.5, rect.top);\n          ctx.lineTo(rect.left - 0.5, rect.bottom);\n          ctx.stroke();\n        });\n      } else if (sel.col === col && sel.row + 1 === row) {\n        //\n        this.drawBorderWithClip(context, (ctx) => {\n          const borderColors = toBoxArray(getColor(this.theme.highlightBorderColor, sel.col, sel.row, this._grid, ctx));\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = borderColors[0] || ctx.strokeStyle;\n          ctx.beginPath();\n          ctx.moveTo(rect.left, rect.top - 0.5);\n          ctx.lineTo(rect.right, rect.top - 0.5);\n          ctx.stroke();\n        });\n      }\n    }\n  }\n  buildCheckBoxInline(\n    check: boolean,\n    context: CellContext,\n    option: {\n      animElapsedTime?: number;\n      uncheckBgColor?: ColorPropertyDefine;\n      checkBgColor?: ColorPropertyDefine;\n      borderColor?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n    } = {}\n  ): InlineDrawer {\n    // eslint-disable-next-line @typescript-eslint/no-this-alias\n    const self = this;\n    const ctx = context.getContext();\n    const boxWidth = canvashelper.measureCheckbox(ctx).width;\n    return new InlineDrawer({\n      draw,\n      width: boxWidth + 3,\n      height: boxWidth + 1,\n      color: undefined\n    });\n\n    function draw({ ctx, rect, offset, offsetLeft, offsetRight, offsetTop, offsetBottom }: InlineDrawOption): void {\n      const { col, row } = context;\n      drawCheckbox(ctx, rect, col, row, check, self, option, {\n        offset: offset + 1,\n        padding: {\n          left: offsetLeft + 1,\n          right: offsetRight,\n          top: offsetTop,\n          bottom: offsetBottom\n        }\n      });\n    }\n  }\n  checkbox(\n    check: boolean,\n    context: CellContext,\n    option: {\n      animElapsedTime?: number;\n      uncheckBgColor?: ColorPropertyDefine;\n      checkBgColor?: ColorPropertyDefine;\n      borderColor?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n    } = {}\n  ): void {\n    this.drawWithClip(context, (ctx) => {\n      const { col, row } = context;\n      drawCheckbox(ctx, context.getRect(), col, row, check, this, option);\n    });\n  }\n  radioButton(\n    check: boolean,\n    context: CellContext,\n    option: {\n      animElapsedTime?: number;\n      checkColor?: ColorPropertyDefine;\n      uncheckBorderColor?: ColorPropertyDefine;\n      checkBorderColor?: ColorPropertyDefine;\n      bgColor?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n    } = {}\n  ): void {\n    this.drawWithClip(context, (ctx) => {\n      const { col, row } = context;\n      drawRadioButton(ctx, context.getRect(), col, row, check, this, option);\n    });\n  }\n  button(\n    caption: string,\n    context: CellContext,\n    {\n      bgColor = this.theme.button.bgColor,\n      padding,\n      offset = 2,\n      color = this.theme.button.color,\n      textAlign = 'center',\n      textBaseline = 'middle',\n      shadow,\n      font,\n      textOverflow = 'clip',\n      icons\n    }: {\n      bgColor?: ColorPropertyDefine;\n      padding?: number | string | (number | string)[];\n      offset?: number;\n      color?: ColorPropertyDefine;\n      textAlign?: CanvasTextAlign;\n      textBaseline?: CanvasTextBaseline;\n      shadow?: canvashelper.DrawButtonOption['shadow'];\n      font?: FontPropertyDefine;\n      textOverflow?: TextOverflow;\n      icons?: SimpleColumnIconOption[];\n    } = {}\n  ): void {\n    const rect = context.getRect();\n\n    this.drawWithClip(context, (ctx) => {\n      font = getFont(font, context.col, context.row, this._grid, ctx);\n      const { col, row } = context;\n      const paddingNums = this.toBoxPixelArray(padding || rect.height / 8, context, font);\n      const left = rect.left + paddingNums[3];\n      const top = rect.top + paddingNums[0];\n      const width = rect.width - paddingNums[1] - paddingNums[3];\n      const height = rect.height - paddingNums[0] - paddingNums[2];\n\n      bgColor = getColor(bgColor, context.col, context.row, this._grid, ctx);\n\n      canvashelper.drawButton(ctx, left, top, width, height, {\n        bgColor,\n        radius: rect.height / 8,\n        // offset,\n        shadow\n      });\n      _inlineRect(this._grid, ctx, caption, new Rect(left, top, width, height), col, row, {\n        offset,\n        color,\n        textAlign,\n        textBaseline,\n        font,\n        textOverflow,\n        icons\n      });\n    });\n  }\n  testFontLoad(font: string | undefined, value: string, context: CellContext): boolean {\n    return testFontLoad(font, value, context, this._grid);\n  }\n}\n","import { EventHandler } from '../../internal/EventHandler';\nimport type { ListGridAPI } from '../../ts-types';\nimport { createElement } from '../../internal/dom';\n\nconst CLASSNAME = 'cheetah-grid__tooltip-element';\nconst CONTENT_CLASSNAME = `${CLASSNAME}__content`;\nconst HIDDEN_CLASSNAME = `${CLASSNAME}--hidden`;\nconst SHOWN_CLASSNAME = `${CLASSNAME}--shown`;\nimport './TooltipElement.css';\nfunction createTooltipDomElement(): HTMLElement {\n  // require('@/tooltip/internal/TooltipElement.css')\n  const rootElement = createElement('div', {\n    classList: [CLASSNAME, HIDDEN_CLASSNAME]\n  });\n  const messageElement = createElement('pre', {\n    classList: [CONTENT_CLASSNAME]\n  });\n  rootElement.appendChild(messageElement);\n  return rootElement;\n}\n\nexport class TooltipElement<T> {\n  private _handler: EventHandler;\n  private _rootElement: HTMLElement;\n  private _messageElement: HTMLElement;\n\n  constructor() {\n    this._handler = new EventHandler();\n    const rootElement = (this._rootElement = createTooltipDomElement());\n    this._messageElement = rootElement.querySelector(`.${CONTENT_CLASSNAME}`) as HTMLElement;\n  }\n\n  dispose(): void {\n    this.detach();\n\n    const rootElement = this._rootElement;\n    if (rootElement.parentElement) {\n      rootElement.parentElement.removeChild(rootElement);\n    }\n\n    this._handler.dispose();\n    // @ts-expect-error -- ignore\n    delete this._rootElement;\n    // @ts-expect-error -- ignore\n    delete this._messageElement;\n  }\n\n  attach(grid: ListGridAPI<T>, col: number, row: number, content: string): void {\n    const rootElement = this._rootElement;\n    const messageElement = this._messageElement;\n\n    rootElement.classList.remove(SHOWN_CLASSNAME);\n    rootElement.classList.add(HIDDEN_CLASSNAME);\n\n    if (this._attachCell(grid, col, row)) {\n      rootElement.classList.add(SHOWN_CLASSNAME);\n      rootElement.classList.remove(HIDDEN_CLASSNAME);\n\n      messageElement.textContent = content;\n    } else {\n      this._detach();\n    }\n  }\n\n  move(grid: ListGridAPI<T>, col: number, row: number): void {\n    const rootElement = this._rootElement;\n    if (this._attachCell(grid, col, row)) {\n      rootElement.classList.add(SHOWN_CLASSNAME);\n      rootElement.classList.remove(HIDDEN_CLASSNAME);\n    } else {\n      this._detach();\n    }\n  }\n\n  detach(): void {\n    this._detach();\n  }\n\n  _detach(): void {\n    const rootElement = this._rootElement;\n    if (rootElement.parentElement) {\n      // rootElement.parentElement.removeChild(rootElement);\n      rootElement.classList.remove(SHOWN_CLASSNAME);\n      rootElement.classList.add(HIDDEN_CLASSNAME);\n    }\n  }\n\n  _attachCell(grid: ListGridAPI<T>, col: number, row: number): boolean {\n    const rootElement = this._rootElement;\n    const { element, rect } = grid.getAttachCellsArea(grid.getCellRange(col, row));\n\n    const { bottom: top, left, width } = rect;\n    const { frozenRowCount, frozenColCount } = grid;\n    if (row >= frozenRowCount && frozenRowCount > 0) {\n      const { rect: frozenRect } = grid.getAttachCellsArea(grid.getCellRange(col, frozenRowCount - 1));\n      if (top < frozenRect.bottom) {\n        return false; //\n      }\n    } else {\n      if (top < 0) {\n        return false; //\n      }\n    }\n    if (col >= frozenColCount && frozenColCount > 0) {\n      const { rect: frozenRect } = grid.getAttachCellsArea(grid.getCellRange(frozenColCount - 1, row));\n      if (left < frozenRect.right) {\n        return false; //\n      }\n    } else {\n      if (left < 0) {\n        return false; //\n      }\n    }\n    const { offsetHeight, offsetWidth } = element;\n    if (offsetHeight < top) {\n      return false; //\n    }\n    if (offsetWidth < left) {\n      return false; //\n    }\n\n    rootElement.style.top = `${top.toFixed()}px`;\n    rootElement.style.left = `${(left + width / 2).toFixed()}px`;\n    rootElement.style.minWidth = `${width.toFixed()}px`;\n    if (rootElement.parentElement !== element) {\n      element.appendChild(rootElement);\n    }\n    return true;\n  }\n}\n","import { BaseTooltip } from './BaseTooltip';\nimport { TooltipElement } from './internal/TooltipElement';\n\nexport class Tooltip<T> extends BaseTooltip<T> {\n  createTooltipElementInternal(): TooltipElement<T> {\n    return new TooltipElement();\n  }\n}\n","import type { ListGridAPI } from '../ts-types';\nimport type { TooltipElement } from './internal/TooltipElement';\n\nexport abstract class BaseTooltip<T> {\n  private _grid: ListGridAPI<T>;\n  private _tooltipElement?: TooltipElement<T>;\n  constructor(grid: ListGridAPI<T>) {\n    this._grid = grid;\n  }\n  dispose(): void {\n    this.detachTooltipElement();\n    if (this._tooltipElement) {\n      this._tooltipElement.dispose();\n    }\n    this._tooltipElement = undefined;\n  }\n  private _getTooltipElement(): TooltipElement<T> {\n    if (this._tooltipElement) {\n      return this._tooltipElement;\n    }\n    return (this._tooltipElement = this.createTooltipElementInternal());\n  }\n  abstract createTooltipElementInternal(): TooltipElement<T>;\n  attachTooltipElement(col: number, row: number, content: string): void {\n    const tooltipElement = this._getTooltipElement();\n    tooltipElement.attach(this._grid, col, row, content);\n  }\n  moveTooltipElement(col: number, row: number): void {\n    const tooltipElement = this._getTooltipElement();\n    tooltipElement.move(this._grid, col, row);\n  }\n  detachTooltipElement(): void {\n    const tooltipElement = this._getTooltipElement();\n    tooltipElement._detach();\n  }\n}\n","import type { CellRange, ListGridAPI } from '../ts-types';\nimport type { BaseTooltip } from './BaseTooltip';\nimport { LG_EVENT_TYPE } from '../list-grid/LG_EVENT_TYPE';\nimport { Tooltip } from './Tooltip';\nimport { cellInRange } from '../internal/utils';\n\nconst TOOLTIP_INSTANCE_FACTORY = {\n  'overflow-text'<T>(grid: ListGridAPI<T>): BaseTooltip<T> {\n    return new Tooltip(grid);\n  }\n};\n\nfunction getTooltipInstanceInfo<T>(\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  grid: ListGridAPI<T>,\n  col: number,\n  row: number\n): {\n    type: 'overflow-text';\n    content: string;\n  } | null {\n  //\n  // overflow text tooltip\n  const overflowText = grid.getCellOverflowText(col, row);\n  if (overflowText) {\n    return {\n      type: 'overflow-text',\n      content: overflowText\n    };\n  }\n  return null;\n}\n\ntype AttachInfo<T> = {\n  instance: BaseTooltip<T>;\n  range: CellRange;\n};\n\nexport class TooltipHandler<T> {\n  private _grid: ListGridAPI<T>;\n  private _tooltipInstances: { [type: string]: BaseTooltip<T> };\n  private _attachInfo?: AttachInfo<T> | null;\n  constructor(grid: ListGridAPI<T>) {\n    this._grid = grid;\n    this._tooltipInstances = {};\n    this._bindGridEvent(grid);\n  }\n  dispose(): void {\n    const tooltipInstances = this._tooltipInstances;\n    for (const k in tooltipInstances) {\n      tooltipInstances[k].dispose();\n    }\n    // @ts-expect-error -- ignore\n    delete this._tooltipInstances;\n    this._attachInfo = null;\n  }\n  _attach(col: number, row: number): void {\n    const info = this._attachInfo;\n    const instanceInfo = this._getTooltipInstanceInfo(col, row);\n    if (info && (!instanceInfo || info.instance !== instanceInfo.instance)) {\n      info.instance.detachTooltipElement();\n      this._attachInfo = null;\n    }\n    if (!instanceInfo) {\n      return;\n    }\n    const { instance } = instanceInfo;\n    instance.attachTooltipElement(col, row, instanceInfo.content);\n    const range = this._grid.getCellRange(col, row);\n    this._attachInfo = { range, instance };\n  }\n  _move(col: number, row: number): void {\n    const info = this._attachInfo;\n    if (!info || !cellInRange(info.range, col, row)) {\n      return;\n    }\n    const { instance } = info;\n    instance.moveTooltipElement(col, row);\n  }\n  _detach(): void {\n    const info = this._attachInfo;\n    if (!info) {\n      return;\n    }\n    const { instance } = info;\n    instance.detachTooltipElement();\n    this._attachInfo = null;\n  }\n  _isAttachCell(col: number, row: number): boolean {\n    const info = this._attachInfo;\n    if (!info) {\n      return false;\n    }\n    return cellInRange(info.range, col, row);\n  }\n  _bindGridEvent(grid: ListGridAPI<T>): void {\n    grid.listen(LG_EVENT_TYPE.MOUSEOVER_CELL, (e) => {\n      if (e.related) {\n        if (this._isAttachCell(e.col, e.row)) {\n          return;\n        }\n      }\n      this._attach(e.col, e.row);\n    });\n    grid.listen(LG_EVENT_TYPE.MOUSEOUT_CELL, (e) => {\n      if (e.related) {\n        if (this._isAttachCell(e.related.col, e.related.row)) {\n          return;\n        }\n      }\n      this._detach();\n    });\n    grid.listen(LG_EVENT_TYPE.SELECTED_CELL, (e) => {\n      if (this._isAttachCell(e.col, e.row)) {\n        this._detach();\n      }\n    });\n    grid.listen(LG_EVENT_TYPE.SCROLL, () => {\n      const info = this._attachInfo;\n      if (!info) {\n        return;\n      }\n      this._move(info.range.start.col, info.range.start.row);\n    });\n    grid.listen(LG_EVENT_TYPE.CHANGED_VALUE, (e) => {\n      if (this._isAttachCell(e.col, e.row)) {\n        this._detach();\n        this._attach(e.col, e.row);\n      }\n    });\n  }\n  _getTooltipInstanceInfo(\n    col: number,\n    row: number\n  ): {\n      instance: Tooltip<T>;\n      type: string;\n      content: string;\n    } | null {\n    const grid = this._grid;\n    const tooltipInstances = this._tooltipInstances;\n    const info = getTooltipInstanceInfo(grid, col, row);\n    if (!info) {\n      return null;\n    }\n    const { type } = info;\n    const instance = tooltipInstances[type] || (tooltipInstances[type] = TOOLTIP_INSTANCE_FACTORY[type](grid));\n    return {\n      instance,\n      type,\n      content: info.content\n    };\n  }\n}\n","import * as icons from './internal/icons';\nimport * as themes from './themes';\n// import { CachedDataSource, DataSource } from './data'\nimport { CachedDataSource } from './data/CachedDataSource';\nimport { DataSource } from './data/DataSource';\nimport type {\n  CellAddress,\n  CellContext,\n  CellRange,\n  ColorPropertyDefine,\n  ColorsPropertyDefine,\n  ColumnIconOption,\n  ColumnStyleOption,\n  ColumnTypeAPI,\n  DrawGridAPI,\n  EventListenerId,\n  FieldData,\n  FieldDef,\n  HeaderValues,\n  LayoutObjectId,\n  ListGridAPI,\n  ListGridEventHandlersEventMap,\n  ListGridEventHandlersReturnMap,\n  MaybePromise,\n  MaybePromiseOrUndef,\n  Message,\n  PasteCellEvent,\n  SelectedCellEvent,\n  SetPasteValueTestData,\n  SortState,\n  ThemeDefine\n} from './ts-types';\nimport { ColumnDefine, GroupHeaderDefine, HeaderDefine, HeadersDefine, MultiLayoutMap, SimpleHeaderLayoutMap } from './list-grid/layout-map';\nimport type { DrawGridConstructorOptions, DrawGridProtected } from './core/DrawGrid';\nimport type { LayoutDefine, LayoutMapAPI } from './list-grid/layout-map';\nimport { MessageHandler, hasMessage } from './columns/message/MessageHandler';\nimport { cellEquals, event, isPromise, obj, omit, then } from './internal/utils';\nimport type { BaseColumn } from './columns/type/BaseColumn';\nimport { BaseStyle } from './columns/style';\nimport type { ColumnData } from './list-grid/layout-map/api';\nimport type { DrawCellInfo } from './ts-types-internal';\nimport { DrawGrid } from './core/DrawGrid';\nimport { GridCanvasHelper } from './GridCanvasHelper';\nimport { BaseStyle as HeaderBaseStyle } from './header/style';\nimport { LG_EVENT_TYPE } from './list-grid/LG_EVENT_TYPE';\nimport { Rect } from './internal/Rect';\nimport type { Theme } from './themes/theme';\nimport { TooltipHandler } from './tooltip/TooltipHandler';\n//protected symbol\nimport { getProtectedSymbol } from './internal/symbolManager';\nimport { parsePasteRangeBoxValues } from './internal/paste-utils';\n\n/** @private */\nconst _ = getProtectedSymbol();\n\n//private methods\n/** @private */\nfunction _getCellRange<T>(grid: ListGrid<T>, col: number, row: number): CellRange {\n  return grid[_].layoutMap.getCellRange(col, row);\n}\n\n/** @private */\nfunction _updateRect<T>(grid: ListGrid<T>, col: number, row: number, context: CellContext): void {\n  context.setRectFilter((rect) => {\n    let { left, right, top, bottom } = rect;\n    const {\n      start: { col: startCol, row: startRow },\n      end: { col: endCol, row: endRow }\n    } = _getCellRange(grid, col, row);\n    for (let c = col - 1; c >= startCol; c--) {\n      left -= grid.getColWidth(c);\n    }\n    for (let c = col + 1; c <= endCol; c++) {\n      right += grid.getColWidth(c);\n    }\n    for (let r = row - 1; r >= startRow; r--) {\n      top -= grid.getRowHeight(r);\n    }\n    for (let r = row + 1; r <= endRow; r++) {\n      bottom += grid.getRowHeight(r);\n    }\n    return Rect.bounds(left, top, right, bottom);\n  });\n}\n\n/** @private */\nfunction _getCellValue<T>(grid: ListGrid<T>, col: number, row: number): FieldData {\n  if (row < grid[_].layoutMap.headerRowCount) {\n    const { caption } = grid[_].layoutMap.getHeader(col, row);\n    return typeof caption === 'function' ? caption() : caption;\n  } else {\n    const { field } = grid[_].layoutMap.getBody(col, row);\n    return _getField(grid, field, row);\n  }\n}\n\n/** @private */\nfunction _setCellValue<T>(\n  grid: ListGrid<T>,\n  col: number,\n  row: number,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  value: any\n): MaybePromise<boolean> {\n  if (row < grid[_].layoutMap.headerRowCount) {\n    // nop\n    return false;\n  } else {\n    const { field } = grid[_].layoutMap.getBody(col, row);\n    if (field == null) {\n      return false;\n    }\n    const index = _getRecordIndexByRow(grid, row);\n    return grid[_].dataSource.setField(index, field, value);\n  }\n}\n\n/** @private */\nfunction _getCellMessage<T>(grid: ListGrid<T>, col: number, row: number): FieldData {\n  if (row < grid[_].layoutMap.headerRowCount) {\n    return null;\n  } else {\n    const { message } = grid[_].layoutMap.getBody(col, row);\n    if (!message) {\n      return null;\n    }\n    if (!Array.isArray(message)) {\n      return _getField(grid, message as FieldDef<T>, row);\n    }\n    const promises: Promise<Message>[] = [];\n    for (let index = 0; index < message.length; index++) {\n      const msg = _getField(grid, message[index] as FieldDef<T>, row);\n      if (isPromise(msg)) {\n        promises.push(msg);\n      } else if (hasMessage(msg)) {\n        return msg;\n      }\n    }\n    if (!promises.length) {\n      return null;\n    }\n    return new Promise((resolve, reject) => {\n      promises.forEach((p) => {\n        p.then((msg) => {\n          if (hasMessage(msg)) {\n            resolve(msg);\n          }\n        }, reject);\n      });\n    });\n  }\n}\n\n/** @private */\nfunction _getCellIcon0<T>(grid: ListGrid<T>, icon: ColumnIconOption<T>, row: number): ColumnIconOption<T>;\nfunction _getCellIcon0<T>(grid: ListGrid<T>, icon: ColumnIconOption<T>[], row: number): ColumnIconOption<T>[];\nfunction _getCellIcon0<T>(grid: ListGrid<T>, icon: ColumnIconOption<T> | ColumnIconOption<T>[], row: number): ColumnIconOption<T> | ColumnIconOption<T>[];\nfunction _getCellIcon0<T>(grid: ListGrid<T>, icon: ColumnIconOption<T> | ColumnIconOption<T>[], row: number): ColumnIconOption<T> | ColumnIconOption<T>[] {\n  if (Array.isArray(icon)) {\n    return icon.map((i) => _getCellIcon0(grid, i, row));\n  }\n  if (!obj.isObject(icon) || typeof icon === 'function') {\n    return _getField(grid, icon, row);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const retIcon: any = {};\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const iconOpt: any = icon;\n  icons.iconPropKeys.forEach((k) => {\n    if (iconOpt[k]) {\n      const f = _getField(grid, iconOpt[k], row);\n      if (f != null) {\n        retIcon[k] = f;\n      } else {\n        if (!_hasField(grid, iconOpt[k], row)) {\n          retIcon[k] = iconOpt[k];\n        }\n      }\n    }\n  });\n  return retIcon;\n}\n\n/** @private */\nfunction _getCellIcon<T>(grid: ListGrid<T>, col: number, row: number): ColumnIconOption<T> | ColumnIconOption<T>[] | null {\n  const { icon } = grid[_].layoutMap.getBody(col, row);\n  if (icon == null) {\n    return null;\n  }\n  return _getCellIcon0(grid, icon, row);\n}\n\n/** @private */\nfunction _getField<T>(grid: ListGrid<T>, field: FieldDef<T> | undefined, row: number): FieldData {\n  if (field == null) {\n    return null;\n  }\n  if (row < grid[_].layoutMap.headerRowCount) {\n    return null;\n  } else {\n    const index = _getRecordIndexByRow(grid, row);\n    return grid[_].dataSource.getField(index, field);\n  }\n}\n\n/** @private */\nfunction _hasField<T>(grid: ListGrid<T>, field: FieldDef<T>, row: number): boolean {\n  if (field == null) {\n    return false;\n  }\n  if (row < grid[_].layoutMap.headerRowCount) {\n    return false;\n  } else {\n    const index = _getRecordIndexByRow(grid, row);\n    return grid[_].dataSource.hasField(index, field);\n  }\n}\n\n/** @private */\nfunction _onDrawValue<T>(\n  grid: ListGrid<T>,\n  cellValue: MaybePromise<unknown>,\n  context: CellContext,\n  { col, row }: CellAddress,\n  style: ColumnStyleOption | null | undefined,\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  draw: BaseColumn<T, any>['onDrawCell']\n): MaybePromise<void> {\n  const helper = grid[_].gridCanvasHelper;\n\n  const drawCellBg = ({ bgColor }: { bgColor?: ColorPropertyDefine } = {}): void => {\n    const fillOpt = {\n      fillColor: bgColor\n    };\n    //cell\n    helper.fillCellWithState(context, fillOpt);\n  };\n  const drawCellBorder = (): void => {\n    if (context.col === grid.frozenColCount - 1) {\n      //\n      const rect = context.getRect();\n      helper.drawWithClip(context, (ctx) => {\n        const borderColor = context.row >= grid.frozenRowCount ? helper.theme.borderColor : helper.theme.frozenRowsBorderColor;\n\n        const borderColors = helper.toBoxArray(helper.getColor(borderColor, context.col, context.row, ctx));\n        if (borderColors[1]) {\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = borderColors[1];\n          ctx.beginPath();\n          ctx.moveTo(rect.right - 2.5, rect.top);\n          ctx.lineTo(rect.right - 2.5, rect.bottom);\n          ctx.stroke();\n        }\n      });\n    }\n\n    _borderWithState(grid, helper, context);\n  };\n\n  const drawCellBase = ({ bgColor }: { bgColor?: ColorPropertyDefine } = {}): void => {\n    drawCellBg({ bgColor });\n    drawCellBorder();\n  };\n  const info: DrawCellInfo<T> = {\n    getRecord: () => grid.getRowRecord(row),\n    getIcon: () => _getCellIcon(grid, col, row),\n    getMessage: () => _getCellMessage(grid, col, row),\n    messageHandler: grid[_].messageHandler,\n    style,\n    drawCellBase,\n    drawCellBg,\n    drawCellBorder\n  };\n\n  return draw(cellValue, info, context, grid);\n}\n\n/** @private */\nfunction _borderWithState<T>(grid: ListGrid<T>, helper: GridCanvasHelper<T>, context: CellContext): void {\n  const { col, row } = context;\n  const sel = grid.selection.select;\n  const { layoutMap } = grid[_];\n\n  const rect = context.getRect();\n  const option: { borderColor?: ColorsPropertyDefine; lineWidth?: number } = {};\n\n  const selRecordIndex = layoutMap.getRecordIndexByRow(sel.row);\n  const selId = layoutMap.getCellId(sel.col, sel.row);\n\n  function isSelectCell(col: number, row: number): boolean {\n    if (col === sel.col && row === sel.row) {\n      return true;\n    }\n    return selId != null && layoutMap.getCellId(col, row) === selId && layoutMap.getRecordIndexByRow(row) === selRecordIndex;\n  }\n\n  //\n  if (isSelectCell(col, row)) {\n    option.borderColor = helper.theme.highlightBorderColor;\n    option.lineWidth = 2;\n    helper.border(context, option);\n  } else {\n    option.lineWidth = 1;\n    // header color\n    const isFrozenCell = grid.isFrozenCell(col, row);\n    if (isFrozenCell?.row) {\n      option.borderColor = helper.theme.frozenRowsBorderColor;\n    }\n    helper.border(context, option);\n\n    //\n    if (col > 0 && isSelectCell(col - 1, row)) {\n      //\n      helper.drawBorderWithClip(context, (ctx) => {\n        const borderColors = helper.toBoxArray(helper.getColor(helper.theme.highlightBorderColor, sel.col, sel.row, ctx));\n        if (borderColors[1]) {\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = borderColors[1];\n          ctx.beginPath();\n          ctx.moveTo(rect.left - 0.5, rect.top);\n          ctx.lineTo(rect.left - 0.5, rect.bottom);\n          ctx.stroke();\n        }\n      });\n    } else if (row > 0 && isSelectCell(col, row - 1)) {\n      //\n      helper.drawBorderWithClip(context, (ctx) => {\n        const borderColors = helper.toBoxArray(helper.getColor(helper.theme.highlightBorderColor, sel.col, sel.row, ctx));\n        if (borderColors[0]) {\n          ctx.lineWidth = 1;\n          ctx.strokeStyle = borderColors[0];\n          ctx.beginPath();\n          ctx.moveTo(rect.left, rect.top - 0.5);\n          ctx.lineTo(rect.right, rect.top - 0.5);\n          ctx.stroke();\n        }\n      });\n    }\n  }\n}\n\n/** @private */\nfunction _refreshHeader<T>(grid: ListGrid<T>): void {\n  const protectedSpace = grid[_];\n  if (protectedSpace.headerEvents) {\n    protectedSpace.headerEvents.forEach((id) => grid.unlisten(id));\n  }\n\n  const headerEvents: EventListenerId[] = (grid[_].headerEvents = []);\n\n  headerEvents.forEach((id) => grid.unlisten(id));\n  let layoutMap: LayoutMapAPI<T>;\n  if (protectedSpace.layout && (!Array.isArray(protectedSpace.layout) || protectedSpace.layout.length > 0)) {\n    layoutMap = protectedSpace.layoutMap = new MultiLayoutMap(protectedSpace.layout);\n  } else {\n    layoutMap = protectedSpace.layoutMap = new SimpleHeaderLayoutMap(protectedSpace.header ?? []);\n  }\n  layoutMap.headerObjects.forEach((cell) => {\n    const ids = cell.headerType.bindGridEvent(grid, cell.id);\n    headerEvents.push(...ids);\n    if (cell.style) {\n      if (cell.style instanceof HeaderBaseStyle) {\n        const id = cell.style.listen(HeaderBaseStyle.EVENT_TYPE.CHANGE_STYLE, () => {\n          grid.invalidate();\n        });\n        headerEvents.push(id);\n      }\n    }\n    if (cell.action) {\n      const ids = cell.action.bindGridEvent(grid, cell.id);\n      headerEvents.push(...ids);\n    }\n  });\n  layoutMap.columnObjects.forEach((col) => {\n    if (col.action) {\n      const ids = col.action.bindGridEvent(grid, col.id);\n      headerEvents.push(...ids);\n    }\n    if (col.columnType) {\n      const ids = col.columnType.bindGridEvent(grid, col.id);\n      headerEvents.push(...ids);\n    }\n    if (col.style) {\n      if (col.style instanceof BaseStyle) {\n        const id = col.style.listen(BaseStyle.EVENT_TYPE.CHANGE_STYLE, () => {\n          grid.invalidate();\n        });\n        headerEvents.push(id);\n      }\n    }\n  });\n  for (let col = 0; col < layoutMap.columnWidths.length; col++) {\n    const column = layoutMap.columnWidths[col];\n    const { width, minWidth, maxWidth } = column;\n    if (width && (width > 0 || typeof width === 'string')) {\n      grid.setColWidth(col, width);\n    }\n    if (minWidth && (minWidth > 0 || typeof minWidth === 'string')) {\n      grid.setMinColWidth(col, minWidth);\n    }\n    if (maxWidth && (maxWidth > 0 || typeof maxWidth === 'string')) {\n      grid.setMaxColWidth(col, maxWidth);\n    }\n  }\n  const { headerRowHeight } = grid[_];\n  for (let row = 0; row < layoutMap.headerRowCount; row++) {\n    const height = Array.isArray(headerRowHeight) ? headerRowHeight[row] : headerRowHeight;\n    if (height && height > 0) {\n      grid.setRowHeight(row, height);\n    }\n  }\n  grid.colCount = layoutMap.colCount;\n  _refreshRowCount(grid);\n  grid.frozenRowCount = layoutMap.headerRowCount;\n}\n\n/** @private */\nfunction _refreshRowCount<T>(grid: ListGrid<T>): void {\n  const { layoutMap } = grid[_];\n  grid.rowCount = grid[_].dataSource.length * layoutMap.bodyRowCount + layoutMap.headerRowCount;\n}\n\n/** @private */\nfunction _tryWithUpdateDataSource<T>(grid: ListGrid<T>, fn: (grid: ListGrid<T>) => void): void {\n  const { dataSourceEventIds } = grid[_];\n\n  if (dataSourceEventIds) {\n    dataSourceEventIds.forEach((id) => grid[_].handler.off(id));\n  }\n\n  fn(grid);\n\n  grid[_].dataSourceEventIds = [\n    grid[_].handler.on(grid[_].dataSource, DataSource.EVENT_TYPE.UPDATED_LENGTH, () => {\n      _refreshRowCount(grid);\n      grid.invalidate();\n    }),\n    grid[_].handler.on(grid[_].dataSource, DataSource.EVENT_TYPE.UPDATED_ORDER, () => {\n      grid.invalidate();\n    })\n  ];\n}\n\n/** @private */\nfunction _setRecords<T>(grid: ListGrid<T>, records: T[] = []): void {\n  _tryWithUpdateDataSource(grid, () => {\n    grid[_].records = records;\n    const newDataSource = (grid[_].dataSource = CachedDataSource.ofArray(records));\n    grid.addDisposable(newDataSource);\n  });\n}\n\n/** @private */\nfunction _setDataSource<T>(grid: ListGrid<T>, dataSource: DataSource<T>): void {\n  _tryWithUpdateDataSource(grid, () => {\n    if (dataSource) {\n      if (dataSource instanceof DataSource) {\n        grid[_].dataSource = dataSource;\n      } else {\n        const newDataSource = (grid[_].dataSource = new CachedDataSource(dataSource));\n        grid.addDisposable(newDataSource);\n      }\n    } else {\n      grid[_].dataSource = DataSource.EMPTY;\n    }\n    grid[_].records = null;\n  });\n}\n\n/** @private */\nfunction _getRecordIndexByRow<T>(grid: ListGrid<T>, row: number): number {\n  const { layoutMap } = grid[_];\n  return layoutMap.getRecordIndexByRow(row);\n}\n\n/** @private */\nfunction _onRangePaste<T>(this: ListGrid<T>, text: string, test: (data: SetPasteValueTestData<T>) => boolean = (): boolean => true): void {\n  const { layoutMap } = this[_];\n  const selectionRange = this.selection.range;\n  const { start } = this.getCellRange(selectionRange.start.col, selectionRange.start.row);\n  const { end } = this.getCellRange(selectionRange.end.col, selectionRange.end.row);\n  const values = parsePasteRangeBoxValues(text);\n\n  const pasteRowCount = Math.min(Math.max(end.row - start.row + 1, values.rowCount), this.rowCount - start.row);\n  const pasteColCount = Math.min(Math.max(end.col - start.col + 1, values.colCount), this.colCount - start.col);\n\n  let hasEditable = false;\n  const actionColumnsBox: ColumnData<T>[][] = [];\n  for (let bodyRow = 0; bodyRow < layoutMap.bodyRowCount; bodyRow++) {\n    const actionColumnsRow: ColumnData<T>[] = [];\n    actionColumnsBox.push(actionColumnsRow);\n    for (let offsetCol = 0; offsetCol < pasteColCount; offsetCol++) {\n      const body = layoutMap.getBody(start.col + offsetCol, bodyRow + layoutMap.headerRowCount);\n      actionColumnsRow[offsetCol] = body;\n      if (!hasEditable && body.action?.editable) {\n        hasEditable = true;\n      }\n    }\n  }\n  if (!hasEditable) {\n    return;\n  }\n\n  const startRow = layoutMap.getRecordStartRowByRecordIndex(layoutMap.getRecordIndexByRow(start.row));\n  const startRowOffset = start.row - startRow;\n\n  let duplicate: { [key: number]: boolean } = {};\n  let actionRow = startRowOffset;\n  let valuesRow = 0;\n  for (let offsetRow = 0; offsetRow < pasteRowCount; offsetRow++) {\n    let valuesCol = 0;\n    for (let offsetCol = 0; offsetCol < pasteColCount; offsetCol++) {\n      const { action, id } = actionColumnsBox[actionRow][offsetCol];\n      if (!duplicate[id as number] && action?.editable) {\n        duplicate[id as number] = true;\n        const col = start.col + offsetCol;\n        const row = start.row + offsetRow;\n        const cellValue = values.getCellValue(valuesCol, valuesRow);\n\n        then(this.getRowRecord(row), (record) => {\n          then(_getCellValue(this, col, row), (oldValue) => {\n            if (\n              test({\n                grid: this,\n                record: record as T,\n                col,\n                row,\n                value: cellValue,\n                oldValue\n              })\n            ) {\n              action.onPasteCellRangeBox(this, { col, row }, cellValue);\n            }\n          });\n        });\n      }\n      valuesCol++;\n      if (valuesCol >= values.colCount) {\n        valuesCol = 0;\n      }\n    }\n    actionRow++;\n    if (actionRow >= layoutMap.bodyRowCount) {\n      actionRow = 0;\n      duplicate = {};\n    }\n    valuesRow++;\n    if (valuesRow >= values.rowCount) {\n      valuesRow = 0;\n    }\n  }\n\n  const newEnd = {\n    col: start.col + pasteColCount - 1,\n    row: start.row + pasteRowCount - 1\n  };\n  this.selection.range = {\n    start,\n    end: newEnd\n  };\n  this.invalidateCellRange(this.selection.range);\n}\n\n/** @private */\nfunction _onRangeDelete<T>(this: ListGrid<T>): void {\n  const { layoutMap } = this[_];\n  const selectionRange = this.selection.range;\n  const { start } = this.getCellRange(selectionRange.start.col, selectionRange.start.row);\n  const { end } = this.getCellRange(selectionRange.end.col, selectionRange.end.row);\n\n  const deleteRowCount = Math.min(end.row - start.row + 1, this.rowCount - start.row);\n  const deleteColCount = Math.min(end.col - start.col + 1, this.colCount - start.col);\n\n  let hasEditable = false;\n  const actionColumnsBox: ColumnData<T>[][] = [];\n  for (let bodyRow = 0; bodyRow < layoutMap.bodyRowCount; bodyRow++) {\n    const actionColumnsRow: ColumnData<T>[] = [];\n    actionColumnsBox.push(actionColumnsRow);\n    for (let offsetCol = 0; offsetCol < deleteColCount; offsetCol++) {\n      const body = layoutMap.getBody(start.col + offsetCol, bodyRow + layoutMap.headerRowCount);\n      actionColumnsRow[offsetCol] = body;\n      if (!hasEditable && body.action?.editable) {\n        hasEditable = true;\n      }\n    }\n  }\n  if (!hasEditable) {\n    return;\n  }\n\n  const startRow = layoutMap.getRecordStartRowByRecordIndex(layoutMap.getRecordIndexByRow(start.row));\n  const startRowOffset = start.row - startRow;\n\n  let duplicate: { [key: number]: boolean } = {};\n  let actionRow = startRowOffset;\n  for (let offsetRow = 0; offsetRow < deleteRowCount; offsetRow++) {\n    for (let offsetCol = 0; offsetCol < deleteColCount; offsetCol++) {\n      const { action, id } = actionColumnsBox[actionRow][offsetCol];\n      if (!duplicate[id as number] && action?.editable) {\n        duplicate[id as number] = true;\n        const col = start.col + offsetCol;\n        const row = start.row + offsetRow;\n\n        then(this.getRowRecord(row), (_record) => {\n          then(_getCellValue(this, col, row), (_oldValue) => {\n            action.onDeleteCellRangeBox(this, { col, row });\n          });\n        });\n      }\n    }\n    actionRow++;\n    if (actionRow >= layoutMap.bodyRowCount) {\n      actionRow = 0;\n      duplicate = {};\n    }\n  }\n\n  this.invalidateCellRange(selectionRange);\n}\n\n//end private methods\n//\n//\n//\n\n/** @protected */\ninterface ListGridProtected<T> extends DrawGridProtected {\n  dataSourceEventIds?: EventListenerId[];\n  headerEvents?: EventListenerId[];\n  layoutMap: LayoutMapAPI<T>;\n  headerValues?: HeaderValues;\n  tooltipHandler: TooltipHandler<T>;\n  messageHandler: MessageHandler<T>;\n  theme: Theme | null;\n  headerRowHeight: number[] | number;\n  header: HeadersDefine<T>;\n  layout: LayoutDefine<T>;\n  gridCanvasHelper: GridCanvasHelper<T>;\n  sortState: SortState;\n  dataSource: DataSource<T>;\n  records?: T[] | null;\n  allowRangePaste: boolean;\n}\n\nexport { ListGridProtected };\n\nexport interface ListGridConstructorOptions<T> extends DrawGridConstructorOptions {\n  /**\n   * Simple header property\n   */\n  header?: HeadersDefine<T>;\n  /**\n   * Layout property\n   */\n  layout?: LayoutDefine<T>;\n  /**\n   * Header row height(s)\n   */\n  headerRowHeight?: number[] | number;\n  /**\n   * Records data source\n   */\n  dataSource?: DataSource<T>;\n  /**\n   * Simple records data\n   */\n  records?: T[];\n  /**\n   * Theme\n   */\n  theme?: ThemeDefine | string;\n  /**\n   * If set to true to allow pasting of ranges. default false\n   */\n  allowRangePaste?: boolean;\n  /**\n   * @deprecated Cannot be used with ListGrid.\n   * @override\n   */\n  rowCount?: undefined;\n  /**\n   * @deprecated Cannot be used with ListGrid.\n   * @override\n   */\n  colCount?: undefined;\n  /**\n   * @deprecated Cannot be used with ListGrid.\n   * @override\n   */\n  frozenRowCount?: undefined;\n}\n\n// export { HeadersDefine, ColumnDefine, HeaderDefine, GroupHeaderDefine }\n\n/**\n * ListGrid\n * @classdesc cheetahGrid.ListGrid\n * @memberof cheetahGrid\n */\nexport class ListGrid<T> extends DrawGrid implements ListGridAPI<T> {\n  protected [_]: ListGridProtected<T>;\n  public disabled = false;\n  public readOnly = false;\n\n  static get EVENT_TYPE(): typeof LG_EVENT_TYPE {\n    return LG_EVENT_TYPE;\n  }\n\n  /**\n   * constructor\n   *\n   * @constructor\n   * @param options Constructor options\n   */\n  constructor(options: ListGridConstructorOptions<T> = {}) {\n    super(omit(options, ['colCount', 'rowCount', 'frozenRowCount']));\n    const protectedSpace = this[_];\n    protectedSpace.header = options.header || [];\n    protectedSpace.layout = options.layout || [];\n    protectedSpace.headerRowHeight = options.headerRowHeight || [];\n    if (options.dataSource) {\n      _setDataSource(this, options.dataSource);\n    } else {\n      _setRecords(this, options.records);\n    }\n    protectedSpace.allowRangePaste = options.allowRangePaste ?? false;\n    _refreshHeader(this);\n    protectedSpace.sortState = {\n      col: -1,\n      row: -1,\n      order: undefined\n    };\n    protectedSpace.gridCanvasHelper = new GridCanvasHelper(this);\n    protectedSpace.theme = themes.of(options.theme);\n    protectedSpace.messageHandler = new MessageHandler(this, (col: number, row: number): Message => _getCellMessage(this, col, row));\n    protectedSpace.tooltipHandler = new TooltipHandler(this);\n    this.invalidate();\n    protectedSpace.handler.on(window, 'resize', () => {\n      this.updateSize();\n      this.updateScroll();\n      this.invalidate();\n    });\n  }\n\n  /**\n   * Dispose the grid instance.\n   * @returns {void}\n   */\n  dispose(): void {\n    const protectedSpace = this[_];\n    protectedSpace.messageHandler.dispose();\n    protectedSpace.tooltipHandler.dispose();\n    super.dispose();\n  }\n\n  /**\n   * Gets the define of the header.\n   */\n  get header(): HeadersDefine<T> {\n    return this[_].header;\n  }\n\n  /**\n   * Sets the define of the header with the given data.\n   * <pre>\n   * column options\n   * -----\n   * caption: header caption\n   * field: field name\n   * width: column width\n   * minWidth: column min width\n   * maxWidth: column max width\n   * icon: icon name\n   * message: message key name\n   * columnType: column type\n   * action: column action\n   * style: column style\n   * headerType: header type\n   * headerStyle: header style\n   * headerAction: header action\n   * headerField: header field name\n   * sort: define sort setting\n   * -----\n   *\n   * multiline header\n   * -----\n   * caption: header caption\n   * columns: columns define\n   * -----\n   * </pre>\n   */\n  set header(header: HeadersDefine<T>) {\n    this[_].header = header;\n    _refreshHeader(this);\n  }\n\n  /**\n   * Gets the define of the layout.\n   */\n  get layout(): LayoutDefine<T> {\n    return this[_].layout;\n  }\n\n  /**\n   * Sets the define of the layout with the given data.\n   */\n  set layout(layout: LayoutDefine<T>) {\n    this[_].layout = layout;\n    _refreshHeader(this);\n  }\n\n  /**\n   * Get the row count per record\n   */\n  get recordRowCount(): number {\n    return this[_].layoutMap.bodyRowCount;\n  }\n\n  /**\n   * Get the records.\n   */\n  get records(): T[] | null {\n    return this[_].records || null;\n  }\n\n  /**\n   * Set the records from given\n   */\n  set records(records: T[] | null) {\n    if (records == null) {\n      return;\n    }\n    _setRecords(this, records);\n    _refreshRowCount(this);\n    this.invalidate();\n  }\n\n  /**\n   * Get the data source.\n   */\n  get dataSource(): DataSource<T> {\n    return this[_].dataSource;\n  }\n\n  /**\n   * Set the data source from given\n   */\n  set dataSource(dataSource: DataSource<T>) {\n    _setDataSource(this, dataSource);\n    _refreshRowCount(this);\n    this.invalidate();\n  }\n\n  /**\n   * Get the theme.\n   */\n  get theme(): Theme | null {\n    return this[_].theme;\n  }\n\n  /**\n   * Set the theme from given\n   */\n  set theme(theme: Theme | null) {\n    this[_].theme = themes.of(theme);\n    this.invalidate();\n  }\n\n  /**\n   * If set to true to allow pasting of ranges.\n   */\n  get allowRangePaste(): boolean {\n    return this[_].allowRangePaste;\n  }\n\n  set allowRangePaste(allowRangePaste: boolean) {\n    this[_].allowRangePaste = allowRangePaste;\n  }\n\n  /**\n   * Get the font definition as a string.\n   * @override\n   */\n\n  get font(): string {\n    // return super.font || this[_].gridCanvasHelper.theme.font\n    return '';\n  }\n\n  /**\n   * Set the font definition with the given string.\n   * @override\n   */\n  set font(font: string) {\n    // super.font = font\n  }\n\n  /**\n   * Get the background color of the underlay.\n   * @override\n   */\n  get underlayBackgroundColor(): string {\n    return 'transparent';\n    /*return (\n            super.underlayBackgroundColor ||\n            this[_].gridCanvasHelper.theme.underlayBackgroundColor\n        )*/\n  }\n\n  /**\n   * Set the background color of the underlay.\n   * @override\n   */\n  set underlayBackgroundColor(underlayBackgroundColor: string) {\n    // super.underlayBackgroundColor = underlayBackgroundColor\n  }\n\n  /**\n   * Get the sort state.\n   */\n  get sortState(): SortState {\n    return this[_].sortState;\n  }\n\n  /**\n   * Sets the sort state.\n   * If `null` to set, the sort state is initialized.\n   */\n  set sortState(sortState: SortState) {\n    const oldState = this.sortState;\n    let oldField;\n    if (oldState.col >= 0 && oldState.row >= 0) {\n      oldField = this.getHeaderField(oldState.col, oldState.row);\n    }\n\n    const newState = (this[_].sortState =\n      sortState != null\n        ? sortState\n        : {\n          col: -1,\n          row: -1,\n          order: undefined\n        });\n\n    let newField;\n    if (newState.col >= 0 && newState.row >= 0) {\n      newField = this.getHeaderField(newState.col, newState.row);\n    }\n\n    // bind header value\n    if (oldField != null && oldField !== newField) {\n      this.setHeaderValue(oldState.col, oldState.row, undefined);\n    }\n    if (newField != null) {\n      this.setHeaderValue(newState.col, newState.row, newState.order);\n    }\n  }\n\n  /**\n   * Get the header values.\n   */\n  get headerValues(): HeaderValues {\n    return this[_].headerValues || (this[_].headerValues = new Map());\n  }\n\n  /**\n   * Sets the header values.\n   */\n  set headerValues(headerValues: HeaderValues) {\n    this[_].headerValues = headerValues || new Map();\n  }\n\n  /**\n   * Get the field of the given column index.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index.\n   * @return {*} The field object.\n   */\n  getField(col: number, row: number): FieldDef<T> | undefined {\n    return this[_].layoutMap.getBody(col, row ?? this[_].layoutMap.headerRowCount).field;\n  }\n\n  /**\n   * Get the column define of the given column index.\n   * @param  {number} col The column index.\n   * @param  {number} row The row index.\n   * @return {*} The column define object.\n   */\n  getColumnDefine(col: number, row: number): ColumnDefine<T> {\n    return this[_].layoutMap.getBody(col, row ?? this[_].layoutMap.headerRowCount).define;\n  }\n\n  getColumnType(col: number, row: number): ColumnTypeAPI {\n    return this[_].layoutMap.getBody(col, row).columnType;\n  }\n\n  /**\n   * Get the header field of the given header cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The header row index.\n   * @return {*} The field object.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getHeaderField(col: number, row: number): any | undefined {\n    const hd = this[_].layoutMap.getHeader(col, row);\n    return hd.field;\n  }\n\n  /**\n   * Get the header define of the given header cell.\n   * @param  {number} col The column index.\n   * @param  {number} row The header row index.\n   * @return {*} The header define object.\n   */\n  getHeaderDefine(col: number, row: number): HeaderDefine<T> {\n    const hd = this[_].layoutMap.getHeader(col, row);\n    return hd.define;\n  }\n\n  /**\n   * Get the record of the given row index.\n   * @param  {number} row The row index.\n   * @return {object} The record.\n   */\n  getRowRecord(row: number): MaybePromiseOrUndef<T> {\n    if (row < this[_].layoutMap.headerRowCount) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return undefined;\n    } else {\n      return this[_].dataSource.get(_getRecordIndexByRow(this, row));\n    }\n  }\n\n  /**\n   * Get the record index of the given row index.\n   * @param  {number} row The row index.\n   */\n  getRecordIndexByRow(row: number): number {\n    return _getRecordIndexByRow(this, row);\n  }\n\n  /**\n   * Gets the row index starting at the given record index.\n   * @param  {number} index The record index.\n   */\n  getRecordStartRowByRecordIndex(index: number): number {\n    return this[_].layoutMap.getRecordStartRowByRecordIndex(index);\n  }\n\n  /**\n   * Get the column index of the given field.\n   * @param  {*} field The field.\n   * @return {number} The column index.\n   * @deprecated use `getCellRangeByField` instead\n   */\n  getColumnIndexByField(field: FieldDef<T>): number | null {\n    const range = this.getCellRangeByField(field, 0);\n    return range?.start.col ?? null;\n  }\n\n  /**\n   * Get the column index of the given field.\n   * @param  {*} field The field.\n   * @param  {number} index The record index\n   * @return {number} The column index.\n   */\n  getCellRangeByField(field: FieldDef<T>, index: number): CellRange | null {\n    const { layoutMap } = this[_];\n    const colObj = layoutMap.columnObjects.find((col) => col.field === field);\n    if (colObj) {\n      const layoutRange = layoutMap.getBodyLayoutRangeById(colObj.id);\n      const startRow = layoutMap.getRecordStartRowByRecordIndex(index);\n      return {\n        start: {\n          col: layoutRange.start.col,\n          row: startRow + layoutRange.start.row\n        },\n        end: {\n          col: layoutRange.end.col,\n          row: startRow + layoutRange.end.row\n        }\n      };\n    }\n    return null;\n  }\n\n  /**\n   * Focus the cell.\n   * @param  {*} field The field.\n   * @param  {number} index The record index\n   * @return {void}\n   */\n  focusGridCell(field: FieldDef<T>, index: number): void {\n    const {\n      start: { col: startCol, row: startRow },\n      end: { col: endCol, row: endRow }\n    } = this.selection.range;\n\n    const newFocus = this.getCellRangeByField(field, index)?.start;\n    if (newFocus == null) {\n      return;\n    }\n    this.focusCell(newFocus.col, newFocus.row);\n    this.selection.select = newFocus;\n    this.invalidateGridRect(startCol, startRow, endCol, endRow);\n    this.invalidateCell(newFocus.col, newFocus.row);\n  }\n\n  /**\n   * Scroll to where cell is visible.\n   * @param  {*} field The field.\n   * @param  {number} index The record index\n   * @return {void}\n   */\n  makeVisibleGridCell(field: FieldDef<T>, index: number): void {\n    const cell = this.getCellRangeByField(field, index)?.start;\n    this.makeVisibleCell(cell?.col ?? 0, cell?.row ?? this[_].layoutMap.headerRowCount);\n  }\n\n  getGridCanvasHelper(): GridCanvasHelper<T> {\n    return this[_].gridCanvasHelper;\n  }\n\n  /**\n   * Get cell range information for a given cell.\n   * @param {number} col column index of the cell\n   * @param {number} row row index of the cell\n   * @returns {object} cell range info\n   */\n  getCellRange(col: number, row: number): CellRange {\n    return _getCellRange(this, col, row);\n  }\n\n  /**\n   * Get header range information for a given cell.\n   * @param {number} col column index of the cell\n   * @param {number} row row index of the cell\n   * @returns {object} cell range info\n   * @deprecated use `getCellRange` instead\n   */\n  getHeaderCellRange(col: number, row: number): CellRange {\n    return this.getCellRange(col, row);\n  }\n\n  protected getCopyCellValue(col: number, row: number, range?: CellRange): string {\n    const cellRange = _getCellRange(this, col, row);\n    const startCol = range ? Math.max(range.start.col, cellRange.start.col) : cellRange.start.col;\n    const startRow = range ? Math.max(range.start.row, cellRange.start.row) : cellRange.start.row;\n    if (startCol !== col || startRow !== row) {\n      return '';\n    }\n\n    const value = _getCellValue(this, col, row);\n\n    if (row < this[_].layoutMap.headerRowCount) {\n      return value;\n    }\n\n    const columnData = this[_].layoutMap.getBody(col, row);\n    return columnData.columnType.getCopyCellValue(value, this, { col, row }) ?? value;\n  }\n\n  protected onDrawCell(col: number, row: number, context: CellContext): MaybePromise<void> {\n    const { layoutMap } = this[_];\n\n    let draw;\n    let style;\n    if (row < layoutMap.headerRowCount) {\n      const hd = layoutMap.getHeader(col, row);\n      draw = hd.headerType.onDrawCell;\n      ({ style } = hd);\n      _updateRect(this, col, row, context);\n    } else {\n      const column = layoutMap.getBody(col, row);\n      draw = column.columnType.onDrawCell;\n      ({ style } = column);\n      _updateRect(this, col, row, context);\n    }\n    const cellValue = _getCellValue(this, col, row);\n    if (this.rowCount <= row) {\n      // Depending on the FilterDataSource, the rowCount may be reduced.\n      return undefined;\n    }\n    return _onDrawValue(this, cellValue, context, { col, row }, style, draw);\n  }\n\n  doGetCellValue(\n    col: number,\n    row: number,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    valueCallback: (value: any) => void\n  ): boolean {\n    if (row < this[_].layoutMap.headerRowCount) {\n      // nop\n      return false;\n    } else {\n      const value = _getCellValue(this, col, row);\n      if (isPromise(value)) {\n        //\n        return false;\n      }\n      valueCallback(value);\n    }\n    return true;\n  }\n\n  doChangeValue(\n    col: number,\n    row: number,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    changeValueCallback: (before: any) => any\n  ): MaybePromise<boolean> {\n    if (row < this[_].layoutMap.headerRowCount) {\n      // nop\n      return false;\n    } else {\n      const record = this.getRowRecord(row);\n      if (isPromise(record)) {\n        //\n        return false;\n      }\n      const before = _getCellValue(this, col, row);\n      if (isPromise(before)) {\n        //\n        return false;\n      }\n      const after = changeValueCallback(before);\n      if (after === undefined) {\n        return false;\n      }\n      return then(_setCellValue(this, col, row, after), (ret) => {\n        if (ret) {\n          const { field } = this[_].layoutMap.getBody(col, row);\n          this.fireListeners(LG_EVENT_TYPE.CHANGED_VALUE, {\n            col,\n            row,\n            record: record as T,\n            field: field as FieldDef<T>,\n            value: after,\n            oldValue: before\n          });\n        }\n        return ret;\n      });\n    }\n  }\n\n  doSetPasteValue(text: string, test?: (data: SetPasteValueTestData<T>) => boolean): void {\n    _onRangePaste.call<ListGrid<T>, [string, (data: SetPasteValueTestData<T>) => boolean], void>(this, text, test as (data: SetPasteValueTestData<T>) => boolean);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  getHeaderValue(col: number, row: number): any | undefined {\n    const field = this.getHeaderField(col, row);\n    return this.headerValues.get(field);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  setHeaderValue(col: number, row: number, newValue: any): void {\n    const field = this.getHeaderField(col, row);\n\n    const oldValue = this.headerValues.get(field);\n    this.headerValues.set(field, newValue);\n\n    this.fireListeners(LG_EVENT_TYPE.CHANGED_HEADER_VALUE, {\n      col,\n      row,\n      field,\n      value: newValue,\n      oldValue\n    });\n  }\n\n  getLayoutCellId(col: number, row: number): LayoutObjectId {\n    return this[_].layoutMap.getCellId(col, row);\n  }\n\n  protected bindEventsInternal(): void {\n    const grid: DrawGridAPI = this as DrawGridAPI;\n    grid.listen(LG_EVENT_TYPE.SELECTED_CELL, (e: SelectedCellEvent) => {\n      const range = _getCellRange(this, e.col, e.row);\n      const {\n        start: { col: startCol, row: startRow },\n        end: { col: endCol, row: endRow }\n      } = range;\n      if (startCol !== endCol || startRow !== endRow) {\n        this.invalidateCellRange(range);\n      }\n    });\n    grid.listen(LG_EVENT_TYPE.PASTE_CELL, (e: PasteCellEvent) => {\n      if (!this[_].allowRangePaste) {\n        return;\n      }\n      const { start, end } = this.selection.range;\n      if (!e.multi && cellEquals(start, end)) {\n        return;\n      }\n      const { layoutMap } = this[_];\n\n      if (start.row < layoutMap.headerRowCount) {\n        return;\n      }\n      event.cancel(e.event);\n      _onRangePaste.call<ListGrid<T>, [string], void>(this, e.normalizeValue);\n    });\n    grid.listen(LG_EVENT_TYPE.DELETE_CELL, (e) => {\n      const { start } = this.selection.range;\n      const { layoutMap } = this[_];\n\n      if (start.row < layoutMap.headerRowCount) {\n        return;\n      }\n      event.cancel(e.event);\n      _onRangeDelete.call<ListGrid<T>, [], void>(this);\n    });\n  }\n\n  protected getMoveLeftColByKeyDownInternal({ col, row }: CellAddress): number {\n    const {\n      start: { col: startCol }\n    } = _getCellRange(this, col, row);\n    col = startCol;\n    return super.getMoveLeftColByKeyDownInternal({ col, row });\n  }\n\n  protected getMoveRightColByKeyDownInternal({ col, row }: CellAddress): number {\n    const {\n      end: { col: endCol }\n    } = _getCellRange(this, col, row);\n    col = endCol;\n    return super.getMoveRightColByKeyDownInternal({ col, row });\n  }\n\n  protected getMoveUpRowByKeyDownInternal({ col, row }: CellAddress): number {\n    const {\n      start: { row: startRow }\n    } = _getCellRange(this, col, row);\n    row = startRow;\n    return super.getMoveUpRowByKeyDownInternal({ col, row });\n  }\n\n  protected getMoveDownRowByKeyDownInternal({ col, row }: CellAddress): number {\n    const {\n      end: { row: endRow }\n    } = _getCellRange(this, col, row);\n    row = endRow;\n    return super.getMoveDownRowByKeyDownInternal({ col, row });\n  }\n\n  protected getOffsetInvalidateCells(): number {\n    return 1;\n  }\n\n  protected getCopyRangeInternal(range: CellRange): CellRange {\n    const { start } = this.getCellRange(range.start.col, range.start.row);\n    const { end } = this.getCellRange(range.end.col, range.end.row);\n    return { start, end };\n  }\n\n  fireListeners<TYPE extends keyof ListGridEventHandlersEventMap<T>>(type: TYPE, ...event: ListGridEventHandlersEventMap<T>[TYPE]): ListGridEventHandlersReturnMap[TYPE][] {\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    return super.fireListeners(type as any, ...event);\n  }\n}\n","import type { FieldDef, MaybePromise, MaybePromiseOrUndef } from '../ts-types';\nimport { each, isPromise } from '../internal/utils';\nimport { DataSource } from './DataSource';\nimport { EventHandler } from '../internal/EventHandler';\n\n/** @private */\ntype Filter<T> = (record: T | undefined) => boolean;\n\n/** @private */\nclass DataSourceIterator<T> {\n  _dataSource: DataSource<T>;\n  _curIndex: number;\n  _data: MaybePromiseOrUndef<T>[];\n  constructor(dataSource: DataSource<T>) {\n    this._dataSource = dataSource;\n    this._curIndex = -1;\n    this._data = [];\n  }\n  hasNext(): boolean {\n    const next = this._curIndex + 1;\n    return this._dataSource.length > next;\n  }\n  next(): MaybePromiseOrUndef<T> {\n    const next = this._curIndex + 1;\n    const data = this._getIndexData(next);\n    this._curIndex = next;\n    return data;\n  }\n  movePrev(): void {\n    this._curIndex--;\n  }\n  _getIndexData(index: number, nest?: boolean): MaybePromiseOrUndef<T> {\n    const dataSource = this._dataSource;\n    const data = this._data;\n    if (index < data.length) {\n      return data[index];\n    }\n\n    if (dataSource.length <= index) {\n      return undefined;\n    }\n    const record = this._dataSource.get(index);\n    data[index] = record;\n    if (isPromise(record)) {\n      record.then((val) => {\n        data[index] = val;\n      });\n      if (!nest) {\n        for (let i = 1; i <= 100; i++) {\n          this._getIndexData(index + i, true);\n        }\n      }\n    }\n    return record;\n  }\n}\n/** @private */\nclass FilterData<T> {\n  _owner: FilterDataSource<T>;\n  _dataSourceItr: DataSourceIterator<T>;\n  _filter: Filter<T>;\n  _filterdList: (T | undefined)[];\n  _queues: (Promise<T | undefined> | null)[];\n  _cancel = false;\n  constructor(dc: FilterDataSource<T>, original: DataSource<T>, filter: Filter<T>) {\n    this._owner = dc;\n    this._dataSourceItr = new DataSourceIterator(original);\n    this._filter = filter;\n    this._filterdList = [];\n    this._queues = [];\n  }\n  get(index: number): MaybePromiseOrUndef<T> {\n    if (this._cancel) {\n      return undefined;\n    }\n    const filterdList = this._filterdList;\n    if (index < filterdList.length) {\n      return filterdList[index];\n    }\n    const queues = this._queues;\n    const indexQueue = queues[index];\n    if (indexQueue) {\n      return indexQueue;\n    }\n    return queues[index] || this._findIndex(index);\n  }\n  cancel(): void {\n    this._cancel = true;\n  }\n  _findIndex(index: number): MaybePromiseOrUndef<T> {\n    if (window.Promise) {\n      const timeout = Date.now() + 100;\n      let count = 0;\n      return this._findIndexWithTimeout(index, () => {\n        count++;\n        if (count >= 100) {\n          count = 0;\n          return timeout < Date.now();\n        }\n        return false;\n      });\n    }\n    return this._findIndexWithTimeout(index, () => false);\n  }\n  _findIndexWithTimeout(index: number, testTimeout: () => boolean): MaybePromiseOrUndef<T> {\n    const filterdList = this._filterdList;\n    const filter = this._filter;\n    const dataSourceItr = this._dataSourceItr;\n\n    const queues = this._queues;\n\n    while (dataSourceItr.hasNext()) {\n      if (this._cancel) {\n        return undefined;\n      }\n      const record = dataSourceItr.next();\n      if (isPromise(record)) {\n        dataSourceItr.movePrev();\n        const queue = record.then((_value) => {\n          queues[index] = null;\n          return this.get(index);\n        });\n        queues[index] = queue;\n        return queue;\n      }\n      if (filter(record)) {\n        filterdList.push(record);\n        if (index < filterdList.length) {\n          return filterdList[index];\n        }\n      }\n      if (testTimeout()) {\n        const promise = new Promise<void>((resolve) => {\n          setTimeout(() => {\n            resolve();\n          }, 300);\n        });\n        const queue = promise.then(() => {\n          queues[index] = null;\n          return this.get(index);\n        });\n        queues[index] = queue;\n        return queue;\n      }\n    }\n    const dc = this._owner;\n    dc.length = filterdList.length;\n    return undefined;\n  }\n}\n\n/**\n * grid data source for filter\n *\n * @classdesc cheetahGrid.data.FilterDataSource\n * @memberof cheetahGrid.data\n */\nexport class FilterDataSource<T> extends DataSource<T> {\n  private _dataSource: DataSource<T>;\n  private _handler: EventHandler;\n  private _filterData: FilterData<T> | null = null;\n  static get EVENT_TYPE(): typeof DataSource.EVENT_TYPE {\n    return DataSource.EVENT_TYPE;\n  }\n  constructor(dataSource: DataSource<T>, filter: Filter<T>) {\n    super(dataSource);\n    this._dataSource = dataSource;\n    this.filter = filter;\n    const handler = (this._handler = new EventHandler());\n    handler.on(dataSource, DataSource.EVENT_TYPE.UPDATED_ORDER, () => {\n      // reset\n      // eslint-disable-next-line no-self-assign\n      this.filter = this.filter;\n    });\n    each(DataSource.EVENT_TYPE, (type) => {\n      handler.on(dataSource, type, (...args) => this.fireListeners(type, ...args));\n    });\n  }\n  get filter(): Filter<T> | null {\n    return this._filterData?._filter || null;\n  }\n  set filter(filter: Filter<T> | null) {\n    if (this._filterData) {\n      this._filterData.cancel();\n    }\n    this._filterData = filter ? new FilterData(this, this._dataSource, filter) : null;\n    this.length = this._dataSource.length;\n  }\n  protected getOriginal(index: number): MaybePromiseOrUndef<T> {\n    if (!this._filterData) {\n      return super.getOriginal(index);\n    }\n    return this._filterData.get(index);\n  }\n  sort(field: FieldDef<T>, order: 'desc' | 'asc'): MaybePromise<void> {\n    return this._dataSource.sort(field, order);\n  }\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  get source(): any {\n    return this._dataSource.source;\n  }\n  get dataSource(): DataSource<T> {\n    return this._dataSource;\n  }\n  dispose(): void {\n    this._handler.dispose();\n    super.dispose();\n  }\n}\n","import { DataSource } from './data/DataSource';\nimport { CachedDataSource } from './data/CachedDataSource';\nimport { FilterDataSource } from './data/FilterDataSource';\n\n/**\n * data modules\n */\nexport const data = {\n  DataSource,\n  CachedDataSource,\n  FilterDataSource\n};\n","// import * as action from './header/action'\n// import * as style from './header/style'\n// import * as type from './header/type'\n\nimport { ACTIONS, BaseAction, BaseActionOption, SortHeaderAction, CheckHeaderAction, of as headerActionOf, ofCell as headerActionOfCell, ImmutableHeaderActions } from './header/action';\nimport {\n  BaseStyle,\n  // BaseStdStyle,\n  // BaseCheckStyle,\n  Style,\n  SortHeaderStyle,\n  CheckHeaderStyle,\n  // SwitchHeaderStyle,\n  MultilineTextHeaderStyle,\n  of as headerStyleOf\n} from './header/style';\nimport {\n  TYPES,\n  BaseHeader,\n  // BaseCheckHeader,\n  Header,\n  SortHeader,\n  CheckHeader,\n  // SwitchHeader,\n  MultilineTextHeader,\n  of as headerTypeOf,\n  ofCell as headerTypeOfCell\n} from './header/type';\n\nconst action = {\n  ACTIONS: ACTIONS as ImmutableHeaderActions,\n  BaseAction,\n  // BaseCheckAction,\n  SortHeaderAction,\n  CheckHeaderAction,\n  // SwitchHeaderAction,\n  of: headerActionOf,\n  ofCell: headerActionOfCell\n};\nconst style = {\n  BaseStyle,\n  // BaseStdStyle,\n  // BaseCheckStyle,\n  Style,\n  SortHeaderStyle,\n  CheckHeaderStyle,\n  // SwitchHeaderStyle,\n  MultilineTextHeaderStyle,\n  of: headerStyleOf\n};\nconst type = {\n  TYPES,\n  BaseHeader,\n  // BaseCheckHeader,\n  Header,\n  SortHeader,\n  CheckHeader,\n  // SwitchHeader,\n  MultilineTextHeader,\n  of: headerTypeOf,\n  ofCell: headerTypeOfCell\n};\n/**\n * header classes\n */\nexport const headers = { action, type, style };\n","import type { IconDefine } from './ts-types';\nimport type { Theme } from './themes/theme';\nimport { icons as iconPlugins } from './plugins/icons';\nimport { themes as themePlugins } from './plugins/themes';\n\nfunction registerPlugin<T>(obj: { [key: string]: T }, name: string, value: T): T {\n  const old = obj[name];\n  obj[name] = value;\n  return old;\n}\n\nfunction registerPlugins<T>(obj: { [key: string]: T }, values: { [key: string]: T }): void {\n  for (const k in values) {\n    obj[k] = values[k];\n  }\n}\n\nexport function theme(name: string, theme?: Theme): Theme {\n  if (theme != null) {\n    return registerPlugin(themePlugins, name, theme);\n  } else {\n    return themePlugins[name];\n  }\n}\n\nexport function icon(name: string, icon?: IconDefine): IconDefine {\n  if (icon != null) {\n    return registerPlugin(iconPlugins, name, icon);\n  } else {\n    return iconPlugins[name];\n  }\n}\n\nexport function icons(icons: { [key: string]: IconDefine }): void {\n  return registerPlugins(iconPlugins, icons);\n}\n\nexport const register = {\n  theme,\n  icon,\n  icons\n};\n","/*// import type * as TYPES from './ts-types'\nimport { IconDefine } from './ts-types'\nimport * as columns from './columns'\nimport * as core from './core'\nimport * as data from './data'\nimport * as headers from './headers'\nimport * as icons from './icons'\nimport * as register from './register'\nimport * as themes from './themes'\nimport * as tools from './tools'\nimport {\n    ColumnDefine,\n    GroupHeaderDefine,\n    HeaderDefine,\n    HeadersDefine,\n    ListGrid,\n    ListGridConstructorOptions\n} from './ListGrid'\nimport { GridCanvasHelper } from './GridCanvasHelper'\nimport type { Theme } from './themes/theme'\n\nexport { getInternal as _getInternal } from './get-internal'*/\n\nimport { IconDefine } from './ts-types';\nimport { columns as _columns } from './columns';\nimport { core as _core } from './core';\nimport { tools as _tools } from './tools';\nimport { ListGrid as _ListGrid } from './ListGrid';\nimport { data as _data } from './data';\nimport { headers as _headers } from './headers';\nimport { themes as _themes } from './themes';\nimport { GridCanvasHelper as _GridCanvasHelper } from './GridCanvasHelper';\nimport { register as _register } from './register';\nimport { svgIcons } from './icons';\n\nconst kakaGrid = {\n  version: '1.0.1',\n  core: _core,\n  tools: _tools,\n\n  // impl Grids\n  ListGrid: _ListGrid,\n\n  // objects\n  columns: _columns,\n  data: _data,\n  headers: _headers,\n  themes: _themes,\n\n  // helper\n  GridCanvasHelper: _GridCanvasHelper,\n  get icons() {\n    return svgIcons.get();\n  },\n\n  // plugin registers\n  register: _register\n};\nexport default kakaGrid;\n/*\n\nexport {\n    core,\n    tools,\n    // impl Grids\n    ListGrid,\n    // ListGrid types\n    ListGridConstructorOptions,\n    HeadersDefine,\n    ColumnDefine,\n    HeaderDefine,\n    GroupHeaderDefine,\n    // objects\n    columns,\n    headers,\n    themes,\n    data,\n    // helper\n    GridCanvasHelper,\n    readonly icons:{\n  [key: string]:IconDefine\n},\n    // getIcons,\n    register\n}\n\n/!*function getIcons(): { [key: string]: TYPES.IconDefine } {\n    return icons.get()\n}*!/\n\nexport default {\n    core,\n    tools,\n    // impl Grids\n    ListGrid,\n    // objects\n    columns,\n    headers,\n    themes,\n    data,\n    // helper\n    GridCanvasHelper,\n    //plugin registers\n    register,\n    get icons(): { [key: string]: TYPES.IconDefine } {\n        return getIcons()\n    }\n}\n*/\n"],"names":["root","factory","exports","module","define","amd","self","mag","v","Math","sqrt","angle","u","sign","acos","value","dot","ratio","min","max","ellipseFromEllipticalArc","ctx","x1","y1","rx","ry","phi","fA","fS","x2","y2","lineTo","PI","abs","xPrime","cost","cos","sint","sin","rotClockwise","xPrime2","pointMul","rx2","ry2","lambda","factor","cPrime","c","scale","sum","rotCounterClockwise","meanVec","x1UnitVector","x2UnitVector","theta","start","end","save","translate","rotate","arc","restore","PathCommands","M","m","L","l","H","h","V","Z","z","C","S","s","Q","q","T","t","A","a","constructor","lMx","lMy","reflected","lx","ly","lastCommand","makeReflected","indexOf","x","y","this","px","py","moveTo","closePath","cp1x","cp1y","cp2x","cp2y","bezierCurveTo","cpx","cpy","quadraticCurveTo","xAxisRotation","largeArcFlag","sweepFlag","command","builder","cmd","argsProvider","toUpperCase","next","console","warn","parser","arcTo","ellipse","rect","_commands","_ops","buildPush","op","args","push","name","numArgs","i","length","apply","parse","d","ops","tokens","idx","pathTokens","subsequentCommand","isNaN","Number","fst","e","log","Path2DShim","arg","undefined","hasOwnProperty","Error","CanvasRenderingContext2D","window","originalFill","prototype","fill","path","beginPath","forEach","Array","slice","call","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","Function","obj","prop","r","Symbol","toStringTag","isNode","arrayFind","arrayFindIndex","array","find","arr","predicate","index","findIndex","IE","Chrome","Firefox","Edge","Safari","ua","navigator","userAgent","toLowerCase","exec","analyzeUserAgent","each","fn","defaults","source","defs","keys","result","val","set","configurable","extend","isDescendantElement","target","parentElement","p","applyChainSafe","names","getChainSafe","getOrApply","isPromise","data","Boolean","then","callback","cellEquals","b","col","row","cellInRange","range","browser","setReadonly","isObject","str","endsWith","searchString","position","subjectString","toString","isFinite","floor","lastIndex","lastIndexOf","genChars","re","res","genWords","getMouseButtons","buttons","which","button","getKeyCode","keyCode","isTouchEvent","changedTouches","cancel","preventDefault","stopPropagation","style","toBoxArray","isArray","emptyFn","DG_EVENT_TYPE","CLICK_CELL","DBLCLICK_CELL","DBLTAP_CELL","MOUSEDOWN_CELL","MOUSEUP_CELL","SELECTED_CELL","KEYDOWN","MOUSEMOVE_CELL","MOUSEENTER_CELL","MOUSELEAVE_CELL","MOUSEOVER_CELL","MOUSEOUT_CELL","CONTEXTMENU_CELL","INPUT_CELL","PASTE_CELL","DELETE_CELL","EDITABLEINPUT_CELL","MODIFY_STATUS_EDITABLEINPUT_CELL","RESIZE_COLUMN","SCROLL","FOCUS_GRID","BLUR_GRID","bindCellClickAction","grid","cellId","action","mouseOver","mouseOut","isTarget","getLayoutCellId","listen","getRowRecord","getElement","cursor","bindCellKeyAction","acceptKeys","keyboardOptions","moveCellOnEnter","sel","selection","select","event","BaseAction","_disabled","option","disabled","onChangeDisabledInternal","isDisabledRecord","getBooleanOptionOfRecord","isReadOnlyRecord","readOnly","toggleValue","replace","record","Action","_action","super","editable","clone","getState","_grid","bindGridEvent","state","cell","mouseActiveCell","getCellRange","invalidateCellRange","onPasteCellRangeBox","onDeleteCellRangeBox","random","cl","mem","getProtectedSymbol","getCheckColumnStateId","getRadioColumnStateId","getButtonColumnStateId","getCheckHeaderStateId","BUTTON_COLUMN_STATE_ID","ButtonAction","Editor","_readOnly","onChangeReadOnlyInternal","cubicBezier","x3","y3","step","EASINGS","linear","easeIn","easeOut","easeInOut","raf","requestAnimationFrame","setTimeout","now","Date","animate","duration","easing","startedAt","easingFn","canceledFlg","createAnim","resolve","reject","anim","point","Promise","CHECK_COLUMN_STATE_ID","CheckEditor","_state","block","elapsed","cellKey","ret","doChangeValue","onChange","_e","selrange","multi","selectionRange","pasteValue","normalizeValue","trim","doGetCellValue","BaseInputEditor","open","onOpenCellInternal","input","onInputCellInternal","stopCellMoving","onChangeSelectCellInternal","selected","onGridScrollInternal","baseRect","getCellRect","rangeRect","getCellRangeRect","top","parseFloat","toFixed","left","width","height","onSetInputAttrsInternal","nextId","EventHandler","_listeners","on","type","listener","options","addEventListener","id","once","off","tryWithOffEvents","list","removeEventListener","fire","hasListener","clear","dispose","createElement","tagName","classList","text","html","element","document","add","textContent","innerHTML","toNodeList","node","nodeType","nodeName","dom","childNodes","toNode","disableFocus","el","dataset","disableBeforeTabIndex","tabIndex","children","isFocusable","findPrevSiblingFocusable","n","previousSibling","findNextSiblingFocusable","nextSibling","setInputValue","handler","setInputAttrs","editor","InlineInputElement","_handler","_input","_beforePropEditor","_activeData","_attaching","static","_bindInputEvents","detach","removeChild","attach","remove","font","getAttachCellsArea","appendChild","focus","selectionStart","selectionEnd","createTextRange","collapse","moveEnd","moveStart","gridFocus","_isActive","stopPropagationOnly","contains","_onKeydownEnter","_onKeydownTab","onKeyDownMove","moveCellOnTab","_","globalElement","bindGridCount","attachInput","addDisposable","detachInput","InlineInputEditor","_classList","_type","inputValue","_cell","_selected","ITEM_CLASSNAME","HIDDEN_CLASSNAME","SHOWN_CLASSNAME","EMPTY_ITEM_CLASSNAME","findItemParents","attachElement","menu","lineHeight","optionToLi","label","item","valueindex","span","InlineMenuElement","_menu","_bindMenuEvents","firstChild","empty","emptyItemEl","valueItemEl","focusEl","focusIndex","offset","allHeight","offsetHeight","offsetTop","transformOrigin","ceil","menuClientRect","getBoundingClientRect","scaleDiff","orgMenuTop","menuTop","menuBottom","winBottom","innerHeight","openMenu","_col","_row","closeMenu","_doChangeValue","shiftKey","items","querySelectorAll","querySelector","EventTarget","listeners","listenerData","splice","unlisten","hasListeners","fireListeners","map","filter","STYLE_EVENT_TYPE","CHANGE_STYLE","defaultStyle","BaseStyle","_bgColor","EVENT_TYPE","DEFAULT","bgColor","doChangeStyle","StdBaseStyle","_textAlign","_textBaseline","textAlign","textBaseline","Style","_color","_font","_padding","_textOverflow","color","padding","textOverflow","ButtonStyle","_buttonBgColor","buttonBgColor","CheckStyle","_uncheckBgColor","_checkBgColor","_borderColor","uncheckBgColor","checkBgColor","borderColor","IconStyle","ImageStyle","_imageSizing","_margin","imageSizing","margin","MenuStyle","_appearance","appearance","MultilineTextStyle","_lineHeight","_autoWrapText","_lineClamp","autoWrapText","lineClamp","NumberStyle","DEFAULT_BAR_COLOR","num","PercentCompleteBarStyle","_barColor","_barBgColor","_barHeight","barColor","barBgColor","barHeight","RadioStyle","_checkColor","_uncheckBorderColor","_checkBorderColor","checkColor","uncheckBorderColor","checkBorderColor","of","columnStyle","StyleClassDef","COLUMN_FADEIN_STATE_ID","getFadeinState","cells","_generateFadeinPointAction","context","drawInternal","drawCellBase","stateKey","opacity","cellState","getContext","globalAlpha","fadeinMgr","activeFadeins","f","margeAnimate","BaseColumn","_fadeinWhenCallbackInPromise","onDrawCell","bind","fadeinWhenCallbackInPromise","StyleClass","cellValue","info","getRecord","helper","getGridCanvasHelper","promise","msg","getMessage","all","message","toCurrentContext","getDrawRect","time","currentContext","actStyle","convertInternal","drawMessageInternal","column","configure","isFadeinWhenCallbackInPromise","messageHandler","drawCellMessage","_cellId","getCopyCellValue","DEFAULT_BRANCH_COLORS","_name","BranchGraphStyle","_branchColors","_circleSize","_branchLineWidth","_mergeStyle","branchColors","circleSize","branchLineWidth","mergeStyle","BranchLine","fromIndex","toIndex","colorIndex","BranchPoint","commit","lines","tag","froms","tos","concat","mergeLines","joinLine","timeline","branchIndex","reverse","j","calcCommand","timelineData","from","branch","to","branches","fromTargetIndex","findBranchRootIndex","branchTargetFromIndex","branchPoint","targetLine","merge","fromTargetLine","pop","commitMerge","commitTag","calcBranchesInfo","field","dataSource","allData","getField","dataIndex","getAllColumnData","BranchGraphColumn","_start","_cache","cache","clearCache","Map","has","_value","upLineIndexKey","downLineIndexKey","frozenRowCount","getRect","radius","drawWithClip","branchXPoints","w","tl","textWidth","measureText","calcBranchXPoints","line","upLineIndex","downLineIndex","pointIndex","reduce","sort","strokeStyle","lineWidth","lineCap","upX","upRect","getCellRelativeRect","upY","downX","downRect","downY","stroke","renderMerge","fillStyle","fillText","ICON_PROP_KEYS","doms","props","toSimpleArray","iconProps","workData","count","k","toPropArray","normarize","isIconKey","className","tagProps","body","beforeStyle","defaultView","getComputedStyle","content","getPropertyValue","substr","quoted","split","part","test","join","quote","clientWidth","isLiga","getIconProps","iconPropKeys","loadIcons","icon","argIcon","iconList","icons","testFontLoad","Column","getIcon","ButtonColumn","_caption","caption","withCaption","active","getSelection","shadow","blur","offsetY","toBoolean","CheckColumn","opt","animElapsedTime","checkbox","IconColumn","_tagName","_className","_content","_iconWidth","iconWidth","Infinity","repeatArray","fontSizeCache","getFontSize","fontName","bk","em","calcStartPosition","paddingLeft","right","paddingRight","paddingTop","bottom","paddingBottom","LRUCache","_list","_map","_cacheSize","cacheSize","put","shift","allCache","getCacheOrLoad0","src","error","img","Image","onload","onerror","url","loadImage","getCacheOrLoad","cacheName","ImageColumn","maxWidth","maxHeight","newWidth","newHeight","calcKeepAspectRatioSize","pos","drawImage","normalize","JSON","normalizeToFn","MenuColumn","_options","withOptions","_convertInternal","basePadding","toBoxPixelArray","textPadding","iconPadding","MultilineTextColumn","multilines","multilineText","defaultFotmat","NumberColumn","_format","Intl","NumberFormat","fmt","format","withFormat","PercentCompleteBarColumn","_min","_max","_formatter","formatter","svalue","rate","barMaxWidth","MARGIN","barTop","barLeft","barSize","RADIO_COLUMN_STATE_ID","RadioColumn","radioButton","TYPES","NUMBER","CHECK","RADIO","BUTTON","IMAGE","MULTILINETEXT","columnType","attachMenu","detachMenu","InlineMenuEditor","pasteOpt","_pasteDataToOptionValue","_textToOptionValue","getColumnType","hasOptions","normalizePasteValueStr","captionOpt","RadioEditor","_group","_checkAction","group","checkAction","actionCell","recordStartRow","getRecordStartRowByRecordIndex","getRecordIndexByRow","girdRecords","rowCount","recordRowCount","targetRow","getAllRecordsFromGrid","showData","setField","flag","INPUT_CLASSNAME","_focus","SmallDialogInputElement","_dialog","_beforeValue","createDialogElement","_bindDialogEvents","dialog","helperText","unbindProps","errorMessage","activeData","_onInputValue","bindProps","_validate","onKeyupAndPress","before","_onInputValueChange","after","inputOnly","inputValidator","validator","SmallDialogInputEditor","_helperText","_inputValidator","_validator","ACTIONS","INPUT","columnAction","columns","isWhitespace","cp","isDigit","isDot","isUnit","isLowerLetter","isUpperLetter","isLetter","createError","calc","PRECEDENCE","lex","buildBinaryExpNode","stack","token","deep","closeIndex","beforeOp","unit","calcStr","exp","len","charCodeAt","parseSign","parseNum","parseUnit","tokenize","calcNode","full","toPxInternal","toPx","SCROLLBAR_SIZE","setRatio","devicePixelRatio","initDocumentVar","dummy","parseInt","getScrollBarWidth","setAttribute","head","getScrollBarSize","NumberMap","_keys","_vals","_sorted","keyFrom","keyTo","elm","low","high","indexFirst","Rect","_left","_top","_width","_height","_right","_bottom","rect1","rect2","bounds","offsetLeft","copy","intersection","x0","y0","another","inPoint","MAX_SCROLL","Scrollable","_scrollable","_endPointElement","_p","_update","calcTop","relativeTop","scrollTop","setScrollSize","scrollWidth","scrollHeight","scrollLeft","onScroll","domHeight","sbSize","vScrollRange","rScrollRange","parsePasteRangeBoxValues","values","colCount","getCellValue","offsetCol","offsetRow","cancelEvent","_vibrate","vibrate","_getTargetRowAt","absoluteY","internal","getTargetRowAtInternal","findBefore","startRow","startBottom","_getRowHeight","findAfter","candRow","defaultRowHeight","_getRowsHeight","_getTargetColAt","absoluteX","_getColWidth","_getTargetFrozenRowAt","scroll","_getTargetFrozenColAt","frozenColCount","_getFrozenRowsRect","canvas","_getFrozenColsRect","_drawCell","absoluteLeft","absoluteTop","visibleRect","skipAbsoluteTop","skipAbsoluteLeft","drawLayers","drawRect","cellDrawing","drawCells","_getCellDrawing","dcContext","DrawCellContext","_putCellDrawing","pCol","_delayMode","_removeCellDrawing","terminate","_drawRow","initFrozenCol","initCol","drawRight","drawOuter","outerLeft","underlayBackgroundColor","_getInitContext","_invalidateRect","_getVisibleRect","initRow","_getColsWidth","drawBottom","initFrozenRow","DrawLayers","outerTop","draw","_toPxWidth","round","calcWidthContext","_adjustColWidth","orgWidth","limits","_getColWidthLimits","_applyColWidthLimits","_getColWidthDefine","colWidthsMap","defaultColWidth","limit","colWidthsLimit","minDef","maxDef","isAutoDefine","_calcAutoColWidthExpr","shortCircuit","fullWidth","sumMin","others","autoCount","hasLimitsOnAuto","def","expr","autoPx","strDefs","_colWidthDefineToPxWidth","_setColWidth","startCol","endCol","defaultColPxWidth","adj","getRowHeightInternal","rowHeightsMap","endRow","getRowsHeightInternal","_getScrollHeight","getScrollHeightInternal","_onKeyDownMove","focusCell","ctrlKey","metaKey","move","hmove","vmove","getMoveUpRowByKeyDownInternal","_moveFocusCell","getMoveDownRowByKeyDownInternal","getMoveLeftColByKeyDownInternal","getMoveRightColByKeyDownInternal","selectAllOnCtrlA","invalidate","vDir","hDir","shiftKeyFlg","getOffsetInvalidateCells","extendRange","beforeRange","beforeRect","_setFocusCell","makeVisibleCell","afterRange","afterRect","_updatedSelection","focusControl","selCol","selRow","results","editMode","storeInputStatus","setDefaultInputStatus","_getMouseAbstractPoint","evt","clientX","pageX","scrollX","clientY","pageY","scrollY","_bindEvents","scrollable","getCellEventArgsSet","abstractPos","getCellAt","eventArgs","canResizeColumn","disableColumnResize","eventArgsSet","resizeCol","_getResizeColAt","columnResizer","cellSelector","doubleTapBefore","longTouchId","clearTimeout","defaultPrevented","isMouseover","mouseEnterCell","mouseOverCell","onMouseenterCell","related","onMouseleaveCell","beforeMouseCell","onMouseoverCell","onMouseoutCell","scrollElement","enterCell","outCell","moving","lastMoving","onKeyDown","lastLeft","lastTop","moveX","moveY","redrawRect","frozenRect","_onScroll","copyRange","getCopyRangeInternal","copyValue","copyCellValue","strCellValue","onCopy","onPaste","rangeBoxValues","pasteCellEvent","onInput","onDelete","onFocus","focusedGrid","invalidateCell","onBlur","abstractX","abstractY","cellRect","_toRelativeRect","absoluteRect","BaseMouseDownMover","_events","_started","_moved","_mouseEndPoint","last","pt","_bindMoveAndUp","events","touchmove","_mouseMove","passive","touchend","_mouseUp","touchcancel","mousemove","mouseup","_moveInternal","_upInternal","CellSelector","_getTargetCell","oldCol","oldRow","newCol","newRow","makeVisibleCol","makeVisibleRow","ColumnResizer","_targetCol","_x","_preX","_invalidateAbsoluteLeft","pre","getColWidth","afterSize","_storeAutoColWidthExprs","updateScroll","setSafeInputValue","FocusControl","_isComposition","_compositionEnd","_inputStatus","_keyDownMoveCallback","lastInputValue","inputClear","storeLastInputValue","handleCompositionEnd","stopCellMove","fireKeyDownMove","deleteCellValueOnDel","dummyInput","pasteText","clipboardData","getData","types","setData","setFocusRect","resetInputStatus","composition","atts","attributes","removeNames","att","removeName","removeAttribute","inputStatus","Selection","_sel","_end","_isWraped","_wrapFireSelectedEvent","_setSelectCell","keepSelect","_updateGridRange","points","needChange","_layers","addDraw","level","DrawLayer","_level","_mode","_ctx","_rect","_drawRect","_drawing","_selection","_drawLayers","_childContexts","_cancel","_onTerminate","_rectFilter","drawing","rectFilter","_getRectInternal","setRectFilter","_isOutOfRange","_toRelativeDrawRect","addLayerDraw","isFrozenCell","fRect","onTerminate","protectedKey","DrawGrid","protectedSpace","createRootElement","getAttribute","wh","alpha","cellTextOverflows","updateSize","bindEventsInternal","hasFocusGrid","setFocusCursor","cfg","config","offsetWidth","getRowHeight","setRowHeight","_setRowHeight","setColWidth","getMaxColWidth","setMaxColWidth","maxwidth","getMinColWidth","setMinColWidth","minwidth","getCellsRect","isFrozenStartCell","isFrozenEndCell","isFrozenRow","isFrozenCol","getRowAt","frozen","getColAt","frozenColsWidth","frozenRowsHeight","_getScrollableVisibleRect","oldEditMode","invalidateGridRect","cellsRect","invalidateTarget","visibleRowCount","visibleTop","visibleColCount","visibleLeft","topRow","leftCol","_range","getCellOverflowText","setCellOverflowText","overflowText","disposable","disposables","_absoluteY","_startRow","_endRow","core","strokeColorsRect","borderColors","strokeRect","positions","preColor","pos1","pos2","strokeRectLines","roundRect","fillRoundRect","strokeRoundRect","fillCircle","strokeCircle","fillTextRect","clip","calcBasePosition","drawInlineImageRect","image","srcLeft","srcTop","srcWidth","srcHeight","destWidth","destHeight","measureCheckbox","measureRadioButton","drawCheckbox","check","boxSize","checkPoint","leftX","topY","size","leftWidth","rightWidth","leftLeftPos","leftTopPos","drawRadioButton","checkSize","drawButton","backgroundColor","offsetX","ox","oy","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","canvasHelper","tools","getProp","superObj","defNames","Theme","_checkbox","_radioButton","_button","_header","_messages","superTheme","frozenRowsColor","defaultBgColor","frozenRowsBgColor","selectionBgColor","highlightBgColor","hasProperty","frozenRowsBorderColor","highlightBorderColor","header","sortArrowColor","messages","infoBgColor","errorBgColor","warnBgColor","hasThemeProperty","extends","cacheLinearGradient","themes","colorStops","stop","stopsKey","grad","createLinearGradient","addColorStop","getLinearGradient","builtin","BASIC","MATERIAL_DESIGN","defTheme","getIgnoreCase","getChoices","getDefault","theme","createArrayPromise","plist","setArrayField","compare","old","createArray","r1","r2","isFieldAssessor","UPDATE_LENGTH","UPDATED_LENGTH","UPDATED_ORDER","getValue","setPromiseBack","maybePromiseValue","promiseValue","fieldGet","ss","fieldSet","_getIndex","sortedIndexMap","mapIndex","DataSource","_get","_length","_source","_sortedIndexMap","getOriginal","getOriginalField","hasField","hasOriginalField","setOriginalField","order","orderFn","v1","v2","dummyPromise","catch","rel","recordPromiseCallBackInternal","fieldPromiseCallBackInternal","_index","_field","_record","CachedDataSource","_rCache","_fCache","rowCache","fCache","_setFieldCache","inMouse","CHECK_HEADER_STATE_ID","CheckHeaderAction","checked","getHeaderValue","setHeaderValue","SortHeaderAction","_sort","_executeSort","newState","fieldRow","sortState","ImmutableSortHeaderAction","SORT","headerAction","ofCell","headerCell","sortMethod","CheckHeaderStyle","MultilineTextHeaderStyle","SortHeaderStyle","_sortArrowColor","headerStyle","BaseHeader","CheckHeader","inlineCheck","buildCheckBoxInline","Header","MultilineTextHeader","SortHeader","arrowSize","getColor","headerType","seqId","EmptyDataCache","headers","getHeader","rows","getBody","SimpleHeaderLayoutMap","_headerObjects","_headerObjectMap","_headerCellIds","_columns","bodyRowCount","_emptyDataCache","_addHeaders","columnWidths","headerRowCount","headerObjects","columnObjects","getCellId","getBodyLayoutRangeById","roots","rowCells","_newRow","hd","headerField","colDef","minWidth","prev","LayoutObjectGrid","objects","objectGrid","objectMap","columnCount","layout","transform","rowLayout","_findStartCell","rowSpan","colSpan","rowIndex","objectGridRow","_getObjectGridRow","colIndex","_setWidthDataIfAbsent","_useColumnIndex","MultiLayoutMap","_body","_columnWidths","_columnCount","hbLayouut","normalizeLayout","widthDef","bodyLayoutRow","_getCellRange","recordIndex","bodyRow","layoutRow","drawExclamationMarkBox","boxRect","fillRect","fillColor","fillRectWithState","BaseMessage","_messageElement","detachMessageElement","_getMessageElement","createMessageElementInternal","attachMessageElement","moveMessageElement","_detach","drawCellMessageInternal","MESSAGE_CLASSNAME","MessageElement","_rootElement","rootElement","messageElement","createMessageDomElement","_attachCell","ErrorMessageElement","ErrorMessage","_message","_info","drawBorderWithClip","InfoMessage","LG_EVENT_TYPE","CHANGED_VALUE","CHANGED_HEADER_VALUE","WarningMessageElement","WarningMessage","EMPTY_MESSAGE","MESSAGE_INSTANCE_FACTORY","warning","normalizeMessage","original","hasMessage","MessageHandler","_messageInstances","_attachInfo","_bindGridEvent","messageInstances","_getMessageInstanceOfMessage","_attach","instance","_move","onSelectMessage","setMessageData","newSel","FontRuler","el_","testStr","display","computeStyle","getWidth","LastResortFonts","SERIF","SANS_SERIF","watchRunners","FontWatchRunner","activeCallbacks","inactiveCallbacks","status","lastResortWidths_","fontRulerA_","fontRulerB_","started_","activeCallback","inactiveCallback","runner","lastResortRulerA","lastResortRulerB","check_","widthA","widthB","isFallbackFont_","isLastResortFont_","finish_","widthMatches_","widthsMatchLastResortWidths_","lastResortFont","HAS_WEBKIT_FALLBACK_BUG","match","hasWebKitFallbackBug","callbacks","cb","loads","load","_testStr","fontFaceSet","fonts","legacy","ready","DOMParser","findElement","child","_svg","_glyphs","_glyphUnis","_fontFace","svgCode","parseFromString","documentElement","svg","fontFaceElement","fontElement","findGlyph","glyphName","findGlyphByUnicode","unicode","walkAllGlyph","walkGlyph","elementToPaths","getD","circle","cx","cy","ANGLE","anchorX","anchorY","controlX","tan","controlY","paths","circleToPath","buildObject","isGlyph","ud","fontFace","qualifiedName","glyph","fontHorizAdvX","fontVertAdvX","horizAdvX","vertAdvX","unitsPerEm","contentSize","outerHTML","glyphToJSON","viewBox","svgToJSON","builtins","arrowDownward","arrowUpward","edit","star","starBorder","starHalf","svgIcons","getPath2D","Path2D","breakWidth","itr","candidateIndex","chars","beforeWidth","charWidth","beforeContent","afterContent","Inline","canDraw","onReady","_callback","canvashelper","offsetRight","offsetBottom","canBreak","splitIndex","breakWord","allWidth","candidate","breakAll","InlineDrawer","_draw","_arg","InlineIcon","_icon","letterSpacing","InlineImage","_src","_imageLeft","_imageTop","_imageWidth","_imageHeight","_onloaded","_inlineImgPromise","_inlineImg","imageLeft","imageTop","imageWidth","imageHeight","_loadImage","InlinePath2D","_path","buildSvgDataUrl","XMLSerializer","serializeToString","encodeURIComponent","getSvgElement","InlineSvg","svgElem","elmWidth","elmHeight","numElmWidth","numElmHeight","drawRegisteredIcon","drawWidth","drawHeight","pathModule","upsideDown","xrate","yrate","path2d","buildInlines","inline","isIconConstructorOption","isInlineImageConstructorOption","isInlineSvgConstructorOption","regedIcons","regedIcon","iconOf","il","rgbMap","hexToNum","hex","createRGB","testRGB","rateToByte","colorToRGB0","tripleHexToRGB","g1","g2","b1","b2","sextupleHexToRGB","rgb","colorToRGB","styleColor","styleColorToRGB","INLINE_ELLIPSIS","getFont","getThemeColor","gridThemeColor","defaultThemeColor","drawInlines","inlines","drawInline","inlineWidths","inlineWidth","inlineToString","getOverflowInline","isAllowOverflow","getOverflowInlinesIndex","remWidth","breakWidthInlines","indexData","beforeInlines","overflow","afterInlines","truncateInlines","overflowInline","_inlineRect","isOverflowInlines","truncInlines","calcElapsedColor","startColor","endColor","elapsedTime","startColorRGB","endColorRGB","getRGB","colorName","diff","positionOpt","boxWidth","ThemeResolver","GridCanvasHelper","_theme","createCalculator","calcWidth","calcHeight","calculator","box","clipLeft","clipWidth","clipTop","clipHeight","paddingNums","multiInlines","rectHeight","buildedMultiInlines","procLineClamp","hasNext","procLine","lineRow","pad","buildedInline","_multiInlineRect","fillCell","fillCellWithState","getFillColorState","border","startOffset","borderWithState","CONTENT_CLASSNAME","TooltipElement","createTooltipDomElement","Tooltip","_tooltipElement","detachTooltipElement","_getTooltipElement","createTooltipElementInternal","attachTooltipElement","moveTooltipElement","TOOLTIP_INSTANCE_FACTORY","TooltipHandler","_tooltipInstances","tooltipInstances","instanceInfo","_getTooltipInstanceInfo","_isAttachCell","getTooltipInstanceInfo","layoutMap","_updateRect","_getCellValue","_getField","_getCellMessage","promises","_getCellIcon0","retIcon","iconOpt","_getRecordIndexByRow","_hasField","_onDrawValue","gridCanvasHelper","drawCellBg","fillOpt","drawCellBorder","selRecordIndex","selId","isSelectCell","_borderWithState","_getCellIcon","_refreshHeader","headerEvents","ids","headerRowHeight","_refreshRowCount","_tryWithUpdateDataSource","dataSourceEventIds","_setRecords","records","newDataSource","ofArray","_setDataSource","EMPTY","_onRangePaste","pasteRowCount","pasteColCount","hasEditable","actionColumnsBox","actionColumnsRow","duplicate","actionRow","valuesRow","valuesCol","oldValue","newEnd","_onRangeDelete","deleteRowCount","deleteColCount","_oldValue","DataSourceIterator","_dataSource","_curIndex","_data","_getIndexData","movePrev","nest","FilterData","_owner","_dataSourceItr","_filter","_filterdList","_queues","dc","filterdList","queues","indexQueue","_findIndex","timeout","_findIndexWithTimeout","testTimeout","dataSourceItr","queue","FilterDataSource","_filterData","registerPlugin","register","registerPlugins","kakaGrid","version","ListGrid","omits","omit","allowRangePaste","tooltipHandler","oldState","oldField","getHeaderField","newField","headerValues","getColumnDefine","getHeaderDefine","getColumnIndexByField","getCellRangeByField","colObj","layoutRange","focusGridCell","newFocus","makeVisibleGridCell","getHeaderCellRange","cellRange","valueCallback","changeValueCallback","_setCellValue","doSetPasteValue","newValue"],"sourceRoot":""}